<?xml version="1.0" encoding="utf-8"?>
<search> 
  
  
    
    <entry>
      <title>Linux部署ZeroTier Moon节点</title>
      <link href="//posts/53922/"/>
      <url>//posts/53922/</url>
      
        <content type="html"><![CDATA[<h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>ZeroTier是一个虚拟网络系统，可以让你在本地网络中建立虚拟局域网，并且可以连接到其他的局域网。</p><p>其主要有三部分组成：行星服务器Planet、月亮服务器Moon、客户端节点LEFA。</p><p>但是对于国内而言，由于其官方节点都位于海外，实际使用起来延迟会较高，这时候就需要部署MOON节点以加快转发和P2P的速度。</p><p>本文将介绍最近在Linux上部署Moon节点的一次经历。</p><h1 id="准备工作"><a href="#准备工作" class="headerlink" title="准备工作"></a>准备工作</h1><h2 id="1-配置ZeroTier网络"><a href="#1-配置ZeroTier网络" class="headerlink" title="1. 配置ZeroTier网络"></a>1. 配置ZeroTier网络</h2><p>首先，你需要注册一个<a href="https://www.zerotier.com/">ZeroTier</a>账号，并在<a href="https://my.zerotier.com/">管理页</a>创建一个网络。</p><p><img src="https://cdn.randench.cn/image/25/06/f5e6d0f97c12ebe2.png"></p><p>接着需要配置网络属性，主要是设置网段和是否公开（设为Private的话，别人在得到网络代码加入后，还需要你在管理页勾选Auth才能加入）。</p><p><img src="https://cdn.randench.cn/image/25/06/58cab9ef9c72f772.png"></p><h2 id="2-安装ZeroTier-One客户端"><a href="#2-安装ZeroTier-One客户端" class="headerlink" title="2. 安装ZeroTier One客户端"></a>2. 安装ZeroTier One客户端</h2><p>其次，你需要一台运行Linux的服务器，并安装ZeroTier One客户端。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">curl -s https://install.zerotier.com | <span class="built_in">sudo</span> bash</span><br></pre></td></tr></table></figure><h1 id="配置Moon节点"><a href="#配置Moon节点" class="headerlink" title="配置Moon节点"></a>配置Moon节点</h1><div class="note warning flat"><p>如果服务器有防火墙(运营商防火墙和机器防火墙都需要操作)，请在防火墙放行9993端口。</p></div><h2 id="1-加入ZeroTier网络"><a href="#1-加入ZeroTier网络" class="headerlink" title="1. 加入ZeroTier网络"></a>1. 加入ZeroTier网络</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> zerotier-cli <span class="built_in">join</span> &lt;你的Network ID&gt;</span><br></pre></td></tr></table></figure><p>如果网络为Private，加入后还需要在ZeroTier管理页面勾选Auth，否则无法加入网络。</p><p><img src="https://cdn.randench.cn/image/25/06/507428404897a220.png"></p><h2 id="2-生成Moon配置文件"><a href="#2-生成Moon配置文件" class="headerlink" title="2. 生成Moon配置文件"></a>2. 生成Moon配置文件</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> /var/lib/zerotier-one</span><br><span class="line"><span class="built_in">sudo</span> zerotier-idtool initmoon identity.public &gt; moon.json</span><br></pre></td></tr></table></figure><h2 id="3-编辑Moon配置文件"><a href="#3-编辑Moon配置文件" class="headerlink" title="3. 编辑Moon配置文件"></a>3. 编辑Moon配置文件</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> vi moon.json</span><br></pre></td></tr></table></figure><p>配置文件中可以看到当前服务器的ID，后面会用到</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line"> <span class="attr">&quot;id&quot;</span><span class="punctuation">:</span> <span class="string">&quot;xxxxxxxxxx&quot;</span><span class="punctuation">,</span></span><br><span class="line"> <span class="attr">&quot;objtype&quot;</span><span class="punctuation">:</span> <span class="string">&quot;world&quot;</span><span class="punctuation">,</span></span><br><span class="line"> <span class="attr">&quot;roots&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">  <span class="punctuation">&#123;</span></span><br><span class="line">   <span class="attr">&quot;identity&quot;</span><span class="punctuation">:</span> <span class="string">&quot;xxxxxxxxxx:xxxxxxxxxx&quot;</span><span class="punctuation">,</span></span><br><span class="line">   <span class="attr">&quot;stableEndpoints&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;你的公网IP/9993&quot;</span><span class="punctuation">]</span></span><br><span class="line">  <span class="punctuation">&#125;</span></span><br><span class="line"> <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line"> <span class="attr">&quot;signingKey&quot;</span><span class="punctuation">:</span> <span class="string">&quot;xxxxxxxxxx&quot;</span><span class="punctuation">,</span></span><br><span class="line"> <span class="attr">&quot;signingKey_SECRET&quot;</span><span class="punctuation">:</span> <span class="string">&quot;xxxxxxxxxx&quot;</span><span class="punctuation">,</span></span><br><span class="line"> <span class="attr">&quot;updatesMustBeSignedBy&quot;</span><span class="punctuation">:</span> <span class="string">&quot;xxxxxxxxxx&quot;</span><span class="punctuation">,</span></span><br><span class="line"> <span class="attr">&quot;worldType&quot;</span><span class="punctuation">:</span> <span class="string">&quot;moon&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure><h2 id="4-生成签名"><a href="#4-生成签名" class="headerlink" title="4. 生成签名"></a>4. 生成签名</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> zerotier-idtool genmoon moon.json</span><br></pre></td></tr></table></figure><h2 id="5-配置-moons-d-目录"><a href="#5-配置-moons-d-目录" class="headerlink" title="5. 配置 moons.d 目录"></a>5. 配置 moons.d 目录</h2><p>此处的<code>*******.moon</code>是你刚才生成的签名文件名，也就是服务器的ID。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">mkdir</span> moons.d</span><br><span class="line"><span class="built_in">mv</span> *******.moon moons.d/</span><br></pre></td></tr></table></figure><h2 id="6-启动ZeroTier服务"><a href="#6-启动ZeroTier服务" class="headerlink" title="6. 启动ZeroTier服务"></a>6. 启动ZeroTier服务</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> systemctl <span class="built_in">enable</span> zerotier-one</span><br><span class="line"><span class="built_in">sudo</span> systemctl restart zerotier-one</span><br></pre></td></tr></table></figure><h1 id="验证Moon节点"><a href="#验证Moon节点" class="headerlink" title="验证Moon节点"></a>验证Moon节点</h1><h2 id="1-加入Moon节点"><a href="#1-加入Moon节点" class="headerlink" title="1. 加入Moon节点"></a>1. 加入Moon节点</h2><p>Windows直接管理员模式打开Powershell，输入以下命令加入Moon节点：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">zerotier-cli orbit &lt;Moon节点服务器ID&gt; &lt;Moon节点服务器ID&gt;</span><br></pre></td></tr></table></figure><h2 id="2-验证Moon节点"><a href="#2-验证Moon节点" class="headerlink" title="2. 验证Moon节点"></a>2. 验证Moon节点</h2><p>继续在Powershell中输入以下命令查看Moon节点状态：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">zerotier-cli listpeers</span><br></pre></td></tr></table></figure><p>看到存在Moon节点的ID，说明Moon节点加入成功。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">200 listpeers 服务器ID 服务器IP/9993;4452;1476 17 1.14.2 MOON</span><br></pre></td></tr></table></figure><p>至此，Linux部署ZeroTier Moon节点完成。</p><h1 id="结语"><a href="#结语" class="headerlink" title="结语"></a>结语</h1><p>通过部署自己的ZeroTier Moon节点，你可以显著改善虚拟网络的连接质量和稳定性。这对于需要跨地域组网或官方服务器连接不畅的情况尤其有用。</p><p>相比于自建Planet节点，Moon节点的操作简单，维护成本低，是提升ZeroTier使用体验的经济有效方案。</p>]]></content>
      
      
      <categories>
          
          <category> 实用 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Linux </tag>
            
            <tag> 教程 </tag>
            
            <tag> ZeroTier </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>音乐馆解除VIP限制</title>
      <link href="//posts/2316/"/>
      <url>//posts/2316/</url>
      
        <content type="html"><![CDATA[<h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>AnZhiYu主题有个<a href="https://docs.anheyu.com/page/music.html">音乐馆</a>的页面，是通过调用<a href="https://github.com/injahow/meting-api">Meting API</a>来获取音乐消息的，但是默认的meting-api已经无法使用，需要<a href="https://blog.anheyu.com/posts/a76e.html">更换CDN或自建API</a>。不过我发现公益项目和自建API貌似都存在VIP歌曲的限制，由于部分歌曲需要VIP才能播放，导致只能获取到30s的试听，无法播放完整的歌曲。因此思考能否绕过VIP限制，获取完整的歌曲。</p><h1 id="解决方案"><a href="#解决方案" class="headerlink" title="解决方案"></a>解决方案</h1><div class="note warning flat"><p>本文中所有方法均需要自建API，需要完成服务器的部署和域名的解析，将<code>_config.anzhiyu.yml</code>中的<code>CDN.option.meting_api</code>改为自己的API地址。</p></div><h2 id="1-使用Cookie"><a href="#1-使用Cookie" class="headerlink" title="1. 使用Cookie"></a>1. 使用Cookie</h2><p>meting-api项目提供了使用Cookie获取音乐的方法，可以直接使用，但是此方法存在Cookie过期问题，需要定时更新Cookie，十分麻烦，因此不予采用。</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// index.php</span></span><br><span class="line"><span class="comment">// 设置cookie</span></span><br><span class="line"><span class="keyword">if</span> (<span class="variable">$server</span> == <span class="string">&#x27;netease&#x27;</span>) &#123;</span><br><span class="line">    <span class="variable">$api</span>-&gt;<span class="title function_ invoke__">cookie</span>(<span class="string">&#x27;NMTID=00OtTy3WMXKPeSbp0qLuGy8FKJYOrAAAAGNCHbO_Q;&#x27;</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="2-使用云盘"><a href="#2-使用云盘" class="headerlink" title="2. 使用云盘"></a>2. 使用云盘</h2><div class="note warning flat"><p>因为meting-api项目的作者已经不再维护，因此kuwo等音乐平台的API似乎已经失效，而QQ音乐的网盘请求存在次数限制，故本文的修改只涉及了网易云音乐。</p></div><p><a href="https://music.gdstudio.xyz/">https://music.gdstudio.xyz/</a>提供了网易云音乐的云盘服务，使用它的<a href="https://music-api.gdstudio.xyz/api.php">API</a>可以获取完整的歌曲。</p><p>修改<a href="https://github.com/injahow/meting-api">Meting API</a>项目中的<code>/src/meting.php</code>文件，修改以下片段即可：</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">url</span>(<span class="params"><span class="variable">$id</span>, <span class="variable">$br</span> = <span class="number">320</span></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">switch</span> (<span class="variable language_">$this</span>-&gt;server) &#123;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&#x27;netease&#x27;</span>:</span><br><span class="line">            <span class="comment">// 首先尝试 GD Studio API</span></span><br><span class="line">            <span class="variable">$gd_api</span> = <span class="keyword">array</span>(</span><br><span class="line">                <span class="string">&#x27;method&#x27;</span> =&gt; <span class="string">&#x27;POST&#x27;</span>,</span><br><span class="line">                <span class="string">&#x27;url&#x27;</span>    =&gt; <span class="string">&#x27;https://music-api.gdstudio.xyz/api.php&#x27;</span>,</span><br><span class="line">                <span class="string">&#x27;body&#x27;</span>   =&gt; <span class="keyword">array</span>(</span><br><span class="line">                    <span class="string">&#x27;types&#x27;</span> =&gt; <span class="string">&#x27;url&#x27;</span>,</span><br><span class="line">                    <span class="string">&#x27;id&#x27;</span> =&gt; <span class="variable">$id</span>,</span><br><span class="line">                    <span class="string">&#x27;br&#x27;</span> =&gt; <span class="variable">$br</span>,</span><br><span class="line">                ),</span><br><span class="line">            );</span><br><span class="line">            </span><br><span class="line">            <span class="variable">$result</span> = <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">exec</span>(<span class="variable">$gd_api</span>);</span><br><span class="line">            <span class="variable">$result_arr</span> = <span class="title function_ invoke__">json_decode</span>(<span class="variable">$result</span>, <span class="literal">true</span>);</span><br><span class="line">            </span><br><span class="line">            <span class="comment">// 检查 GD Studio API 返回结果是否有效</span></span><br><span class="line">            <span class="keyword">if</span> (!<span class="keyword">empty</span>(<span class="variable">$result_arr</span>) &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$result_arr</span>[<span class="string">&#x27;url&#x27;</span>]) &amp;&amp; !<span class="keyword">empty</span>(<span class="variable">$result_arr</span>[<span class="string">&#x27;url&#x27;</span>])) &#123;</span><br><span class="line">                <span class="comment">// 转换为与原始 API 相同的格式</span></span><br><span class="line">                <span class="variable">$formatted_result</span> = <span class="keyword">array</span>(</span><br><span class="line">                    <span class="string">&#x27;url&#x27;</span>  =&gt; <span class="variable">$result_arr</span>[<span class="string">&#x27;url&#x27;</span>],</span><br><span class="line">                    <span class="string">&#x27;size&#x27;</span> =&gt; <span class="keyword">isset</span>(<span class="variable">$result_arr</span>[<span class="string">&#x27;size&#x27;</span>]) ? <span class="variable">$result_arr</span>[<span class="string">&#x27;size&#x27;</span>] : <span class="number">0</span>,</span><br><span class="line">                    <span class="string">&#x27;br&#x27;</span>   =&gt; <span class="keyword">isset</span>(<span class="variable">$result_arr</span>[<span class="string">&#x27;br&#x27;</span>]) ? <span class="variable">$result_arr</span>[<span class="string">&#x27;br&#x27;</span>] : <span class="variable">$br</span>,</span><br><span class="line">                );</span><br><span class="line">                <span class="keyword">return</span> <span class="title function_ invoke__">json_encode</span>(<span class="variable">$formatted_result</span>);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// 如果 GD Studio API 失败，使用原始网易云 API</span></span><br><span class="line">            <span class="variable">$api</span> = <span class="keyword">array</span>(</span><br><span class="line">                <span class="string">&#x27;method&#x27;</span> =&gt; <span class="string">&#x27;POST&#x27;</span>,</span><br><span class="line">                <span class="string">&#x27;url&#x27;</span>    =&gt; <span class="string">&#x27;http://music.163.com/api/song/enhance/player/url&#x27;</span>,</span><br><span class="line">                <span class="string">&#x27;body&#x27;</span>   =&gt; <span class="keyword">array</span>(</span><br><span class="line">                    <span class="string">&#x27;ids&#x27;</span> =&gt; <span class="keyword">array</span>(<span class="variable">$id</span>),</span><br><span class="line">                    <span class="string">&#x27;br&#x27;</span>  =&gt; <span class="variable">$br</span> * <span class="number">1000</span>,</span><br><span class="line">                ),</span><br><span class="line">                <span class="string">&#x27;encode&#x27;</span> =&gt; <span class="string">&#x27;netease_AESCBC&#x27;</span>,</span><br><span class="line">                <span class="string">&#x27;decode&#x27;</span> =&gt; <span class="string">&#x27;netease_url&#x27;</span>,</span><br><span class="line">            );</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line"></span><br></pre></td></tr></table></figure><p>现在，你的音乐馆页面应该可以获取完整的歌曲了。</p><h1 id="进阶"><a href="#进阶" class="headerlink" title="进阶"></a>进阶</h1><div class="note warning flat"><p>跨域访问可能会出现CORS问题，需要在服务器上放行相关域名，可能还需要开启反代功能。</p></div><p>如果你还部署了<a href="https://github.com/beer-on-ice/UNM-Server">网易云解灰项目</a>，那么你还可以添加解灰API的请求以实现获取一些无版权的歌曲（例如周杰伦）。</p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">url</span>(<span class="params"><span class="variable">$id</span>, <span class="variable">$br</span> = <span class="number">320</span></span>)</span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">switch</span> (<span class="variable language_">$this</span>-&gt;server) &#123;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&#x27;netease&#x27;</span>:</span><br><span class="line">            <span class="comment">// 首先尝试 GD Studio API</span></span><br><span class="line">            <span class="variable">$gd_api</span> = <span class="keyword">array</span>(</span><br><span class="line">                <span class="string">&#x27;method&#x27;</span> =&gt; <span class="string">&#x27;POST&#x27;</span>,</span><br><span class="line">                <span class="string">&#x27;url&#x27;</span>    =&gt; <span class="string">&#x27;https://music-api.gdstudio.xyz/api.php&#x27;</span>,</span><br><span class="line">                <span class="string">&#x27;body&#x27;</span>   =&gt; <span class="keyword">array</span>(</span><br><span class="line">                    <span class="string">&#x27;types&#x27;</span> =&gt; <span class="string">&#x27;url&#x27;</span>,</span><br><span class="line">                    <span class="string">&#x27;id&#x27;</span> =&gt; <span class="variable">$id</span>,</span><br><span class="line">                    <span class="string">&#x27;br&#x27;</span> =&gt; <span class="variable">$br</span>,</span><br><span class="line">                ),</span><br><span class="line">            );</span><br><span class="line">            </span><br><span class="line">            <span class="variable">$result</span> = <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">exec</span>(<span class="variable">$gd_api</span>);</span><br><span class="line">            <span class="variable">$result_arr</span> = <span class="title function_ invoke__">json_decode</span>(<span class="variable">$result</span>, <span class="literal">true</span>);</span><br><span class="line">            </span><br><span class="line">            <span class="comment">// 检查 GD Studio API 返回结果是否有效</span></span><br><span class="line">            <span class="keyword">if</span> (!<span class="keyword">empty</span>(<span class="variable">$result_arr</span>) &amp;&amp; <span class="keyword">isset</span>(<span class="variable">$result_arr</span>[<span class="string">&#x27;url&#x27;</span>]) &amp;&amp; !<span class="keyword">empty</span>(<span class="variable">$result_arr</span>[<span class="string">&#x27;url&#x27;</span>])) &#123;</span><br><span class="line">                <span class="comment">// 转换为与原始 API 相同的格式</span></span><br><span class="line">                <span class="variable">$formatted_result</span> = <span class="keyword">array</span>(</span><br><span class="line">                    <span class="string">&#x27;url&#x27;</span>  =&gt; <span class="variable">$result_arr</span>[<span class="string">&#x27;url&#x27;</span>],</span><br><span class="line">                    <span class="string">&#x27;size&#x27;</span> =&gt; <span class="keyword">isset</span>(<span class="variable">$result_arr</span>[<span class="string">&#x27;size&#x27;</span>]) ? <span class="variable">$result_arr</span>[<span class="string">&#x27;size&#x27;</span>] : <span class="number">0</span>,</span><br><span class="line">                    <span class="string">&#x27;br&#x27;</span>   =&gt; <span class="keyword">isset</span>(<span class="variable">$result_arr</span>[<span class="string">&#x27;br&#x27;</span>]) ? <span class="variable">$result_arr</span>[<span class="string">&#x27;br&#x27;</span>] : <span class="variable">$br</span>,</span><br><span class="line">                );</span><br><span class="line">                <span class="keyword">return</span> <span class="title function_ invoke__">json_encode</span>(<span class="variable">$formatted_result</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            </span><br><span class="line">            <span class="comment">// 如果 GD Studio API 失败，尝试 解灰 API</span></span><br><span class="line">            <span class="variable">$unlock_api</span> = <span class="keyword">array</span>(</span><br><span class="line">                <span class="string">&#x27;method&#x27;</span> =&gt; <span class="string">&#x27;GET&#x27;</span>,</span><br><span class="line">                <span class="string">&#x27;url&#x27;</span>    =&gt; <span class="string">&#x27;https://your-unm-server.com/match&#x27;</span>,</span><br><span class="line">                <span class="string">&#x27;body&#x27;</span>   =&gt; <span class="keyword">array</span>(</span><br><span class="line">                    <span class="string">&#x27;id&#x27;</span> =&gt; <span class="variable">$id</span>,</span><br><span class="line">                ),</span><br><span class="line">            );</span><br><span class="line">            </span><br><span class="line">            <span class="variable">$result</span> = <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">exec</span>(<span class="variable">$unlock_api</span>);</span><br><span class="line">            <span class="variable">$result_arr</span> = <span class="title function_ invoke__">json_decode</span>(<span class="variable">$result</span>, <span class="literal">true</span>);</span><br><span class="line">            </span><br><span class="line">            <span class="comment">// 检查 解灰 API 返回结果是否有效</span></span><br><span class="line">            <span class="keyword">if</span> (!<span class="keyword">empty</span>(<span class="variable">$result_arr</span>) &amp;&amp; <span class="variable">$result_arr</span>[<span class="string">&#x27;code&#x27;</span>] == <span class="number">200</span> &amp;&amp; !<span class="keyword">empty</span>(<span class="variable">$result_arr</span>[<span class="string">&#x27;data&#x27;</span>][<span class="string">&#x27;url&#x27;</span>])) &#123;</span><br><span class="line">                <span class="comment">// 转换为与原始 API 相同的格式</span></span><br><span class="line">                <span class="variable">$formatted_result</span> = <span class="keyword">array</span>(</span><br><span class="line">                    <span class="string">&#x27;url&#x27;</span>  =&gt; <span class="variable">$result_arr</span>[<span class="string">&#x27;data&#x27;</span>][<span class="string">&#x27;url&#x27;</span>],</span><br><span class="line">                    <span class="string">&#x27;size&#x27;</span> =&gt; <span class="keyword">isset</span>(<span class="variable">$result_arr</span>[<span class="string">&#x27;data&#x27;</span>][<span class="string">&#x27;size&#x27;</span>]) ? <span class="variable">$result_arr</span>[<span class="string">&#x27;data&#x27;</span>][<span class="string">&#x27;size&#x27;</span>] : <span class="number">0</span>,</span><br><span class="line">                    <span class="string">&#x27;br&#x27;</span>   =&gt; <span class="keyword">isset</span>(<span class="variable">$result_arr</span>[<span class="string">&#x27;data&#x27;</span>][<span class="string">&#x27;br&#x27;</span>]) ? <span class="variable">$result_arr</span>[<span class="string">&#x27;data&#x27;</span>][<span class="string">&#x27;br&#x27;</span>] / <span class="number">1000</span> : <span class="variable">$br</span>,</span><br><span class="line">                );</span><br><span class="line">                <span class="keyword">return</span> <span class="title function_ invoke__">json_encode</span>(<span class="variable">$formatted_result</span>);</span><br><span class="line">            &#125;</span><br><span class="line">            </span><br><span class="line">            <span class="comment">// 如果两个 API 都失败，使用原始网易云 API</span></span><br><span class="line">            <span class="variable">$api</span> = <span class="keyword">array</span>(</span><br><span class="line">                <span class="string">&#x27;method&#x27;</span> =&gt; <span class="string">&#x27;POST&#x27;</span>,</span><br><span class="line">                <span class="string">&#x27;url&#x27;</span>    =&gt; <span class="string">&#x27;http://music.163.com/api/song/enhance/player/url&#x27;</span>,</span><br><span class="line">                <span class="string">&#x27;body&#x27;</span>   =&gt; <span class="keyword">array</span>(</span><br><span class="line">                    <span class="string">&#x27;ids&#x27;</span> =&gt; <span class="keyword">array</span>(<span class="variable">$id</span>),</span><br><span class="line">                    <span class="string">&#x27;br&#x27;</span>  =&gt; <span class="variable">$br</span> * <span class="number">1000</span>,</span><br><span class="line">                ),</span><br><span class="line">                <span class="string">&#x27;encode&#x27;</span> =&gt; <span class="string">&#x27;netease_AESCBC&#x27;</span>,</span><br><span class="line">                <span class="string">&#x27;decode&#x27;</span> =&gt; <span class="string">&#x27;netease_url&#x27;</span>,</span><br><span class="line">            );</span><br><span class="line">            <span class="keyword">break</span>;</span><br></pre></td></tr></table></figure><p>这样，你的音乐馆页面就可以既没有VIP限制，又可以获取完整的歌曲，甚至可以播放无版权歌曲。</p>]]></content>
      
      
      <categories>
          
          <category> Hexo </category>
          
      </categories>
      
      
        <tags>
            
            <tag> AnZhiYu </tag>
            
            <tag> 教程 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>上传Python项目到PyPI</title>
      <link href="//posts/65106/"/>
      <url>//posts/65106/</url>
      
        <content type="html"><![CDATA[<h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>本教程介绍如何将 Python 项目上传到 PyPI，使用 twine 进行上传，并涵盖以下三种情况：</p><ol><li><p>一般方式（基于 setup.py）</p></li><li><p>使用 Poetry</p></li><li><p>不使用 setup.py（基于 pyproject.toml）</p></li></ol><p>你也可以直接查看<a href="https://packaging.python.org/en/latest/guides/section-build-and-publish/">官方文档</a></p><h1 id="先决条件"><a href="#先决条件" class="headerlink" title="先决条件"></a>先决条件</h1><p>在开始之前，你需要：</p><ul><li>在 <a href="https://github.com/">GitHub</a> 上创建一个新的仓库，并推送你的项目代码。</li><li>在 <a href="https://pypi.org/">PyPI</a> 上创建一个账号，并创建相应的项目（首次上传时自动创建）</li></ul><h1 id="1-创建-API-Token"><a href="#1-创建-API-Token" class="headerlink" title="1. 创建 API Token"></a>1. 创建 API Token</h1><h2 id="1-1-注册-PyPI-账号"><a href="#1-1-注册-PyPI-账号" class="headerlink" title="1.1 注册 PyPI 账号"></a>1.1 注册 PyPI 账号</h2><p>访问 <a href="https://pypi.org/">PyPI 官网</a> 并注册一个账号。</p><h2 id="1-2-创建-API-Token"><a href="#1-2-创建-API-Token" class="headerlink" title="1.2 创建 API Token"></a>1.2 创建 API Token</h2><div class="note info flat"><p>PyPI 注册可能会要求开启2FA（两步认证），可以下载<a href="https://www.microsoft.com/zh-cn/security/mobile-authenticator-app">微软的验证App</a>扫码通过或者直接安装<a href="https://authenticator.cc/">浏览器插件</a>保存密钥。</p></div><ol><li>登录 PyPI 后，点击右上角的用户名。</li><li>选择 <strong>Account settings</strong>。</li><li>在 <strong>API tokens</strong> 部分，点击 <strong>Add API token</strong>(或者<a href="https://pypi.org/manage/account/token/">直接跳转</a>)。</li><li>选择 <strong>Scope</strong>（可以选择适用于所有项目或仅适用于某个项目），不想麻烦直接选择 <strong>All projects</strong>即可。</li><li>生成 Token 并妥善保存。</li></ol><h2 id="1-3-配置-Token"><a href="#1-3-配置-Token" class="headerlink" title="1.3 配置 Token"></a>1.3 配置 Token</h2><h3 id="Windows"><a href="#Windows" class="headerlink" title="Windows"></a>Windows</h3><p>在用户主目录 (<code>C:\Users\YourUsername\</code>) 下创建 <code>.pypirc</code> 文件（如果不存在）添加以下内容：</p><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">[distutils]</span></span><br><span class="line"><span class="attr">index-servers</span> =</span><br><span class="line">    pypi</span><br><span class="line"></span><br><span class="line"><span class="section">[pypi]</span></span><br><span class="line">  <span class="attr">username</span> = __token__</span><br><span class="line">  <span class="attr">password</span> = your_pypi_api_token</span><br></pre></td></tr></table></figure><h3 id="Linux-macOS"><a href="#Linux-macOS" class="headerlink" title="Linux&#x2F;macOS"></a>Linux&#x2F;macOS</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> vim ~/.pypirc</span><br></pre></td></tr></table></figure><p>在 <code>~/.pypirc</code> 文件中添加以下内容：</p><figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">[distutils]</span></span><br><span class="line"><span class="attr">index-servers</span> =</span><br><span class="line">    pypi</span><br><span class="line"></span><br><span class="line"><span class="section">[pypi]</span></span><br><span class="line">  <span class="attr">username</span> = __token__</span><br><span class="line">  <span class="attr">password</span> = your_pypi_api_token</span><br></pre></td></tr></table></figure><h1 id="2-上传项目"><a href="#2-上传项目" class="headerlink" title="2. 上传项目"></a>2. 上传项目</h1><h2 id="1-一般方式（基于-setup-py）"><a href="#1-一般方式（基于-setup-py）" class="headerlink" title="1. 一般方式（基于 setup.py）"></a>1. 一般方式（基于 <code>setup.py</code>）</h2><h2 id="1-1-安装必要工具"><a href="#1-1-安装必要工具" class="headerlink" title="1.1 安装必要工具"></a>1.1 安装必要工具</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install setuptools wheel twine</span><br></pre></td></tr></table></figure><h2 id="1-2-创建-setup-py"><a href="#1-2-创建-setup-py" class="headerlink" title="1.2 创建 setup.py"></a>1.2 创建 <code>setup.py</code></h2><p>在项目根目录创建 <code>setup.py</code> 文件：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> setuptools <span class="keyword">import</span> setup, find_packages</span><br><span class="line"></span><br><span class="line">setup(</span><br><span class="line">    name=<span class="string">&#x27;your_package_name&#x27;</span>,  <span class="comment"># 包名</span></span><br><span class="line">    version=<span class="string">&#x27;0.1.0&#x27;</span>,</span><br><span class="line">    packages=find_packages(),</span><br><span class="line">    install_requires=[</span><br><span class="line">        <span class="string">&#x27;requests&#x27;</span>,  <span class="comment"># 依赖包列表</span></span><br><span class="line">    ],</span><br><span class="line">    author=<span class="string">&#x27;Your Name&#x27;</span>,  <span class="comment"># 作者名</span></span><br><span class="line">    author_email=<span class="string">&#x27;your_email@example.com&#x27;</span>,  <span class="comment"># 作者邮箱</span></span><br><span class="line">    description=<span class="string">&#x27;A brief description of your package&#x27;</span>,  <span class="comment"># 项目简介</span></span><br><span class="line">    url=<span class="string">&#x27;https://github.com/your_username/your_repo&#x27;</span>,  <span class="comment"># 项目地址</span></span><br><span class="line">    classifiers=[</span><br><span class="line">        <span class="string">&#x27;Programming Language :: Python :: 3&#x27;</span>,  <span class="comment"># Python 版本</span></span><br><span class="line">        <span class="string">&#x27;License :: OSI Approved :: MIT License&#x27;</span>,  <span class="comment"># 许可证</span></span><br><span class="line">        <span class="string">&#x27;Operating System :: OS Independent&#x27;</span>,  <span class="comment"># 操作系统</span></span><br><span class="line">    ],</span><br><span class="line">    python_requires=<span class="string">&#x27;&gt;=3.9&#x27;</span>, <span class="comment"># Python 版本要求</span></span><br><span class="line">)</span><br></pre></td></tr></table></figure><h2 id="1-3-生成分发包"><a href="#1-3-生成分发包" class="headerlink" title="1.3 生成分发包"></a>1.3 生成分发包</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python setup.py sdist bdist_wheel</span><br></pre></td></tr></table></figure><p>生成的 <code>.tar.gz</code> 和 <code>.whl</code> 文件会存放在 <code>dist/</code> 目录下。</p><h2 id="1-4-上传到-PyPI"><a href="#1-4-上传到-PyPI" class="headerlink" title="1.4 上传到 PyPI"></a>1.4 上传到 PyPI</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">twine upload dist/*</span><br></pre></td></tr></table></figure><h1 id="2-使用-Poetry"><a href="#2-使用-Poetry" class="headerlink" title="2. 使用 Poetry"></a>2. 使用 Poetry</h1><h2 id="2-1-安装-Poetry"><a href="#2-1-安装-Poetry" class="headerlink" title="2.1 安装 Poetry"></a>2.1 安装 Poetry</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install poetry</span><br></pre></td></tr></table></figure><h2 id="2-2-初始化项目"><a href="#2-2-初始化项目" class="headerlink" title="2.2 初始化项目"></a>2.2 初始化项目</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">poetry init</span><br></pre></td></tr></table></figure><p>按照提示填写项目信息。</p><h2 id="2-3-配置-PyPI-认证"><a href="#2-3-配置-PyPI-认证" class="headerlink" title="2.3 配置 PyPI 认证"></a>2.3 配置 PyPI 认证</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">poetry config pypi-token.pypi your_pypi_api_token</span><br></pre></td></tr></table></figure><h2 id="2-4-构建并上传"><a href="#2-4-构建并上传" class="headerlink" title="2.4 构建并上传"></a>2.4 构建并上传</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">poetry build</span><br><span class="line">poetry publish</span><br></pre></td></tr></table></figure><h1 id="3-不使用-setup-py（基于-pyproject-toml）"><a href="#3-不使用-setup-py（基于-pyproject-toml）" class="headerlink" title="3. 不使用 setup.py（基于 pyproject.toml）"></a>3. 不使用 <code>setup.py</code>（基于 <code>pyproject.toml</code>）</h1><h2 id="3-1-安装-build"><a href="#3-1-安装-build" class="headerlink" title="3.1 安装 build"></a>3.1 安装 <code>build</code></h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install build</span><br></pre></td></tr></table></figure><h2 id="3-2-创建-pyproject-toml"><a href="#3-2-创建-pyproject-toml" class="headerlink" title="3.2 创建 pyproject.toml"></a>3.2 创建 <code>pyproject.toml</code></h2><figure class="highlight toml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">[build-system]</span></span><br><span class="line"><span class="attr">requires</span> = [<span class="string">&quot;setuptools&quot;</span>, <span class="string">&quot;wheel&quot;</span>]</span><br><span class="line"><span class="attr">build-backend</span> = <span class="string">&quot;setuptools.build_meta&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="section">[project]</span></span><br><span class="line"><span class="attr">name</span> = <span class="string">&quot;your_package_name&quot;</span></span><br><span class="line"><span class="attr">version</span> = <span class="string">&quot;0.1.0&quot;</span></span><br><span class="line"><span class="attr">description</span> = <span class="string">&quot;A brief description of your package&quot;</span></span><br><span class="line"><span class="attr">authors</span> = [</span><br><span class="line">    &#123; name=<span class="string">&quot;Your Name&quot;</span>, email=<span class="string">&quot;your_email@example.com&quot;</span> &#125;</span><br><span class="line">]</span><br><span class="line"><span class="attr">readme</span> = <span class="string">&quot;README.md&quot;</span></span><br><span class="line"><span class="attr">requires-python</span> = <span class="string">&quot;&gt;=3.9&quot;</span></span><br><span class="line"><span class="attr">dependencies</span> = [</span><br><span class="line">    <span class="string">&quot;requests&quot;</span></span><br><span class="line">]</span><br><span class="line"><span class="attr">license</span> = &#123; text = <span class="string">&quot;MIT&quot;</span> &#125;</span><br><span class="line"></span><br><span class="line"><span class="section">[project.urls]</span></span><br><span class="line"><span class="attr">&quot;Homepage&quot;</span> = <span class="string">&quot;https://github.com/your_username/your_repo&quot;</span></span><br></pre></td></tr></table></figure><h2 id="3-3-生成分发包"><a href="#3-3-生成分发包" class="headerlink" title="3.3 生成分发包"></a>3.3 生成分发包</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python -m build</span><br></pre></td></tr></table></figure><h2 id="3-4-上传到-PyPI"><a href="#3-4-上传到-PyPI" class="headerlink" title="3.4 上传到 PyPI"></a>3.4 上传到 PyPI</h2><p>如果想先测试上传，可以使用 <code>TestPyPI</code>：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">twine upload --repository testpypi dist/*</span><br></pre></td></tr></table></figure><p>然后在 <a href="https://test.pypi.org/">https://test.pypi.org/</a> 上查看效果。</p><p>确认无误后，再上传到正式 PyPI：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">twine upload dist/*</span><br></pre></td></tr></table></figure><h1 id="5-总结"><a href="#5-总结" class="headerlink" title="5. 总结"></a>5. 总结</h1><ul><li><strong>一般方式</strong> 使用 <code>setup.py</code> 和 <code>twine</code> 进行构建和上传。</li><li><strong>Poetry</strong> 提供更现代的依赖管理和自动上传方式。</li><li><strong>基于 <code>pyproject.toml</code></strong> 可替代 <code>setup.py</code>，配合 <code>build</code> 和 <code>twine</code> 上传。</li></ul><p>选择适合自己的方式，即可轻松发布 Python 包到 PyPI！</p>]]></content>
      
      
      <categories>
          
          <category> 编程 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Python </tag>
            
            <tag> PyPI </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>RKR98键盘使用说明</title>
      <link href="//posts/42313/"/>
      <url>//posts/42313/</url>
      
        <content type="html"><![CDATA[<h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>由于本人时常记不住RK R98键盘的组合键，又不想每次都去查，所以就写下这篇文章，方便自己查阅。</p><h1 id="小键盘指示灯"><a href="#小键盘指示灯" class="headerlink" title="小键盘指示灯"></a>小键盘指示灯</h1><p><img src="https://cdn.randench.cn/image/25/03/991738802826b130.png"></p><h1 id="常用快捷键"><a href="#常用快捷键" class="headerlink" title="常用快捷键"></a>常用快捷键</h1><table><thead><tr><th><strong>按键</strong></th><th><strong>按键功能</strong></th></tr></thead><tbody><tr><td><code>Fn</code> + <code>Enter</code></td><td>查看电池电量</td></tr><tr><td><code>Fn</code> + <code>A</code></td><td>切换到Windows系统组合键</td></tr><tr><td><code>Fn</code> + <code>S</code></td><td>切换到mac系统组合键</td></tr><tr><td><code>Fn</code> + <code>Ins</code></td><td>Scrlk（Scroll Lock）</td></tr><tr><td><code>Fn</code> + <code>PrtSc</code></td><td>Home</td></tr><tr><td><code>Fn</code> + <code>PgUp</code></td><td>Pause</td></tr><tr><td><code>Fn</code> + <code>PgDn</code></td><td>End</td></tr></tbody></table><h1 id="背光控制"><a href="#背光控制" class="headerlink" title="背光控制"></a>背光控制</h1><table><thead><tr><th>按键</th><th>功能</th><th>按键</th><th>功能</th></tr></thead><tbody><tr><td><code>Fn</code> + <code>↑</code></td><td>字健背光亮度+</td><td><code>Fn</code> + <code>win</code></td><td>窗口锁定</td></tr><tr><td><code>Fn</code> + <code>↓</code></td><td>字健背光亮度-</td><td><code>Fn</code> + <code>— _</code></td><td>侧边灯切换</td></tr><tr><td><code>Fn</code> + <code>←</code></td><td>动态背光速度-</td><td><code>Fn</code> + <code>\</code></td><td>背光效果切换</td></tr><tr><td><code>Fn</code> + <code>→</code></td><td>动态背光速度+</td><td><code>Fn</code> + <code>Space</code></td><td>长按三秒，恢复出厂设置</td></tr><tr><td><code>Fn</code> + <code>+</code></td><td>灯条亮度+</td><td><code>Fn</code> + <code>, &lt;</code></td><td>切换背光颜色</td></tr><tr><td><code>Fn</code> + <code>-</code></td><td>灯条亮度-</td><td><code>Fn</code> + <code>= +</code></td><td>切换灯条颜色</td></tr><tr><td><code>Fn</code> + <code>Esc</code></td><td>关闭所有灯光</td><td></td><td></td></tr></tbody></table><h1 id="背光录制方法"><a href="#背光录制方法" class="headerlink" title="背光录制方法"></a>背光录制方法</h1><ol><li>按<code>Fn</code> + <code>1!</code>选择要自定义的背光注：<code>Fn</code> + <code>2@</code>和<code>Fn</code> + <code>3#</code>为固定灯效，不可录制</li><li>按<code>Fn</code> + <code>Backspace</code>进入背光录制模式</li><li>按下想要录制背光的按键，重复此步骤，录制自己想要的背光</li><li>完成后，再次按下<code>Fn</code> + <code>Backspace</code>，将保存并推出背光录制模式</li></ol><p><img src="https://cdn.randench.cn/image/25/03/7b9e760ed13cb63e.jpg" alt="背光录制"></p><h1 id="蓝牙配对方法"><a href="#蓝牙配对方法" class="headerlink" title="蓝牙配对方法"></a>蓝牙配对方法</h1><ol><li>开关拨到<code>B</code>状态。</li><li><code>Fn</code>+<code>Q</code>&#x2F;<code>W</code>&#x2F;<code>E</code>.任意一组长按3秒对码，比如<code>Fn</code>+<code>Q</code>，此时<code>Q</code>键持续闪烁，表示已进入配对状态，慢闪烁表示键盘在回连状态。</li><li>打开电脑&#x2F;手机蓝牙，搜索并连接设备，搜索显示的名称：<code>R98RGB 3.0</code>（连接PC端Windows7以下系统），<code>R98RGB 5.0</code>(连接Windows8以上系统版本，移动设备等）。</li><li>完成连接以此类推：重复以上步骤，<code>Q</code>&#x2F;<code>W</code>&#x2F;<code>E</code>可存储3组蓝牙设备，在使用切换时短按<code>Fn</code>+<code>Q</code>&#x2F;<code>W</code>&#x2F;<code>E</code>，即可在不同蓝牙设备之间切换（温馨提示：使用切换前，请先配对好3组蓝牙）</li></ol><h1 id="2-4G配对方法"><a href="#2-4G配对方法" class="headerlink" title="2.4G配对方法"></a>2.4G配对方法</h1><p>开关拨到G状态。<code>Fn</code>+<code>P</code>长按对码，<code>P</code>键闪烁插入接收器，<code>P</code>键停止闪烁即对码成功。慢闪烁表示键盘在回连状态。（温馨提示：出厂时已配对好接收器，无需再次配对）</p><h1 id="WINDOWS多媒体键"><a href="#WINDOWS多媒体键" class="headerlink" title="WINDOWS多媒体键"></a>WINDOWS多媒体键</h1><table><thead><tr><th>按键</th><th>功能</th><th>按键</th><th>功能</th></tr></thead><tbody><tr><td><code>Fn</code> + <code>F1</code></td><td>我的电脑</td><td><code>Fn</code> + <code>F7</code></td><td>上一曲</td></tr><tr><td><code>Fn</code> + <code>F2</code></td><td>浏览器</td><td><code>Fn</code> + <code>F8</code></td><td>播放&#x2F;暂停</td></tr><tr><td><code>Fn</code> + <code>F3</code></td><td>邮箱</td><td><code>Fn</code> + <code>F9</code></td><td>下一曲</td></tr><tr><td><code>Fn</code> + <code>F4</code></td><td>计算器</td><td><code>Fn</code> + <code>F10</code></td><td>静音</td></tr><tr><td><code>Fn</code> + <code>F5</code></td><td>播放器</td><td><code>Fn</code> + <code>F11</code></td><td>音量减</td></tr><tr><td><code>Fn</code> + <code>F6</code></td><td>停止</td><td><code>Fn</code> + <code>F12</code></td><td>音量加</td></tr></tbody></table><h1 id="MAC多媒体键"><a href="#MAC多媒体键" class="headerlink" title="MAC多媒体键"></a>MAC多媒体键</h1><div class="note info flat"><p>MAC系统（<code>FN</code> + <code>S</code>：切换到MAC系统）MAC系统视窗键和ALT键互换</p></div><table><thead><tr><th>按键</th><th>功能</th><th>按键</th><th>功能</th></tr></thead><tbody><tr><td><code>Fn</code> + <code>F1</code></td><td>屏幕亮度减小</td><td><code>Fn</code> + <code>F8 </code></td><td>播放&#x2F;暂停</td></tr><tr><td><code>Fn</code> + <code>F2</code></td><td>屏幕亮度增加</td><td><code>Fn</code> + <code>F9 </code></td><td>下一曲</td></tr><tr><td><code>Fn</code> + <code>F5</code></td><td>键盘背光亮度减小</td><td><code>Fn</code> + <code>F10</code></td><td>静音</td></tr><tr><td><code>Fn</code> + <code>F6</code></td><td>键盘背光亮度增加</td><td><code>Fn</code> + <code>F11</code></td><td>音量减</td></tr><tr><td><code>Fn</code> + <code>F7</code></td><td>上一曲</td><td><code>Fn</code> + <code>F12</code></td><td>音量加</td></tr></tbody></table>]]></content>
      
      
      <categories>
          
          <category> 生活 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 键盘 </tag>
            
            <tag> 实用 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Flask蓝图的使用</title>
      <link href="//posts/23620/"/>
      <url>//posts/23620/</url>
      
        <content type="html"><![CDATA[<h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>最近编写了一个Flask应用，其API接口路由数量较多，为了方便管理和分组接口代码，使用了Flask的蓝图功能，在此处做一个记录。</p><h1 id="蓝图介绍"><a href="#蓝图介绍" class="headerlink" title="蓝图介绍"></a>蓝图介绍</h1><p>Flask 的蓝图（Blueprints）允许你将 Flask 应用分解成多个模块。这样可以更好地组织应用逻辑，使得应用更具可维护性和可扩展性。</p><p>每个蓝图可以有自己的路由、视图函数、模板和静态文件，这样可以将相关的功能分组。</p><p>通过使用蓝图，你可以将 Flask 应用拆分成多个模块，每个模块处理相关的功能，使得代码更加清晰和易于管理。</p><h1 id="创建蓝图"><a href="#创建蓝图" class="headerlink" title="创建蓝图"></a>创建蓝图</h1><p>创建蓝图涉及到以下几个步骤：</p><p>定义蓝图：在一个独立的模块（文件）中定义蓝图。</p><p>注册蓝图：在主应用中注册蓝图，使其生效。</p><h2 id="项目结构"><a href="#项目结构" class="headerlink" title="项目结构"></a>项目结构</h2><p>因为我的项目需求为纯API请求，不需要模板文件，因此选择直接将蓝图放在<code>routes</code>文件夹下</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">app/</span><br><span class="line">│</span><br><span class="line">├─ app.py</span><br><span class="line">├─ config.py</span><br><span class="line">│</span><br><span class="line">└─ routes/</span><br><span class="line">    ├─ index.py</span><br><span class="line">    ├─ token.py</span><br><span class="line">    ├─ user.py</span><br><span class="line">    └─ __init__.py</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="定义蓝图"><a href="#定义蓝图" class="headerlink" title="定义蓝图"></a>定义蓝图</h2><p>以<code>index.py</code>中的内容为例</p><p><code>Blueprint(&#39;index_bp&#39;, __name__)</code>：创建一个名为 <code>index_bp</code> 的蓝图。</p><p>蓝图中定义的路由函数可以用来处理请求。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Blueprint, jsonify, request</span><br><span class="line"></span><br><span class="line">index_bp = Blueprint(<span class="string">&#x27;index_bp&#x27;</span>, __name__)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 定义/路由</span></span><br><span class="line"><span class="meta">@index_bp.route(<span class="params"><span class="string">&#x27;/&#x27;</span>, methods=[<span class="string">&#x27;GET&#x27;</span>, <span class="string">&#x27;POST&#x27;</span>]</span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">index</span>():</span><br><span class="line">    <span class="keyword">return</span> jsonify(&#123;<span class="string">&#x27;code&#x27;</span>: <span class="string">&#x27;500&#x27;</span>, <span class="string">&#x27;error&#x27;</span>: <span class="string">&#x27;Method not allowed&#x27;</span>&#125;)</span><br></pre></td></tr></table></figure><h2 id="注册蓝图"><a href="#注册蓝图" class="headerlink" title="注册蓝图"></a>注册蓝图</h2><p>在<code>app.py</code>中注册蓝图，使其生效。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask</span><br><span class="line"><span class="keyword">from</span> routes <span class="keyword">import</span> index_bp</span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 注册蓝图</span></span><br><span class="line">app.register_blueprint(index_bp)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    app.run(debug=<span class="literal">True</span>)</span><br></pre></td></tr></table></figure><p>启动应用，访问<code>http://localhost:5000/</code>，可以看到返回的结果为<code>&#123;&#39;code&#39;: &#39;500&#39;, &#39;error&#39;: &#39;Method not allowed&#39;&#125;</code>，说明蓝图注册成功。</p><p>如果需要为蓝图添加前缀，可以修改<code>index_bp</code>的构造函数，添加<code>url_prefix</code>参数。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">index_bp = Blueprint(<span class="string">&#x27;index_bp&#x27;</span>, __name__, url_prefix=<span class="string">&#x27;/index&#x27;</span>)</span><br></pre></td></tr></table></figure><p>这样，访问<code>http://localhost:5000/index/</code>时，会返回<code>&#123;&#39;code&#39;: &#39;500&#39;, &#39;error&#39;: &#39;Method not allowed&#39;&#125;</code>。</p><h2 id="在蓝图中使用钩子"><a href="#在蓝图中使用钩子" class="headerlink" title="在蓝图中使用钩子"></a>在蓝图中使用钩子</h2><p>蓝图支持请求钩子，例如 <code>before_request</code> 和 <code>after_request</code>，可以在蓝图中定义这些钩子来处理请求和响应。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 在蓝图中使用请求钩子，添加跨域支持</span></span><br><span class="line"><span class="meta">@index_bp.after_request</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">after_request</span>(<span class="params">response</span>):</span><br><span class="line">    response.headers.add(<span class="string">&#x27;Access-Control-Allow-Origin&#x27;</span>, <span class="string">&#x27;*&#x27;</span>)</span><br><span class="line">    response.headers.add(<span class="string">&#x27;Access-Control-Allow-Headers&#x27;</span>, <span class="string">&#x27;Content-Type,Authorization&#x27;</span>)</span><br><span class="line">    response.headers.add(<span class="string">&#x27;Access-Control-Allow-Methods&#x27;</span>, <span class="string">&#x27;GET,POST,OPTIONS&#x27;</span>)</span><br><span class="line">    <span class="keyword">return</span> response</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="使用蓝图中的模板和静态文件"><a href="#使用蓝图中的模板和静态文件" class="headerlink" title="使用蓝图中的模板和静态文件"></a>使用蓝图中的模板和静态文件</h2><p>蓝图可以包含模板文件和静态文件，可以将相关的功能分组，并在蓝图中使用。</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">app/</span><br><span class="line">│</span><br><span class="line">├── app.py</span><br><span class="line">├── auth/</span><br><span class="line">│   ├── __init__.py</span><br><span class="line">│   ├── routes.py</span><br><span class="line">│   └── templates/</span><br><span class="line">│       ├── login.html</span><br><span class="line">│       └── register.html</span><br><span class="line">│</span><br><span class="line">└── user/</span><br><span class="line">    ├── __init__.py</span><br><span class="line">    ├── routes.py</span><br><span class="line">    └── templates/</span><br><span class="line">        ├── index.html</span><br><span class="line">        └── profile.html</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 编程 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Python </tag>
            
            <tag> Flask </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>软著申请源代码整合脚本</title>
      <link href="//posts/59970/"/>
      <url>//posts/59970/</url>
      
        <content type="html"><![CDATA[<h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>最近想要申请软著，发现需要提交60页的源代码，还有格式上的要求，所以写了个脚本来自动将代码整合到word文档中，自动去除了注释和空行，并会统计总行数。</p><div class="note info flat"><p>此脚本需要安装<code>Python</code>环境，并安装<code>python-docx</code>模块。<br>此脚本会整合所有代码文件，并生成一个word文档，但不能自动删减页数到60页，如果代码过多，需要手动删减。</p></div><h1 id="脚本"><a href="#脚本" class="headerlink" title="脚本"></a>脚本</h1><div class="note warning flat"><p>使用前需要用<code>pip install python-docx</code>安装<code>python-docx</code>模块。</p></div><p>将文件放入代码根目录，使用<code>python .\word.py</code>运行脚本，会在当前目录生成一个<code>code.docx</code>文件，打开后就可以看到整合后的代码。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="comment"># pip install python-docx</span></span><br><span class="line"><span class="keyword">from</span> docx <span class="keyword">import</span> Document</span><br><span class="line"><span class="keyword">from</span> docx.shared <span class="keyword">import</span> Pt, RGBColor</span><br><span class="line"><span class="keyword">from</span> docx.enum.text <span class="keyword">import</span> WD_LINE_SPACING, WD_ALIGN_PARAGRAPH</span><br><span class="line"></span><br><span class="line">exclude_dirs = [<span class="string">&#x27;.git&#x27;</span>, <span class="string">&#x27;__pycache__&#x27;</span>, <span class="string">&#x27;backup&#x27;</span>, <span class="string">&#x27;logs&#x27;</span>, <span class="string">&#x27;.idea&#x27;</span>, <span class="string">&#x27;allatori&#x27;</span>, <span class="string">&#x27;target&#x27;</span>]  <span class="comment"># 排除的文件夹/文件</span></span><br><span class="line">suffix_list = [<span class="string">&#x27;.py&#x27;</span>]  <span class="comment"># 要处理的文件后缀</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 获取指定目录下的所有文件</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_java_files</span>(<span class="params">directory</span>):</span><br><span class="line">    java_files = []</span><br><span class="line">    <span class="keyword">for</span> root, dirs, files <span class="keyword">in</span> os.walk(directory):</span><br><span class="line">        <span class="comment"># 排除指定文件夹</span></span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">any</span>(exclude_dir <span class="keyword">in</span> root <span class="keyword">for</span> exclude_dir <span class="keyword">in</span> exclude_dirs):</span><br><span class="line">            <span class="keyword">continue</span></span><br><span class="line">        <span class="keyword">for</span> file <span class="keyword">in</span> files:</span><br><span class="line">            <span class="comment"># 排除本文件</span></span><br><span class="line">            <span class="keyword">if</span> os.path.basename(file) == os.path.basename(__file__):</span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line">            <span class="comment"># 只处理指定后缀</span></span><br><span class="line">            <span class="keyword">if</span> <span class="built_in">any</span>(file.endswith(suffix) <span class="keyword">for</span> suffix <span class="keyword">in</span> suffix_list):</span><br><span class="line">                java_files.append(os.path.join(root, file).replace(<span class="string">&#x27;\\&#x27;</span>, <span class="string">&#x27;/&#x27;</span>))</span><br><span class="line">    <span class="keyword">return</span> java_files</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 返回删掉空行和注释的内容</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">read_java_file</span>(<span class="params">file_path</span>):</span><br><span class="line">    <span class="keyword">with</span> <span class="built_in">open</span>(file_path, <span class="string">&#x27;r&#x27;</span>, encoding=<span class="string">&#x27;utf-8&#x27;</span>) <span class="keyword">as</span> ff:</span><br><span class="line">        file_content = ff.read()</span><br><span class="line">        file_content = re.sub(<span class="string">&#x27;![^\$][^\n]*&#x27;</span>, <span class="string">&#x27;&#x27;</span>, file_content)</span><br><span class="line">        <span class="comment"># 按\n分割成列表</span></span><br><span class="line">        file_lines = file_content.splitlines()</span><br><span class="line">        <span class="keyword">for</span> i <span class="keyword">in</span> file_lines[:]:</span><br><span class="line">            <span class="keyword">if</span> i == <span class="string">&#x27;&#x27;</span>:</span><br><span class="line">                file_lines.remove(i)</span><br><span class="line">            <span class="keyword">if</span> re.<span class="keyword">match</span>(<span class="string">r&#x27;^\s+$&#x27;</span>, i):</span><br><span class="line">                file_lines.remove(i)</span><br><span class="line">    res = <span class="string">&#x27;\n&#x27;</span>.join(file_lines) + <span class="string">&#x27;\n&#x27;</span></span><br><span class="line">    <span class="keyword">return</span> res, <span class="built_in">len</span>(file_lines)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 将处理后的代码写入并保存到指定doc文件下</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">saveDocFile</span>(<span class="params">file_list, save_path, base_path=os.getcwd(<span class="params"></span>)</span>):</span><br><span class="line">    <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">    :param file_list: 要处理的文件列表</span></span><br><span class="line"><span class="string">    :param save_path: 保存路径</span></span><br><span class="line"><span class="string">    :param base_path: 相对路径的基准路径，默认当前路径</span></span><br><span class="line"><span class="string">    &#x27;&#x27;&#x27;</span></span><br><span class="line">    <span class="comment"># WD_LINE_SPACING</span></span><br><span class="line">    <span class="comment"># SINGLE         =&gt;  单倍行距（默认）</span></span><br><span class="line">    <span class="comment"># ONE_POINT_FIVE =&gt;  1.5倍行距</span></span><br><span class="line">    <span class="comment"># DOUBLE2        =&gt;  倍行距</span></span><br><span class="line">    <span class="comment"># AT_LEAST       =&gt;  最小值</span></span><br><span class="line">    <span class="comment"># EXACTLY        =&gt;  固定值</span></span><br><span class="line">    <span class="comment"># MULTIPLE       =&gt;  多倍行距</span></span><br><span class="line">    doc = Document()</span><br><span class="line">    <span class="comment"># doc.add_heading(&#x27;项目源代码整合&#x27;, 0)  # 标题</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 设置正文格式</span></span><br><span class="line">    doc.styles[<span class="string">&#x27;Normal&#x27;</span>].font.name = <span class="string">&#x27;Times New Roman&#x27;</span>  <span class="comment"># 正文是normal， 设置正文的字体格式</span></span><br><span class="line">    doc.styles[<span class="string">&#x27;Normal&#x27;</span>].font.size = Pt(<span class="number">8</span>)  <span class="comment"># 设置字体的大小为 5 号字体</span></span><br><span class="line">    paragraph_format = doc.styles[<span class="string">&#x27;Normal&#x27;</span>].paragraph_format</span><br><span class="line">    paragraph_format.line_spacing = Pt(<span class="number">12.9</span>)  <span class="comment"># 固定值12,9磅, 保证每页有50行代码</span></span><br><span class="line">    lines = <span class="number">0</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 添加代码和标题</span></span><br><span class="line">    <span class="keyword">for</span> i, f <span class="keyword">in</span> <span class="built_in">enumerate</span>(file_list):</span><br><span class="line">        tempStr = <span class="string">&#x27;正在处理文件 %d/%d&#x27;</span> % (i + <span class="number">1</span>, <span class="built_in">len</span>(file_list))</span><br><span class="line">        relative_path = os.path.relpath(f, base_path).replace(<span class="string">&#x27;/&#x27;</span>, <span class="string">&#x27;\\&#x27;</span>)  <span class="comment"># 相对路径</span></span><br><span class="line">        <span class="built_in">print</span>(tempStr + <span class="string">&quot; -&gt; &quot;</span> + relative_path)</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># 添加文件路径为标题（如不需要，注释掉此段落）</span></span><br><span class="line">        p = doc.add_paragraph()</span><br><span class="line">        title_run = p.add_run(relative_path + <span class="string">&#x27;\n&#x27;</span>)</span><br><span class="line">        title_run.font.size = Pt(<span class="number">10</span>)</span><br><span class="line">        title_run.font.color.rgb = RGBColor(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>)</span><br><span class="line">        title_run.bold = <span class="literal">True</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment"># 读取代码文件</span></span><br><span class="line">        code_content, code_lines = read_java_file(f)</span><br><span class="line">        lines += code_lines</span><br><span class="line">        </span><br><span class="line">        <span class="comment"># 添加代码内容</span></span><br><span class="line">        code_run = p.add_run(code_content)  <span class="comment"># 代码接在标题后</span></span><br><span class="line">        code_run.font.size = Pt(<span class="number">8</span>)  <span class="comment"># 确保代码字体小于标题</span></span><br><span class="line">        p.line_spacing_rule = WD_LINE_SPACING.EXACTLY  <span class="comment"># 固定行距</span></span><br><span class="line">    </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;项目源代码已经整合到 Word 文档中。&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;代码总行数: <span class="subst">&#123;lines&#125;</span>&quot;</span>)</span><br><span class="line">    doc.save(save_path)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    path = os.getcwd()</span><br><span class="line">    savePath = path + os.sep + <span class="string">&quot;code.docx&quot;</span></span><br><span class="line">    saveDocFile(get_java_files(path), savePath, base_path=path)</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 编程 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Python </tag>
            
            <tag> 软著 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Python项目生成依赖文件</title>
      <link href="//posts/43649/"/>
      <url>//posts/43649/</url>
      
        <content type="html"><![CDATA[<h1 id="写在前面"><a href="#写在前面" class="headerlink" title="写在前面"></a>写在前面</h1><p>在完成Python项目时，我们一般需要编写一个<code>requirements.txt</code>文件，该文件包含了项目所依赖的库的名称和版本号，方便后续部署项目。但是如果项目使用了较多的第三方库，手动编写该文件会非常麻烦，这时我们可以借助一些工具来自动生成该文件。本文介绍了几种常用的自动生成依赖文件的方法。</p><h1 id="1-pip-freeze"><a href="#1-pip-freeze" class="headerlink" title="1. pip freeze"></a>1. pip freeze</h1><p>Python的 <code>pip</code> 包管理工具提供了 <code>freeze</code> 命令，可以将当前环境中安装的包信息写入 <code>requirements.txt</code> 文件。</p><div class="note warning flat"><p>该命令会将所有安装的包都写入requirements.txt文件，包括系统自带的包和第三方包的依赖包。如果项目中有有第三方包依赖了很多其他的第三方包，那么这些依赖包都会列出来，不利于包管理。</p></div><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip freeze &gt; requirements.txt</span><br></pre></td></tr></table></figure><p>或者</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python -m pip freeze &gt; requirements.txt</span><br></pre></td></tr></table></figure><p>推荐使用第二种方式，使用python调用而不是直接调用pip命令，因为第一种方式可能会出现版本冲突或者其他问题。</p><p>生成完后，可能还需要修改和删除里面不必要的安装包。因为很多安装包都是有依赖的，我们把要的留下就可以了。</p><h1 id="2-pipreqs"><a href="#2-pipreqs" class="headerlink" title="2. pipreqs"></a>2. pipreqs</h1><p><code>pipreqs</code> 是一个自动生成 <code>requirements.txt</code> 文件的工具，它会自动分析项目中的导入语句，然后生成一个 <code>requirements.txt</code> 文件。<br>此方法生成的 <code>requirements.txt</code> 文件会自动排除系统自带的包和第三方包的依赖包，但是速度较慢，在使用虚拟环境时可能会出现问题。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install pipreqs</span><br></pre></td></tr></table></figure><p>然后在项目目录下运行：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pipreqs .</span><br></pre></td></tr></table></figure><p>可选参数：<code>--force</code>强制重新生成，<code>--upgrade</code>更新库的版本号。</p><h1 id="3-poetry"><a href="#3-poetry" class="headerlink" title="3. poetry"></a>3. poetry</h1><p>如果你使用 <code>Poetry</code> 管理项目，那么可以使用 Poetry 的 <code>export</code> 命令生成 <code>requirements.txt</code> 文件。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install poetry</span><br></pre></td></tr></table></figure><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">poetry <span class="built_in">export</span> --format requirements.txt --output requirements.txt --without-hashes</span><br></pre></td></tr></table></figure><p>这个命令将从 <code>poetry.lock</code> 文件中生成一个标准的 <code>requirements.txt</code> 文件，其中包含项目的所有依赖项及其版本信息。<code>--without-hashes</code> 选参数表示不在 <code>requirements.txt</code> 文件中包含安装包时的哈希信息，这样可以使得 <code>requirements.txt</code> 文件更容易被共享。<br>如果只想生成开发环境的依赖（例如测试依赖），可以使用以下命令：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">poetry <span class="built_in">export</span> --dev --format requirements.txt --output requirements.txt --without-hashes</span><br></pre></td></tr></table></figure><p>不过在使用 <code>Poetry</code> 时，最好使用 <code>poetry.lock</code> 文件而不是 <code>requirements.txt</code> 文件来确保安装相同版本的依赖项。<code>poetry.lock</code> 包含了更详细的依赖关系和版本信息。</p><h1 id="4-pipenv"><a href="#4-pipenv" class="headerlink" title="4. pipenv"></a>4. pipenv</h1><p><code>pipenv</code> 是一个包含了<code>pip</code>和<code>virtualenv</code>并补全了两者一些不足之处的包管理工具，可以帮助我们管理Python项目的依赖，和 Poetry 类似，它也生成 <code>requirements.txt</code> 文件。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install pipenv</span><br></pre></td></tr></table></figure><p>然后在项目目录下运行：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pipenv lock -r &gt; requirements.txt</span><br></pre></td></tr></table></figure><p>这将从 <code>Pipfile.lock</code> 中生成 <code>requirements.txt</code> 文件。</p><h1 id="5-PyCharm"><a href="#5-PyCharm" class="headerlink" title="5. PyCharm"></a>5. PyCharm</h1><p>在PyCharm中，提供了一个生成<code>requirements.txt</code>文件的功能，可以准确迅速地生成依赖文件。</p><p>具体位置：<code>Tools</code> -&gt; <code>Sync Python Requirements</code></p><p><img src="https://cdn.randench.cn/image/24/11/4900fbf1328239cf.png"></p><p><img src="https://cdn.randench.cn/image/24/11/bae6246e56b628b1.png"></p>]]></content>
      
      
      <categories>
          
          <category> 编程 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Python </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>给侧边栏添加倒计时</title>
      <link href="//posts/37015/"/>
      <url>//posts/37015/</url>
      
        <content type="html"><![CDATA[<div class="note warning flat"><p>本文修改主题为<code>AnZhiYu</code>主题，若使用其他主题，请自行确认修改位置。</p></div><h1 id="原文出处"><a href="#原文出处" class="headerlink" title="原文出处"></a>原文出处</h1><blockquote><p><a href="https://blog.bsgun.cn/posts/68c5cdb9">https://blog.bsgun.cn/posts/68c5cdb9</a></p></blockquote><h1 id="效果预览"><a href="#效果预览" class="headerlink" title="效果预览"></a>效果预览</h1><details class="folding-tag" ><summary> 查看图片 </summary>              <div class='content'>              <p><img src="https://cdn.randench.cn/image/24/11/8d1f26643c98d878.png" alt="预览"></p>              </div>            </details><h1 id="修改步骤"><a href="#修改步骤" class="headerlink" title="修改步骤"></a>修改步骤</h1><p>本文与原文不同，将其集成为了pug模板，以便在配置文件中控制侧边栏显示以及需要倒计时的日期。</p><h2 id="1-新建文件"><a href="#1-新建文件" class="headerlink" title="1.新建文件"></a>1.新建文件</h2><p>新建<code>[Blogroot]\themes\butterfly\layout\includes\widget\card_countdown.pug</code></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">if theme.aside.card_countdown.enable</span><br><span class="line">  .card-widget.card-countdown</span><br><span class="line">    .item-content</span><br><span class="line">      .cd-count-left#countLeft</span><br><span class="line">        span.cd-text 距离</span><br><span class="line">        span.cd-name#eventName!= theme.aside.card_countdown.event_name</span><br><span class="line">        span.cd-time#daysUntil</span><br><span class="line">        span.cd-date#eventDate!= theme.aside.card_countdown.event_date</span><br><span class="line">      .cd-count-right#countRight</span><br></pre></td></tr></table></figure><p>新建<code>[Blogroot]\source\js\countdown.js</code></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> <span class="title class_">CountdownTimer</span> = (<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">const</span> config = &#123;</span><br><span class="line">        <span class="attr">units</span>: &#123;</span><br><span class="line">            <span class="attr">day</span>: &#123; <span class="attr">text</span>: <span class="string">&quot;今日&quot;</span>, <span class="attr">divider</span>: <span class="number">1</span>, <span class="attr">unit</span>: <span class="string">&quot;小时&quot;</span> &#125;,</span><br><span class="line">            <span class="attr">week</span>: &#123; <span class="attr">text</span>: <span class="string">&quot;本周&quot;</span>, <span class="attr">divider</span>: <span class="number">24</span>, <span class="attr">unit</span>: <span class="string">&quot;天&quot;</span> &#125;,</span><br><span class="line">            <span class="attr">month</span>: &#123; <span class="attr">text</span>: <span class="string">&quot;本月&quot;</span>, <span class="attr">divider</span>: <span class="number">24</span>, <span class="attr">unit</span>: <span class="string">&quot;天&quot;</span> &#125;,</span><br><span class="line">            <span class="attr">year</span>: &#123; <span class="attr">text</span>: <span class="string">&quot;本年&quot;</span>, <span class="attr">divider</span>: <span class="number">24</span>, <span class="attr">unit</span>: <span class="string">&quot;天&quot;</span> &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">getTimeUnit</span>(<span class="params">unit</span>) &#123;</span><br><span class="line">        <span class="keyword">const</span> now = <span class="keyword">new</span> <span class="title class_">Date</span>();</span><br><span class="line">        <span class="keyword">const</span> start = <span class="keyword">new</span> <span class="title class_">Date</span>(now.<span class="title function_">setHours</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>));</span><br><span class="line">        <span class="keyword">const</span> end = <span class="keyword">new</span> <span class="title class_">Date</span>(now.<span class="title function_">setHours</span>(<span class="number">23</span>, <span class="number">59</span>, <span class="number">59</span>, <span class="number">999</span>));</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (unit === <span class="string">&#x27;day&#x27;</span>) &#123;</span><br><span class="line">            <span class="keyword">const</span> currentHour = <span class="keyword">new</span> <span class="title class_">Date</span>().<span class="title function_">getHours</span>();</span><br><span class="line">            <span class="keyword">const</span> remaining = <span class="number">24</span> - currentHour;</span><br><span class="line">            <span class="keyword">const</span> percentage = (currentHour / <span class="number">24</span>) * <span class="number">100</span>;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">return</span> &#123;</span><br><span class="line">                <span class="attr">name</span>: config.<span class="property">units</span>[unit].<span class="property">text</span>,</span><br><span class="line">                <span class="attr">remaining</span>: remaining,</span><br><span class="line">                <span class="attr">percentage</span>: percentage.<span class="title function_">toFixed</span>(<span class="number">2</span>),</span><br><span class="line">                <span class="attr">unit</span>: config.<span class="property">units</span>[unit].<span class="property">unit</span></span><br><span class="line">            &#125;;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">const</span> ranges = &#123;</span><br><span class="line">            <span class="attr">week</span>: <span class="function">() =&gt;</span> &#123;</span><br><span class="line">                start.<span class="title function_">setDate</span>(start.<span class="title function_">getDate</span>() - start.<span class="title function_">getDay</span>());</span><br><span class="line">                end.<span class="title function_">setDate</span>(end.<span class="title function_">getDate</span>() - end.<span class="title function_">getDay</span>() + <span class="number">6</span>);</span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="attr">month</span>: <span class="function">() =&gt;</span> &#123;</span><br><span class="line">                start.<span class="title function_">setDate</span>(<span class="number">1</span>);</span><br><span class="line">                end.<span class="title function_">setMonth</span>(end.<span class="title function_">getMonth</span>() + <span class="number">1</span>, <span class="number">0</span>);</span><br><span class="line">            &#125;,</span><br><span class="line">            <span class="attr">year</span>: <span class="function">() =&gt;</span> &#123;</span><br><span class="line">                start.<span class="title function_">setMonth</span>(<span class="number">0</span>, <span class="number">1</span>);</span><br><span class="line">                end.<span class="title function_">setMonth</span>(<span class="number">11</span>, <span class="number">31</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;;</span><br><span class="line">        ranges[unit]?.();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">const</span> total = unit === <span class="string">&quot;day&quot;</span> ? <span class="number">24</span> : <span class="title class_">Math</span>.<span class="title function_">floor</span>((end - start) / <span class="number">86400000</span>) + <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">const</span> passed = <span class="title class_">Math</span>.<span class="title function_">floor</span>((now - start) / (<span class="number">3600000</span> * config.<span class="property">units</span>[unit].<span class="property">divider</span>));</span><br><span class="line">        <span class="keyword">const</span> percentage = (passed / total) * <span class="number">100</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> &#123;</span><br><span class="line">            <span class="attr">name</span>: config.<span class="property">units</span>[unit].<span class="property">text</span>,</span><br><span class="line">            <span class="attr">remaining</span>: total - passed,</span><br><span class="line">            <span class="attr">percentage</span>: percentage.<span class="title function_">toFixed</span>(<span class="number">2</span>),</span><br><span class="line">            <span class="attr">unit</span>: config.<span class="property">units</span>[unit].<span class="property">unit</span></span><br><span class="line">        &#125;;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">updateCountdown</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">const</span> elements = [<span class="string">&#x27;eventName&#x27;</span>, <span class="string">&#x27;eventDate&#x27;</span>, <span class="string">&#x27;daysUntil&#x27;</span>, <span class="string">&#x27;countRight&#x27;</span>]</span><br><span class="line">            .<span class="title function_">map</span>(<span class="function"><span class="params">id</span> =&gt;</span> <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(id));</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (elements.<span class="title function_">some</span>(<span class="function"><span class="params">el</span> =&gt;</span> !el)) <span class="keyword">return</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">const</span> [eventName, eventDate, daysUntil, countRight] = elements;</span><br><span class="line">        <span class="keyword">const</span> timeData = <span class="title class_">Object</span>.<span class="title function_">keys</span>(config.<span class="property">units</span>).<span class="title function_">reduce</span>(<span class="function">(<span class="params">acc, unit</span>) =&gt;</span> (&#123; ...acc, [unit]: <span class="title function_">getTimeUnit</span>(unit) &#125;), &#123;&#125;);</span><br><span class="line">        <span class="keyword">const</span> daysRemaining = <span class="title class_">Math</span>.<span class="title function_">round</span>((<span class="keyword">new</span> <span class="title class_">Date</span>(eventDate.<span class="property">textContent</span>) - <span class="keyword">new</span> <span class="title class_">Date</span>().<span class="title function_">setHours</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>)) / <span class="number">86400000</span>);</span><br><span class="line"></span><br><span class="line">        daysUntil.<span class="property">textContent</span> = daysRemaining;</span><br><span class="line">        countRight.<span class="property">innerHTML</span> = <span class="title class_">Object</span>.<span class="title function_">entries</span>(timeData)</span><br><span class="line">            .<span class="title function_">map</span>(<span class="function">(<span class="params">[_, item]</span>) =&gt;</span> <span class="string">`</span></span><br><span class="line"><span class="string">                &lt;div class=&quot;cd-count-item&quot;&gt;</span></span><br><span class="line"><span class="string">                    &lt;div class=&quot;cd-item-name&quot;&gt;<span class="subst">$&#123;item.name&#125;</span>&lt;/div&gt;</span></span><br><span class="line"><span class="string">                    &lt;div class=&quot;cd-item-progress&quot;&gt;</span></span><br><span class="line"><span class="string">                        &lt;div class=&quot;cd-progress-bar&quot; style=&quot;width: <span class="subst">$&#123;item.percentage&#125;</span>%; opacity: <span class="subst">$&#123;item.percentage / <span class="number">100</span>&#125;</span>&quot;&gt;&lt;/div&gt;</span></span><br><span class="line"><span class="string">                        &lt;span class=&quot;cd-percentage <span class="subst">$&#123;item.percentage &gt;= <span class="number">46</span> ? <span class="string">&#x27;cd-many&#x27;</span> : <span class="string">&#x27;&#x27;</span>&#125;</span>&quot;&gt;<span class="subst">$&#123;item.percentage&#125;</span>%&lt;/span&gt;</span></span><br><span class="line"><span class="string">                        &lt;span class=&quot;cd-remaining <span class="subst">$&#123;item.percentage &gt;= <span class="number">60</span> ? <span class="string">&#x27;cd-many&#x27;</span> : <span class="string">&#x27;&#x27;</span>&#125;</span>&quot;&gt;</span></span><br><span class="line"><span class="string">                            &lt;span class=&quot;cd-tip&quot;&gt;还剩&lt;/span&gt;<span class="subst">$&#123;item.remaining&#125;</span>&lt;span class=&quot;cd-tip&quot;&gt;<span class="subst">$&#123;item.unit&#125;</span>&lt;/span&gt;</span></span><br><span class="line"><span class="string">                        &lt;/span&gt;</span></span><br><span class="line"><span class="string">                    &lt;/div&gt;</span></span><br><span class="line"><span class="string">                &lt;/div&gt;</span></span><br><span class="line"><span class="string">            `</span>).<span class="title function_">join</span>(<span class="string">&#x27;&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">injectStyles</span>(<span class="params"></span>) &#123;</span><br><span class="line">        <span class="keyword">const</span> styles = <span class="string">`</span></span><br><span class="line"><span class="string">            .card-countdown .item-content &#123;</span></span><br><span class="line"><span class="string">                display: flex;</span></span><br><span class="line"><span class="string">            &#125;</span></span><br><span class="line"><span class="string">            .cd-count-left &#123;</span></span><br><span class="line"><span class="string">                position: relative;</span></span><br><span class="line"><span class="string">                display: flex;</span></span><br><span class="line"><span class="string">                flex-direction: column;</span></span><br><span class="line"><span class="string">                margin-right: 0.8rem;</span></span><br><span class="line"><span class="string">                line-height: 1.5;</span></span><br><span class="line"><span class="string">                align-items: center;</span></span><br><span class="line"><span class="string">                justify-content: center;</span></span><br><span class="line"><span class="string">            &#125;</span></span><br><span class="line"><span class="string">            .cd-count-left .cd-text &#123;</span></span><br><span class="line"><span class="string">                font-size: 14px;</span></span><br><span class="line"><span class="string">            &#125;</span></span><br><span class="line"><span class="string">            .cd-count-left .cd-name &#123;</span></span><br><span class="line"><span class="string">                font-weight: bold;</span></span><br><span class="line"><span class="string">                font-size: 18px;</span></span><br><span class="line"><span class="string">            &#125;</span></span><br><span class="line"><span class="string">            .cd-count-left .cd-time &#123;</span></span><br><span class="line"><span class="string">                font-size: 30px;</span></span><br><span class="line"><span class="string">                font-weight: bold;</span></span><br><span class="line"><span class="string">                color: var(--anzhiyu-main);</span></span><br><span class="line"><span class="string">            &#125;</span></span><br><span class="line"><span class="string">            .cd-count-left .cd-date &#123;</span></span><br><span class="line"><span class="string">                font-size: 12px;</span></span><br><span class="line"><span class="string">                opacity: 0.6;</span></span><br><span class="line"><span class="string">            &#125;</span></span><br><span class="line"><span class="string">            .cd-count-left::after &#123;</span></span><br><span class="line"><span class="string">                content: &quot;&quot;;</span></span><br><span class="line"><span class="string">                position: absolute;</span></span><br><span class="line"><span class="string">                right: -0.8rem;</span></span><br><span class="line"><span class="string">                width: 2px;</span></span><br><span class="line"><span class="string">                height: 80%;</span></span><br><span class="line"><span class="string">                background-color: var(--anzhiyu-main);</span></span><br><span class="line"><span class="string">                opacity: 0.5;</span></span><br><span class="line"><span class="string">            &#125;</span></span><br><span class="line"><span class="string">            .cd-count-right &#123;</span></span><br><span class="line"><span class="string">                flex: 1;</span></span><br><span class="line"><span class="string">                margin-left: .8rem;</span></span><br><span class="line"><span class="string">                display: flex;</span></span><br><span class="line"><span class="string">                flex-direction: column;</span></span><br><span class="line"><span class="string">                justify-content: space-between;</span></span><br><span class="line"><span class="string">            &#125;</span></span><br><span class="line"><span class="string">            .cd-count-item &#123;</span></span><br><span class="line"><span class="string">                display: flex;</span></span><br><span class="line"><span class="string">                flex-direction: row;</span></span><br><span class="line"><span class="string">                align-items: center;</span></span><br><span class="line"><span class="string">                height: 24px;</span></span><br><span class="line"><span class="string">            &#125;</span></span><br><span class="line"><span class="string">            .cd-item-name &#123;</span></span><br><span class="line"><span class="string">                font-size: 14px;</span></span><br><span class="line"><span class="string">                margin-right: 0.8rem;</span></span><br><span class="line"><span class="string">                white-space: nowrap;</span></span><br><span class="line"><span class="string">            &#125;</span></span><br><span class="line"><span class="string">            .cd-item-progress &#123;</span></span><br><span class="line"><span class="string">                position: relative;</span></span><br><span class="line"><span class="string">                display: flex;</span></span><br><span class="line"><span class="string">                flex-direction: row;</span></span><br><span class="line"><span class="string">                align-items: center;</span></span><br><span class="line"><span class="string">                justify-content: space-between;</span></span><br><span class="line"><span class="string">                height: 100%;</span></span><br><span class="line"><span class="string">                width: 100%;</span></span><br><span class="line"><span class="string">                border-radius: 8px;</span></span><br><span class="line"><span class="string">                background-color: var(--anzhiyu-background);</span></span><br><span class="line"><span class="string">                overflow: hidden;</span></span><br><span class="line"><span class="string">            &#125;</span></span><br><span class="line"><span class="string">            .cd-progress-bar &#123;</span></span><br><span class="line"><span class="string">                height: 100%;</span></span><br><span class="line"><span class="string">                border-radius: 8px;</span></span><br><span class="line"><span class="string">                background-color: var(--anzhiyu-main);</span></span><br><span class="line"><span class="string">            &#125;</span></span><br><span class="line"><span class="string">            .cd-percentage,</span></span><br><span class="line"><span class="string">            .cd-remaining &#123;</span></span><br><span class="line"><span class="string">                position: absolute;</span></span><br><span class="line"><span class="string">                font-size: 12px;</span></span><br><span class="line"><span class="string">                margin: 0 6px;</span></span><br><span class="line"><span class="string">                transition: opacity 0.3s ease-in-out, transform 0.3s ease-in-out;</span></span><br><span class="line"><span class="string">            &#125;</span></span><br><span class="line"><span class="string">            .cd-many &#123;</span></span><br><span class="line"><span class="string">                color: #fff;</span></span><br><span class="line"><span class="string">            &#125;</span></span><br><span class="line"><span class="string">            .cd-remaining &#123;</span></span><br><span class="line"><span class="string">                opacity: 0;</span></span><br><span class="line"><span class="string">                transform: translateX(10px);</span></span><br><span class="line"><span class="string">            &#125;</span></span><br><span class="line"><span class="string">            .card-countdown .item-content:hover .cd-remaining &#123;</span></span><br><span class="line"><span class="string">                transform: translateX(0);</span></span><br><span class="line"><span class="string">                opacity: 1;</span></span><br><span class="line"><span class="string">            &#125;</span></span><br><span class="line"><span class="string">            .card-countdown .item-content:hover .cd-percentage &#123;</span></span><br><span class="line"><span class="string">                transform: translateX(-10px);</span></span><br><span class="line"><span class="string">                opacity: 0;</span></span><br><span class="line"><span class="string">            &#125;</span></span><br><span class="line"><span class="string">        `</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">const</span> styleSheet = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&quot;style&quot;</span>);</span><br><span class="line">        styleSheet.<span class="property">textContent</span> = styles;</span><br><span class="line">        <span class="variable language_">document</span>.<span class="property">head</span>.<span class="title function_">appendChild</span>(styleSheet);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> timer;</span><br><span class="line">    <span class="keyword">const</span> <span class="title function_">start</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">        <span class="title function_">injectStyles</span>();</span><br><span class="line">        <span class="title function_">updateCountdown</span>();</span><br><span class="line">        timer = <span class="built_in">setInterval</span>(updateCountdown, <span class="number">600000</span>);</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    [<span class="string">&#x27;pjax:complete&#x27;</span>, <span class="string">&#x27;DOMContentLoaded&#x27;</span>].<span class="title function_">forEach</span>(<span class="function"><span class="params">event</span> =&gt;</span> <span class="variable language_">document</span>.<span class="title function_">addEventListener</span>(event, start));</span><br><span class="line">    <span class="variable language_">document</span>.<span class="title function_">addEventListener</span>(<span class="string">&#x27;pjax:send&#x27;</span>, <span class="function">() =&gt;</span> timer &amp;&amp; <span class="built_in">clearInterval</span>(timer));</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> &#123; start, <span class="attr">stop</span>: <span class="function">() =&gt;</span> timer &amp;&amp; <span class="built_in">clearInterval</span>(timer) &#125;;</span><br><span class="line">&#125;)();</span><br></pre></td></tr></table></figure><h2 id="2-修改文件"><a href="#2-修改文件" class="headerlink" title="2. 修改文件"></a>2. 修改文件</h2><p>修改<code>[Blogroot]\themes\butterfly\layout\includes\widget\index.pug</code></p><figure class="highlight diff"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">    if showToc &amp;&amp; tocStyleVal</span><br><span class="line">      .sticky_layout</span><br><span class="line">        include ./card_post_toc.pug</span><br><span class="line">    else</span><br><span class="line">      !=partial(&#x27;includes/widget/card_author&#x27;, &#123;&#125;, &#123;cache: true&#125;)</span><br><span class="line">      !=partial(&#x27;includes/widget/card_announcement&#x27;, &#123;&#125;, &#123;cache: true&#125;)</span><br><span class="line">      !=partial(&#x27;includes/widget/card_top_self&#x27;, &#123;&#125;, &#123;cache: true&#125;)</span><br><span class="line"><span class="addition">+     !=partial(&#x27;includes/widget/card_countdown&#x27;, &#123;&#125;, &#123;cache: true&#125;)</span></span><br><span class="line">      .sticky_layout</span><br><span class="line">        if showToc</span><br><span class="line">          include ./card_post_toc.pug</span><br><span class="line">        if page.series</span><br><span class="line">          include ./card_post_series.pug</span><br><span class="line">        !=partial(&#x27;includes/widget/card_recent_post&#x27;, &#123;&#125;, &#123;cache: true&#125;)</span><br><span class="line">        !=partial(&#x27;includes/widget/card_ad&#x27;, &#123;&#125;, &#123;cache: true&#125;)</span><br><span class="line">  else</span><br><span class="line">    //- page</span><br><span class="line">    !=partial(&#x27;includes/widget/card_author&#x27;, &#123;&#125;, &#123;cache: true&#125;)</span><br><span class="line">    !=partial(&#x27;includes/widget/card_announcement&#x27;, &#123;&#125;, &#123;cache: true&#125;)</span><br><span class="line">    !=partial(&#x27;includes/widget/card_top_self&#x27;, &#123;&#125;, &#123;cache: true&#125;)</span><br><span class="line"><span class="addition">+   !=partial(&#x27;includes/widget/card_countdown&#x27;, &#123;&#125;, &#123;cache: true&#125;)</span></span><br><span class="line"></span><br><span class="line">    .sticky_layout</span><br><span class="line">      if showToc</span><br><span class="line">        include ./card_post_toc.pug</span><br><span class="line">      !=partial(&#x27;includes/widget/card_recent_post&#x27;, &#123;&#125;, &#123;cache: true&#125;)</span><br><span class="line">      !=partial(&#x27;includes/widget/card_ad&#x27;, &#123;&#125;, &#123;cache: true&#125;)</span><br><span class="line">      !=partial(&#x27;includes/widget/card_newest_comment&#x27;, &#123;&#125;, &#123;cache: true&#125;)</span><br><span class="line">      !=partial(&#x27;includes/widget/card_categories&#x27;, &#123;&#125;, &#123;cache: true&#125;)</span><br><span class="line">      !=partial(&#x27;includes/widget/card_tags&#x27;, &#123;&#125;, &#123;cache: true&#125;)</span><br><span class="line">      !=partial(&#x27;includes/widget/card_archives&#x27;, &#123;&#125;, &#123;cache: true&#125;)</span><br><span class="line">      !=partial(&#x27;includes/widget/card_webinfo&#x27;, &#123;&#125;, &#123;cache: true&#125;)</span><br><span class="line">      !=partial(&#x27;includes/widget/card_bottom_self&#x27;, &#123;&#125;, &#123;cache: true&#125;)</span><br></pre></td></tr></table></figure><h2 id="3-引入样式"><a href="#3-引入样式" class="headerlink" title="3. 引入样式"></a>3. 引入样式</h2><p>在<code>[Blogroot]\_config.anzhiyu.yml</code>中添加以下内容：</p><figure class="highlight diff"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">aside:</span><br><span class="line">  enable: true</span><br><span class="line">  hide: false</span><br><span class="line">  button: true</span><br><span class="line">  mobile: true # display on mobile</span><br><span class="line">  position: right # left or right</span><br><span class="line">  display:</span><br><span class="line">    archive: true</span><br><span class="line">    tag: true</span><br><span class="line">    category: true</span><br><span class="line"><span class="addition">+ card_countdown:</span></span><br><span class="line"><span class="addition">+   enable: true</span></span><br><span class="line"><span class="addition">+   event_date: &#x27;2025-01-29&#x27;</span></span><br><span class="line"><span class="addition">+   event_name: 春节</span></span><br><span class="line">  card_author:</span><br><span class="line">    enable: true</span><br><span class="line">    description:</span><br></pre></td></tr></table></figure><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">inject:</span></span><br><span class="line">  <span class="attr">bottom:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">&lt;script</span> <span class="string">async</span> <span class="string">src=&quot;/js/countdown.js&quot;&gt;&lt;/script&gt;</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Hexo </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 美化 </tag>
            
            <tag> 魔改 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>宝塔面板切换www目录位置</title>
      <link href="//posts/29231/"/>
      <url>//posts/29231/</url>
      
        <content type="html"><![CDATA[<p>宝塔面板www目录，从系统盘切换到数据盘的操作方法如下：</p><h1 id="一：如果是纯净系统还没安装宝塔面板"><a href="#一：如果是纯净系统还没安装宝塔面板" class="headerlink" title="一：如果是纯净系统还没安装宝塔面板"></a>一：如果是纯净系统还没安装宝塔面板</h1><blockquote><p>&#x2F;mnt 更换成你的另一块磁盘分区名称</p></blockquote><p>第一步：进入mnt目录(mnt是数据盘名称，有很多是home，你的数据盘挂载位置是什么就用什么)</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> /mnt</span><br></pre></td></tr></table></figure><p>第二步：创建宝塔面板安装需要用的www目录</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">mkdir</span> www</span><br></pre></td></tr></table></figure><p>第三步：建立&#x2F;mnt&#x2F;www的软连接到&#x2F;www(也就是给系统根目录建立一个www的“快捷方式”指向&#x2F;mnt&#x2F;www)</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">ln</span> -s /mnt/www /www</span><br></pre></td></tr></table></figure><p>第四步：正常安装宝塔面板即可</p><h1 id="二：如果已经安装了宝塔面板和WEB环境"><a href="#二：如果已经安装了宝塔面板和WEB环境" class="headerlink" title="二：如果已经安装了宝塔面板和WEB环境"></a>二：如果已经安装了宝塔面板和WEB环境</h1><blockquote><p>&#x2F;mnt 更换成你的另一块磁盘分区名称</p></blockquote><p>第一步：移动系统根目录下的www到mnt</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">mv</span> /www /mnt/www</span><br></pre></td></tr></table></figure><p>第二步：建立&#x2F;data&#x2F;www的软连接到&#x2F;www</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">ln</span> -s /mnt/www /www</span><br></pre></td></tr></table></figure><p>第三步：重启服务器</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">reboot</span><br></pre></td></tr></table></figure><p>第四步：重启宝塔面板服务</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">service bt restart</span><br></pre></td></tr></table></figure><p>第五步：打开宝塔面板，CTRL+F5刷新浏览器缓存</p><blockquote><p>PS：Linux下的软链接类似于windows下的快捷方式 ，如上面的示例，当我们执行命令 cd &#x2F;www&#x2F;的时候 实际上是进入了 &#x2F;mnt&#x2F; ，操作前切记备份数据，防止因误操作引起数据丢失!!!</p></blockquote>]]></content>
      
      
      <categories>
          
          <category> 教程 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Linux </tag>
            
            <tag> 宝塔 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>在文章中添加条件勾选表单</title>
      <link href="//posts/22407/"/>
      <url>//posts/22407/</url>
      
        <content type="html"><![CDATA[<h1 id="写在前面"><a href="#写在前面" class="headerlink" title="写在前面"></a>写在前面</h1><p>本文介绍了如何在文章中添加条件勾选表单，并解决PJAX刷新后JS失效的问题。</p><h1 id="原文出处"><a href="#原文出处" class="headerlink" title="原文出处"></a>原文出处</h1><blockquote><p><a href="https://blog.qjqq.cn/posts/51e.html">https://blog.qjqq.cn/posts/51e.html</a></p></blockquote><h1 id="添加方式"><a href="#添加方式" class="headerlink" title="添加方式"></a>添加方式</h1><p>在文章的头部添加以下代码：</p><h2 id="隐藏评论表单"><a href="#隐藏评论表单" class="headerlink" title="隐藏评论表单"></a>隐藏评论表单</h2><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">style</span>&gt;</span><span class="language-css"></span></span><br><span class="line"><span class="language-css"><span class="selector-class">.tk-comments</span> &gt; <span class="selector-class">.tk-submit</span> &#123;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">opacity</span>: <span class="number">0</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">height</span>: <span class="number">0</span>;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">transition</span>: opacity <span class="number">0.5s</span> ease, height <span class="number">0.5s</span> ease;</span></span><br><span class="line"><span class="language-css">    <span class="attribute">overflow</span>: hidden;</span></span><br><span class="line"><span class="language-css">&#125;</span></span><br><span class="line"><span class="language-css"></span><span class="tag">&lt;/<span class="name">style</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="监听复选框勾选状态"><a href="#监听复选框勾选状态" class="headerlink" title="监听复选框勾选状态"></a>监听复选框勾选状态</h2><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="variable language_">document</span>.<span class="title function_">addEventListener</span>(<span class="string">&quot;DOMContentLoaded&quot;</span>, <span class="keyword">function</span> (<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">const</span> checkboxes = <span class="variable language_">document</span>.<span class="title function_">querySelectorAll</span>(<span class="string">&quot;.checkbox-input&quot;</span>);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="comment">// 更新提交按钮的显示状态</span></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">function</span> <span class="title function_">updateSubmitButton</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">const</span> twikooSubmit = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&quot;.tk-submit&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">const</span> input = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;.el-textarea__inner&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">        <span class="comment">// 检查 .tk-submit 是否存在</span></span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">if</span> (!twikooSubmit) &#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="variable language_">console</span>.<span class="title function_">warn</span>(<span class="string">&quot;评论提交按钮 .tk-submit 未找到&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">return</span>;</span></span><br><span class="line"><span class="language-javascript">        &#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">        <span class="comment">// 检查 .el-textarea__inner 是否存在</span></span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">if</span> (!input) &#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="variable language_">console</span>.<span class="title function_">warn</span>(<span class="string">&quot;评论输入框 .el-textarea__inner 未找到&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">return</span>;</span></span><br><span class="line"><span class="language-javascript">        &#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">        <span class="comment">// 检查是否所有复选框都已勾选</span></span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">const</span> allChecked = <span class="title class_">Array</span>.<span class="title function_">from</span>(checkboxes).<span class="title function_">every</span>(<span class="function"><span class="params">checkbox</span> =&gt;</span> checkbox.<span class="property">checked</span>);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">if</span> (allChecked) &#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="comment">// 显示提交按钮</span></span></span><br><span class="line"><span class="language-javascript">            twikooSubmit.<span class="property">style</span>.<span class="property">opacity</span> = <span class="string">&quot;1&quot;</span>;</span></span><br><span class="line"><span class="language-javascript">            twikooSubmit.<span class="property">style</span>.<span class="property">height</span> = <span class="string">&quot;auto&quot;</span>;</span></span><br><span class="line"><span class="language-javascript">            twikooSubmit.<span class="property">style</span>.<span class="property">overflow</span> = <span class="string">&quot;visible&quot;</span>;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">            <span class="comment">// 填写模板信息到输入框</span></span></span><br><span class="line"><span class="language-javascript">            <span class="comment">// input.value = &#x27;-name：\nlink：\navatar：\ndescr：\n&#x27;;</span></span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">            <span class="comment">// 模拟输入事件以更新界面</span></span></span><br><span class="line"><span class="language-javascript">            input.<span class="title function_">dispatchEvent</span>(<span class="keyword">new</span> <span class="title class_">Event</span>(<span class="string">&#x27;input&#x27;</span>, &#123; <span class="attr">bubbles</span>: <span class="literal">true</span> &#125;));</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">            <span class="comment">// 将光标设置到最后一行</span></span></span><br><span class="line"><span class="language-javascript">            input.<span class="title function_">focus</span>();</span></span><br><span class="line"><span class="language-javascript">            input.<span class="title function_">setSelectionRange</span>(input.<span class="property">value</span>.<span class="property">length</span>, input.<span class="property">value</span>.<span class="property">length</span>);</span></span><br><span class="line"><span class="language-javascript">        &#125; <span class="keyword">else</span> &#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="comment">// 隐藏提交按钮</span></span></span><br><span class="line"><span class="language-javascript">            twikooSubmit.<span class="property">style</span>.<span class="property">opacity</span> = <span class="string">&quot;0&quot;</span>;</span></span><br><span class="line"><span class="language-javascript">            twikooSubmit.<span class="property">style</span>.<span class="property">height</span> = <span class="string">&quot;0&quot;</span>;</span></span><br><span class="line"><span class="language-javascript">            twikooSubmit.<span class="property">style</span>.<span class="property">overflow</span> = <span class="string">&quot;hidden&quot;</span>;</span></span><br><span class="line"><span class="language-javascript">        &#125;</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="comment">// 给每个复选框添加监听器</span></span></span><br><span class="line"><span class="language-javascript">    checkboxes.<span class="title function_">forEach</span>(<span class="function"><span class="params">checkbox</span> =&gt;</span> checkbox.<span class="title function_">addEventListener</span>(<span class="string">&quot;change&quot;</span>, updateSubmitButton));</span></span><br><span class="line"><span class="language-javascript">&#125;);</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="在文章中添加条件勾选表单"><a href="#在文章中添加条件勾选表单" class="headerlink" title="在文章中添加条件勾选表单"></a>在文章中添加条件勾选表单</h2><p>在想要添加条件勾选表单的地方添加以下代码：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">p</span> <span class="attr">style</span>=<span class="string">&quot;padding: 0 0 0 .8rem&quot;</span>&gt;</span></span><br><span class="line">    请<span class="tag">&lt;<span class="name">strong</span>&gt;</span>勾选<span class="tag">&lt;/<span class="name">strong</span>&gt;</span>你符合的条件：</span><br><span class="line"><span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;friendlink_checkboxs&quot;</span> <span class="attr">style</span>=<span class="string">&quot;padding: 0 0 0 1.6rem&quot;</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">label</span> <span class="attr">class</span>=<span class="string">&quot;checkbox&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;checkbox&quot;</span> <span class="attr">class</span>=<span class="string">&quot;checkbox-input&quot;</span> <span class="attr">id</span>=<span class="string">&quot;checkbox1&quot;</span>&gt;</span></span><br><span class="line">            我已添加 <span class="tag">&lt;<span class="name">b</span>&gt;</span>RandomEnch<span class="tag">&lt;/<span class="name">b</span>&gt;</span> 博客的友情链接</span><br><span class="line">        <span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">label</span> <span class="attr">class</span>=<span class="string">&quot;checkbox&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;checkbox&quot;</span> <span class="attr">class</span>=<span class="string">&quot;checkbox-input&quot;</span> <span class="attr">id</span>=<span class="string">&quot;checkbox2&quot;</span>&gt;</span></span><br><span class="line">            我的链接主体为 <span class="tag">&lt;<span class="name">b</span>&gt;</span>个人<span class="tag">&lt;/<span class="name">b</span>&gt;</span>，网站类型为<span class="tag">&lt;<span class="name">b</span>&gt;</span>博客<span class="tag">&lt;/<span class="name">b</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">label</span> <span class="attr">class</span>=<span class="string">&quot;checkbox&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;checkbox&quot;</span> <span class="attr">class</span>=<span class="string">&quot;checkbox-input&quot;</span> <span class="attr">id</span>=<span class="string">&quot;checkbox3&quot;</span>&gt;</span></span><br><span class="line">            我的网站现在可以在中国大陆区域正常访问</span><br><span class="line">        <span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">p</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">label</span> <span class="attr">class</span>=<span class="string">&quot;checkbox&quot;</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">&quot;checkbox&quot;</span> <span class="attr">class</span>=<span class="string">&quot;checkbox-input&quot;</span> <span class="attr">id</span>=<span class="string">&quot;checkbox4&quot;</span>&gt;</span></span><br><span class="line">            网站内容符合中国大陆法律法规</span><br><span class="line">        <span class="tag">&lt;/<span class="name">label</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">p</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br></pre></td></tr></table></figure><h1 id="解决PJAX刷新后JS失效的问题"><a href="#解决PJAX刷新后JS失效的问题" class="headerlink" title="解决PJAX刷新后JS失效的问题"></a>解决PJAX刷新后JS失效的问题</h1><p>PJAX的开启，会导致DOM的监听器失效，因此需要在PJAX刷新后重新绑定监听器，将JS代码修改为如下即可：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="keyword">function</span> <span class="title function_">initCheckboxLogic</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">const</span> checkboxes = <span class="variable language_">document</span>.<span class="title function_">querySelectorAll</span>(<span class="string">&quot;.checkbox-input&quot;</span>);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="comment">// 更新提交按钮的显示状态</span></span></span><br><span class="line"><span class="language-javascript">    <span class="keyword">function</span> <span class="title function_">updateSubmitButton</span>(<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">const</span> twikooSubmit = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&quot;.tk-submit&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">const</span> input = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;.el-textarea__inner&#x27;</span>);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">        <span class="comment">// 检查 .tk-submit 是否存在</span></span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">if</span> (!twikooSubmit) &#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="variable language_">console</span>.<span class="title function_">warn</span>(<span class="string">&quot;评论提交按钮 .tk-submit 未找到&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">return</span>;</span></span><br><span class="line"><span class="language-javascript">        &#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">        <span class="comment">// 检查 .el-textarea__inner 是否存在</span></span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">if</span> (!input) &#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="variable language_">console</span>.<span class="title function_">warn</span>(<span class="string">&quot;评论输入框 .el-textarea__inner 未找到&quot;</span>);</span></span><br><span class="line"><span class="language-javascript">            <span class="keyword">return</span>;</span></span><br><span class="line"><span class="language-javascript">        &#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">        <span class="comment">// 检查是否所有复选框都已勾选</span></span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">const</span> allChecked = <span class="title class_">Array</span>.<span class="title function_">from</span>(checkboxes).<span class="title function_">every</span>(<span class="function"><span class="params">checkbox</span> =&gt;</span> checkbox.<span class="property">checked</span>);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">        <span class="keyword">if</span> (allChecked) &#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="comment">// 显示提交按钮</span></span></span><br><span class="line"><span class="language-javascript">            twikooSubmit.<span class="property">style</span>.<span class="property">opacity</span> = <span class="string">&quot;1&quot;</span>;</span></span><br><span class="line"><span class="language-javascript">            twikooSubmit.<span class="property">style</span>.<span class="property">height</span> = <span class="string">&quot;auto&quot;</span>;</span></span><br><span class="line"><span class="language-javascript">            twikooSubmit.<span class="property">style</span>.<span class="property">overflow</span> = <span class="string">&quot;visible&quot;</span>;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">            <span class="comment">// 填写模板信息到输入框</span></span></span><br><span class="line"><span class="language-javascript">            <span class="comment">// input.value = &#x27;-name：\nlink：\navatar：\ndescr：\n&#x27;;</span></span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">            <span class="comment">// 模拟输入事件以更新界面</span></span></span><br><span class="line"><span class="language-javascript">            input.<span class="title function_">dispatchEvent</span>(<span class="keyword">new</span> <span class="title class_">Event</span>(<span class="string">&#x27;input&#x27;</span>, &#123; <span class="attr">bubbles</span>: <span class="literal">true</span> &#125;));</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">            <span class="comment">// 将光标设置到最后一行</span></span></span><br><span class="line"><span class="language-javascript">            input.<span class="title function_">focus</span>();</span></span><br><span class="line"><span class="language-javascript">            input.<span class="title function_">setSelectionRange</span>(input.<span class="property">value</span>.<span class="property">length</span>, input.<span class="property">value</span>.<span class="property">length</span>);</span></span><br><span class="line"><span class="language-javascript">        &#125; <span class="keyword">else</span> &#123;</span></span><br><span class="line"><span class="language-javascript">            <span class="comment">// 隐藏提交按钮</span></span></span><br><span class="line"><span class="language-javascript">            twikooSubmit.<span class="property">style</span>.<span class="property">opacity</span> = <span class="string">&quot;0&quot;</span>;</span></span><br><span class="line"><span class="language-javascript">            twikooSubmit.<span class="property">style</span>.<span class="property">height</span> = <span class="string">&quot;0&quot;</span>;</span></span><br><span class="line"><span class="language-javascript">            twikooSubmit.<span class="property">style</span>.<span class="property">overflow</span> = <span class="string">&quot;hidden&quot;</span>;</span></span><br><span class="line"><span class="language-javascript">        &#125;</span></span><br><span class="line"><span class="language-javascript">    &#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">    <span class="comment">// 给每个复选框添加监听器</span></span></span><br><span class="line"><span class="language-javascript">    checkboxes.<span class="title function_">forEach</span>(<span class="function"><span class="params">checkbox</span> =&gt;</span> checkbox.<span class="title function_">addEventListener</span>(<span class="string">&quot;change&quot;</span>, updateSubmitButton));</span></span><br><span class="line"><span class="language-javascript">&#125;</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="variable language_">document</span>.<span class="title function_">addEventListener</span>(<span class="string">&quot;DOMContentLoaded&quot;</span>, <span class="keyword">function</span> (<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="title function_">initCheckboxLogic</span>();</span></span><br><span class="line"><span class="language-javascript">&#125;);</span></span><br><span class="line"><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript"><span class="comment">// 监听 PJAX 完成事件</span></span></span><br><span class="line"><span class="language-javascript"><span class="variable language_">document</span>.<span class="title function_">addEventListener</span>(<span class="string">&quot;pjax:complete&quot;</span>, <span class="keyword">function</span> (<span class="params"></span>) &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="title function_">initCheckboxLogic</span>();</span></span><br><span class="line"><span class="language-javascript">&#125;);</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Hexo </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 美化 </tag>
            
            <tag> 魔改 </tag>
            
            <tag> AnZhiYu </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Python使用Redis缓存</title>
      <link href="//posts/21307/"/>
      <url>//posts/21307/</url>
      
        <content type="html"><![CDATA[<h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>最近编写了一个Flask应用，其API接口需要访问MySQL数据库读取数据，为了防止高并发情况下MySQL数据库的压力，使用了Redis作为缓存来提高API接口的响应速度。本文将介绍Redis的基本概念和在Python中的使用方法。</p><h1 id="Redis简介"><a href="#Redis简介" class="headerlink" title="Redis简介"></a>Redis简介</h1><p>Redis（Remote Dictionary Server）是一个开源的高性能键值对存储数据库，最初由 Salvatore Sanfilippo 开发，它在内存中存储数据，并提供了持久化功能，可以将数据保存到磁盘中，是一种NoSQL(not-only sql,非关系型数据库)的数据库。</p><p>它的数据结构十分丰富，基础数据类型包括：string（字符串）、list（列表，双向链表）、hash（散列，键值对集合）、set（集合，不重复）和 sorted set（有序集合），这使得它不仅仅是一个简单的键值存储，还可以用于存储和处理复杂的数据。</p><h1 id="Redis-特点-优势"><a href="#Redis-特点-优势" class="headerlink" title="Redis 特点&#x2F;优势"></a>Redis 特点&#x2F;优势</h1><p>Redis 具备许多特点和优势，所以在大规模应用和高并发场景中得到广泛应用。</p><ul><li><strong>丰富的数据结构</strong>：Redis 支持多种数据结构，包括字符串（String）、哈希（Hash）、列表（List）、集合（Set）、有序集合（Sorted Set）等。每种数据结构都有丰富的操作命令，可以方便地对数据进行存储和处理。</li><li><strong>持久化</strong>：Redis 提供了两种持久化方式，RDB（Redis Database）和 AOF（Append Only File）。RDB 是将数据库在指定时间点转储到磁盘的快照持久化方式，AOF 是将写操作追加到文件末尾的日志持久化方式。这两种方式可以根据需求进行选择，保证数据在服务器重启后不会丢失。</li><li><strong>高性能</strong>：Redis 是一种内存数据库，数据存储在内存中，因此读写速度非常快。它采用单线程模型，避免了多线程带来的竞争问题，使得 Redis 能够充分利用 CPU 和内存资源。</li><li><strong>支持事务</strong>：Redis 支持事务操作，可以将多个命令打包执行，保证这些命令要么全部执行成功，要么全部失败，保持数据的一致性。虽然 Redis 在单个命令的执行上是原子性的，但是多个命令的组合并不是原子性的，通过事务可以实现一组命令的原子性执行。</li><li><strong>高可用与分布式</strong>：Redis 支持主从复制、哨兵和集群等功能，可以构建高可用和分布式的 Redis 架构。主从复制可以实现数据的热备份和读写分离，哨兵可以监控 Redis 的健康状态并进行自动故障转移，集群可以将数据分布在多个节点上，提高性能和扩展性。</li><li><strong>发布订阅</strong>：Redis 支持发布订阅模式，可以实现消息的发布和订阅。发布者将消息发布到指定的频道，订阅者可以订阅感兴趣的频道并接收相应的消息，实现了解耦和实时通信。</li></ul><h1 id="Redis-为什么很快"><a href="#Redis-为什么很快" class="headerlink" title="Redis 为什么很快"></a>Redis 为什么很快</h1><ul><li><strong>内存存储</strong>：Redis将数据存储在内存中，而不是像传统的磁盘存储数据库那样将数据写入到硬盘上。由于内存的读写速度远远快于磁盘，因此Redis能够实现极快的读写性能。</li><li><strong>单线程模型</strong>：Redis采用单线程模型，每个Redis实例都由单个主线程来处理所有的客户端请求。虽然单线程看起来似乎会限制其性能，但这实际上是Redis的一大优势。单线程模型消除了多线程之间的竞争和锁等开销，使得Redis能够充分利用CPU资源，并且避免了多线程带来的复杂性。此外，Redis在内部使用了I&#x2F;O多路复用技术（例如epoll或kqueue）来处理并发请求，使得单线程能够同时处理多个客户端连接。</li><li><strong>非阻塞IO</strong>：Redis使用了非阻塞IO，也就是在读写操作时不会阻塞其他操作。在读取数据时，如果内存中没有所需的数据，Redis会立即返回一个空结果，而不会等待数据从磁盘加载进来。这样即使在高并发情况下，Redis也能够快速地响应请求。</li><li><strong>高效的数据结构</strong>：Redis支持多种高效的数据结构，比如字符串、哈希、列表、集合、有序集合等。这些数据结构的设计和实现都非常高效，能够在常量时间内完成查找、插入、删除等操作，保证了Redis的高速性能。</li><li><strong>异步操作</strong>：Redis支持异步操作，比如异步持久化和异步复制。异步操作能够让Redis在进行磁盘持久化和主从复制时不会阻塞其他操作，提高了整体的性能。<br>优化的网络协议：Redis使用RESP（Redis Serialization Protocol）作为网络协议，RESP是一种简单、高效的二进制协议。RESP协议的设计使得网络传输的数据量尽可能地减少，减少了网络传输的开销，提高了性能。</li><li><strong>原子性操作</strong>：Redis支持很多原子性操作，比如INCR、DECR、SETNX等。原子性操作能够在一条命令中完成多个操作，而且这些操作是不可中断的，保证了数据的一致性。</li></ul><h1 id="应用场景"><a href="#应用场景" class="headerlink" title="应用场景"></a>应用场景</h1><p>由于 Redis 具备高性能、丰富的数据结构和多种特性，它的主要应用场景如下：</p><ul><li><strong>缓存</strong>：作为缓存数据库，Redis 可以将经常访问的数据存储在内存中，避免频繁读写数据库，提高应用的响应速度。缓存可以存储热点数据，减轻后端数据库的压力，提高系统的吞吐量。</li><li><strong>计数器</strong>：利用 Redis 的原子性操作，可以实现高效的计数器功能，比如网站的点赞、浏览次数等统计功能。由于 Redis 原子性操作的特性，计数器的更新可以并发执行而不会出现竞争问题。</li><li><strong>消息队列</strong>：Redis 的发布订阅功能和列表数据结构可以实现简单的消息队列，用于解耦系统的各个模块。生产者将消息发布到指定频道，消费者订阅感兴趣的频道并处理消息，实现异步消息传递。<br>排行榜：使用有序集合数据结构，可以实现排行榜功能，比如游戏中的玩家排名。通过有序集合的分数属性，可以对玩家的得分进行排序和排名，实时显示排行榜。</li><li><strong>会话缓存</strong>：在 Web 应用中，可以使用 Redis 存储用户的会话数据，实现分布式会话管理。用户登录后，可以将会话数据存储在 Redis 中，从而实现多台服务器之间的会话共享。</li></ul><h1 id="Redis-常用命令"><a href="#Redis-常用命令" class="headerlink" title="Redis 常用命令"></a>Redis 常用命令</h1><p>Redis 提供了命令行客户端 redis-cli，用于与 Redis 服务进行交互。以下是一些常用的 Redis 命令：</p><p><strong>SET</strong>：添加或修改一个字符串类型的键值对。<br><strong>GET</strong>：根据键名获取对应的值。<br><strong>INCR</strong>：将一个整数值自增 1。<br><strong>DECR</strong>：将一个整数值自减 1。<br><strong>LPUSH</strong>：向列表的左边插入一个元素。<br><strong>RPUSH</strong>：向列表的右边插入一个元素。<br><strong>HSET</strong>：添加或修改一个哈希类型键的字段值。<br><strong>HGET</strong>：根据键名和字段名获取哈希类型的值。</p><h1 id="Python-中使用-Redis"><a href="#Python-中使用-Redis" class="headerlink" title="Python 中使用 Redis"></a>Python 中使用 Redis</h1><h2 id="安装-redis-py-库"><a href="#安装-redis-py-库" class="headerlink" title="安装 redis-py 库"></a>安装 redis-py 库</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install redis</span><br></pre></td></tr></table></figure><h2 id="连接-Redis-服务器"><a href="#连接-Redis-服务器" class="headerlink" title="连接 Redis 服务器"></a>连接 Redis 服务器</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> redis  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># 连接到本地 Redis 服务器  </span></span><br><span class="line">r = redis.Redis(host=<span class="string">&#x27;localhost&#x27;</span>, port=<span class="number">6379</span>, db=<span class="number">0</span>, password=<span class="string">&#x27;&#x27;</span>, decode_responses=<span class="literal">True</span>)  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># host ip地址 默认本地</span></span><br><span class="line"><span class="comment"># port 端口号 默认6379</span></span><br><span class="line"><span class="comment"># password 密码</span></span><br><span class="line"><span class="comment"># db 数据库</span></span><br><span class="line"><span class="comment"># decode_responses=True 参数用于确保从 Redis 获取的字符串数据以 Python 字符串形式存在，而不是字节类型</span></span><br></pre></td></tr></table></figure><h2 id="数据操作"><a href="#数据操作" class="headerlink" title="数据操作"></a>数据操作</h2><h3 id="字符串操作"><a href="#字符串操作" class="headerlink" title="字符串操作"></a>字符串操作</h3><ul><li>key 代指键名</li><li>string 代指值（字符串类型）</li></ul><p><strong>设置键值对 set(key, string)</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">r.<span class="built_in">set</span>(<span class="string">&#x27;mykey&#x27;</span>, <span class="string">&#x27;myvalue&#x27;</span>)</span><br></pre></td></tr></table></figure><p><strong>获取字符串 get(key)</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">value = r.get(<span class="string">&#x27;mykey&#x27;</span>)  </span><br><span class="line"><span class="built_in">print</span>(value)  <span class="comment"># 输出: myvalue</span></span><br></pre></td></tr></table></figure><p><strong>检查键是否存在 exists(key)</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">exists = r.exists(<span class="string">&#x27;mykey&#x27;</span>)  </span><br><span class="line"><span class="built_in">print</span>(exists)  <span class="comment"># 输出: True 或 False</span></span><br></pre></td></tr></table></figure><p><strong>删除键 delete(key)</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">deleted = r.delete(<span class="string">&#x27;mykey&#x27;</span>)  </span><br><span class="line"><span class="built_in">print</span>(deleted)  <span class="comment"># 输出: 1 表示删除成功</span></span><br></pre></td></tr></table></figure><p><strong>批量设置键值对 mset({key: value, key1: value1})</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">r.mset(&#123;<span class="string">&#x27;key1&#x27;</span>: <span class="string">&#x27;value1&#x27;</span>, <span class="string">&#x27;key2&#x27;</span>: <span class="string">&#x27;value2&#x27;</span>&#125;)  </span><br><span class="line">values = r.mget(<span class="string">&#x27;key1&#x27;</span>, <span class="string">&#x27;key2&#x27;</span>)  </span><br><span class="line"><span class="built_in">print</span>(values)  <span class="comment"># 输出: [&#x27;value1&#x27;, &#x27;value2&#x27;]</span></span><br></pre></td></tr></table></figure><h3 id="哈希操作"><a href="#哈希操作" class="headerlink" title="哈希操作"></a>哈希操作</h3><ul><li>keytable 代指哈希表</li><li>key 字段</li><li>value 数据</li></ul><p><strong>存储哈希值hset(keytable, key, value)</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">r.hset(<span class="string">&#x27;myhash&#x27;</span>, <span class="string">&#x27;field1&#x27;</span>, <span class="string">&#x27;value1&#x27;</span>)</span><br></pre></td></tr></table></figure><p><strong>获取哈希值hget(keytable, key)</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">value = r.hget(<span class="string">&#x27;myhash&#x27;</span>, <span class="string">&#x27;field1&#x27;</span>)  </span><br><span class="line"><span class="built_in">print</span>(value)  <span class="comment"># 输出: value1</span></span><br></pre></td></tr></table></figure><p><strong>批量存储哈希值hget(keytable, key_dict)</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 假设 hmset 可用  </span></span><br><span class="line">r.hmset(<span class="string">&#x27;myhash&#x27;</span>, &#123;<span class="string">&#x27;field2&#x27;</span>: <span class="string">&#x27;value2&#x27;</span>, <span class="string">&#x27;field3&#x27;</span>: <span class="string">&#x27;value3&#x27;</span>&#125;)  </span><br><span class="line">values = r.hmget(<span class="string">&#x27;myhash&#x27;</span>, <span class="string">&#x27;field2&#x27;</span>, <span class="string">&#x27;field3&#x27;</span>)  </span><br><span class="line"><span class="built_in">print</span>(values)  <span class="comment"># 输出: [b&#x27;value2&#x27;, b&#x27;value3&#x27;] （注意：这里可能需要 decode_responses=True）</span></span><br></pre></td></tr></table></figure><p><strong>获取所有哈希值hgetall(keytable)</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">all_fields_values = r.hgetall(<span class="string">&#x27;myhash&#x27;</span>)  </span><br><span class="line"><span class="built_in">print</span>(all_fields_values)  <span class="comment"># 输出类似: &#123;&#x27;field1&#x27;: &#x27;value1&#x27;, &#x27;field2&#x27;: &#x27;value2&#x27;, ...&#125;</span></span><br></pre></td></tr></table></figure><h3 id="列表操作"><a href="#列表操作" class="headerlink" title="列表操作"></a>列表操作</h3><ul><li>mylist 代指列表名</li><li>value代指数据</li></ul><p><strong>添加元素</strong></p><ul><li>lpush(mylist, value) 在列表左侧添加</li><li>rpush(mylist, value) 在列表右侧添加</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">r.lpush(<span class="string">&#x27;mylist&#x27;</span>, <span class="string">&#x27;value1&#x27;</span>)  <span class="comment"># 在列表左侧添加  </span></span><br><span class="line">r.rpush(<span class="string">&#x27;mylist&#x27;</span>, <span class="string">&#x27;value2&#x27;</span>)  <span class="comment"># 在列表右侧添加</span></span><br></pre></td></tr></table></figure><p><strong>获取列表元素lrang(mylist, start, end)</strong></p><ul><li>start 索引开始位置</li><li>end 索引结束位置</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 获取列表中的所有元素  </span></span><br><span class="line"><span class="built_in">print</span>(r.lrange(<span class="string">&#x27;mylist&#x27;</span>, <span class="number">0</span>, -<span class="number">1</span>))  <span class="comment"># 输出: [b&#x27;0&#x27;, b&#x27;a&#x27;, b&#x27;b&#x27;, b&#x27;c&#x27;]  </span></span><br><span class="line">  </span><br><span class="line"><span class="comment"># 获取列表中的前两个元素  </span></span><br><span class="line"><span class="built_in">print</span>(r.lrange(<span class="string">&#x27;mylist&#x27;</span>, <span class="number">0</span>, <span class="number">1</span>))  <span class="comment"># 输出: [b&#x27;0&#x27;, b&#x27;a&#x27;]</span></span><br></pre></td></tr></table></figure><p><strong>移除元素</strong></p><ul><li>lpop：移除并获取列表的第一个元素</li><li>rpop：移除并获取列表的最后一个元素</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 移除并获取列表的第一个元素  </span></span><br><span class="line"><span class="built_in">print</span>(r.lpop(<span class="string">&#x27;mylist&#x27;</span>))  <span class="comment"># 输出: b&#x27;0&#x27;  </span></span><br><span class="line">  </span><br><span class="line"><span class="comment"># 移除并获取列表的最后一个元素  </span></span><br><span class="line"><span class="built_in">print</span>(r.rpop(<span class="string">&#x27;mylist&#x27;</span>))  <span class="comment"># 输出: b&#x27;c&#x27;</span></span><br></pre></td></tr></table></figure><p><strong>列表长度llen(mylist)</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(r.llen(<span class="string">&#x27;mylist&#x27;</span>))  <span class="comment"># 输出列表的长度</span></span><br></pre></td></tr></table></figure><h3 id="集合操作"><a href="#集合操作" class="headerlink" title="集合操作"></a>集合操作</h3><ul><li>myset 集合名</li><li>value 数据</li></ul><p><strong>添加元素sadd(myset, value)</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">r.sadd(<span class="string">&#x27;myset&#x27;</span>, <span class="string">&#x27;element1&#x27;</span>)  </span><br><span class="line">r.sadd(<span class="string">&#x27;myset&#x27;</span>, <span class="string">&#x27;element2&#x27;</span>, <span class="string">&#x27;element3&#x27;</span>)  <span class="comment"># 可以一次添加多个元素</span></span><br></pre></td></tr></table></figure><p><strong>获取集合中的元素smember(myset)</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">elements = r.smembers(<span class="string">&#x27;myset&#x27;</span>)  </span><br><span class="line"><span class="built_in">print</span>(elements)  <span class="comment"># 输出集合中的所有元素，可能是一个无序的列表</span></span><br></pre></td></tr></table></figure><p><strong>集合的长度scart(myset)</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">length = r.scard(<span class="string">&#x27;myset&#x27;</span>)  </span><br><span class="line"><span class="built_in">print</span>(length)  <span class="comment"># 输出集合中的元素数量</span></span><br></pre></td></tr></table></figure><p><strong>集合的差集sdiff(myset, myset1)</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">set1 = &#123;<span class="string">&#x27;element1&#x27;</span>, <span class="string">&#x27;element2&#x27;</span>, <span class="string">&#x27;element3&#x27;</span>&#125;  </span><br><span class="line">r.sadd(<span class="string">&#x27;set1&#x27;</span>, *set1)  <span class="comment"># 假设set1已存在于Redis中  </span></span><br><span class="line">r.sadd(<span class="string">&#x27;set2&#x27;</span>, <span class="string">&#x27;element2&#x27;</span>, <span class="string">&#x27;element4&#x27;</span>)  <span class="comment"># 假设set2也已存在  </span></span><br><span class="line">  </span><br><span class="line">diff = r.sdiff(<span class="string">&#x27;set1&#x27;</span>, <span class="string">&#x27;set2&#x27;</span>)  </span><br><span class="line"><span class="built_in">print</span>(diff)  <span class="comment"># 输出: &#123;&#x27;element1&#x27;, &#x27;element3&#x27;&#125;，即set1有而set2没有的元素</span></span><br></pre></td></tr></table></figure><p><strong>集合的交集sinter(myset, myset1)</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">inter = r.sinter(<span class="string">&#x27;set1&#x27;</span>, <span class="string">&#x27;set2&#x27;</span>)  </span><br><span class="line"><span class="built_in">print</span>(inter)  <span class="comment"># 输出: &#123;&#x27;element2&#x27;&#125;，即set1和set2共有的元素</span></span><br></pre></td></tr></table></figure><p><strong>从集合中移除元素</strong><br>使用srem命令从集合中移除一个或多个元素。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">r.srem(<span class="string">&#x27;myset&#x27;</span>, <span class="string">&#x27;element1&#x27;</span>, <span class="string">&#x27;element2&#x27;</span>)  </span><br><span class="line"><span class="comment"># 现在&#x27;myset&#x27;中不再包含&#x27;element1&#x27;和&#x27;element2&#x27;</span></span><br></pre></td></tr></table></figure><p><strong>集合的随机元素</strong><br>使用srandmember命令从集合中随机获取一个或多个元素。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">random_element = r.srandmember(<span class="string">&#x27;myset&#x27;</span>)  </span><br><span class="line"><span class="built_in">print</span>(random_element)  <span class="comment"># 随机输出&#x27;myset&#x27;中的一个元素  </span></span><br><span class="line">  </span><br><span class="line"><span class="comment"># 获取多个随机元素  </span></span><br><span class="line">random_elements = r.srandmember(<span class="string">&#x27;myset&#x27;</span>, <span class="number">2</span>)  <span class="comment"># 获取两个随机元素  </span></span><br><span class="line"><span class="built_in">print</span>(random_elements)</span><br></pre></td></tr></table></figure><p><strong>集合的弹出元素</strong><br>使用spop命令从集合中随机移除一个元素并返回该元素。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">popped_element = r.spop(<span class="string">&#x27;myset&#x27;</span>)  </span><br><span class="line"><span class="built_in">print</span>(popped_element)  <span class="comment"># 随机输出&#x27;myset&#x27;中的一个元素，并从集合中移除它</span></span><br></pre></td></tr></table></figure><h3 id="有序集合"><a href="#有序集合" class="headerlink" title="有序集合"></a>有序集合</h3><p>有序集合是Redis中一种特殊的集合类型，它不仅包含元素，还为每个元素关联了一个浮点数分数（score），这使得元素可以按照分数进行排序。</p><p><strong>添加元素到有序集合</strong><br>使用zadd命令向有序集合中添加一个或多个元素及其分数。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">r.zadd(<span class="string">&#x27;mysortedset&#x27;</span>, &#123;<span class="string">&#x27;member1&#x27;</span>: <span class="number">1</span>, <span class="string">&#x27;member2&#x27;</span>: <span class="number">2</span>&#125;)  </span><br><span class="line"><span class="comment"># 或者对于单个元素  </span></span><br><span class="line">r.zadd(<span class="string">&#x27;mysortedset&#x27;</span>, <span class="number">1</span>, <span class="string">&#x27;member3&#x27;</span>)</span><br></pre></td></tr></table></figure><p><strong>获取有序集合中的元素</strong><br>使用zrange（升序）或zrevrange（降序）命令获取有序集合中的元素及其分数。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 升序获取  </span></span><br><span class="line">ascending = r.zrange(<span class="string">&#x27;mysortedset&#x27;</span>, <span class="number">0</span>, -<span class="number">1</span>, withscores=<span class="literal">True</span>)  </span><br><span class="line"><span class="built_in">print</span>(ascending)  <span class="comment"># 输出类似: [(&#x27;member1&#x27;, 1.0), (&#x27;member2&#x27;, 2.0), (&#x27;member3&#x27;, 1.0)]  </span></span><br><span class="line">  </span><br><span class="line"><span class="comment"># 降序获取  </span></span><br><span class="line">descending = r.zrevrange(<span class="string">&#x27;mysortedset&#x27;</span>, <span class="number">0</span>, -<span class="number">1</span>, withscores=<span class="literal">True</span>)  </span><br><span class="line"><span class="built_in">print</span>(descending)  <span class="comment"># 输出可能反转的顺序</span></span><br></pre></td></tr></table></figure><p><strong>获取有序集合的排名</strong><br>使用zrank（升序排名）或zrevrank（降序排名）命令获取元素的排名。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">rank = r.zrank(<span class="string">&#x27;mysortedset&#x27;</span>, <span class="string">&#x27;member1&#x27;</span>)  </span><br><span class="line"><span class="built_in">print</span>(rank)  <span class="comment"># 输出: 0，如果member1是分数最低的元素  </span></span><br><span class="line">  </span><br><span class="line">revrank = r.zrevrank(<span class="string">&#x27;mysortedset&#x27;</span>, <span class="string">&#x27;member2&#x27;</span>)  </span><br><span class="line"><span class="built_in">print</span>(revrank)  <span class="comment"># 输出: 0，如果member2是分数最高的元素</span></span><br></pre></td></tr></table></figure><p><strong>删除有序集合中的元素</strong><br>使用zrem命令从有序集合中移除一个或多个元素。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">r.zrem(<span class="string">&#x27;mysortedset&#x27;</span>, <span class="string">&#x27;member1&#x27;</span>, <span class="string">&#x27;member3&#x27;</span>)</span><br></pre></td></tr></table></figure><h2 id="使用Redis作为缓存"><a href="#使用Redis作为缓存" class="headerlink" title="使用Redis作为缓存"></a>使用Redis作为缓存</h2><p>为了避免短时间内大量的请求访问导致读取数据频繁，可以使用Redis作为缓存来提高API接口的响应速度。我的思路是将函数名和参数作为key，返回值作为value，并根据数据的变动情况设置缓存过期时间。基本不变的数据可以设置较长的过期时间，而经常变动的数据可以设置较短的过期时间，既能提高缓存命中率，又能避免缓存的滞后性。</p><p>同时，为了方便存入和取出数据，我将缓存函数写为了装饰器(decorator)，可以直接在函数上添加@cache()装饰器，即可在调用函数前先检查缓存，如果缓存存在，则直接返回缓存数据，否则调用函数并将结果存入缓存。</p><p>另外，我还在装饰器中添加了refresh参数的识别，如果函数传参时带有refresh&#x3D;True参数，装饰器会自动将其剔除，不会影响原函数执行，但会强制刷新缓存，即不检查缓存是否存在，这样可以更灵活地控制缓存的更新，比如某些特殊情况下需要即时更新缓存的函数。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> redis</span><br><span class="line"><span class="keyword">from</span> functools <span class="keyword">import</span> wraps</span><br><span class="line"></span><br><span class="line"><span class="comment"># 此处是自定义的配置文件，用于存放Redis连接信息等</span></span><br><span class="line"><span class="comment"># REDIS_HOST redis主机地址</span></span><br><span class="line"><span class="comment"># REDIS_PORT redis端口</span></span><br><span class="line"><span class="comment"># REDIS_DB redis数据库</span></span><br><span class="line"><span class="comment"># EXPIRE_TIME 缓存过期时间，单位秒</span></span><br><span class="line"><span class="comment"># CACHE_PREFIX 缓存前缀，用于区分同一数据库下不同项目的缓存</span></span><br><span class="line"><span class="comment"># ENABLE_CACHE 是否启用缓存</span></span><br><span class="line"><span class="keyword">from</span> config <span class="keyword">import</span> REDIS_HOST, REDIS_PORT, REDIS_DB, EXPIRE_TIME, CACHE_PREFIX, ENABLE_CACHE</span><br><span class="line"></span><br><span class="line"><span class="comment"># 建立Redis连接</span></span><br><span class="line"><span class="comment"># 由于我的redis未设置密码，所以这里无需连接密码，如果设置了密码，则需要修改此处代码</span></span><br><span class="line">redis_db = redis.Redis(host=REDIS_HOST, port=REDIS_PORT, db=REDIS_DB, decode_responses=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">cache</span>(<span class="params">cache_exp=EXPIRE_TIME</span>):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">decorator</span>(<span class="params">func</span>):</span><br><span class="line"><span class="meta">        @wraps(<span class="params">func</span>)</span></span><br><span class="line">        <span class="keyword">def</span> <span class="title function_">wrapper</span>(<span class="params">*args, **kwargs</span>):</span><br><span class="line">            <span class="comment"># 提取刷新标志，并从kwargs中移除，以防止传递给原始函数</span></span><br><span class="line">            refresh = kwargs.pop(<span class="string">&#x27;refresh&#x27;</span>, <span class="literal">False</span>)</span><br><span class="line">            <span class="comment"># 使用函数名称和参数生成唯一的Redis键</span></span><br><span class="line">            cache_key = <span class="string">f&quot;<span class="subst">&#123;CACHE_PREFIX&#125;</span>:<span class="subst">&#123;func.__name__&#125;</span>:<span class="subst">&#123;args&#125;</span>&quot;</span></span><br><span class="line"></span><br><span class="line">            <span class="comment"># 如果缓存未启用，直接调用原始函数</span></span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> ENABLE_CACHE:</span><br><span class="line">                <span class="keyword">return</span> func(*args, **kwargs)</span><br><span class="line"></span><br><span class="line">            <span class="comment"># 检查是否需要刷新缓存</span></span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> refresh:</span><br><span class="line">                <span class="keyword">try</span>:</span><br><span class="line">                    <span class="comment"># 查询Redis缓存</span></span><br><span class="line">                    cached_result = redis_db.get(cache_key)</span><br><span class="line">                    <span class="keyword">if</span> cached_result:</span><br><span class="line">                        <span class="keyword">return</span> <span class="built_in">eval</span>(cached_result)</span><br><span class="line">                <span class="keyword">except</span>:</span><br><span class="line">                    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line">            <span class="comment"># 如果缓存不存在或已过期，调用原始函数</span></span><br><span class="line">            result = func(*args, **kwargs)</span><br><span class="line">            <span class="comment"># 将结果存储到Redis，并设置过期时间</span></span><br><span class="line">            <span class="keyword">if</span> result != &#123;&#125; <span class="keyword">and</span> result != <span class="string">&#x27;&#123;&#125;&#x27;</span>:</span><br><span class="line">                redis_db.setex(cache_key, cache_exp, <span class="built_in">str</span>(result))</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                redis_db.setex(cache_key, <span class="number">180</span>, <span class="built_in">str</span>(result))</span><br><span class="line">            <span class="keyword">return</span> result</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> wrapper</span><br><span class="line">    <span class="keyword">return</span> decorator</span><br></pre></td></tr></table></figure><p><strong>使用方法：</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 调用缓存装饰器，过期时间为默认时间</span></span><br><span class="line"><span class="meta">@cache()</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">my_func</span>(<span class="params">a, b</span>):</span><br><span class="line">    <span class="comment"># 此处是需要缓存的函数</span></span><br><span class="line">    <span class="keyword">return</span> a + b</span><br><span class="line"></span><br><span class="line"><span class="comment"># 调用缓存装饰器，过期时间为120秒</span></span><br><span class="line"><span class="meta">@cache(<span class="params"><span class="number">120</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">my_func1</span>(<span class="params">a, b</span>):</span><br><span class="line">    <span class="comment"># 此处是需要缓存的函数</span></span><br><span class="line">    <span class="keyword">return</span> a + b</span><br><span class="line"></span><br><span class="line"><span class="comment"># 调用函数，并传入参数</span></span><br><span class="line">result = my_func(<span class="number">1</span>, <span class="number">2</span>)</span><br><span class="line"><span class="built_in">print</span>(result)  <span class="comment"># 输出: 3</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 再次调用函数，由于缓存存在，所以直接返回缓存数据，不执行函数</span></span><br><span class="line">result = my_func(<span class="number">1</span>, <span class="number">2</span>)</span><br><span class="line"><span class="built_in">print</span>(result)  <span class="comment"># 输出: 3</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 调用带有refresh参数的函数，会强制刷新缓存，重新执行函数并更新缓存</span></span><br><span class="line">result = my_func(<span class="number">1</span>, <span class="number">2</span>, refresh=<span class="literal">True</span>)</span><br><span class="line"><span class="built_in">print</span>(result)  <span class="comment"># 输出: 3</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 编程 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Python </tag>
            
            <tag> Redis </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>网站字体压缩</title>
      <link href="//posts/61148/"/>
      <url>//posts/61148/</url>
      
        <content type="html"><![CDATA[<h1 id="写在前面"><a href="#写在前面" class="headerlink" title="写在前面"></a>写在前面</h1><p>在修改网站字体时，用到了第三方字体库，但是该字体库有20+MB大小，加载速度很慢。网速很慢的话，极其影响用户体验，还可能致使字体无法生效。换字体是不可能的，特此记录一下如何压缩字体，来加快访问速度。</p><div class="note info flat"><p>据测试，字体从20.7MB压缩至1.65MB，压缩率为92.03%。</p></div><h2 id="字体格式科普"><a href="#字体格式科普" class="headerlink" title="字体格式科普"></a>字体格式科普</h2><p>常见的字体格式有以下几种，这里只作简单介绍。</p><h3 id="TTF"><a href="#TTF" class="headerlink" title="TTF"></a>TTF</h3><blockquote><p>TTF（TrueTypeFont）是Apple 公司和Microsoft公司共同推出的字体文件格式，随着 windows 的流行，已经变成最常用的一种字体文件表示方式。</p></blockquote><p>这种格式的字体文件体积比较大，以<a href="https://github.com/adobe-fonts/source-han-serif/tree/release">思源宋体</a>为例，字体文件可以达到 24MB+，通常只用作安装到计算机中的字体，或者在网页中设备不支持 WOFF2 字体情况的兜底处理。</p><h3 id="OTF"><a href="#OTF" class="headerlink" title="OTF"></a>OTF</h3><blockquote><p><strong>OpenType</strong>，是一种可缩放字体（scalable font）电脑字体类型，采用<a href="https://zh.wikipedia.org/wiki/PostScript">PostScript</a>格式，是微软公司与Adobe公司联合开发，用来替代<a href="https://zh.wikipedia.org/wiki/TrueType">TrueType</a>字体的新字体。这类字体的文件扩展名有<code>.otf</code>、<code>.ttf</code>、<code>.ttc</code>，类型代码是<code>OTTO</code>，现行标准为OpenType 1.9。</p></blockquote><p>可以理解为和 TTF 字体差不多，这里我们主要讨论体积问题，OTF 字体文件体积也很大，基本和 TTF 差不多。</p><h3 id="WOFF-WOFF2"><a href="#WOFF-WOFF2" class="headerlink" title="WOFF &amp; WOFF2"></a>WOFF &amp; WOFF2</h3><blockquote><p><strong>Web开放字体格式</strong>（Web Open Font Format，简称<strong>WOFF</strong>）是一种网页所采用的字体格式标准。此字体格式发展于2009年，由万维网联盟的Web字体工作小组标准化，现在已经是推荐标准。此字体格式不但能够有效利用压缩来减少文件大小，并且不包含加密也不受DRM（数字著作权管理）限制。</p></blockquote><p>这是专门给网页使用的字体格式，体积非常小，实测压缩<a href="https://github.com/adobe-fonts/source-han-serif/tree/release">思源宋体</a>字体文件，可以把体积压缩到 OTF 字体 70% 的大小。</p><p><strong>WOFF 和 WOFF2 的区别在于：</strong></p><blockquote><p>WOFF本质上是包含了基于<a href="https://zh.wikipedia.org/wiki/SFNT">SFNT</a>的字体（如<a href="https://zh.wikipedia.org/wiki/TrueType">TrueType</a>、<a href="https://zh.wikipedia.org/wiki/OpenType">OpenType</a>或其他开放字体格式），且这些字体均经过WOFF的编码工具压缩，以便嵌入网页中。WOFF 1.0使用<a href="https://zh.wikipedia.org/wiki/Zlib">zlib</a>压缩，文件大小一般比TTF小40%。而WOFF 2.0使用<a href="https://zh.wikipedia.org/wiki/Brotli">Brotli</a>压缩，文件大小比上一版小30%。</p></blockquote><p>因此，在网页中，一般推荐直接使用 <strong>WOFF2</strong>。</p><h1 id="压缩方法"><a href="#压缩方法" class="headerlink" title="压缩方法"></a>压缩方法</h1><p>这部分是正式的压缩方法了，主要分为两步，分别是：取子集、压缩。</p><p>前置条件： </p><ul><li>已安装Python环境</li><li>已安装pip</li></ul><h2 id="安装压缩工具"><a href="#安装压缩工具" class="headerlink" title="安装压缩工具"></a>安装压缩工具</h2><p>这里我使用到的是 Python 的一个库：fonttools，使用最新版 Python 的 pip 命令安装即可在 Shell 中使用：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install fonttools</span><br></pre></td></tr></table></figure><h2 id="提取字体子集"><a href="#提取字体子集" class="headerlink" title="提取字体子集"></a>提取字体子集</h2><p>中文汉字数量很多，以<a href="https://github.com/adobe-fonts/source-han-serif/tree/release">思源宋体</a>为例，思源宋体遵循 GB 18030 和通用规范汉字表，包含 8105 个规范字（来源：<a href="https://sspai.com/post/38705">少数派</a>），可能还有其他语言的字符，实际字符数量肯定是远超这个数字的。</p><p>实际上，常用汉字数量也就 3500 个左右，如果你的文本相对固定，可以考虑删减掉其他不常用的汉字。</p><p>极端做法是只保留文本中出现的字符，其他的全部删掉，但是我个人更倾向于折中保留 3500 汉字，在未来如果修改了文本，也不至于每次都要重新压缩一遍字体。</p><p>这种删减字符的做法叫**“取子集”**。取子集我们需要定义一个纯文本文件，里面包含所有要保留的字符。</p><p>这里提供两种方法，一种是使用整合好的子集，另一种是自行制作子集。</p><div class="tabs" id="提取子集"><ul class="nav-tabs"><button type="button" class="tab  active" data-href="提取子集-1">整合好的子集</button><button type="button" class="tab " data-href="提取子集-2">自行制作子集</button></ul><div class="tab-contents"><div class="tab-item-content active" id="提取子集-1"><p>三选一下载即可，Unicode字符集的整合较为全面，但是压缩后的字体文件体积会比文本字符集的大，优点是支持的字符更多。根据你的需求选择即可。</p><p>文本字符集：<a href="https://gist.github.com/MoyuScript/f94d0c594e47113b209156a653aaba93#file-%E7%8E%B0%E4%BB%A3%E6%B1%89%E8%AF%AD%E5%B8%B8%E7%94%A83500%E5%AD%97-txt">现代汉语常用 3500 字</a>。</p><p>Unicode字符集：<a href="https://font-1312300313.cos.ap-beijing.myqcloud.com/font/sc_unicode.txt">汉语Unicode字符集</a>（直接网页打开，另存为<code>txt</code>文件）</p><p>通用Unicode字符集：<a href="https://cdn.randench.cn/cloud/unicodes.txt">通用字符集</a>（直接网页打开，另存为<code>txt</code>文件，支持<code>英文&amp;日文&amp;中文简繁&amp;常用符号</code>，但压缩率不如上述两个字符集）</p></div><div class="tab-item-content" id="提取子集-2"><div class="note warning flat"><p>此方式生成的字符集更小，压缩率也更高，但是缺点是发布新文章后，如果文章中有上次没有的字符，则会导致字体丢失，这时候就需要重新生成子集并压缩。</p></div><p>以<code>Hexo</code>网站为例，先执行<code>hexo g</code>指令生成你的网站<code>public</code>文件夹，然后通过脚本遍历此目录下的所有文件，提取出所有字符，并将其写入一个纯文本文件中。<br>这里提供一个用于提取字符的python脚本：</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">from</span> collections <span class="keyword">import</span> defaultdict</span><br><span class="line"></span><br><span class="line"><span class="comment"># 要提取的文件类型</span></span><br><span class="line">extensions = (<span class="string">&#x27;.txt&#x27;</span>, <span class="string">&#x27;.html&#x27;</span>, <span class="string">&#x27;.js&#x27;</span>, <span class="string">&#x27;.css&#x27;</span>, <span class="string">&#x27;.xml&#x27;</span>, <span class="string">&#x27;.json&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 字符分类</span></span><br><span class="line">categories = &#123;</span><br><span class="line">    <span class="string">&#x27;Latin&#x27;</span>: <span class="built_in">set</span>(),</span><br><span class="line">    <span class="string">&#x27;Chinese Characters&#x27;</span>: <span class="built_in">set</span>(),</span><br><span class="line">    <span class="string">&#x27;Chinese Simplified &amp; Traditional&#x27;</span>: <span class="built_in">set</span>(),</span><br><span class="line">    <span class="string">&#x27;Symbols&#x27;</span>: <span class="built_in">set</span>(),</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># 字符的Unidcode范围</span></span><br><span class="line">latin_range = <span class="built_in">range</span>(<span class="number">0x0000</span>, <span class="number">0x0100</span>)</span><br><span class="line">chinese_range = <span class="built_in">range</span>(<span class="number">0x4E00</span>, <span class="number">0x9FFF</span>)</span><br><span class="line">symbols_range = [</span><br><span class="line">    <span class="built_in">range</span>(<span class="number">0x2000</span>, <span class="number">0x206F</span>),  <span class="comment"># General Punctuation</span></span><br><span class="line">    <span class="built_in">range</span>(<span class="number">0x3000</span>, <span class="number">0x303F</span>),  <span class="comment"># CJK Symbols and Punctuation</span></span><br><span class="line">    <span class="built_in">range</span>(<span class="number">0xFF00</span>, <span class="number">0xFFEF</span>),  <span class="comment"># Halfwidth and Fullwidth Forms</span></span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 分类字符</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">categorize_character</span>(<span class="params">char</span>):</span><br><span class="line">    code_point = <span class="built_in">ord</span>(char)</span><br><span class="line">    <span class="keyword">if</span> code_point <span class="keyword">in</span> latin_range:</span><br><span class="line">        categories[<span class="string">&#x27;Latin&#x27;</span>].add(<span class="string">f&#x27;<span class="subst">&#123;code_point:04X&#125;</span>&#x27;</span>)</span><br><span class="line">    <span class="keyword">elif</span> code_point <span class="keyword">in</span> chinese_range:</span><br><span class="line">        categories[<span class="string">&#x27;Chinese Simplified &amp; Traditional&#x27;</span>].add(<span class="string">f&#x27;<span class="subst">&#123;code_point:04X&#125;</span>&#x27;</span>)</span><br><span class="line">    <span class="keyword">elif</span> <span class="built_in">any</span>(code_point <span class="keyword">in</span> r <span class="keyword">for</span> r <span class="keyword">in</span> symbols_range):</span><br><span class="line">        categories[<span class="string">&#x27;Symbols&#x27;</span>].add(<span class="string">f&#x27;<span class="subst">&#123;code_point:04X&#125;</span>&#x27;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        categories[<span class="string">&#x27;Chinese Characters&#x27;</span>].add(<span class="string">f&#x27;<span class="subst">&#123;code_point:04X&#125;</span>&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 遍历文件</span></span><br><span class="line"><span class="keyword">for</span> root, dirs, files <span class="keyword">in</span> os.walk(<span class="string">&#x27;./public&#x27;</span>):</span><br><span class="line">    <span class="keyword">for</span> file <span class="keyword">in</span> files:</span><br><span class="line">        <span class="keyword">if</span> file.endswith(extensions):</span><br><span class="line">            file_path = os.path.join(root, file)</span><br><span class="line">            <span class="keyword">with</span> <span class="built_in">open</span>(file_path, <span class="string">&#x27;r&#x27;</span>, encoding=<span class="string">&#x27;utf-8&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">                content = f.read()</span><br><span class="line">                <span class="keyword">for</span> char <span class="keyword">in</span> content:</span><br><span class="line">                    categorize_character(char)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 输出结果</span></span><br><span class="line">output_str = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> category, chars <span class="keyword">in</span> categories.items():</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;# <span class="subst">&#123;category&#125;</span>&quot;</span>)</span><br><span class="line">    output_str += <span class="string">f&quot;# <span class="subst">&#123;category&#125;</span>\n&quot;</span></span><br><span class="line">    <span class="keyword">for</span> char <span class="keyword">in</span> <span class="built_in">sorted</span>(chars):</span><br><span class="line">        <span class="comment"># print(char)</span></span><br><span class="line">        output_str += <span class="string">f&quot;<span class="subst">&#123;char&#125;</span>\n&quot;</span></span><br><span class="line">        </span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;unicode_set.txt&#x27;</span>, <span class="string">&#x27;w+&#x27;</span>, encoding=<span class="string">&#x27;utf-8&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    f.write(output_str)</span><br></pre></td></tr></table></figure><p>将脚本文件放在博客根目录下，运行脚本即可生成<code>unicode_set.txt</code>文件。</p></div></div><div class="tab-to-top"><button type="button" aria-label="scroll to top"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i></button></div></div><h2 id="压缩字体"><a href="#压缩字体" class="headerlink" title="压缩字体"></a>压缩字体</h2><p>使用以下命令即可对字体文件取子集：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 对于文字子集</span></span><br><span class="line">fonttools subset <span class="string">&quot;<span class="variable">$input_file</span>&quot;</span> --text-file=<span class="string">&quot;<span class="variable">$text_file</span>&quot;</span></span><br><span class="line"><span class="comment"># 对于Unicode子集</span></span><br><span class="line">fonttools subset <span class="string">&quot;<span class="variable">$input_file</span>&quot;</span> --unicodes-file=<span class="string">&quot;<span class="variable">$text_file</span>&quot;</span></span><br></pre></td></tr></table></figure><p>变量含义：</p><ul><li>$input_file：输入的字体文件。</li><li>$text_file：定义保留字符的纯文本文件路径。</li></ul><p>压缩命令执行完毕后，会在当前目录出现压缩过的字体库<code>example-font.subset.ttf</code>。</p><p>此时的字体文件已经相较于原来有了近乎 90% 的压缩。</p><h2 id="进一步压缩"><a href="#进一步压缩" class="headerlink" title="进一步压缩"></a>进一步压缩</h2><p>使用在线压缩工具 <a href="https://cloudconvert.com/">Cloudconvert</a> ，将ttf文件转换成woff2文件（进一步压缩大小）</p>]]></content>
      
      
      <categories>
          
          <category> Hexo </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 教程 </tag>
            
            <tag> 字体压缩 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>MC服务器实现外置+正版混合登录</title>
      <link href="//posts/7169/"/>
      <url>//posts/7169/</url>
      
        <content type="html"><![CDATA[<h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>由于国内不少MC玩家没有正版账号，如果开正版服务器，离线玩家就无法进入，开离线服务器又需要增加登录插件，玩家每次进入服务器都需要登录，比较繁琐。离线验证可以通过使用皮肤站外置登录方式解决，但这样正版玩家也需要去皮肤站注册才能完成登录，因此考虑能否实现外置+正版混合登录，正版玩家能直接进入服务器，而盗版玩家在皮肤站注册后能在启动器层完成登录直接进服，省去每次进服后的登陆过程。</p><h1 id="准备工作"><a href="#准备工作" class="headerlink" title="准备工作"></a>准备工作</h1><ul><li>一个 MC 服务端</li><li>一个皮肤站</li><li>一个启动器(支持第三方登录)</li><li>YggdrasilOfficialProxy&#x2F;YggdrasilGateway</li></ul><h1 id="皮肤站搭建"><a href="#皮肤站搭建" class="headerlink" title="皮肤站搭建"></a>皮肤站搭建</h1><p>如果你需要自己的皮肤站，可以选择<a href="https://github.com/bs-community/blessing-skin-server">Blessing Skin</a>，安装指南见<a href="https://blessing.netlify.app/setup.html">Blessing Skin 用户手册</a>。<br>文档中给出了详细的安装方法，本文不再赘述。</p><div class="note info flat"><p>如果遇到插件市场无法打开的问题，可以参考<a href="https://github.com/bs-community/blessing-skin-server/issues/454#issuecomment-2116159226">Issues</a>解决</p></div><p>或者你也可以直接使用现成的皮肤站，比如<a href="https://littleskin.cn/">LittleSkin</a>。</p><h1 id="登录代理"><a href="#登录代理" class="headerlink" title="登录代理"></a>登录代理</h1><p>下载<a href="https://github.com/YggdrasilOfficialProxy/YggdrasilOfficialProxy/releases/download/2.3.0/">YggdrasilOfficialProxy</a>和<a href="https://github.com/yushijinhun/authlib-injector/releases/tag/v1.2.5">authlib-injector</a></p><p>首先打开你的服务器配置文件<code>server.properties</code>，找到<code>online-mode</code>这一行，将其改为<code>online-mode=true</code>，即开启正版验证。</p><p>将两个文件放到服务端核心的同一目录下后，在你的服务器启动脚本中添加以下参数:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">-javaagent:./authlib-injector.jar-1.2.5=https://你的皮肤站域名/api/yggdrasil</span><br></pre></td></tr></table></figure><p>启动一次服务器，然后将参数替换为：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">-javaagent:YggdrasilOfficialProxy-2.3.0-paperclip.jar</span><br></pre></td></tr></table></figure><p>启动服务器，此时会生成<code>YggdrasilOfficialProxy.conf</code>文件，修改配置文件，然后重启服务器</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"># API Root, 将这里改成你的皮肤站域名</span><br><span class="line">api=&quot;https://你的皮肤站域名/api/yggdrasil&quot;</span><br><span class="line"># Authlib Injector的位置, 无效的话服务器将无法启动</span><br><span class="line">authlib-injector=&quot;authlib-injector-1.2.5.jar&quot;</span><br><span class="line"># 重要! 重要!, 必须为 true!</span><br><span class="line">edited=true</span><br><span class="line"># 在合并玩家查找的时候, 是否优先使用正版服务器的内容</span><br><span class="line">official-first=false</span><br><span class="line"># 代理服务器的设置</span><br><span class="line">server &#123;</span><br><span class="line">    # 换成 127.0.0.1</span><br><span class="line">    host=&quot;127.0.0.1&quot;</span><br><span class="line">    # 随便写, 随便写一个没有被占用的端口</span><br><span class="line">    port=32217</span><br><span class="line">&#125;</span><br><span class="line"># Proxy settings</span><br><span class="line">proxy &#123;</span><br><span class="line">    just-example-for-http &#123;</span><br><span class="line">        type=http</span><br><span class="line">        url=&quot;http://localhost/proxy&quot;</span><br><span class="line">    &#125;</span><br><span class="line">    # The proxy of official connecting</span><br><span class="line">    official &#123;</span><br><span class="line">        host=localhost</span><br><span class="line">        port=1080</span><br><span class="line">        # type=socks</span><br><span class="line">        type=direct</span><br><span class="line">    &#125;</span><br><span class="line">    # The proxy of yggdrasil connecting</span><br><span class="line">    yggdrasil &#123;</span><br><span class="line">        type=direct</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>此时，你的服务器已经可以支持外置+正版混合登录了，正版玩家需要使用正版登录，外置玩家需要使用启动器第三方登录。</p><h1 id="第三方登录"><a href="#第三方登录" class="headerlink" title="第三方登录"></a>第三方登录</h1><div class="note warning flat"><p>如果你是自建皮肤站，则需要在插件市场中安装<code>Yggdrasil API</code>插件，才可用第三方登录。</p></div><p>进入皮肤站主页登录后会进入仪表盘页面，此时按照指示安装第三方登录即可，即将按钮拖入启动器：</p><p><img src="https://cdn.randench.cn/image/24/08/8c0d46cdea512a5d.png" alt="第三方登录"></p><p>点击启动器上的第三方登录按钮，会弹出登录窗口，输入你的用户名和密码，点击登录即可。</p><h1 id="特别说明"><a href="#特别说明" class="headerlink" title="特别说明"></a>特别说明</h1><p>根据 Minecraft Server, 只要UUID不一样, Name一样服务器都会允许玩家加入游戏, 原本 Minecraft 的 Name 是不可能重复的, 但是, YggdrasilOfficialProxy 打破了这个限制! 由于 YggdrasilOfficialProxy 的工作方式是替换 Mojang 的 hasJoined. 所以你可能会遇到服务器出现同名玩家的情况(两个分别来自正版&#x2F;第三方验证服务器的同名玩家, 同时加到了一个服务器里)。为了避免这种情况，需要额外的插件来限制玩家重名。<br>例如<a href="https://github.com/TURX/VL-UniqueUUID">UniqueUUID</a>或者<a href="https://github.com/YggdrasilOfficialProxy/UniqueUidName">UniqueUidName</a>，前者需要自行够构建，后者则提供了构建好的jar。</p><div class="note info flat"><p>这里提供一个已经构建好的<a href="https://cdn.randench.cn/cloud/UniqueUUID.jar">UniqueUUID</a></p></div>]]></content>
      
      
      <categories>
          
          <category> 游戏 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 教程 </tag>
            
            <tag> MC </tag>
            
            <tag> 游戏 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>使用CDN加速你的网站</title>
      <link href="//posts/65285/"/>
      <url>//posts/65285/</url>
      
        <content type="html"><![CDATA[<h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>由于我的博客部署在Vercel等Serverless平台上，此类平台对于国内来说访问速度较慢，有的地区甚至会出现无法访问的情况，因此我打算使用CDN来加速网站，奖网站分发到国内节点，同时还能通过缓存功能减少流量消耗并加快访问速度。</p><div class="note warning flat"><p>注意：大部分国内 CDN 使用需要域名进行备案。</p></div><h1 id="什么是CDN"><a href="#什么是CDN" class="headerlink" title="什么是CDN"></a>什么是CDN</h1><p>CDN英文全称<code>Content Delivery Network</code>，中文翻译即为内容分发网络。它是建立并覆盖在承载网之上，由分布在不同区域的边缘节点服务器群组成的分布式网络。<br>简而言之就是，厂商在全国各地都有很多很多的服务器，每一个服务器我们称之为节点，很多的节点组成了CDN。</p><h1 id="CDN的原理"><a href="#CDN的原理" class="headerlink" title="CDN的原理"></a>CDN的原理</h1><p>CDN的工作原理就是将源站的资源缓存到位于全国各地的CDN节点上，用户请求资源时，就近返回节点上缓存的资源，而不需要每个用户的请求都回您的源站获取，避免网络拥塞、分担源站压力，保证用户访问资源的速度和体验。</p><p>在用户与源站之间加了一层CDN，用户先访问 CDN的节点，CDN节点再去源站拿取内容，当用户第二次访问的时候就会直接返回节点上缓存的内容，由于节点离用户近，所以用户拿到资源的速度就会缩短，访问也就变快了。</p><p><strong>访问优先级</strong><br>通常情况下，中国内地的网络质量有以下特点：</p><ul><li>用户访问同运营商的 IP 地址过程中的网络质量优于访问跨运营商的 IP 地址过程中的网络质量。</li><li>用户访问同省运营商的 IP 地址过程中的网络质量优于访问跨省运营商的 IP 地址过程中的网络质量。</li><li>用户访问跨省同运营商的 IP 地址过程中的网络质量优于访问同省跨运营商的 IP 地址过程中的网络质量。</li></ul><h1 id="如何使用CDN"><a href="#如何使用CDN" class="headerlink" title="如何使用CDN"></a>如何使用CDN</h1><p>因为又拍云提供免费的每月10G云存储+15G流量，所以本文以又拍云为例进行说明。</p><h2 id="加入又拍云"><a href="#加入又拍云" class="headerlink" title="加入又拍云"></a>加入又拍云</h2><p>又拍云的免费流向需要你先加入又拍云联盟才可以获取:</p><p><img src="https://cdn.randench.cn/image/24/08/7ec795307642b4dd.webp" alt="申请规则"></p><p>首先注册<a href="https://console.upyun.com/register/">又拍云</a>，实名认证成功之后再申请加入<a href="https://www.upyun.com/league">又拍云联盟</a></p><p>然后按照网页上的要求，在网站底部加上又拍云的的标识，填写相关信息，提交申请。</p><p><img src="https://cdn.randench.cn/image/24/08/f1a406d055741474.png" alt="申请页面"></p><p>如果你是 Butterfly 主题的话，可以直接在主题的配置文件找到 custom_text 并加入以下代码</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">custom_text:</span> <span class="string">&lt;a</span> <span class="string">href=&quot;https://www.upyun.com/?utm_source=lianmeng&amp;utm_medium=referral&quot;</span> <span class="string">target=&quot;_blank&quot;</span> <span class="string">rel=&quot;noopener</span> <span class="string">nofollow&quot;&gt;&lt;img</span> <span class="string">style=&quot;position:relative;top:-2.5px;&quot;</span> <span class="string">src=&quot;https://cdn.jsdelivr.net/gh/caibhh/CDN/img/blog/%E5%8F%88%E6%8B%8D%E4%BA%91_logo5.webp&quot;</span> <span class="string">align=&quot;absmiddle&quot;</span> <span class="string">width=&quot;60px&quot;</span> <span class="string">height=&quot;30px&quot;&gt;提供加速服务&lt;/a&gt;</span></span><br></pre></td></tr></table></figure><p>对于 Anzhiyu 主题，可以参考 <a href="https://blog.randench.cn/posts/46303/">在网页上加入自定义徽标</a> 文章，修改配置文件，示例如下</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">bdageitem:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">list:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">link:</span> <span class="string">https://www.upyun.com/?utm_source=lianmeng&amp;utm_medium=referral</span></span><br><span class="line">      <span class="attr">shields:</span> <span class="string">https://img.shields.io/badge/CDN-%E5%8F%88%E6%8B%8D%E4%BA%91-00b6ff?style=flat&amp;logo=data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAABS2lUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4KPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNS42LWMxNDIgNzkuMTYwOTI0LCAyMDE3LzA3LzEzLTAxOjA2OjM5ICAgICAgICAiPgogPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4KICA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIi8+CiA8L3JkZjpSREY+CjwveDp4bXBtZXRhPgo8P3hwYWNrZXQgZW5kPSJyIj8+nhxg7wAABs1JREFUSInllv2PVFcZxz/n3LfZmdmd3ZndZWGhhV0qYLaFEgzQpog12tZYbVRCSa00mLap6Q+aNERp5QcVlRhi0GjaGElromI08aU1tMRXWmspRaEVbIDtdimwy77M7uy83Xvn3nP84c7b7oD/QE8yyT13znO/z/f7nOcF3m9L1B4OnNYYEoSG165kGZkukLLjdEmXiew4yum7+4qK31u2rduLFXOgEEoQCrQs9RjepaW2f35Nu/9QqRh4Fi4jrkHCMmhTitlCBcOIoP768CoAzGt5owFLQBKfad/Yflau+Mo4qY0IE8qAUbXUgKT9ctFZVJAzqzcivLN+/JGY0H6HKD0riKGvw7gFWAFtUmMTyFPF5C+Gded2LBmBaB2BAigRyeMJ0jGPgxtiyX+MtW18/ZL1DLEMK/TER9eb+Z2GQGU1CK0b8gKy9uCYYJmQcUCgUm+U0qeGw/R2pIwAdbPvAiE0aAGux0MDc7eJAJ57V7+GZYAQjLDo8yd0z6lAqQ5bBbh+iF8JWxmP5XwSJrhCyz9NJU7mdHwwknOBWEKAAq0EuIrPrKp8d3lb+M/HT/qvlsN2pKNRSoDUXAxSN+eKlWMPD7jrFi3pZc4NeHUh4+zcNMW5q/z47dLhi4X4IHYt2hFDBBFDpUmYJXoNb+y23tzPHlgRfu2F8bZ9s4W2zdgSpap2OopbzsysPUHX85YIcdU1YnxLX5pT0+59w+X4NqwmpgIIgUCxNF4+vsaY2bsknjtq+yYTnsGhMx33H8127SFp03KTBBAT/H3U+qTIZe9ambFfagHOl0OOjJs/wjCZdwtCARI2d899Z0iP7Rkv2J0ngu49xUCvu1R2+sJS6g4MAyF11deasY5+CjBs3jE6f3KrMXlDC/Cfr0xuuegtWYIpmjwXUA7YcbP69tb2ypPfO5naPyJ7d4fKioLUDihdVxZEpI4ApGiEyoKLM8aydyx5J/CXeTE+m5PbkFZV4qpBoPlAJnh7R7rw5G8vm9+/4PfvDg0rSiMdgYraeQ0xGVZu78o9tSUx9ViK0pUGc0CbTNtdu1oYG7Geu+vFAaLbqz0+3B1sf2WKnhcvJ79MvCn21JiKiGIAt6amn9scK+4brpiskOHMKRU/jCSS2xG8ddVbVcOrM54KrBvqoERyO4YqLTaKb76ct7+JtufHfuEyYKIkeoKKpN12ySs1QF28qkJmrL8FuBwqv7HTEELC4b/Fks/EjPgcDq05TeO8EJrhSten35KLDjpmhfd8/QBNYY6clp0twC1LAmGQLJdyCF08gub/MtYCECZni+JBTyYwrKS7ML2UbrxplEwpHeoJHkk9IPO/z3QluKen/GC/MXuM8PrIQkc3+sY298hAwsIQbSvnAWuwpSq3AGesyhhh08EwZKBdHi+EDjEkyxLBm9dtNYjqXx5DTnHvsCeXFCoi1fh6VPEsEYy3ACf1zN9qlRE0whAcdzM/GCk5Hz+W1dv+U0jubFy+aqdpFsCD9en8r4ba9fDLU6mfI8wo7Zqc65Ccru3q6dQtC79EVb6AUc1lQzJakP2jOvUSZrqKUgu0QMvqNgBkyOpk7ndfXKruP+11Pf5uwdgqHYWqHwIIGTTLh88tBN7a3/3i+VF/ZtyzujAFut57a0d0A1sDpdzoUkfMdCTNs4Pm3MG1nfL1Fy7bjxwtxn6IXfOzauNDZ6w8u67Pf/7IQuDB3hSfCMtPHDoX/hTDaJKxXgzR1ca/PjnzxOL47IGgXOYG2+U9f/Gyw1Op31yYsz6LKcEEpZryyPe5d1B+dWnf4rrwdeATo+P0yfBQr53cOVHp2oIjWpo/LgwlZp/etdo78MeJ9DeO5cUmM+fflNcdy9E2ONGkoWvZIQSUFGt63ZNb+hPPzPr1S9KUTlYndizDl1Zan+qOlXNUqobVD2gPMubcyP4PlR57Ix979MhI+9fLRsfH8qJ7OYYNhkZo1dRfNATQ3ebmdq2073KFQTmgFfjG7jjprjgrMsncPb2FDXEKkwRV8BCEGbD7g2LNmdnYwLPn257Gro6kNMaixlQlwJckVXbyvszsBseJTU+VqA4JC4DdisavwNUy2Ia4sCk5OdRvzLxCBXAVj64NdvTGtbf337ETaBvMa3V9EQ2BFbgpkf/XnbHpIUuHF2YrYMqGgPNi3OxJIZQgjYmNidIdYwHfyjpZ3ZGtHN6fXXbOVfE0MebncHXMAUiL4uRHlpQP3pJW+04OC3KhST+tw8k152oJeEpQNGxWx0tP+WGeK0Xbcb3SWCYpTS80ul0lECi0EF6n8LNJOzjThvuHobj/603dTnFcORQDQcf1y937bP0Pc6b8FW3Czt0AAAAASUVORK5CYII=</span></span><br><span class="line">      <span class="attr">message:</span> <span class="string">本站由又拍云提供CDN加速/云存储服务</span></span><br></pre></td></tr></table></figure><p>数天过后会有邮件通知你成功加入又拍云联盟，67￥ &#x2F; 年的代金券也发放下来了。</p><h1 id="开启CDN"><a href="#开启CDN" class="headerlink" title="开启CDN"></a>开启CDN</h1><p>进入 <a href="https://console.upyun.com/services/cdn/">CDN 服务管理</a>，点击创建服务</p><p><img src="https://cdn.randench.cn/image/24/08/4af582922265b5dc.webp" alt="创建服务"></p><p>如果你部署了多条线路，可以像我一样填写</p><p><img src="https://cdn.randench.cn/image/24/08/9b3adba05d5799d0.png" alt="创建服务2"></p><p>最后点击创建，CDN服务就创建好了。然后按照提供的域名，将你的加速域名解析到此。例如我需要加速国内，而境外直接访问源站，可以这样解析：</p><p><img src="https://cdn.randench.cn/image/24/08/8a46a636d5a28701.png" alt="解析"></p><p>然后你需要在<a href="https://console.upyun.com/toolbox/ssl/">SSL 证书服务</a>申请SSL证书，然后在CDN服务管理中绑定证书，或者你也可以直接上传已有证书。推荐直接在又拍云进行申请，方便管理也支持自动续签。</p><p>点击申购证书-Let’s Encrypt，然后直接创建订单即可。然后在购买列表补全订单中的域名即可(需要创建玩cdn服务后先等待审核完毕)</p><p><img src="https://cdn.randench.cn/image/24/08/5e16553799f151ae.png" alt="SSL"></p><p>证书申请成功后，回到CDN配置，在HTTPS-HTTPS配置中绑定证书即可，现在你的网址已经可以访问了。</p><h1 id="配置CDN"><a href="#配置CDN" class="headerlink" title="配置CDN"></a>配置CDN</h1><p>这里给出我个人的配置，大家可以根据自己的需求进行调整。</p><p><strong>缓存控制</strong></p><ul><li>全局缓存2小时(需要网站即时更新可不开启)</li><li>开启了分段缓存和离线模式</li></ul><table><thead><tr><th align="left">模板</th><th align="left">资源路径</th><th align="left">缓存时间</th></tr></thead><tbody><tr><td align="left">字体资源</td><td align="left">&#x2F;*.(ttf,otf,woff,woff2,eot,sfnt)</td><td align="left">7 天</td></tr><tr><td align="left">图片文件</td><td align="left">&#x2F;*.(jpg,jpeg,png,bmp,gif,psd,ico,tga,imb,tiff)</td><td align="left">7 天</td></tr><tr><td align="left">音视频文件</td><td align="left">&#x2F;*.(wav,mp3,wmv,rmi,aac,mp4,rmvb,mkv,avi,flv,swf,rm,mov,movie,qt)</td><td align="left">7 天</td></tr></tbody></table><p><strong>性能优化</strong></p><ul><li>智能压缩（GZip 和 Brotli 我都开启了，等级都为 3 级）但是要注意，当客户端同时支持 Gzip 和 Brotli 算法的情况下，Brotli 的优先级高于 Gzip。</li><li>页面压缩，开启</li><li>重定向跟随，开启</li></ul><p><strong>HTTPS</strong></p><ul><li>TLS 1.3，开启</li><li>最低 TLS 版本，我选的 <code>1.0</code></li><li>HTTP&#x2F;2，开启</li></ul><p><strong>访问控制（重要）</strong></p><ul><li><p>IP 黑白名单，建议大家把以下 IP 都加入到<strong>黑名单</strong>里</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">117.136.14.181</span><br><span class="line">117.183.0.241</span><br><span class="line">171.106.203.19</span><br><span class="line">220.173.125.83</span><br><span class="line">222.217.145.185</span><br><span class="line">113.14.130.128</span><br><span class="line">222.83.150.92</span><br><span class="line">113.14.130.19</span><br><span class="line">113.14.130.73</span><br><span class="line">113.57.53.37</span><br></pre></td></tr></table></figure></li><li><p>IP 访问限制，开启</p><p>点击添加限制规则，资源路径：<code>/*</code>，限制策略：100 - 200 禁止 600 秒，200 - 500 禁止 3600 秒，500 以上 86400 秒</p></li><li><p>CC 防护，开启</p><p>URI 匹配规则：<code>/*</code>，访问频率阈值：200 次，智能防护</p></li><li><p>WAF 保护，开启</p></li></ul>]]></content>
      
      
      <categories>
          
          <category> Hexo </category>
          
      </categories>
      
      
        <tags>
            
            <tag> CDN </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>代理和换源</title>
      <link href="//posts/57236/"/>
      <url>//posts/57236/</url>
      
        <content type="html"><![CDATA[<h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>此文章旨在记录一些常用的设置代理的方法，方便随时查阅。</p><h1 id="pip"><a href="#pip" class="headerlink" title="pip"></a>pip</h1><h2 id="临时换源"><a href="#临时换源" class="headerlink" title="临时换源"></a>临时换源</h2><div class="tabs" id="pip临时换源"><ul class="nav-tabs"><button type="button" class="tab  active" data-href="pip临时换源-1">命令行参数</button><button type="button" class="tab " data-href="pip临时换源-2">使用环境变量</button></ul><div class="tab-contents"><div class="tab-item-content active" id="pip临时换源-1"><p>你可以在运行pip命令时，使用-i参数指定源地址。例如：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install &lt;package_name&gt; -i &lt;mirror_url&gt;</span><br></pre></td></tr></table></figure><p>例如，从国内的阿里云镜像安装requests包，可以这样操作：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install requests -i https://mirrors.aliyun.com/pypi/simple</span><br></pre></td></tr></table></figure></div><div class="tab-item-content" id="pip临时换源-2"><p>你还可以通过设置环境变量来临时指定pip源。这种方法的好处是你可以在一次会话中多次使用该源，而无需每次都指定。<br>在Linux或macOS系统上，可以这样操作：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">export</span> PIP_INDEX_URL=https://mirrors.aliyun.com/pypi/simple</span><br><span class="line">pip install requests</span><br></pre></td></tr></table></figure><p>在Windows系统上，可以这样操作：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">set</span> PIP_INDEX_URL=https://mirrors.aliyun.com/pypi/simple </span><br><span class="line">pip install requests</span><br></pre></td></tr></table></figure><p>这种方法的好处是你可以在一次会话中多次使用该源，而无需每次都指定。</p></div></div><div class="tab-to-top"><button type="button" aria-label="scroll to top"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i></button></div></div><h2 id="永久换源"><a href="#永久换源" class="headerlink" title="永久换源"></a>永久换源</h2><div class="tabs" id="pip永久换源"><ul class="nav-tabs"><button type="button" class="tab  active" data-href="pip永久换源-1">修改pip配置文件</button><button type="button" class="tab " data-href="pip永久换源-2">使用pip命令设置</button></ul><div class="tab-contents"><div class="tab-item-content active" id="pip永久换源-1"><p>你可以在pip的配置文件中设置默认的源地址。pip的配置文件通常位于以下路径：</p><p>Linux和macOS: <code>~/.pip/pip.conf</code><br>Windows: <code>%APPDATA%\pip\pip.ini</code></p><p>如果这些文件不存在，可以手动创建。在文件中添加以下内容：</p><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">[global] index-url = https://mirrors.aliyun.com/pypi/simple </span><br></pre></td></tr></table></figure></div><div class="tab-item-content" id="pip永久换源-2"><p>你还可以通过pip命令来设置默认源：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip config <span class="built_in">set</span> global.index-url https://mirrors.aliyun.com/pypi/simple </span><br></pre></td></tr></table></figure><p>执行上述命令后，pip会自动创建或更新配置文件，并将默认源设置为你指定的地址。</p></div></div><div class="tab-to-top"><button type="button" aria-label="scroll to top"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i></button></div></div><h2 id="常见的国内镜像源"><a href="#常见的国内镜像源" class="headerlink" title="常见的国内镜像源"></a>常见的国内镜像源</h2><p>以下是一些常用的国内PyPI镜像源，你可以根据需要选择使用：</p><ul><li>阿里云: <code>https://mirrors.aliyun.com/pypi/simple/</code></li><li>豆瓣: <code>https://pypi.douban.com/simple/</code></li><li>清华大学: <code>https://pypi.tuna.tsinghua.edu.cn/simple/</code></li><li>中国科学技术大学: <code>https://pypi.mirrors.ustc.edu.cn/simple/</code></li></ul><h2 id="还原默认源"><a href="#还原默认源" class="headerlink" title="还原默认源"></a>还原默认源</h2><p>查看当前的源地址：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip config get global.index-url</span><br></pre></td></tr></table></figure><p>恢复默认源：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip config <span class="built_in">unset</span> global.index-url</span><br></pre></td></tr></table></figure><h1 id="npm"><a href="#npm" class="headerlink" title="npm"></a>npm</h1><div class="tip warning"><p>在发表npm包时，注意把源改回官方源才能发布，因此不推荐直接修改源，而是使用代理或者其他包管理器。</p></div><div class="tabs" id="npm换源"><ul class="nav-tabs"><button type="button" class="tab  active" data-href="npm换源-1">直接换源(不推荐)</button><button type="button" class="tab " data-href="npm换源-2">使用代理</button><button type="button" class="tab " data-href="npm换源-3">使用cnpm</button><button type="button" class="tab " data-href="npm换源-4">使用nrm</button></ul><div class="tab-contents"><div class="tab-item-content active" id="npm换源-1"><p>你可以直接修改npm的源地址。在命令行中输入以下命令：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm config <span class="built_in">set</span> registry https://registry.npmmirror.com</span><br></pre></td></tr></table></figure></div><div class="tab-item-content" id="npm换源-2"><p>在命令行中输入以下命令设置代理</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">npm config <span class="built_in">set</span> proxy http://127.0.0.1:1080</span><br><span class="line">npm config <span class="built_in">set</span> https-proxy https://127.0.0.1:1080</span><br></pre></td></tr></table></figure><p>或者你也可以在环境变量中设置代理</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># linux/macos</span></span><br><span class="line"><span class="built_in">export</span> http_proxy=http://127.0.0.1:1080</span><br><span class="line"><span class="built_in">export</span> https_proxy=https://127.0.0.1:1080</span><br><span class="line"><span class="comment"># windows</span></span><br><span class="line"><span class="built_in">set</span> http_proxy=http://127.0.0.1:1080</span><br><span class="line"><span class="built_in">set</span> https_proxy=https://127.0.0.1:1080</span><br></pre></td></tr></table></figure><p>查看代理：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">npm config get proxy</span><br><span class="line">npm config get https-proxy</span><br></pre></td></tr></table></figure><p>删除代理：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">npm config delete proxy</span><br><span class="line">npm config delete https-proxy</span><br></pre></td></tr></table></figure></div><div class="tab-item-content" id="npm换源-3"><p>安装cnpm包来代替npm，然后使用cnpm来安装依赖。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">npm install -g cnpm --registry=https://registry.npmmirror.com</span><br><span class="line">cnpm install &lt;package_name&gt;</span><br></pre></td></tr></table></figure></div><div class="tab-item-content" id="npm换源-4"><p>nrm是npm registry manager的简称，它可以帮助你管理npm源。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">npm install -g nrm --registry=https://registry.npmmirror.com</span><br><span class="line">nrm use taobao</span><br></pre></td></tr></table></figure><p>测试速度：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nrm <span class="built_in">test</span> taobao</span><br></pre></td></tr></table></figure><p>使用nrm添加镜像地址：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">nrm add r_name r_url </span><br><span class="line"><span class="comment"># r_name 为镜像名字，r_url 为镜像地址</span></span><br></pre></td></tr></table></figure><p>删除nrm镜像:</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">nrm del r_name</span><br></pre></td></tr></table></figure></div></div><div class="tab-to-top"><button type="button" aria-label="scroll to top"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i></button></div></div><h2 id="还原默认源-1"><a href="#还原默认源-1" class="headerlink" title="还原默认源"></a>还原默认源</h2><p>查看当前的源地址：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm config get registry</span><br></pre></td></tr></table></figure><p>恢复默认源：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm config <span class="built_in">set</span> registry https://registry.npmjs.org</span><br></pre></td></tr></table></figure><h1 id="git"><a href="#git" class="headerlink" title="git"></a>git</h1><h2 id="设置代理"><a href="#设置代理" class="headerlink" title="设置代理"></a>设置代理</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">git config --global http.proxy http://127.0.0.1:1080</span><br><span class="line">git config --global https.proxy https://127.0.0.1:1080</span><br></pre></td></tr></table></figure><h2 id="取消代理"><a href="#取消代理" class="headerlink" title="取消代理"></a>取消代理</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 取消HTTP代理设置</span></span><br><span class="line">git config --global --<span class="built_in">unset</span> http.proxy</span><br><span class="line"><span class="comment"># 取消HTTPS代理设置</span></span><br><span class="line">git config --global --<span class="built_in">unset</span> https.proxy</span><br></pre></td></tr></table></figure><h1 id="Python"><a href="#Python" class="headerlink" title="Python"></a>Python</h1><div class="tabs" id="python使用代理"><ul class="nav-tabs"><button type="button" class="tab  active" data-href="python使用代理-1">requests</button><button type="button" class="tab " data-href="python使用代理-2">httpx</button><button type="button" class="tab " data-href="python使用代理-3">aiohttp</button></ul><div class="tab-contents"><div class="tab-item-content active" id="python使用代理-1"><p>requests模块的代理设置如下</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">proxies = &#123;</span><br><span class="line">    <span class="string">&quot;http&quot;</span>: <span class="string">&quot;http://127.0.0.1:1080&quot;</span>,</span><br><span class="line">    <span class="string">&quot;https&quot;</span>: <span class="string">&quot;https://127.0.0.1:1080&quot;</span>,</span><br><span class="line">&#125;  </span><br><span class="line"></span><br><span class="line">response = requests.get(<span class="string">&quot;https://www.google.com&quot;</span>, proxies=proxies)</span><br><span class="line"><span class="built_in">print</span>(response.text)</span><br></pre></td></tr></table></figure></div><div class="tab-item-content" id="python使用代理-2"><p>httpx的使用方法与requests类似，只需将requests替换为httpx即可，代理格式可以简化，而且它还支持异步请求。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> httpx</span><br><span class="line"></span><br><span class="line">proxies = <span class="string">&quot;http://127.0.0.1:1080&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 同步</span></span><br><span class="line">response = httpx.get(<span class="string">&quot;https://www.google.com&quot;</span>, proxies=proxies)</span><br><span class="line"><span class="built_in">print</span>(response.text)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 异步</span></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">with</span> httpx.AsyncClient(proxies=proxies) <span class="keyword">as</span> client:</span><br><span class="line">    response = <span class="keyword">await</span> client.get(<span class="string">&quot;https://www.google.com&quot;</span>)</span><br><span class="line">    <span class="built_in">print</span>(response.text)</span><br></pre></td></tr></table></figure></div><div class="tab-item-content" id="python使用代理-3"><p>aiohttp是Python异步HTTP客户端&#x2F;服务器框架，它可以帮助你更方便地处理HTTP请求。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> aiohttp</span><br><span class="line"></span><br><span class="line">proxies = <span class="string">&quot;http://127.0.0.1:1080&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">with</span> aiohttp.ClientSession() <span class="keyword">as</span> session:</span><br><span class="line">    <span class="keyword">async</span> <span class="keyword">with</span> session.get(<span class="string">&quot;https://www.google.com&quot;</span>, proxy=proxies) <span class="keyword">as</span> response:</span><br><span class="line">        <span class="built_in">print</span>(<span class="keyword">await</span> response.text())</span><br></pre></td></tr></table></figure></div></div><div class="tab-to-top"><button type="button" aria-label="scroll to top"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i></button></div></div><h1 id="环境变量代理"><a href="#环境变量代理" class="headerlink" title="环境变量代理"></a>环境变量代理</h1><p>Linux和Windows如果直接在系统环境设置代理可能会出现问题，本文仅介绍临时代理的设置</p><div class="tabs" id="环境变量代理"><ul class="nav-tabs"><button type="button" class="tab  active" data-href="环境变量代理-1">Linux/macOS</button><button type="button" class="tab " data-href="环境变量代理-2">Windows</button></ul><div class="tab-contents"><div class="tab-item-content active" id="环境变量代理-1"><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">export</span> http_proxy=http://127.0.0.1:1080</span><br><span class="line"><span class="built_in">export</span> https_proxy=https://127.0.0.1:1080</span><br></pre></td></tr></table></figure><p>取消代理：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">unset</span> http_proxy</span><br><span class="line"><span class="built_in">unset</span> https_proxy</span><br></pre></td></tr></table></figure></div><div class="tab-item-content" id="环境变量代理-2"><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">set</span> http_proxy=http://127.0.0.1:1080</span><br><span class="line"><span class="built_in">set</span> https_proxy=https://127.0.0.1:1080</span><br></pre></td></tr></table></figure><p>取消代理：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">set</span> http_proxy=</span><br><span class="line"><span class="built_in">set</span> https_proxy=</span><br></pre></td></tr></table></figure></div></div><div class="tab-to-top"><button type="button" aria-label="scroll to top"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i></button></div></div>]]></content>
      
      
      <categories>
          
          <category> 教程 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Python </tag>
            
            <tag> 教程 </tag>
            
            <tag> 实用 </tag>
            
            <tag> git </tag>
            
            <tag> npm </tag>
            
            <tag> linux </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Anzhiyu主题重写右键菜单播放器</title>
      <link href="//posts/46572/"/>
      <url>//posts/46572/</url>
      
        <content type="html"><![CDATA[<div class="note warning flat"><p>本文修改主题为<code>AnZhiYu</code>主题，若使用其他主题，请自行确认修改位置。</p></div><div class="tip warning faa-horizontal animated-hover"><p>本文对主题文件进行了较多的修改，请在修改前先备份原文件。</p></div><h1 id="写在前面"><a href="#写在前面" class="headerlink" title="写在前面"></a>写在前面</h1><p>主题右键菜单原有的功能仅在右键音乐时才显示。本文重写了该模块，将其改为常驻在菜单最下方的播放器样式，支持调整音量、播放&#x2F;暂停、下一首、上一首等功能，使其更加直观。</p><h1 id="样式预览"><a href="#样式预览" class="headerlink" title="样式预览"></a>样式预览</h1><details class="folding-tag" ><summary> 样式预览 </summary>              <div class='content'>              <p><img src="https://cdn.randench.cn/image/24/08/2e46960bf375626b.gif" alt="右键菜单播放器样式预览"></p>              </div>            </details><h1 id="修改步骤"><a href="#修改步骤" class="headerlink" title="修改步骤"></a>修改步骤</h1><h2 id="新建文件"><a href="#新建文件" class="headerlink" title="新建文件"></a>新建文件</h2><p>新建<code>[Blogroot]\themes\anzhiyu\source\css\_custom\rightmenu.css</code>文件，用于存储样式：</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-id">#menu-music-data</span> &#123;</span><br><span class="line">    <span class="attribute">display</span>: flex;</span><br><span class="line">    <span class="attribute">flex-direction</span>: column;</span><br><span class="line">    <span class="attribute">align-items</span>: center;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-id">#menu-music-volume</span> &#123;</span><br><span class="line">    <span class="attribute">display</span>: flex;</span><br><span class="line">    <span class="attribute">flex-direction</span>: row;</span><br><span class="line">    <span class="attribute">align-items</span>: center;</span><br><span class="line">    <span class="attribute">justify-content</span>: space-between;</span><br><span class="line">    <span class="attribute">padding</span>: <span class="number">0</span> <span class="number">10px</span> <span class="number">0</span> <span class="number">10px</span>;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-id">#menu-music-volume</span> <span class="selector-tag">i</span> &#123;</span><br><span class="line">    <span class="comment">/* color: #c6c6c6; */</span></span><br><span class="line">    <span class="attribute">font-size</span>: <span class="number">20px</span>;</span><br><span class="line">    <span class="attribute">transition</span>: color .<span class="number">3s</span>;</span><br><span class="line">    <span class="attribute">cursor</span>: pointer;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-id">#menu-music-volume</span> <span class="selector-tag">i</span><span class="selector-pseudo">:hover</span> &#123;</span><br><span class="line">    <span class="attribute">color</span>: <span class="built_in">var</span>(--anzhiyu-main);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-id">#menu-music-control</span> &#123;</span><br><span class="line">    <span class="attribute">display</span>: flex;</span><br><span class="line">    <span class="attribute">flex-direction</span>: row;</span><br><span class="line">    <span class="attribute">align-items</span>: center;</span><br><span class="line">    <span class="attribute">justify-content</span>: space-evenly;</span><br><span class="line">    <span class="attribute">padding</span>: auto;</span><br><span class="line">    <span class="attribute">margin-top</span>: .<span class="number">2rem</span>;</span><br><span class="line">    <span class="attribute">margin-bottom</span>: .<span class="number">2rem</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-id">#menu-music-control</span> &gt; <span class="selector-tag">div</span> &#123;</span><br><span class="line">    <span class="attribute">padding</span>: <span class="number">2px</span> <span class="number">6px</span> <span class="number">2px</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-id">#menu-music-control</span> &gt; <span class="selector-tag">div</span><span class="selector-pseudo">:hover</span> &#123;</span><br><span class="line">    <span class="attribute">background-color</span>: <span class="built_in">var</span>(--anzhiyu-main);</span><br><span class="line">    <span class="attribute">color</span>: <span class="built_in">var</span>(--anzhiyu-white);</span><br><span class="line">    <span class="attribute">box-shadow</span>: <span class="built_in">var</span>(--anzhiyu-shadow-theme);</span><br><span class="line">    -webkit-<span class="attribute">transition</span>: <span class="number">0.1s</span>;</span><br><span class="line">    -moz-<span class="attribute">transition</span>: <span class="number">0.1s</span>;</span><br><span class="line">    -o-<span class="attribute">transition</span>: <span class="number">0.1s</span>;</span><br><span class="line">    -ms-<span class="attribute">transition</span>: <span class="number">0.1s</span>;</span><br><span class="line">    <span class="attribute">transition</span>: <span class="number">0.1s</span>;</span><br><span class="line">    <span class="attribute">border-radius</span>: <span class="number">8px</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-id">#menu-music-control</span> &gt; <span class="selector-tag">div</span> &gt; <span class="selector-tag">i</span> &#123;</span><br><span class="line">    <span class="attribute">font-size</span>: <span class="number">24px</span>;</span><br><span class="line">    <span class="attribute">cursor</span>: pointer;</span><br><span class="line">    <span class="attribute">line-height</span>: <span class="number">1rem</span>;</span><br><span class="line">    <span class="attribute">display</span>: inline-block;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.rightMenuMusic-item</span><span class="selector-pseudo">:hover</span> &#123;</span><br><span class="line">    <span class="attribute">background-color</span>: unset;</span><br><span class="line">    <span class="attribute">color</span>: unset;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-id">#rightMenu</span> <span class="selector-class">.rightMenu-group</span> <span class="selector-class">.rightMenu-item</span> &#123;</span><br><span class="line">    <span class="attribute">margin-top</span>: <span class="number">6px</span>;</span><br><span class="line">    <span class="attribute">padding</span>: <span class="number">2px</span> <span class="number">6px</span> <span class="number">0px</span>;</span><br><span class="line">    <span class="attribute">display</span>: inline-block;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-id">#volume-slider</span> &#123;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">100%</span><span class="meta">!important</span>;</span><br><span class="line">    <span class="attribute">height</span>: auto<span class="meta">!important</span>;</span><br><span class="line">    <span class="attribute">margin</span>: <span class="number">0</span><span class="meta">!important</span>;</span><br><span class="line">    <span class="attribute">padding</span>: <span class="number">0</span> <span class="number">4px</span><span class="meta">!important</span>;</span><br><span class="line">    <span class="attribute">position</span>: relative;</span><br><span class="line">    -webkit-<span class="attribute">box-sizing</span>: content-box;</span><br><span class="line">    <span class="attribute">box-sizing</span>: content-box;</span><br><span class="line">    -webkit-user-<span class="selector-tag">select</span>: none;</span><br><span class="line">    -moz-user-<span class="selector-tag">select</span>: none;</span><br><span class="line">    -ms-user-<span class="selector-tag">select</span>: none;</span><br><span class="line">    user-<span class="selector-tag">select</span>: none;</span><br><span class="line">    <span class="attribute">display</span>: block;</span><br><span class="line">    -webkit-tap-highlight-<span class="attribute">color</span>: <span class="built_in">rgba</span>(<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-id">#slider-rail</span> &#123;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">8px</span>;</span><br><span class="line">    <span class="attribute">background-color</span>: <span class="number">#f2b94b23</span>;</span><br><span class="line">    <span class="attribute">border-radius</span>: <span class="number">25px</span>;</span><br><span class="line">    <span class="attribute">position</span>: relative;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">    -webkit-<span class="attribute">transition-property</span>: width,height,left,right,top,bottom;</span><br><span class="line">    <span class="attribute">transition-property</span>: width,height,left,right,top,bottom;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-id">#slider-process</span> &#123;</span><br><span class="line">    <span class="attribute">border-radius</span>: <span class="number">25px</span>;</span><br><span class="line">    <span class="attribute">background-color</span>: <span class="number">#f2b94b</span>;</span><br><span class="line">    <span class="attribute">position</span>: absolute;</span><br><span class="line">    <span class="attribute">z-index</span>: <span class="number">1</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">100%</span>;</span><br><span class="line">    <span class="attribute">top</span>: <span class="number">0px</span>;</span><br><span class="line">    <span class="attribute">left</span>: <span class="number">0%</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-id">#slider-dot</span> &#123;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">14px</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">14px</span>;</span><br><span class="line">    <span class="attribute">transform</span>: <span class="built_in">translate</span>(-<span class="number">50%</span>, -<span class="number">50%</span>);</span><br><span class="line">    <span class="attribute">top</span>: <span class="number">50%</span>;</span><br><span class="line">    <span class="attribute">border</span>: <span class="number">1px</span> solid <span class="number">#f2b94b23</span>;</span><br><span class="line">    <span class="attribute">background-color</span>: <span class="number">#f2b94b</span>;</span><br><span class="line">    <span class="attribute">box-shadow</span>: .<span class="number">5px</span> .<span class="number">5px</span> <span class="number">2px</span> <span class="number">1px</span> <span class="number">#00000052</span>;</span><br><span class="line">    <span class="attribute">border-radius</span>: <span class="number">50%</span>;</span><br><span class="line">    <span class="attribute">cursor</span>: pointer;</span><br><span class="line">    <span class="attribute">position</span>: absolute;</span><br><span class="line">    <span class="attribute">z-index</span>: <span class="number">5</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-id">#menu-music-data</span> <span class="selector-id">#name</span>&#123;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">    <span class="attribute">padding</span>: <span class="number">0</span> <span class="number">8px</span>;</span><br><span class="line">    <span class="attribute">text-align</span>: center;</span><br><span class="line">    <span class="attribute">white-space</span>: nowrap;</span><br><span class="line">    <span class="attribute">overflow</span>: hidden;</span><br><span class="line">    <span class="attribute">text-overflow</span>: ellipsis;  </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-id">#menu-music-data</span> <span class="selector-id">#artist</span> &#123;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">    <span class="attribute">font-size</span>: <span class="number">14px</span>;</span><br><span class="line">    <span class="attribute">color</span>: <span class="number">#c6c6c6</span>;</span><br><span class="line">    <span class="attribute">padding</span>: <span class="number">0</span> <span class="number">8px</span>;</span><br><span class="line">    <span class="attribute">text-align</span>: center;</span><br><span class="line">    <span class="attribute">white-space</span>: nowrap;</span><br><span class="line">    <span class="attribute">overflow</span>: hidden;</span><br><span class="line">    <span class="attribute">text-overflow</span>: ellipsis;  </span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="修改菜单生成"><a href="#修改菜单生成" class="headerlink" title="修改菜单生成"></a>修改菜单生成</h2><p>修改<code>[Blogroot]\themes\anzhiyu\layout\includes\anzhiyu\rightmenu.pug</code>文件，整体修改为如下内容：</p><div class="note warning flat"><p>原文件的缩进使用代是制表符(Tab)缩进，而非空格缩进，两者不可混用，会产生报错，此处我使用的是空格缩进，修改时请注意。</p></div><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br></pre></td><td class="code"><pre><span class="line">- const &#123; translate &#125; = theme</span><br><span class="line">#rightMenu</span><br><span class="line">    .rightMenu-group.rightMenu-small</span><br><span class="line">        .rightMenu-item#menu-backward</span><br><span class="line">            i.anzhiyufont.anzhiyu-icon-arrow-left</span><br><span class="line">        .rightMenu-item#menu-forward</span><br><span class="line">            i.anzhiyufont.anzhiyu-icon-arrow-right</span><br><span class="line">        .rightMenu-item#menu-refresh</span><br><span class="line">            i.anzhiyufont.anzhiyu-icon-arrow-rotate-right(style=&quot;font-size: 1rem;&quot;)</span><br><span class="line">        .rightMenu-item#menu-top</span><br><span class="line">            i.anzhiyufont.anzhiyu-icon-arrow-up</span><br><span class="line">    .rightMenu-group.rightMenu-line.rightMenuPlugin</span><br><span class="line">        .rightMenu-item#menu-copytext</span><br><span class="line">            i.anzhiyufont.anzhiyu-icon-copy</span><br><span class="line">            span 复制选中文本</span><br><span class="line">        .rightMenu-item#menu-pastetext</span><br><span class="line">            i.anzhiyufont.anzhiyu-icon-paste</span><br><span class="line">            span 粘贴文本</span><br><span class="line">        a.rightMenu-item#menu-commenttext</span><br><span class="line">            i.anzhiyufont.anzhiyu-icon-comment-medical</span><br><span class="line">            span 引用到评论</span><br><span class="line">        .rightMenu-item#menu-newwindow</span><br><span class="line">            i.anzhiyufont.anzhiyu-icon-window-restore</span><br><span class="line">            span 新窗口打开</span><br><span class="line">        .rightMenu-item#menu-copylink</span><br><span class="line">            i.anzhiyufont.anzhiyu-icon-link</span><br><span class="line">            span 复制链接地址</span><br><span class="line">        .rightMenu-item#menu-copyimg</span><br><span class="line">            i.anzhiyufont.anzhiyu-icon-images</span><br><span class="line">            span 复制此图片</span><br><span class="line">        .rightMenu-item#menu-downloadimg</span><br><span class="line">            i.anzhiyufont.anzhiyu-icon-download</span><br><span class="line">            span 下载此图片</span><br><span class="line">        .rightMenu-item#menu-newwindowimg</span><br><span class="line">            i.anzhiyufont.anzhiyu-icon-window-restore</span><br><span class="line">            span 新窗口打开图片</span><br><span class="line">        .rightMenu-item#menu-search</span><br><span class="line">            i.anzhiyufont.anzhiyu-icon-magnifying-glass</span><br><span class="line">            span 站内搜索</span><br><span class="line">        .rightMenu-item#menu-searchBaidu</span><br><span class="line">            i.anzhiyufont.anzhiyu-icon-magnifying-glass</span><br><span class="line">            span 百度搜索</span><br><span class="line">        - const nav_music_all_playlist = theme.nav_music.all_playlist</span><br><span class="line">        .rightMenu-item#menu-music-playlist(onclick=`window.open(&quot;$&#123;nav_music_all_playlist&#125;&quot;, &quot;_blank&quot;);`, style=&#x27;display: none;&#x27;)</span><br><span class="line">            i.anzhiyufont.anzhiyu-icon-radio</span><br><span class="line">            span 查看所有歌曲</span><br><span class="line">        .rightMenu-item#menu-music-copyMusicName</span><br><span class="line">            i.anzhiyufont.anzhiyu-icon-copy</span><br><span class="line">            span 复制歌名</span><br><span class="line">    .rightMenu-group.rightMenu-line.rightMenuOther</span><br><span class="line">        a.rightMenu-item.menu-link#menu-randomPost</span><br><span class="line">            i.anzhiyufont.anzhiyu-icon-shuffle</span><br><span class="line">            span 随便逛逛</span><br><span class="line">        a.rightMenu-item.menu-link(href=&#x27;/categories/&#x27;)</span><br><span class="line">            i.anzhiyufont.anzhiyu-icon-cube</span><br><span class="line">            span 博客分类</span><br><span class="line">        a.rightMenu-item.menu-link(href=&#x27;/tags/&#x27;)</span><br><span class="line">            i.anzhiyufont.anzhiyu-icon-tags</span><br><span class="line">            span 文章标签</span><br><span class="line">    .rightMenu-group.rightMenu-line.rightMenuOther</span><br><span class="line">        a.rightMenu-item#menu-copy(href=&#x27;javascript:void(0);&#x27;)</span><br><span class="line">            i.anzhiyufont.anzhiyu-icon-copy</span><br><span class="line">            span 复制地址</span><br><span class="line">        a.rightMenu-item#menu-commentBarrage(href=&#x27;javascript:void(0);&#x27;)</span><br><span class="line">            i.anzhiyufont.anzhiyu-icon-message</span><br><span class="line">            span.menu-commentBarrage-text 关闭热评</span><br><span class="line">        a.rightMenu-item#menu-darkmode(href=&#x27;javascript:void(0);&#x27;)</span><br><span class="line">            i.anzhiyufont.anzhiyu-icon-circle-half-stroke</span><br><span class="line">            span.menu-darkmode-text 深色模式</span><br><span class="line">        a.rightMenu-item#menu-translate(href=&#x27;javascript:void(0);&#x27;)</span><br><span class="line">            i.anzhiyufont.anzhiyu-icon-language</span><br><span class="line">            span=translate.rightMenuMsgDefault</span><br><span class="line">    .rightMenu-group.rightMenu-music.rightMenuPlayer </span><br><span class="line">        a.rightMenuMusic-item#menu-music-data</span><br><span class="line">            span#name</span><br><span class="line">            span#artist</span><br><span class="line">        a.rightMenuMusic-item#menu-music-volume</span><br><span class="line">            #menu-music-volume-down</span><br><span class="line">                i.iconfont.icon-volume-down</span><br><span class="line">            #volume-slider</span><br><span class="line">                #slider-rail</span><br><span class="line">                    #slider-process</span><br><span class="line">                    #slider-dot</span><br><span class="line">                        #slider-dot-handle</span><br><span class="line">            #menu-music-volume-up</span><br><span class="line">                i.iconfont.icon-volume-up</span><br><span class="line">        a.rightMenuMusic-item#menu-music-control</span><br><span class="line">            #menu-music-back</span><br><span class="line">                i.iconfont.icon-prev</span><br><span class="line">            #menu-music-toggle</span><br><span class="line">                i.iconfont.icon-play</span><br><span class="line">            #menu-music-forward</span><br><span class="line">                i.iconfont.icon-next</span><br><span class="line">#rightmenu-mask</span><br></pre></td></tr></table></figure><h2 id="修改菜单JS"><a href="#修改菜单JS" class="headerlink" title="修改菜单JS"></a>修改菜单JS</h2><p>修改<code>[Blogroot]\themes\anzhiyu\source\js\anzhiyu\right_click_menu.js</code>文件，整体替换为以下内容：</p><div class="note info flat"><p>修改中关闭了<code>关闭热评</code>的选项，若需要使用，请自行注释有关内容，具体为：<br><code>const $rightMenuCommentBarrage = document.querySelector(&quot;#menu-commentBarrage&quot;);</code><br><code>$rightMenuCommentBarrage.style.display = &quot;none&quot;;</code></p></div><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br><span class="line">484</span><br><span class="line">485</span><br><span class="line">486</span><br><span class="line">487</span><br><span class="line">488</span><br><span class="line">489</span><br><span class="line">490</span><br><span class="line">491</span><br><span class="line">492</span><br><span class="line">493</span><br><span class="line">494</span><br><span class="line">495</span><br><span class="line">496</span><br><span class="line">497</span><br><span class="line">498</span><br><span class="line">499</span><br><span class="line">500</span><br><span class="line">501</span><br><span class="line">502</span><br><span class="line">503</span><br><span class="line">504</span><br><span class="line">505</span><br><span class="line">506</span><br><span class="line">507</span><br><span class="line">508</span><br><span class="line">509</span><br><span class="line">510</span><br><span class="line">511</span><br><span class="line">512</span><br><span class="line">513</span><br><span class="line">514</span><br><span class="line">515</span><br><span class="line">516</span><br><span class="line">517</span><br><span class="line">518</span><br><span class="line">519</span><br><span class="line">520</span><br><span class="line">521</span><br><span class="line">522</span><br><span class="line">523</span><br><span class="line">524</span><br><span class="line">525</span><br><span class="line">526</span><br><span class="line">527</span><br><span class="line">528</span><br><span class="line">529</span><br><span class="line">530</span><br><span class="line">531</span><br><span class="line">532</span><br><span class="line">533</span><br><span class="line">534</span><br><span class="line">535</span><br><span class="line">536</span><br><span class="line">537</span><br><span class="line">538</span><br><span class="line">539</span><br><span class="line">540</span><br><span class="line">541</span><br><span class="line">542</span><br><span class="line">543</span><br><span class="line">544</span><br><span class="line">545</span><br><span class="line">546</span><br><span class="line">547</span><br><span class="line">548</span><br><span class="line">549</span><br><span class="line">550</span><br><span class="line">551</span><br><span class="line">552</span><br><span class="line">553</span><br><span class="line">554</span><br><span class="line">555</span><br><span class="line">556</span><br><span class="line">557</span><br><span class="line">558</span><br><span class="line">559</span><br><span class="line">560</span><br><span class="line">561</span><br><span class="line">562</span><br><span class="line">563</span><br><span class="line">564</span><br><span class="line">565</span><br><span class="line">566</span><br><span class="line">567</span><br><span class="line">568</span><br><span class="line">569</span><br><span class="line">570</span><br><span class="line">571</span><br><span class="line">572</span><br><span class="line">573</span><br><span class="line">574</span><br><span class="line">575</span><br><span class="line">576</span><br><span class="line">577</span><br><span class="line">578</span><br><span class="line">579</span><br><span class="line">580</span><br><span class="line">581</span><br><span class="line">582</span><br><span class="line">583</span><br><span class="line">584</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 初始化函数</span></span><br><span class="line">rm = &#123;&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">//禁止图片与超链接拖拽</span></span><br><span class="line"><span class="keyword">let</span> aElements = <span class="variable language_">document</span>.<span class="title function_">getElementsByTagName</span>(<span class="string">&quot;a&quot;</span>);</span><br><span class="line"><span class="keyword">for</span> (<span class="keyword">let</span> i = <span class="number">0</span>; i &lt; aElements.<span class="property">length</span>; i++) &#123;</span><br><span class="line">  aElements[i].<span class="title function_">setAttribute</span>(<span class="string">&quot;draggable&quot;</span>, <span class="string">&quot;false&quot;</span>);</span><br><span class="line">  <span class="keyword">let</span> imgElements = aElements[i].<span class="title function_">getElementsByTagName</span>(<span class="string">&quot;img&quot;</span>);</span><br><span class="line">  <span class="keyword">for</span> (<span class="keyword">let</span> j = <span class="number">0</span>; j &lt; imgElements.<span class="property">length</span>; j++) &#123;</span><br><span class="line">    imgElements[j].<span class="title function_">setAttribute</span>(<span class="string">&quot;draggable&quot;</span>, <span class="string">&quot;false&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 显示菜单</span></span><br><span class="line">rm.<span class="property">showRightMenu</span> = <span class="keyword">function</span> (<span class="params">isTrue, x = <span class="number">0</span>, y = <span class="number">0</span></span>) &#123;</span><br><span class="line">  <span class="comment">// console.info(x, y);</span></span><br><span class="line">  <span class="keyword">let</span> rightMenu = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;rightMenu&quot;</span>);</span><br><span class="line">  rightMenu.<span class="property">style</span>.<span class="property">top</span> = x + <span class="string">&quot;px&quot;</span>;</span><br><span class="line">  rightMenu.<span class="property">style</span>.<span class="property">left</span> = y + <span class="string">&quot;px&quot;</span>;</span><br><span class="line">  <span class="keyword">if</span> (isTrue) &#123;</span><br><span class="line">    rightMenu.<span class="property">style</span>.<span class="property">display</span> = <span class="string">&quot;block&quot;</span>;</span><br><span class="line">    <span class="title function_">stopMaskScroll</span>();</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    rightMenu.<span class="property">style</span>.<span class="property">display</span> = <span class="string">&quot;none&quot;</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  rm.<span class="title function_">updateMusicInfo</span>();</span><br><span class="line">  rm.<span class="title function_">updateVolumeSlider</span>();</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 隐藏菜单</span></span><br><span class="line">rm.<span class="property">hideRightMenu</span> = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">  rm.<span class="title function_">showRightMenu</span>(<span class="literal">false</span>);</span><br><span class="line">  <span class="keyword">let</span> rightMenuMask = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&quot;#rightmenu-mask&quot;</span>);</span><br><span class="line">  rightMenuMask.<span class="property">style</span>.<span class="property">display</span> = <span class="string">&quot;none&quot;</span>;</span><br><span class="line">  sliderDot.<span class="property">style</span>.<span class="property">transition</span> = <span class="string">&#x27;none&#x27;</span>;</span><br><span class="line">  sliderProcess.<span class="property">style</span>.<span class="property">transition</span> = <span class="string">&#x27;none&#x27;</span>;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 尺寸</span></span><br><span class="line"><span class="keyword">let</span> rmWidth = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;rightMenu&quot;</span>).<span class="property">offsetWidth</span>;</span><br><span class="line"><span class="keyword">let</span> rmHeight = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;rightMenu&quot;</span>).<span class="property">offsetHeight</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 重新定义尺寸</span></span><br><span class="line">rm.<span class="property">reloadrmSize</span> = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">  rightMenu.<span class="property">style</span>.<span class="property">visibility</span> = <span class="string">&quot;hidden&quot;</span>;</span><br><span class="line">  rightMenu.<span class="property">style</span>.<span class="property">display</span> = <span class="string">&quot;block&quot;</span>;</span><br><span class="line">  <span class="comment">// 获取宽度和高度</span></span><br><span class="line">  rmWidth = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;rightMenu&quot;</span>).<span class="property">offsetWidth</span>;</span><br><span class="line">  rmHeight = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;rightMenu&quot;</span>).<span class="property">offsetHeight</span>;</span><br><span class="line">  rightMenu.<span class="property">style</span>.<span class="property">visibility</span> = <span class="string">&quot;visible&quot;</span>;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 获取点击的href</span></span><br><span class="line"><span class="keyword">let</span> domhref = <span class="string">&quot;&quot;</span>;</span><br><span class="line"><span class="keyword">let</span> domImgSrc = <span class="string">&quot;&quot;</span>;</span><br><span class="line"><span class="keyword">let</span> globalEvent = <span class="literal">null</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> oncontextmenuFunction = <span class="keyword">function</span> (<span class="params">event</span>) &#123;</span><br><span class="line">  <span class="keyword">if</span> (<span class="variable language_">document</span>.<span class="property">body</span>.<span class="property">clientWidth</span> &gt; <span class="number">768</span>) &#123;</span><br><span class="line">    <span class="keyword">let</span> pageX = event.<span class="property">clientX</span> + <span class="number">10</span>; <span class="comment">//加10是为了防止显示时鼠标遮在菜单上</span></span><br><span class="line">    <span class="keyword">let</span> pageY = event.<span class="property">clientY</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//其他额外菜单</span></span><br><span class="line">    <span class="keyword">const</span> $rightMenuOther = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&quot;.rightMenuOther&quot;</span>);</span><br><span class="line">    <span class="keyword">const</span> $rightMenuPlugin = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&quot;.rightMenuPlugin&quot;</span>);</span><br><span class="line">    <span class="keyword">const</span> $rightMenuCopyText = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&quot;#menu-copytext&quot;</span>);</span><br><span class="line">    <span class="keyword">const</span> $rightMenuPasteText = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&quot;#menu-pastetext&quot;</span>);</span><br><span class="line">    <span class="keyword">const</span> $rightMenuCommentText = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&quot;#menu-commenttext&quot;</span>);</span><br><span class="line">    <span class="keyword">const</span> $rightMenuCommentBarrage = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&quot;#menu-commentBarrage&quot;</span>);</span><br><span class="line">    <span class="keyword">const</span> $rightMenuNewWindow = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&quot;#menu-newwindow&quot;</span>);</span><br><span class="line">    <span class="keyword">const</span> $rightMenuNewWindowImg = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&quot;#menu-newwindowimg&quot;</span>);</span><br><span class="line">    <span class="keyword">const</span> $rightMenuCopyLink = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&quot;#menu-copylink&quot;</span>);</span><br><span class="line">    <span class="keyword">const</span> $rightMenuCopyImg = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&quot;#menu-copyimg&quot;</span>);</span><br><span class="line">    <span class="keyword">const</span> $rightMenuDownloadImg = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&quot;#menu-downloadimg&quot;</span>);</span><br><span class="line">    <span class="keyword">const</span> $rightMenuSearch = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&quot;#menu-search&quot;</span>);</span><br><span class="line">    <span class="keyword">const</span> $rightMenuSearchBaidu = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&quot;#menu-searchBaidu&quot;</span>);</span><br><span class="line">    <span class="keyword">const</span> $rightMenuMusicPlayer = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&quot;#rightMenu &gt; div.rightMenu-group.rightMenu-music.rightMenuPlayer&quot;</span>);</span><br><span class="line">    <span class="keyword">const</span> $rightMenuMusicPlaylist = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&quot;#menu-music-playlist&quot;</span>);</span><br><span class="line">    <span class="keyword">const</span> $rightMenuMusicCopyMusicName = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&quot;#menu-music-copyMusicName&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> href = event.<span class="property">target</span>.<span class="property">href</span>;</span><br><span class="line">    <span class="keyword">let</span> imgsrc = event.<span class="property">target</span>.<span class="property">currentSrc</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 判断模式 扩展模式为有事件</span></span><br><span class="line">    <span class="keyword">let</span> pluginMode = <span class="literal">false</span>;</span><br><span class="line">    $rightMenuOther.<span class="property">style</span>.<span class="property">display</span> = <span class="string">&quot;block&quot;</span>;</span><br><span class="line">    $rightMenuCommentBarrage.<span class="property">style</span>.<span class="property">display</span> = <span class="string">&quot;none&quot;</span>;</span><br><span class="line">    globalEvent = event;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 检查是否需要复制 是否有选中文本</span></span><br><span class="line">    <span class="keyword">if</span> (selectTextNow &amp;&amp; <span class="variable language_">window</span>.<span class="title function_">getSelection</span>()) &#123;</span><br><span class="line">      pluginMode = <span class="literal">true</span>;</span><br><span class="line">      $rightMenuCopyText.<span class="property">style</span>.<span class="property">display</span> = <span class="string">&quot;block&quot;</span>;</span><br><span class="line">      $rightMenuCommentText.<span class="property">style</span>.<span class="property">display</span> = <span class="string">&quot;block&quot;</span>;</span><br><span class="line">      $rightMenuSearch.<span class="property">style</span>.<span class="property">display</span> = <span class="string">&quot;block&quot;</span>;</span><br><span class="line">      $rightMenuSearchBaidu.<span class="property">style</span>.<span class="property">display</span> = <span class="string">&quot;block&quot;</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      $rightMenuCopyText.<span class="property">style</span>.<span class="property">display</span> = <span class="string">&quot;none&quot;</span>;</span><br><span class="line">      $rightMenuCommentText.<span class="property">style</span>.<span class="property">display</span> = <span class="string">&quot;none&quot;</span>;</span><br><span class="line">      $rightMenuSearchBaidu.<span class="property">style</span>.<span class="property">display</span> = <span class="string">&quot;none&quot;</span>;</span><br><span class="line">      $rightMenuSearch.<span class="property">style</span>.<span class="property">display</span> = <span class="string">&quot;none&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//检查是否右键点击了链接a标签</span></span><br><span class="line">    <span class="keyword">if</span> (href) &#123;</span><br><span class="line">      pluginMode = <span class="literal">true</span>;</span><br><span class="line">      $rightMenuNewWindow.<span class="property">style</span>.<span class="property">display</span> = <span class="string">&quot;block&quot;</span>;</span><br><span class="line">      $rightMenuCopyLink.<span class="property">style</span>.<span class="property">display</span> = <span class="string">&quot;block&quot;</span>;</span><br><span class="line">      domhref = href;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      $rightMenuNewWindow.<span class="property">style</span>.<span class="property">display</span> = <span class="string">&quot;none&quot;</span>;</span><br><span class="line">      $rightMenuCopyLink.<span class="property">style</span>.<span class="property">display</span> = <span class="string">&quot;none&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//检查是否需要复制图片</span></span><br><span class="line">    <span class="keyword">if</span> (imgsrc) &#123;</span><br><span class="line">      pluginMode = <span class="literal">true</span>;</span><br><span class="line">      $rightMenuCopyImg.<span class="property">style</span>.<span class="property">display</span> = <span class="string">&quot;block&quot;</span>;</span><br><span class="line">      $rightMenuDownloadImg.<span class="property">style</span>.<span class="property">display</span> = <span class="string">&quot;block&quot;</span>;</span><br><span class="line">      $rightMenuNewWindowImg.<span class="property">style</span>.<span class="property">display</span> = <span class="string">&quot;block&quot;</span>;</span><br><span class="line">      <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;rightMenu&quot;</span>).<span class="property">style</span>.<span class="property">width</span> = <span class="string">&quot;12rem&quot;</span>;</span><br><span class="line">      domImgSrc = imgsrc;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      $rightMenuCopyImg.<span class="property">style</span>.<span class="property">display</span> = <span class="string">&quot;none&quot;</span>;</span><br><span class="line">      $rightMenuDownloadImg.<span class="property">style</span>.<span class="property">display</span> = <span class="string">&quot;none&quot;</span>;</span><br><span class="line">      $rightMenuNewWindowImg.<span class="property">style</span>.<span class="property">display</span> = <span class="string">&quot;none&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 判断是否为输入框</span></span><br><span class="line">    <span class="keyword">if</span> (event.<span class="property">target</span>.<span class="property">tagName</span>.<span class="title function_">toLowerCase</span>() === <span class="string">&quot;input&quot;</span> || event.<span class="property">target</span>.<span class="property">tagName</span>.<span class="title function_">toLowerCase</span>() === <span class="string">&quot;textarea&quot;</span>) &#123;</span><br><span class="line">      pluginMode = <span class="literal">true</span>;</span><br><span class="line">      $rightMenuPasteText.<span class="property">style</span>.<span class="property">display</span> = <span class="string">&quot;block&quot;</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      $rightMenuPasteText.<span class="property">style</span>.<span class="property">display</span> = <span class="string">&quot;none&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">const</span> navMusicEl = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&quot;#nav-music&quot;</span>);</span><br><span class="line">    <span class="comment">//判断是否是音乐</span></span><br><span class="line">    <span class="keyword">if</span> (navMusicEl &amp;&amp; navMusicEl.<span class="title function_">contains</span>(event.<span class="property">target</span>)) &#123;</span><br><span class="line">      pluginMode = <span class="literal">true</span>;</span><br><span class="line">      <span class="comment">// $rightMenuMusicToggle.style.display = &quot;block&quot;;</span></span><br><span class="line">      <span class="comment">// $rightMenuMusicBack.style.display = &quot;block&quot;;</span></span><br><span class="line">      <span class="comment">// $rightMenuMusicForward.style.display = &quot;block&quot;;</span></span><br><span class="line">      $rightMenuMusicPlaylist.<span class="property">style</span>.<span class="property">display</span> = <span class="string">&quot;block&quot;</span>;</span><br><span class="line">      $rightMenuMusicCopyMusicName.<span class="property">style</span>.<span class="property">display</span> = <span class="string">&quot;block&quot;</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="comment">// $rightMenuMusicToggle.style.display = &quot;none&quot;;</span></span><br><span class="line">      <span class="comment">// $rightMenuMusicBack.style.display = &quot;none&quot;;</span></span><br><span class="line">      <span class="comment">// $rightMenuMusicForward.style.display = &quot;none&quot;;</span></span><br><span class="line">      $rightMenuMusicPlaylist.<span class="property">style</span>.<span class="property">display</span> = <span class="string">&quot;none&quot;</span>;</span><br><span class="line">      $rightMenuMusicCopyMusicName.<span class="property">style</span>.<span class="property">display</span> = <span class="string">&quot;none&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 检查 `body` 是否具有 `data-type=&quot;music&quot;` 属性</span></span><br><span class="line">    <span class="keyword">let</span> bodyElement = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;body&#x27;</span>);</span><br><span class="line">    <span class="keyword">if</span> (bodyElement.<span class="title function_">getAttribute</span>(<span class="string">&#x27;data-type&#x27;</span>) === <span class="string">&#x27;music&#x27;</span>) &#123;</span><br><span class="line">      $rightMenuMusicPlayer.<span class="property">style</span>.<span class="property">display</span> = <span class="string">&quot;none&quot;</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      $rightMenuMusicPlayer.<span class="property">style</span>.<span class="property">display</span> = <span class="string">&quot;block&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 如果不是扩展模式则隐藏扩展模块</span></span><br><span class="line">    <span class="keyword">if</span> (pluginMode) &#123;</span><br><span class="line">      $rightMenuOther.<span class="property">style</span>.<span class="property">display</span> = <span class="string">&quot;none&quot;</span>;</span><br><span class="line">      $rightMenuPlugin.<span class="property">style</span>.<span class="property">display</span> = <span class="string">&quot;block&quot;</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      $rightMenuPlugin.<span class="property">style</span>.<span class="property">display</span> = <span class="string">&quot;none&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    rm.<span class="title function_">reloadrmSize</span>();</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 鼠标默认显示在鼠标右下方，当鼠标靠右或靠下时，将菜单显示在鼠标左方\上方</span></span><br><span class="line">    <span class="keyword">if</span> (pageX + rmWidth &gt; <span class="variable language_">window</span>.<span class="property">innerWidth</span>) &#123;</span><br><span class="line">      pageX -= rmWidth + <span class="number">10</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span> (pageY + rmHeight &gt; <span class="variable language_">window</span>.<span class="property">innerHeight</span>) &#123;</span><br><span class="line">      pageY -= pageY + rmHeight - <span class="variable language_">window</span>.<span class="property">innerHeight</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    rm.<span class="title function_">showRightMenu</span>(<span class="literal">true</span>, pageY, pageX);</span><br><span class="line">    <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;rightmenu-mask&quot;</span>).<span class="property">style</span>.<span class="property">display</span> = <span class="string">&quot;flex&quot;</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 监听右键初始化</span></span><br><span class="line"><span class="variable language_">window</span>.<span class="property">oncontextmenu</span> = oncontextmenuFunction;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 下载图片状态</span></span><br><span class="line">rm.<span class="property">downloadimging</span> = <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 复制图片到剪贴板</span></span><br><span class="line">rm.<span class="property">writeClipImg</span> = <span class="keyword">function</span> (<span class="params">imgsrc</span>) &#123;</span><br><span class="line">  <span class="comment">// console.log(&quot;按下复制&quot;);</span></span><br><span class="line">  rm.<span class="title function_">hideRightMenu</span>();</span><br><span class="line">  anzhiyu.<span class="title function_">snackbarShow</span>(<span class="string">&quot;正在下载中，请稍后&quot;</span>, <span class="literal">false</span>, <span class="number">10000</span>);</span><br><span class="line">  <span class="keyword">if</span> (rm.<span class="property">downloadimging</span> == <span class="literal">false</span>) &#123;</span><br><span class="line">    rm.<span class="property">downloadimging</span> = <span class="literal">true</span>;</span><br><span class="line">    <span class="built_in">setTimeout</span>(<span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">      <span class="title function_">copyImage</span>(imgsrc);</span><br><span class="line">      anzhiyu.<span class="title function_">snackbarShow</span>(<span class="string">&quot;复制成功！图片已添加盲水印，请遵守版权协议&quot;</span>);</span><br><span class="line">      rm.<span class="property">downloadimging</span> = <span class="literal">false</span>;</span><br><span class="line">    &#125;, <span class="string">&quot;10000&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">imageToBlob</span>(<span class="params">imageURL</span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> img = <span class="keyword">new</span> <span class="title class_">Image</span>();</span><br><span class="line">  <span class="keyword">const</span> c = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&quot;canvas&quot;</span>);</span><br><span class="line">  <span class="keyword">const</span> ctx = c.<span class="title function_">getContext</span>(<span class="string">&quot;2d&quot;</span>);</span><br><span class="line">  img.<span class="property">crossOrigin</span> = <span class="string">&quot;&quot;</span>;</span><br><span class="line">  img.<span class="property">src</span> = imageURL;</span><br><span class="line">  <span class="keyword">return</span> <span class="keyword">new</span> <span class="title class_">Promise</span>(<span class="function"><span class="params">resolve</span> =&gt;</span> &#123;</span><br><span class="line">    img.<span class="property">onload</span> = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">      c.<span class="property">width</span> = <span class="variable language_">this</span>.<span class="property">naturalWidth</span>;</span><br><span class="line">      c.<span class="property">height</span> = <span class="variable language_">this</span>.<span class="property">naturalHeight</span>;</span><br><span class="line">      ctx.<span class="title function_">drawImage</span>(<span class="variable language_">this</span>, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">      c.<span class="title function_">toBlob</span>(</span><br><span class="line">        <span class="function"><span class="params">blob</span> =&gt;</span> &#123;</span><br><span class="line">          <span class="comment">// here the image is a blob</span></span><br><span class="line">          <span class="title function_">resolve</span>(blob);</span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="string">&quot;image/png&quot;</span>,</span><br><span class="line">        <span class="number">0.75</span></span><br><span class="line">      );</span><br><span class="line">    &#125;;</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">copyImage</span>(<span class="params">imageURL</span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> blob = <span class="keyword">await</span> <span class="title function_">imageToBlob</span>(imageURL);</span><br><span class="line">  <span class="keyword">const</span> item = <span class="keyword">new</span> <span class="title class_">ClipboardItem</span>(&#123; <span class="string">&quot;image/png&quot;</span>: blob &#125;);</span><br><span class="line">  navigator.<span class="property">clipboard</span>.<span class="title function_">write</span>([item]);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">rm.<span class="property">copyUrl</span> = <span class="keyword">function</span> (<span class="params">id</span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> input = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&quot;input&quot;</span>); <span class="comment">// Create a new &lt;input&gt; element</span></span><br><span class="line">  input.<span class="property">id</span> = <span class="string">&quot;copyVal&quot;</span>; <span class="comment">// Set the id of the new element to &quot;copyVal&quot;</span></span><br><span class="line">  <span class="variable language_">document</span>.<span class="property">body</span>.<span class="title function_">appendChild</span>(input); <span class="comment">// Append the new element to the end of the &lt;body&gt; element</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> text = id;</span><br><span class="line">  input.<span class="property">value</span> = text;</span><br><span class="line">  input.<span class="title function_">select</span>();</span><br><span class="line">  input.<span class="title function_">setSelectionRange</span>(<span class="number">0</span>, input.<span class="property">value</span>.<span class="property">length</span>);</span><br><span class="line">  <span class="variable language_">document</span>.<span class="title function_">execCommand</span>(<span class="string">&quot;copy&quot;</span>);</span><br><span class="line"></span><br><span class="line">  input.<span class="title function_">remove</span>(); <span class="comment">// Remove the &lt;input&gt; element from the DOM</span></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">stopMaskScroll</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">if</span> (<span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;rightmenu-mask&quot;</span>)) &#123;</span><br><span class="line">    <span class="keyword">let</span> xscroll = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;rightmenu-mask&quot;</span>);</span><br><span class="line">    xscroll.<span class="title function_">addEventListener</span>(</span><br><span class="line">      <span class="string">&quot;mousewheel&quot;</span>,</span><br><span class="line">      <span class="keyword">function</span> (<span class="params">e</span>) &#123;</span><br><span class="line">        <span class="comment">//阻止浏览器默认方法</span></span><br><span class="line">        rm.<span class="title function_">hideRightMenu</span>();</span><br><span class="line">        <span class="comment">// e.preventDefault();</span></span><br><span class="line">      &#125;,</span><br><span class="line">      &#123; <span class="attr">passive</span>: <span class="literal">true</span> &#125;</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> (<span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;rightMenu&quot;</span>)) &#123;</span><br><span class="line">    <span class="keyword">let</span> xscroll = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;rightMenu&quot;</span>);</span><br><span class="line">    xscroll.<span class="title function_">addEventListener</span>(</span><br><span class="line">      <span class="string">&quot;mousewheel&quot;</span>,</span><br><span class="line">      <span class="keyword">function</span> (<span class="params">e</span>) &#123;</span><br><span class="line">        <span class="comment">//阻止浏览器默认方法</span></span><br><span class="line">        rm.<span class="title function_">hideRightMenu</span>();</span><br><span class="line">        <span class="comment">// e.preventDefault();</span></span><br><span class="line">      &#125;,</span><br><span class="line">      &#123; <span class="attr">passive</span>: <span class="literal">true</span> &#125;</span><br><span class="line">    );</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">rm.<span class="property">rightmenuCopyText</span> = <span class="keyword">function</span> (<span class="params">txt</span>) &#123;</span><br><span class="line">  <span class="keyword">if</span> (navigator.<span class="property">clipboard</span>) &#123;</span><br><span class="line">    navigator.<span class="property">clipboard</span>.<span class="title function_">writeText</span>(txt);</span><br><span class="line">  &#125;</span><br><span class="line">  rm.<span class="title function_">hideRightMenu</span>();</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">rm.<span class="property">copyPageUrl</span> = <span class="keyword">function</span> (<span class="params">url</span>) &#123;</span><br><span class="line">  <span class="keyword">if</span> (!url) &#123;</span><br><span class="line">    url = <span class="variable language_">window</span>.<span class="property">location</span>.<span class="property">href</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  rm.<span class="title function_">copyUrl</span>(url);</span><br><span class="line">  anzhiyu.<span class="title function_">snackbarShow</span>(<span class="string">&quot;复制链接地址成功&quot;</span>, <span class="literal">false</span>, <span class="number">2000</span>);</span><br><span class="line">  rm.<span class="title function_">hideRightMenu</span>();</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 复制当前选中文本</span></span><br><span class="line"><span class="keyword">var</span> selectTextNow = <span class="string">&quot;&quot;</span>;</span><br><span class="line"><span class="variable language_">document</span>.<span class="property">onmouseup</span> = <span class="variable language_">document</span>.<span class="property">ondblclick</span> = selceText;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">selceText</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">var</span> txt;</span><br><span class="line">  <span class="keyword">if</span> (<span class="variable language_">document</span>.<span class="property">selection</span>) &#123;</span><br><span class="line">    txt = <span class="variable language_">document</span>.<span class="property">selection</span>.<span class="title function_">createRange</span>().<span class="property">text</span>;</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    txt = <span class="variable language_">window</span>.<span class="title function_">getSelection</span>().<span class="title function_">toString</span>();</span><br><span class="line">  &#125;</span><br><span class="line">  selectTextNow = txt !== <span class="string">&quot;&quot;</span> ? txt : <span class="string">&quot;&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 读取剪切板</span></span><br><span class="line">rm.<span class="property">readClipboard</span> = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">if</span> (navigator.<span class="property">clipboard</span>) &#123;</span><br><span class="line">    navigator.<span class="property">clipboard</span>.<span class="title function_">readText</span>().<span class="title function_">then</span>(<span class="function"><span class="params">clipText</span> =&gt;</span> rm.<span class="title function_">insertAtCaret</span>(globalEvent.<span class="property">target</span>, clipText));</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 粘贴文本到焦点</span></span><br><span class="line">rm.<span class="property">insertAtCaret</span> = <span class="keyword">function</span> (<span class="params">elemt, value</span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> startPos = elemt.<span class="property">selectionStart</span>,</span><br><span class="line">    endPos = elemt.<span class="property">selectionEnd</span>;</span><br><span class="line">  <span class="keyword">if</span> (<span class="variable language_">document</span>.<span class="property">selection</span>) &#123;</span><br><span class="line">    elemt.<span class="title function_">focus</span>();</span><br><span class="line">    <span class="keyword">var</span> sel = <span class="variable language_">document</span>.<span class="property">selection</span>.<span class="title function_">createRange</span>();</span><br><span class="line">    sel.<span class="property">text</span> = value;</span><br><span class="line">    elemt.<span class="title function_">focus</span>();</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (startPos || startPos == <span class="string">&quot;0&quot;</span>) &#123;</span><br><span class="line">      <span class="keyword">var</span> scrollTop = elemt.<span class="property">scrollTop</span>;</span><br><span class="line">      elemt.<span class="property">value</span> = elemt.<span class="property">value</span>.<span class="title function_">substring</span>(<span class="number">0</span>, startPos) + value + elemt.<span class="property">value</span>.<span class="title function_">substring</span>(endPos, elemt.<span class="property">value</span>.<span class="property">length</span>);</span><br><span class="line">      elemt.<span class="title function_">focus</span>();</span><br><span class="line">      elemt.<span class="property">selectionStart</span> = startPos + value.<span class="property">length</span>;</span><br><span class="line">      elemt.<span class="property">selectionEnd</span> = startPos + value.<span class="property">length</span>;</span><br><span class="line">      elemt.<span class="property">scrollTop</span> = scrollTop;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      elemt.<span class="property">value</span> += value;</span><br><span class="line">      elemt.<span class="title function_">focus</span>();</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">//粘贴文本</span></span><br><span class="line">rm.<span class="property">pasteText</span> = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> result = rm.<span class="title function_">readClipboard</span>() || <span class="string">&quot;&quot;</span>;</span><br><span class="line">  rm.<span class="title function_">hideRightMenu</span>();</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">//引用到评论</span></span><br><span class="line">rm.<span class="property">rightMenuCommentText</span> = <span class="keyword">function</span> (<span class="params">txt</span>) &#123;</span><br><span class="line">  rm.<span class="title function_">hideRightMenu</span>();</span><br><span class="line">  <span class="keyword">const</span> postCommentDom = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;post-comment&quot;</span>);</span><br><span class="line">  <span class="keyword">var</span> domTop = postCommentDom.<span class="property">offsetTop</span>;</span><br><span class="line">  <span class="variable language_">window</span>.<span class="title function_">scrollTo</span>(<span class="number">0</span>, domTop - <span class="number">80</span>);</span><br><span class="line">  <span class="keyword">if</span> (txt == <span class="string">&quot;undefined&quot;</span> || txt == <span class="string">&quot;null&quot;</span>) txt = <span class="string">&quot;好棒！&quot;</span>;</span><br><span class="line">  <span class="keyword">function</span> <span class="title function_">setText</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">var</span> input = <span class="variable language_">document</span>.<span class="title function_">getElementsByClassName</span>(<span class="string">&quot;el-textarea__inner&quot;</span>)[<span class="number">0</span>];</span><br><span class="line">      <span class="keyword">if</span> (!input) <span class="title function_">setText</span>();</span><br><span class="line">      <span class="keyword">let</span> evt = <span class="variable language_">document</span>.<span class="title function_">createEvent</span>(<span class="string">&quot;HTMLEvents&quot;</span>);</span><br><span class="line">      evt.<span class="title function_">initEvent</span>(<span class="string">&quot;input&quot;</span>, <span class="literal">true</span>, <span class="literal">true</span>);</span><br><span class="line">      <span class="keyword">let</span> inputValue = <span class="title function_">replaceAll</span>(txt, <span class="string">&quot;\n&quot;</span>, <span class="string">&quot;\n&gt; &quot;</span>);</span><br><span class="line">      input.<span class="property">value</span> = <span class="string">&quot;&gt; &quot;</span> + inputValue + <span class="string">&quot;\n\n&quot;</span>;</span><br><span class="line">      input.<span class="title function_">dispatchEvent</span>(evt);</span><br><span class="line">      input.<span class="title function_">focus</span>();</span><br><span class="line">      input.<span class="title function_">setSelectionRange</span>(-<span class="number">1</span>, -<span class="number">1</span>);</span><br><span class="line">      <span class="keyword">if</span> (<span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;comment-tips&quot;</span>)) &#123;</span><br><span class="line">        <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;comment-tips&quot;</span>).<span class="property">classList</span>.<span class="title function_">add</span>(<span class="string">&quot;show&quot;</span>);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;, <span class="number">100</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="title function_">setText</span>();</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">//替换所有内容</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">replaceAll</span>(<span class="params">string, search, replace</span>) &#123;</span><br><span class="line">  <span class="keyword">return</span> string.<span class="title function_">split</span>(search).<span class="title function_">join</span>(replace);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 百度搜索</span></span><br><span class="line">rm.<span class="property">searchBaidu</span> = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">  anzhiyu.<span class="title function_">snackbarShow</span>(<span class="string">&quot;即将跳转到百度搜索&quot;</span>, <span class="literal">false</span>, <span class="number">2000</span>);</span><br><span class="line">  <span class="built_in">setTimeout</span>(<span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">window</span>.<span class="title function_">open</span>(<span class="string">&quot;https://www.baidu.com/s?wd=&quot;</span> + selectTextNow);</span><br><span class="line">  &#125;, <span class="string">&quot;2000&quot;</span>);</span><br><span class="line">  rm.<span class="title function_">hideRightMenu</span>();</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">//分享链接</span></span><br><span class="line">rm.<span class="property">copyLink</span> = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">  rm.<span class="title function_">rightmenuCopyText</span>(domhref);</span><br><span class="line">  anzhiyu.<span class="title function_">snackbarShow</span>(<span class="string">&quot;已复制链接地址&quot;</span>);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">rm.<span class="property">updateMusicInfo</span> = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">  <span class="comment">// 获取名称和作者的 span 元素</span></span><br><span class="line">  <span class="keyword">const</span> nameSpan = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&quot;#name&quot;</span>);</span><br><span class="line">  <span class="keyword">const</span> artistSpan = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&quot;#artist&quot;</span>);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (!nameSpan || !artistSpan) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">error</span>(<span class="string">&quot;未找到歌曲名称和作者&quot;</span>);</span><br><span class="line">    <span class="keyword">return</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 获取当前播放的歌曲信息</span></span><br><span class="line">  <span class="keyword">const</span> name = anzhiyu.<span class="title function_">musicGetName</span>();</span><br><span class="line">  <span class="keyword">const</span> artist = anzhiyu.<span class="title function_">musicGetauthor</span>();</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 将歌曲名称和作者写入到 span 元素</span></span><br><span class="line">  nameSpan.<span class="property">textContent</span> = name || <span class="string">&#x27;Unknown&#x27;</span>; <span class="comment">// 显示歌曲名称，默认&quot;Unknown&quot;</span></span><br><span class="line">  artistSpan.<span class="property">textContent</span> = artist || <span class="string">&#x27;Unknown&#x27;</span>; <span class="comment">// 显示作者名称，默认&quot;Unknown&quot;</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> volumeSlider = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;volume-slider&quot;</span>);</span><br><span class="line"><span class="keyword">const</span> sliderRail = volumeSlider.<span class="title function_">querySelector</span>(<span class="string">&#x27;#slider-rail&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> sliderProcess = volumeSlider.<span class="title function_">querySelector</span>(<span class="string">&#x27;#slider-process&#x27;</span>);</span><br><span class="line"><span class="keyword">const</span> sliderDot = volumeSlider.<span class="title function_">querySelector</span>(<span class="string">&#x27;#slider-dot&#x27;</span>);</span><br><span class="line"></span><br><span class="line">rm.<span class="property">updateVolumeSlider</span> = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">  <span class="comment">// 获取相关元素</span></span><br><span class="line">  <span class="keyword">const</span> volume = navMusicEl.<span class="title function_">querySelector</span>(<span class="string">&quot;meting-js&quot;</span>).<span class="property">aplayer</span>.<span class="title function_">volume</span>();</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 确保音量在 0 到 1 之间</span></span><br><span class="line">  <span class="keyword">const</span> validVolume = <span class="title class_">Math</span>.<span class="title function_">min</span>(<span class="title class_">Math</span>.<span class="title function_">max</span>(volume, <span class="number">0</span>), <span class="number">1</span>);</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 计算滑块的位置</span></span><br><span class="line">  <span class="keyword">const</span> railRect = sliderRail.<span class="title function_">getBoundingClientRect</span>();</span><br><span class="line">  <span class="keyword">const</span> dotWidth = sliderDot.<span class="property">clientWidth</span>;</span><br><span class="line">  <span class="keyword">const</span> sliderWidth = railRect.<span class="property">width</span>;</span><br><span class="line"></span><br><span class="line">  <span class="comment">// 更新滑块的位置和进度条的宽度</span></span><br><span class="line">  sliderProcess.<span class="property">style</span>.<span class="property">width</span> = <span class="string">`<span class="subst">$&#123;validVolume * <span class="number">100</span>&#125;</span>%`</span>;</span><br><span class="line">  <span class="comment">// sliderDot.style.left = `$&#123;validVolume * 100&#125;%`;</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">// 计算滑块的位置，使其不会超出滑条边界</span></span><br><span class="line">  <span class="keyword">const</span> dotPosition = validVolume * sliderWidth;</span><br><span class="line">  <span class="keyword">const</span> limitedPosition = <span class="title class_">Math</span>.<span class="title function_">min</span>(<span class="title class_">Math</span>.<span class="title function_">max</span>(dotPosition - dotWidth / <span class="number">2</span>, <span class="number">3</span>), <span class="number">82</span>);</span><br><span class="line">  sliderDot.<span class="property">style</span>.<span class="property">left</span> = <span class="string">`<span class="subst">$&#123;limitedPosition&#125;</span>px`</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">initializeSliderEvents</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">let</span> isDragging = <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">function</span> <span class="title function_">handleSliderMove</span>(<span class="params">event</span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> railRect = sliderRail.<span class="title function_">getBoundingClientRect</span>();</span><br><span class="line">    <span class="keyword">const</span> position = event.<span class="property">clientX</span>;</span><br><span class="line">    <span class="keyword">const</span> volume = <span class="title class_">Math</span>.<span class="title function_">min</span>(<span class="title class_">Math</span>.<span class="title function_">max</span>((position - railRect.<span class="property">left</span>) / railRect.<span class="property">width</span>, <span class="number">0</span>), <span class="number">1</span>);</span><br><span class="line">    </span><br><span class="line">    navMusicEl.<span class="title function_">querySelector</span>(<span class="string">&quot;meting-js&quot;</span>).<span class="property">aplayer</span>.<span class="title function_">volume</span>(volume);</span><br><span class="line">    rm.<span class="title function_">updateVolumeSlider</span>();</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  sliderRail.<span class="title function_">addEventListener</span>(<span class="string">&#x27;click&#x27;</span>, <span class="keyword">function</span> (<span class="params">event</span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (!isDragging) &#123;</span><br><span class="line">      sliderDot.<span class="property">style</span>.<span class="property">transition</span> = <span class="string">&#x27;left 0.3s&#x27;</span>;</span><br><span class="line">      sliderProcess.<span class="property">style</span>.<span class="property">transition</span> = <span class="string">&#x27;width 0.3s&#x27;</span>;</span><br><span class="line">      <span class="title function_">handleSliderMove</span>(event);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  sliderDot.<span class="title function_">addEventListener</span>(<span class="string">&#x27;mousedown&#x27;</span>, <span class="keyword">function</span> (<span class="params">event</span>) &#123;</span><br><span class="line">    isDragging = <span class="literal">true</span>;</span><br><span class="line">    sliderDot.<span class="property">style</span>.<span class="property">transition</span> = <span class="string">&#x27;none&#x27;</span>;</span><br><span class="line">    sliderProcess.<span class="property">style</span>.<span class="property">transition</span> = <span class="string">&#x27;none&#x27;</span>;</span><br><span class="line">    event.<span class="title function_">preventDefault</span>();</span><br><span class="line"></span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">onMouseMove</span>(<span class="params">event</span>) &#123;</span><br><span class="line">      <span class="title function_">handleSliderMove</span>(event);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">function</span> <span class="title function_">onMouseUp</span>(<span class="params"></span>) &#123;</span><br><span class="line">      isDragging = <span class="literal">false</span>;</span><br><span class="line">      <span class="variable language_">document</span>.<span class="title function_">removeEventListener</span>(<span class="string">&#x27;mousemove&#x27;</span>, onMouseMove);</span><br><span class="line">      <span class="variable language_">document</span>.<span class="title function_">removeEventListener</span>(<span class="string">&#x27;mouseup&#x27;</span>, onMouseUp);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="variable language_">document</span>.<span class="title function_">addEventListener</span>(<span class="string">&#x27;mousemove&#x27;</span>, onMouseMove);</span><br><span class="line">    <span class="variable language_">document</span>.<span class="title function_">addEventListener</span>(<span class="string">&#x27;mouseup&#x27;</span>, onMouseUp);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">addRightMenuClickEvent</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="comment">// 添加点击事件</span></span><br><span class="line">  <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;menu-backward&quot;</span>).<span class="title function_">addEventListener</span>(<span class="string">&quot;click&quot;</span>, <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">window</span>.<span class="property">history</span>.<span class="title function_">back</span>();</span><br><span class="line">    rm.<span class="title function_">hideRightMenu</span>();</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;menu-forward&quot;</span>).<span class="title function_">addEventListener</span>(<span class="string">&quot;click&quot;</span>, <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">window</span>.<span class="property">history</span>.<span class="title function_">forward</span>();</span><br><span class="line">    rm.<span class="title function_">hideRightMenu</span>();</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;menu-refresh&quot;</span>).<span class="title function_">addEventListener</span>(<span class="string">&quot;click&quot;</span>, <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">window</span>.<span class="property">location</span>.<span class="title function_">reload</span>();</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;menu-top&quot;</span>).<span class="title function_">addEventListener</span>(<span class="string">&quot;click&quot;</span>, <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    anzhiyu.<span class="title function_">scrollToDest</span>(<span class="number">0</span>, <span class="number">500</span>);</span><br><span class="line">    rm.<span class="title function_">hideRightMenu</span>();</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;menu-translate&quot;</span>).<span class="title function_">addEventListener</span>(<span class="string">&quot;click&quot;</span>, <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">window</span>.<span class="property">translateFn</span>.<span class="title function_">translatePage</span>();</span><br><span class="line">    rm.<span class="title function_">hideRightMenu</span>();</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> menuLinks = <span class="variable language_">document</span>.<span class="title function_">querySelectorAll</span>(<span class="string">&quot;.menu-link&quot;</span>);</span><br><span class="line">  menuLinks.<span class="title function_">forEach</span>(<span class="keyword">function</span> (<span class="params">link</span>) &#123;</span><br><span class="line">    link.<span class="title function_">addEventListener</span>(<span class="string">&quot;click&quot;</span>, rm.<span class="property">hideRightMenu</span>);</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;menu-home&quot;</span>) &amp;&amp;</span><br><span class="line">    <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;menu-home&quot;</span>).<span class="title function_">addEventListener</span>(<span class="string">&quot;click&quot;</span>, <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">      <span class="variable language_">window</span>.<span class="property">location</span>.<span class="property">href</span> = <span class="variable language_">window</span>.<span class="property">location</span>.<span class="property">origin</span>;</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;menu-randomPost&quot;</span>).<span class="title function_">addEventListener</span>(<span class="string">&quot;click&quot;</span>, <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="title function_">toRandomPost</span>();</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;menu-commentBarrage&quot;</span>).<span class="title function_">addEventListener</span>(<span class="string">&quot;click&quot;</span>, anzhiyu.<span class="property">switchCommentBarrage</span>);</span><br><span class="line"></span><br><span class="line">  <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;rightmenu-mask&quot;</span>).<span class="title function_">addEventListener</span>(<span class="string">&quot;click&quot;</span>, rm.<span class="property">hideRightMenu</span>);</span><br><span class="line"></span><br><span class="line">  <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;rightmenu-mask&quot;</span>).<span class="title function_">addEventListener</span>(<span class="string">&quot;contextmenu&quot;</span>, <span class="keyword">function</span> (<span class="params">event</span>) &#123;</span><br><span class="line">    rm.<span class="title function_">hideRightMenu</span>();</span><br><span class="line">    event.<span class="title function_">preventDefault</span>(); <span class="comment">// Prevent the default context menu from appearing</span></span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;menu-copy&quot;</span>).<span class="title function_">addEventListener</span>(<span class="string">&quot;click&quot;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    rm.<span class="title function_">copyPageUrl</span>();</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;menu-pastetext&quot;</span>).<span class="title function_">addEventListener</span>(<span class="string">&quot;click&quot;</span>, rm.<span class="property">pasteText</span>);</span><br><span class="line"></span><br><span class="line">  <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;menu-copytext&quot;</span>).<span class="title function_">addEventListener</span>(<span class="string">&quot;click&quot;</span>, <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    rm.<span class="title function_">rightmenuCopyText</span>(selectTextNow);</span><br><span class="line">    <span class="keyword">const</span> copyright = <span class="variable constant_">GLOBAL_CONFIG</span>.<span class="property">copyright</span>;</span><br><span class="line">    <span class="keyword">if</span> (copyright.<span class="property">copy</span>) &#123;</span><br><span class="line">      anzhiyu.<span class="title function_">snackbarShow</span>(copyright.<span class="property">languages</span>.<span class="property">copySuccess</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;menu-commenttext&quot;</span>).<span class="title function_">addEventListener</span>(<span class="string">&quot;click&quot;</span>, <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    rm.<span class="title function_">rightMenuCommentText</span>(selectTextNow);</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;menu-newwindow&quot;</span>).<span class="title function_">addEventListener</span>(<span class="string">&quot;click&quot;</span>, <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">window</span>.<span class="title function_">open</span>(domhref, <span class="string">&quot;_blank&quot;</span>);</span><br><span class="line">    rm.<span class="title function_">hideRightMenu</span>();</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;menu-copylink&quot;</span>).<span class="title function_">addEventListener</span>(<span class="string">&quot;click&quot;</span>, rm.<span class="property">copyLink</span>);</span><br><span class="line"></span><br><span class="line">  <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;menu-downloadimg&quot;</span>).<span class="title function_">addEventListener</span>(<span class="string">&quot;click&quot;</span>, <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    anzhiyu.<span class="title function_">downloadImage</span>(domImgSrc, <span class="string">&quot;anzhiyu&quot;</span>);</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;menu-newwindowimg&quot;</span>).<span class="title function_">addEventListener</span>(<span class="string">&quot;click&quot;</span>, <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">window</span>.<span class="title function_">open</span>(domImgSrc, <span class="string">&quot;_blank&quot;</span>);</span><br><span class="line">    rm.<span class="title function_">hideRightMenu</span>();</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;menu-copyimg&quot;</span>).<span class="title function_">addEventListener</span>(<span class="string">&quot;click&quot;</span>, <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    rm.<span class="title function_">writeClipImg</span>(domImgSrc);</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;menu-searchBaidu&quot;</span>).<span class="title function_">addEventListener</span>(<span class="string">&quot;click&quot;</span>, rm.<span class="property">searchBaidu</span>);</span><br><span class="line"></span><br><span class="line">  <span class="comment">//音乐</span></span><br><span class="line">  <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;menu-music-volume-up&quot;</span>).<span class="title function_">addEventListener</span>(<span class="string">&quot;click&quot;</span>, anzhiyu.<span class="property">musicVolumeUp</span>);</span><br><span class="line"></span><br><span class="line">  <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;menu-music-volume-down&quot;</span>).<span class="title function_">addEventListener</span>(<span class="string">&quot;click&quot;</span>, anzhiyu.<span class="property">musicVolumeDown</span>);</span><br><span class="line"></span><br><span class="line">  <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;menu-music-toggle&quot;</span>).<span class="title function_">addEventListener</span>(<span class="string">&quot;click&quot;</span>, anzhiyu.<span class="property">musicToggle</span>);</span><br><span class="line"></span><br><span class="line">  <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;menu-music-back&quot;</span>).<span class="title function_">addEventListener</span>(<span class="string">&quot;click&quot;</span>, anzhiyu.<span class="property">musicSkipBack</span>);</span><br><span class="line"></span><br><span class="line">  <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;menu-music-forward&quot;</span>).<span class="title function_">addEventListener</span>(<span class="string">&quot;click&quot;</span>, anzhiyu.<span class="property">musicSkipForward</span>);</span><br><span class="line"></span><br><span class="line">  <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;menu-music-copyMusicName&quot;</span>).<span class="title function_">addEventListener</span>(<span class="string">&quot;click&quot;</span>, <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    rm.<span class="title function_">rightmenuCopyText</span>(anzhiyu.<span class="title function_">musicGetName</span>());</span><br><span class="line">    anzhiyu.<span class="title function_">snackbarShow</span>(<span class="string">&quot;复制歌曲名称成功&quot;</span>, <span class="literal">false</span>, <span class="number">3000</span>);</span><br><span class="line">  &#125;);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">addRightMenuClickEvent</span>();</span><br><span class="line"><span class="title function_">initializeSliderEvents</span>();</span><br><span class="line"></span><br></pre></td></tr></table></figure><h2 id="修改主题JS"><a href="#修改主题JS" class="headerlink" title="修改主题JS"></a>修改主题JS</h2><p>修改<code>[Blogroot]\themes\anzhiyu\source\js\utils.js</code>文件：</p><figure class="highlight diff"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br></pre></td><td class="code"><pre><span class="line">  //切换音乐播放状态</span><br><span class="line">  musicToggle: function (changePaly = true) &#123;</span><br><span class="line">    if (!anzhiyu_musicFirst) &#123;</span><br><span class="line">      anzhiyu.musicBindEvent();</span><br><span class="line">      anzhiyu_musicFirst = true;</span><br><span class="line">    &#125;</span><br><span class="line">    let msgPlay = &#x27;&lt;i class=&quot;anzhiyufont anzhiyu-icon-play&quot;&gt;&lt;/i&gt;&lt;span&gt;播放音乐&lt;/span&gt;&#x27;;</span><br><span class="line">    let msgPause = &#x27;&lt;i class=&quot;anzhiyufont anzhiyu-icon-pause&quot;&gt;&lt;/i&gt;&lt;span&gt;暂停音乐&lt;/span&gt;&#x27;;</span><br><span class="line">    if (anzhiyu_musicPlaying) &#123;</span><br><span class="line">      navMusicEl.classList.remove(&quot;playing&quot;);</span><br><span class="line"><span class="deletion">-     document.getElementById(&quot;menu-music-toggle&quot;).innerHTML = msgPlay;</span></span><br><span class="line">      document.getElementById(&quot;nav-music-hoverTips&quot;).innerHTML = &quot;音乐已暂停&quot;;</span><br><span class="line">      document.querySelector(&quot;#consoleMusic&quot;).classList.remove(&quot;on&quot;);</span><br><span class="line">      anzhiyu_musicPlaying = false;</span><br><span class="line">      navMusicEl.classList.remove(&quot;stretch&quot;);</span><br><span class="line">    &#125; else &#123;</span><br><span class="line">      navMusicEl.classList.add(&quot;playing&quot;);</span><br><span class="line"><span class="deletion">-     document.getElementById(&quot;menu-music-toggle&quot;).innerHTML = msgPause;</span></span><br><span class="line">      document.querySelector(&quot;#consoleMusic&quot;).classList.add(&quot;on&quot;);</span><br><span class="line">      anzhiyu_musicPlaying = true;</span><br><span class="line">      navMusicEl.classList.add(&quot;stretch&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">    if (changePaly) document.querySelector(&quot;#nav-music meting-js&quot;).aplayer.toggle();</span><br><span class="line"><span class="deletion">-   rm &amp;&amp; rm.hideRightMenu();</span></span><br><span class="line">  &#125;,</span><br><span class="line">  // 音乐伸缩</span><br><span class="line">  musicTelescopic: function () &#123;</span><br><span class="line">    if (navMusicEl.classList.contains(&quot;stretch&quot;)) &#123;</span><br><span class="line">      navMusicEl.classList.remove(&quot;stretch&quot;);</span><br><span class="line">    &#125; else &#123;</span><br><span class="line">      navMusicEl.classList.add(&quot;stretch&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  //音乐上一曲</span><br><span class="line">  musicSkipBack: function () &#123;</span><br><span class="line">    navMusicEl.querySelector(&quot;meting-js&quot;).aplayer.skipBack();</span><br><span class="line"><span class="deletion">-   rm &amp;&amp; rm.hideRightMenu();</span></span><br><span class="line"><span class="addition">+   rm.updateMusicInfo();</span></span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line">  //音乐下一曲</span><br><span class="line">  musicSkipForward: function () &#123;</span><br><span class="line">    navMusicEl.querySelector(&quot;meting-js&quot;).aplayer.skipForward();</span><br><span class="line"><span class="deletion">-   rm &amp;&amp; rm.hideRightMenu();</span></span><br><span class="line"><span class="addition">+   rm.updateMusicInfo();</span></span><br><span class="line">  &#125;,</span><br><span class="line"></span><br><span class="line"><span class="addition">+ // 增加音量</span></span><br><span class="line"><span class="addition">+ musicVolumeUp: function () &#123;</span></span><br><span class="line"><span class="addition">+   navMusicEl.querySelector(&quot;meting-js&quot;).aplayer.volume(</span></span><br><span class="line"><span class="addition">+     Math.min(navMusicEl.querySelector(&quot;meting-js&quot;).aplayer.volume() + 0.1, 1)</span></span><br><span class="line"><span class="addition">+   );</span></span><br><span class="line"><span class="addition">+   rm.updateVolumeSlider();</span></span><br><span class="line"><span class="addition">+ &#125;,</span></span><br><span class="line"><span class="addition">+</span></span><br><span class="line"><span class="addition">+ // 减少音量</span></span><br><span class="line"><span class="addition">+ musicVolumeDown: function () &#123;</span></span><br><span class="line"><span class="addition">+   navMusicEl.querySelector(&quot;meting-js&quot;).aplayer.volume(</span></span><br><span class="line"><span class="addition">+     Math.max(navMusicEl.querySelector(&quot;meting-js&quot;).aplayer.volume() - 0.1, 0)</span></span><br><span class="line"><span class="addition">+   );</span></span><br><span class="line"><span class="addition">+   rm.updateVolumeSlider();</span></span><br><span class="line"><span class="addition">+ &#125;,</span></span><br><span class="line"></span><br><span class="line">  //获取音乐中的名称</span><br><span class="line">  musicGetName: function () &#123;</span><br><span class="line"><span class="deletion">-   var x = document.querySelector(&quot;.aplayer-title&quot;);</span></span><br><span class="line"><span class="deletion">-   var arr = [];</span></span><br><span class="line"><span class="deletion">-   for (var i = x.length - 1; i &gt;= 0; i--) &#123;</span></span><br><span class="line"><span class="deletion">-     arr[i] = x[i].innerText;</span></span><br><span class="line"><span class="deletion">-   &#125;</span></span><br><span class="line"><span class="deletion">-   return arr[0];</span></span><br><span class="line"><span class="addition">+   return x.innerText;</span></span><br><span class="line">  &#125;,</span><br><span class="line"><span class="addition">+</span></span><br><span class="line"><span class="addition">+ //获取音乐中的作者</span></span><br><span class="line"><span class="addition">+ musicGetauthor: function () &#123;</span></span><br><span class="line"><span class="addition">+   var x = document.querySelector(&quot;.aplayer-author&quot;);</span></span><br><span class="line"><span class="addition">+   var composer = x.innerText.trim().replace(/^-\s*|\s*-\s*/g, &#x27;&#x27;);</span></span><br><span class="line"><span class="addition">+   return composer;</span></span><br><span class="line"><span class="addition">+ &#125;,</span></span><br></pre></td></tr></table></figure><p>修改<code>[Blogroot]\themes\anzhiyu\source\js\main.js</code>文件：</p><figure class="highlight diff"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">  // 监听nav是否被其他音频暂停⏸️</span><br><span class="line">  const listenNavMusicPause = function () &#123;</span><br><span class="line">    const timer = setInterval(() =&gt; &#123;</span><br><span class="line">      if (navMusicEl &amp;&amp; navMusicEl.querySelector(&quot;#nav-music meting-js&quot;).aplayer) &#123;</span><br><span class="line">        clearInterval(timer);</span><br><span class="line">        let msgPlay = &#x27;&lt;i class=&quot;anzhiyufont anzhiyu-icon-play&quot;&gt;&lt;/i&gt;&lt;span&gt;播放音乐&lt;/span&gt;&#x27;;</span><br><span class="line">        let msgPause = &#x27;&lt;i class=&quot;anzhiyufont anzhiyu-icon-pause&quot;&gt;&lt;/i&gt;&lt;span&gt;暂停音乐&lt;/span&gt;&#x27;;</span><br><span class="line">        navMusicEl.querySelector(&quot;#nav-music meting-js&quot;).aplayer.on(&quot;pause&quot;, function () &#123;</span><br><span class="line">          navMusicEl.classList.remove(&quot;playing&quot;);</span><br><span class="line"><span class="deletion">-         document.getElementById(&quot;menu-music-toggle&quot;).innerHTML = msgPlay;</span></span><br><span class="line"><span class="addition">+         let menuMusicToggle  = document.getElementById(&quot;menu-music-toggle&quot;);</span></span><br><span class="line"><span class="addition">+         let iconElement = menuMusicToggle.querySelector(&#x27;i&#x27;);</span></span><br><span class="line"><span class="addition">+         iconElement.className = &#x27;iconfont icon-play&#x27;;</span></span><br><span class="line">          document.getElementById(&quot;nav-music-hoverTips&quot;).innerHTML = &quot;音乐已暂停&quot;;</span><br><span class="line">          document.querySelector(&quot;#consoleMusic&quot;).classList.remove(&quot;on&quot;);</span><br><span class="line">          anzhiyu_musicPlaying = false;</span><br><span class="line">          navMusicEl.classList.remove(&quot;stretch&quot;);</span><br><span class="line">        &#125;);</span><br><span class="line">        navMusicEl.querySelector(&quot;#nav-music meting-js&quot;).aplayer.on(&quot;play&quot;, function () &#123;</span><br><span class="line">          navMusicEl.classList.add(&quot;playing&quot;);</span><br><span class="line"><span class="deletion">-         document.getElementById(&quot;menu-music-toggle&quot;).innerHTML = msgPause;</span></span><br><span class="line"><span class="addition">+         let menuMusicToggle  = document.getElementById(&quot;menu-music-toggle&quot;);</span></span><br><span class="line"><span class="addition">+         let iconElement = menuMusicToggle.querySelector(&#x27;i&#x27;);</span></span><br><span class="line"><span class="addition">+         iconElement.className = &#x27;iconfont icon-pause&#x27;;</span></span><br><span class="line">          document.querySelector(&quot;#consoleMusic&quot;).classList.add(&quot;on&quot;);</span><br><span class="line">          anzhiyu_musicPlaying = true;</span><br><span class="line">          // navMusicEl.classList.add(&quot;stretch&quot;);</span><br><span class="line">        &#125;);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;, 16);</span><br><span class="line">  &#125;;</span><br></pre></td></tr></table></figure><h2 id="拓展修改"><a href="#拓展修改" class="headerlink" title="拓展修改"></a>拓展修改</h2><p>如果你还按照文章<a href="https://blog.randench.cn/posts/11982/">添加白天夜间模式转换动画</a>进行了修改，那么需要修改<code>[Blogroot]\themes\anzhiyu\source\js\sun_moon.js</code>文件，不然右键菜单中的昼夜模式切换选项会始终显示深色模式：</p><figure class="highlight diff"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line">function switchNightMode() &#123;</span><br><span class="line">  document.querySelector(&quot;body&quot;).insertAdjacentHTML(&quot;beforeend&quot;, &#x27;&lt;div class=&quot;Cuteen_DarkSky&quot;&gt;&lt;div class=&quot;Cuteen_DarkPlanet&quot;&gt;&lt;div id=&quot;sun&quot;&gt;&lt;/div&gt;&lt;div id=&quot;moon&quot;&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&#x27;);</span><br><span class="line"><span class="addition">+ $rightMenu = document.getElementById(&quot;rightMenu&quot;);</span></span><br><span class="line"><span class="addition">+ const menuDarkmodeText = $rightMenu.querySelector(&quot;.menu-darkmode-text&quot;);</span></span><br><span class="line"></span><br><span class="line">  setTimeout(() =&gt; &#123;</span><br><span class="line">    if (document.querySelector(&quot;body&quot;).classList.contains(&quot;DarkMode&quot;)) &#123;</span><br><span class="line">      document.querySelector(&quot;body&quot;).classList.remove(&quot;DarkMode&quot;);</span><br><span class="line">      localStorage.setItem(&quot;isDark&quot;, &quot;0&quot;);</span><br><span class="line">      document.getElementById(&quot;modeicon&quot;).setAttribute(&quot;xlink:href&quot;, &quot;#icon-moon&quot;);</span><br><span class="line">    &#125; else &#123;</span><br><span class="line">      document.querySelector(&quot;body&quot;).classList.add(&quot;DarkMode&quot;);</span><br><span class="line">      localStorage.setItem(&quot;isDark&quot;, &quot;1&quot;);</span><br><span class="line">      document.getElementById(&quot;modeicon&quot;).setAttribute(&quot;xlink:href&quot;, &quot;#icon-sun&quot;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    setTimeout(() =&gt; &#123;</span><br><span class="line">      document.getElementsByClassName(&quot;Cuteen_DarkSky&quot;)[0].style.transition = &quot;opacity 3s&quot;;</span><br><span class="line">      document.getElementsByClassName(&quot;Cuteen_DarkSky&quot;)[0].style.opacity = &quot;0&quot;;</span><br><span class="line">      setTimeout(() =&gt; &#123;</span><br><span class="line">        document.getElementsByClassName(&quot;Cuteen_DarkSky&quot;)[0].remove();</span><br><span class="line">      &#125;, 1000);</span><br><span class="line">    &#125;, 2000);</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  if (&quot;light&quot; <span class="comment">=== (&quot;dark&quot; === document.documentElement.getAttribute(&quot;data-theme&quot;) ? &quot;dark&quot; : &quot;light&quot;)) &#123;</span></span><br><span class="line">    document.getElementById(&quot;sun&quot;).style.opacity = &quot;1&quot;;</span><br><span class="line">    document.getElementById(&quot;moon&quot;).style.opacity = &quot;0&quot;;</span><br><span class="line">    setTimeout(() =&gt; &#123;</span><br><span class="line">      document.getElementById(&quot;sun&quot;).style.opacity = &quot;0&quot;;</span><br><span class="line">      document.getElementById(&quot;moon&quot;).style.opacity = &quot;1&quot;;</span><br><span class="line">    &#125;, 1000);</span><br><span class="line"></span><br><span class="line">    activateDarkMode();</span><br><span class="line">    saveToLocal.set(&quot;theme&quot;, &quot;dark&quot;, 2);</span><br><span class="line">    document.getElementById(&quot;modeicon&quot;).setAttribute(&quot;xlink:href&quot;, &quot;#icon-sun&quot;);</span><br><span class="line"><span class="addition">+   menuDarkmodeText.textContent = &quot;浅色模式&quot;;</span></span><br><span class="line"></span><br><span class="line">    setTimeout(() =&gt; &#123;</span><br><span class="line">      if (GLOBAL_CONFIG.Snackbar !== undefined) &#123;</span><br><span class="line">        anzhiyu.snackbarShow(GLOBAL_CONFIG.Snackbar.day_to_night);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;, 2000);</span><br><span class="line">  &#125; else &#123;</span><br><span class="line">    document.getElementById(&quot;sun&quot;).style.opacity = &quot;0&quot;;</span><br><span class="line">    document.getElementById(&quot;moon&quot;).style.opacity = &quot;1&quot;;</span><br><span class="line">    setTimeout(() =&gt; &#123;</span><br><span class="line">      document.getElementById(&quot;sun&quot;).style.opacity = &quot;1&quot;;</span><br><span class="line">      document.getElementById(&quot;moon&quot;).style.opacity = &quot;0&quot;;</span><br><span class="line">    &#125;, 1000);</span><br><span class="line"></span><br><span class="line">    activateLightMode();</span><br><span class="line">    saveToLocal.set(&quot;theme&quot;, &quot;light&quot;, 2);</span><br><span class="line">    document.querySelector(&quot;body&quot;).classList.add(&quot;DarkMode&quot;);</span><br><span class="line">    document.getElementById(&quot;modeicon&quot;).setAttribute(&quot;xlink:href&quot;, &quot;#icon-moon&quot;);</span><br><span class="line"><span class="addition">+   menuDarkmodeText.textContent = &quot;深色模式&quot;;</span></span><br><span class="line"></span><br><span class="line">    setTimeout(() =&gt; &#123;</span><br><span class="line">      if (GLOBAL_CONFIG.Snackbar !== undefined) &#123;</span><br><span class="line">        anzhiyu.snackbarShow(GLOBAL_CONFIG.Snackbar.night_to_day);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;, 2000);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  if (typeof utterancesTheme <span class="comment">=== &quot;function&quot;) utterancesTheme();</span></span><br><span class="line">  if (typeof FB <span class="comment">=== &quot;object&quot;) window.loadFBComment();</span></span><br><span class="line">  if (window.DISQUS &amp;&amp; document.getElementById(&quot;disqus_thread&quot;).children.length) setTimeout(() =&gt; window.disqusReset(), 200);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Hexo </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 美化 </tag>
            
            <tag> 魔改 </tag>
            
            <tag> AnZhiYu </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Anzhiyu主题主控台添加右键菜单开关</title>
      <link href="//posts/9798/"/>
      <url>//posts/9798/</url>
      
        <content type="html"><![CDATA[<div class="note warning flat"><p>本文修改主题为<code>AnZhiYu</code>主题，若使用其他主题，请自行确认修改位置。</p></div><h1 id="写在前面"><a href="#写在前面" class="headerlink" title="写在前面"></a>写在前面</h1><p><code>AnZhiYu</code>主题开启右键菜单后，关闭右键菜单的功能隐藏在快捷键中，不容易发现，于是我在中控台的按钮中添加了一个开关，方便用户开启或关闭右键菜单。</p><h1 id="样式预览"><a href="#样式预览" class="headerlink" title="样式预览"></a>样式预览</h1><p><img src="https://cdn.randench.cn/image/24/08/f63996443c18899e.png" alt="样式预览"></p><h1 id="修改步骤"><a href="#修改步骤" class="headerlink" title="修改步骤"></a>修改步骤</h1><h2 id="添加按钮"><a href="#添加按钮" class="headerlink" title="添加按钮"></a>添加按钮</h2><div class="tip info flat"><p>此处的<code>iconfont.icon-list</code>为我自己添加的字体，请根据你网页的字体情况修改。</p></div><p>修改<code>[Blogroot]\themes\anzhiyu\layout\includes\anzhiyu\console.pug</code>：</p><figure class="highlight diff"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">    if theme.comment_barrage_config.enable</span><br><span class="line">      .console-btn-item.on#consoleCommentBarrage(onclick=&#x27;anzhiyu.switchCommentBarrage()&#x27;, title=&#x27;热评开关&#x27;)</span><br><span class="line">        a.commentBarrage</span><br><span class="line">          i.anzhiyufont.anzhiyu-icon-message</span><br><span class="line"><span class="addition">+   if theme.rightClickMenu.enable</span></span><br><span class="line"><span class="addition">+     .console-btn-item#consoleRightMenu(onclick=&#x27;anzhiyu.rightMenuToggle()&#x27;, title=&#x27;右键菜单开关&#x27;)</span></span><br><span class="line"><span class="addition">+       a.rightMenu-switch</span></span><br><span class="line"><span class="addition">+         i.iconfont.icon-list</span></span><br><span class="line">    if theme.nav_music.enable</span><br><span class="line">      .console-btn-item#consoleMusic(onclick=&#x27;anzhiyu.musicToggle()&#x27;, title=&#x27;音乐开关&#x27;)</span><br><span class="line">        a.music-switch</span><br><span class="line">          i.anzhiyufont.anzhiyu-icon-music</span><br></pre></td></tr></table></figure><h2 id="修改JS"><a href="#修改JS" class="headerlink" title="修改JS"></a>修改JS</h2><p>修改<code>[Blogroot]\themes\anzhiyu\source\js\utils.js</code>：</p><figure class="highlight diff"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br></pre></td><td class="code"><pre><span class="line">  keyboardToggle: function () &#123;</span><br><span class="line">    const isKeyboardOn = anzhiyu_keyboard;</span><br><span class="line"></span><br><span class="line">    if (isKeyboardOn) &#123;</span><br><span class="line">      const consoleKeyboard = document.querySelector(&quot;#consoleKeyboard&quot;);</span><br><span class="line">      consoleKeyboard.classList.remove(&quot;on&quot;);</span><br><span class="line">      anzhiyu_keyboard = false;</span><br><span class="line">    &#125; else &#123;</span><br><span class="line">      const consoleKeyboard = document.querySelector(&quot;#consoleKeyboard&quot;);</span><br><span class="line">      consoleKeyboard.classList.add(&quot;on&quot;);</span><br><span class="line">      anzhiyu_keyboard = true;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    localStorage.setItem(&quot;keyboardToggle&quot;, isKeyboardOn ? &quot;false&quot; : &quot;true&quot;);</span><br><span class="line">  &#125;,</span><br><span class="line">  rightMenuToggle: function () &#123;</span><br><span class="line"><span class="addition">+   const isRightMenuOn = anzhiyu_rightMenu;</span></span><br><span class="line"><span class="addition">+</span></span><br><span class="line"><span class="addition">+   if (!consolRightMenu) &#123;</span></span><br><span class="line"><span class="addition">+     anzhiyu_rightMenu = true;</span></span><br><span class="line"><span class="addition">+   &#125;</span></span><br><span class="line"><span class="addition">+</span></span><br><span class="line"><span class="addition">+   if (isRightMenuOn) &#123;</span></span><br><span class="line"><span class="addition">+     const consolRightMenu = document.querySelector(&quot;#consoleRightMenu&quot;);</span></span><br><span class="line"><span class="addition">+     consolRightMenu.classList.remove(&quot;on&quot;);</span></span><br><span class="line"><span class="addition">+     anzhiyu_rightMenu = false;</span></span><br><span class="line"><span class="addition">+     window.oncontextmenu = null;</span></span><br><span class="line"><span class="addition">+   &#125; else &#123; </span></span><br><span class="line"><span class="addition">+     const consolRightMenu = document.querySelector(&quot;#consoleRightMenu&quot;);</span></span><br><span class="line"><span class="addition">+     consolRightMenu.classList.add(&quot;on&quot;);  </span></span><br><span class="line"><span class="addition">+     anzhiyu_rightMenu = true;</span></span><br><span class="line"><span class="addition">+     window.oncontextmenu = oncontextmenuFunction;</span></span><br><span class="line"><span class="addition">+   &#125;</span></span><br><span class="line"><span class="deletion">-   if (window.oncontextmenu) &#123;</span></span><br><span class="line"><span class="deletion">-     window.oncontextmenu = null;</span></span><br><span class="line"><span class="deletion">-   &#125; else if (!window.oncontextmenu &amp;&amp; oncontextmenuFunction) &#123;</span></span><br><span class="line"><span class="deletion">-     window.oncontextmenu = oncontextmenuFunction;</span></span><br><span class="line"><span class="deletion">-   &#125;</span></span><br><span class="line"><span class="addition">+   localStorage.setItem(&quot;rightMenuToggle&quot;, isRightMenuOn ? &quot;false&quot; : &quot;true&quot;);</span></span><br><span class="line">  &#125;,</span><br><span class="line">  switchConsole: () =&gt; &#123;</span><br><span class="line">    // switch console</span><br><span class="line">    const consoleEl = document.getElementById(&quot;console&quot;);</span><br><span class="line">    //初始化隐藏边栏</span><br><span class="line">    const $htmlDom = document.documentElement.classList;</span><br><span class="line">    $htmlDom.contains(&quot;hide-aside&quot;)</span><br><span class="line">      ? document.querySelector(&quot;#consoleHideAside&quot;).classList.add(&quot;on&quot;)</span><br><span class="line">      : document.querySelector(&quot;#consoleHideAside&quot;).classList.remove(&quot;on&quot;);</span><br><span class="line">    if (consoleEl.classList.contains(&quot;show&quot;)) &#123;</span><br><span class="line">      consoleEl.classList.remove(&quot;show&quot;);</span><br><span class="line">    &#125; else &#123;</span><br><span class="line">      consoleEl.classList.add(&quot;show&quot;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line"><span class="addition">+   const consolRightMenu = document.querySelector(&quot;#consoleRightMenu&quot;);</span></span><br><span class="line"><span class="addition">+</span></span><br><span class="line"><span class="addition">+   if (consolRightMenu) &#123;</span></span><br><span class="line"><span class="addition">+     if (localStorage.getItem(&quot;rightMenuToggle&quot;) === &quot;true&quot;) &#123;</span></span><br><span class="line"><span class="addition">+       consolRightMenu.classList.add(&quot;on&quot;);</span></span><br><span class="line"><span class="addition">+       anzhiyu_rightMenu = true;</span></span><br><span class="line"><span class="addition">+     &#125; else &#123;</span></span><br><span class="line"><span class="addition">+       consolRightMenu.classList.remove(&quot;on&quot;);</span></span><br><span class="line"><span class="addition">+       anzhiyu_rightMenu = false;</span></span><br><span class="line"><span class="addition">+     &#125;</span></span><br><span class="line"><span class="addition">+   &#125;</span></span><br><span class="line"></span><br><span class="line">    const consoleKeyboard = document.querySelector(&quot;#consoleKeyboard&quot;);</span><br><span class="line"></span><br><span class="line">    if (consoleKeyboard) &#123;</span><br><span class="line">      if (localStorage.getItem(&quot;keyboardToggle&quot;) <span class="comment">=== &quot;true&quot;) &#123;</span></span><br><span class="line">        consoleKeyboard.classList.add(&quot;on&quot;);</span><br><span class="line">        anzhiyu_keyboard = true;</span><br><span class="line">      &#125; else &#123;</span><br><span class="line">        consoleKeyboard.classList.remove(&quot;on&quot;);</span><br><span class="line">        anzhiyu_keyboard = false;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;,</span><br></pre></td></tr></table></figure><p>修改<code>[Blogroot]\themes\anzhiyu\source\js\main.js</code>：</p><figure class="highlight diff"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">    GLOBAL_CONFIG.islazyload &amp;&amp; lazyloadImg();</span><br><span class="line">    GLOBAL_CONFIG.copyright !== undefined &amp;&amp; addCopyright();</span><br><span class="line">    GLOBAL_CONFIG.navMusic &amp;&amp; listenNavMusicPause();</span><br><span class="line"><span class="addition">+   if (document.getElementById(&quot;consoleRightMenu&quot;)) &#123;</span></span><br><span class="line"><span class="addition">+     localStorage.setItem(&quot;rightMenuToggle&quot;, &quot;true&quot;);</span></span><br><span class="line"><span class="addition">+     document.getElementById(&quot;consoleRightMenu&quot;).classList.add(&quot;on&quot;);</span></span><br><span class="line"><span class="addition">+     anzhiyu_rightMenu = true;</span></span><br><span class="line"><span class="addition">+   &#125;</span></span><br><span class="line">    if (GLOBAL_CONFIG.shortcutKey &amp;&amp; document.getElementById(&quot;consoleKeyboard&quot;)) &#123;</span><br><span class="line">      localStorage.setItem(&quot;keyboardToggle&quot;, &quot;true&quot;);</span><br><span class="line">      document.getElementById(&quot;consoleKeyboard&quot;).classList.add(&quot;on&quot;);</span><br><span class="line">      anzhiyu_keyboard = true;</span><br><span class="line">      executeShortcutKeyFunction();</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><h1 id="拓展修改"><a href="#拓展修改" class="headerlink" title="拓展修改"></a>拓展修改</h1><div class="note info flat"><p>试试在右键菜单中直接加入关闭选项，这样用户不用打开主控台也能关闭右键菜单了。</p></div><h2 id="样式预览-1"><a href="#样式预览-1" class="headerlink" title="样式预览"></a>样式预览</h2><details class="folding-tag" ><summary> 打开预览 </summary>              <div class='content'>              <p><img src="https://cdn.randench.cn/image/24/08/fbf80f9f11737538.gif" alt="关闭右键菜单样式预览"></p>              </div>            </details><h2 id="修改步骤-1"><a href="#修改步骤-1" class="headerlink" title="修改步骤"></a>修改步骤</h2><p>修改<code>[Blogroot]\themes\anzhiyu\source\js\utils.js</code>，防止<code>anzhiyu_rightMenu</code>未定义，并且加入<code>rm.hideRightMenu()</code>用以关闭已经打开的菜单：</p><figure class="highlight diff"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">  rightMenuToggle: function () &#123;</span><br><span class="line"><span class="addition">+   if (typeof anzhiyu_rightMenu === &#x27;undefined&#x27;) &#123;</span></span><br><span class="line"><span class="addition">+     anzhiyu_rightMenu = window.oncontextmenu !== null;</span></span><br><span class="line"><span class="addition">+   &#125;</span></span><br><span class="line">    const isRightMenuOn = anzhiyu_rightMenu;</span><br><span class="line"></span><br><span class="line">    if (isRightMenuOn) &#123;</span><br><span class="line"><span class="addition">+     rm &amp;&amp; rm.hideRightMenu();</span></span><br><span class="line">      const consolRightMenu = document.querySelector(&quot;#consoleRightMenu&quot;);</span><br><span class="line">      consolRightMenu.classList.remove(&quot;on&quot;);</span><br><span class="line">      anzhiyu_rightMenu = false;</span><br><span class="line">      window.oncontextmenu = null;</span><br><span class="line">    &#125; else &#123; </span><br><span class="line">      const consolRightMenu = document.querySelector(&quot;#consoleRightMenu&quot;);</span><br><span class="line">      consolRightMenu.classList.add(&quot;on&quot;);  </span><br><span class="line">      anzhiyu_rightMenu = true;</span><br><span class="line">      window.oncontextmenu = oncontextmenuFunction;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure><p>修改<code>[Blogroot]\themes\anzhiyu\layout\includes\anzhiyu\rightmenu.pug</code>：</p><figure class="highlight diff"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">    a.rightMenu-item#menu-translate(href=&#x27;javascript:void(0);&#x27;)</span><br><span class="line">      i.anzhiyufont.anzhiyu-icon-language</span><br><span class="line">      span=translate.rightMenuMsgDefault</span><br><span class="line"><span class="addition">+   a.rightMenu-item#menu-rightMenuToggle(onclick=&#x27;anzhiyu.rightMenuToggle();&#x27;)</span></span><br><span class="line"><span class="addition">+     i.iconfont.icon-list</span></span><br><span class="line"><span class="addition">+     span 关闭右键菜单</span></span><br><span class="line">#rightmenu-mask</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Hexo </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 美化 </tag>
            
            <tag> 魔改 </tag>
            
            <tag> AnZhiYu </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>linux挂载硬盘</title>
      <link href="//posts/54747/"/>
      <url>//posts/54747/</url>
      
        <content type="html"><![CDATA[<p>在 Linux 系统上格式化新硬盘并设置开机自动挂载到 <code>/mnt</code> 目录的步骤如下：</p><h1 id="挂载步骤"><a href="#挂载步骤" class="headerlink" title="挂载步骤"></a>挂载步骤</h1><h2 id="1-确认新硬盘的设备名称"><a href="#1-确认新硬盘的设备名称" class="headerlink" title="1. 确认新硬盘的设备名称"></a>1. 确认新硬盘的设备名称</h2><p>首先，使用以下命令列出所有连接的存储设备，以确认新硬盘的设备名称（如 <code>/dev/sdb</code>）：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">lsblk</span><br></pre></td></tr></table></figure><h2 id="2-分区和格式化新硬盘"><a href="#2-分区和格式化新硬盘" class="headerlink" title="2. 分区和格式化新硬盘"></a>2. 分区和格式化新硬盘</h2><p>如果硬盘没有分区，您可以使用 <code>fdisk</code> 或 <code>parted</code> 工具创建新分区。以下是使用 <code>fdisk</code> 创建单一分区并格式化为 ext4 文件系统的步骤：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> fdisk /dev/sdb</span><br></pre></td></tr></table></figure><p>在 <code>fdisk</code> 中，您可以输入以下命令：</p><ul><li><code>n</code> 创建新分区</li><li><code>p</code> 选择主分区</li><li><code>1</code> 选择分区号</li><li><code>w</code> 写入更改并退出</li></ul><p>完成分区后，格式化新分区（假设分区名称为 <code>/dev/sdb1</code>）：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> mkfs.ext4 /dev/sdb1</span><br></pre></td></tr></table></figure><h2 id="3-创建挂载点目录"><a href="#3-创建挂载点目录" class="headerlink" title="3. 创建挂载点目录"></a>3. 创建挂载点目录</h2><p>创建挂载点目录，例如 <code>/mnt</code>：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> <span class="built_in">mkdir</span> -p /mnt</span><br></pre></td></tr></table></figure><h2 id="4-临时挂载硬盘"><a href="#4-临时挂载硬盘" class="headerlink" title="4. 临时挂载硬盘"></a>4. 临时挂载硬盘</h2><p>为了立即挂载新硬盘，可以执行以下命令：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> mount /dev/sdb1 /mnt</span><br></pre></td></tr></table></figure><h2 id="5-设置开机自动挂载"><a href="#5-设置开机自动挂载" class="headerlink" title="5. 设置开机自动挂载"></a>5. 设置开机自动挂载</h2><p>编辑 <code>/etc/fstab</code> 文件，使新硬盘在系统启动时自动挂载：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> vim /etc/fstab</span><br></pre></td></tr></table></figure><p>在 <code>fstab</code> 文件中添加一行，内容如下：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/dev/sdb1 /mnt/newdisk ext4 defaults 0 2</span><br></pre></td></tr></table></figure><p>如果需要使用 <code>UUID</code> 而不是设备名称（推荐做法），可以使用以下命令获取分区的 UUID：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> blkid /dev/sdb1</span><br></pre></td></tr></table></figure><p>然后在 <code>/etc/fstab</code> 中添加：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">UUID=your-uuid /mnt/newdisk ext4 defaults 0 2</span><br></pre></td></tr></table></figure><h2 id="6-验证配置"><a href="#6-验证配置" class="headerlink" title="6. 验证配置"></a>6. 验证配置</h2><p>在保存更改后，执行以下命令以验证 <code>/etc/fstab</code> 配置是否正确：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">sudo</span> mount -a</span><br></pre></td></tr></table></figure><p>如果没有报错，硬盘将在下次启动时自动挂载到 <code>/mnt</code>。</p><p>这样就成功地格式化了新硬盘并设置了开机自动挂载到 <code>/mnt</code> 目录。</p>]]></content>
      
      
      <categories>
          
          <category> 实用 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Linux </tag>
            
            <tag> 教程 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>AnZhiYu主题顶栏适配心知天气</title>
      <link href="//posts/3991/"/>
      <url>//posts/3991/</url>
      
        <content type="html"><![CDATA[<div class="note warning flat"><p>本文修改主题为<code>AnZhiYu</code>主题，若使用其他主题，请自行确认修改位置。</p></div><h1 id="写在前面"><a href="#写在前面" class="headerlink" title="写在前面"></a>写在前面</h1><p>Anzhiyu主题的顶栏菜单使用了和风天气的API提供天气服务，但是和风天气已经在2024年5月1日停止服务，所以即便填写了key，也无法获取到天气数据。此时，我们需要寻找其他的天气API来替换掉和风天气。本文将介绍如何使用心知天气API替换掉Anzhiyu主题顶栏的天气功能。</p><h1 id="效果预览"><a href="#效果预览" class="headerlink" title="效果预览"></a>效果预览</h1><p><img src="https://cdn.randench.cn/image/24/08/317c8a155917f179.png" alt="效果预览"></p><h1 id="修改步骤"><a href="#修改步骤" class="headerlink" title="修改步骤"></a>修改步骤</h1><h2 id="心知天气API"><a href="#心知天气API" class="headerlink" title="心知天气API"></a>心知天气API</h2><p>首先，需要到 <a href="https://www.seniverse.com/">心知天气</a> 注册一个账号，并创建一个Widget应用。此步骤在 <a href="https://blog.randench.cn/posts/20458/">顶栏菜单重写</a> 文章中有给出。</p><div class="tip info"><p>插件类型随意选择，需要吸附顶栏则选择固定极简，其余根据需要选择</p></div><div calss='anzhiyu-tag-link'><a class="tag-Link" target="_blank" href="https://www.seniverse.com/widgetv3">    <div class="tag-link-tips">引用站外地址</div>    <div class="tag-link-bottom">        <div class="tag-link-left" style="background-image: url(https://cdn.sencdn.com/widget2/assets/img/chameleon/logo.svg)">          <i class="anzhiyufont anzhiyu-icon-link" style="display: none"></i>        </div>        <div class="tag-link-right">            <div class="tag-link-title">心知天气Widget生成</div>            <div class="tag-link-sitename"> https://www.seniverse.com/widgetv3</div>        </div>        <i class="anzhiyufont anzhiyu-icon-angle-right"></i>    </div>    </a></div><p>点击生成后会得到一段HTML，将其<code>script</code>部分记录下来，后面需要使用</p><h2 id="修改样式"><a href="#修改样式" class="headerlink" title="修改样式"></a>修改样式</h2><ol><li>修改<code>[Blogroot]\themes\anzhiyu\layout\includes\anzhiyu\clock.pug</code>文件，可以接替换为如下样式：</li></ol><div class="note info flat"><p>其中<code>location</code>和<code>token</code>需要替换为自己的心知天气API信息</p></div><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">#he-plugin-simple</span><br><span class="line">script.</span><br><span class="line">  (function(a,h,g,f,e,d,c,b)&#123;b=function()&#123;d=h.createElement(g);c=h.getElementsByTagName(g)[0];d.src=e;d.charset=&quot;utf-8&quot;;d.async=1;c.parentNode.insertBefore(d,c)&#125;;a [&quot;SeniverseWeatherWidgetObject&quot;]=f;a[f]||(a[f]=function()&#123;(a[f].q=a[f].q||[]).push(arguments)&#125;);a[f].l=+new Date();if(a.attachEvent)&#123;a.attachEvent(&quot;onload&quot;,b)&#125;else&#123;a.addEventListener (&quot;load&quot;,b,false)&#125;&#125;(window,document,&quot;script&quot;,&quot;SeniverseWeatherWidget&quot;,&quot;//cdn.sencdn.com/widget2/static/js/bundle.js?t=&quot;+parseInt((new Date().getTime() / 100000000).toString(),10)));</span><br><span class="line">  window.SeniverseWeatherWidget(&#x27;show&#x27;, &#123;</span><br><span class="line">    flavor: &quot;slim&quot;,</span><br><span class="line">    location: &quot;XXXXXXXXXXXX&quot;,</span><br><span class="line">    geolocation: true,</span><br><span class="line">    language: &quot;auto&quot;,</span><br><span class="line">    unit: &quot;c&quot;,</span><br><span class="line">    theme: &quot;auto&quot;,</span><br><span class="line">    token: &quot;xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx&quot;,</span><br><span class="line">    hover: &quot;enabled&quot;,</span><br><span class="line">    container: &quot;he-plugin-simple&quot;</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  document.addEventListener(&#x27;DOMContentLoaded&#x27;, function () &#123;</span><br><span class="line">    const pageHeader = document.getElementById(&#x27;page-header&#x27;);</span><br><span class="line">    if (pageHeader &amp;&amp; pageHeader.classList.contains(&#x27;nav-fixed&#x27;)) &#123;</span><br><span class="line">        const elements = document.querySelectorAll(&#x27;#he-plugin-simple .sw-bar-slim-location&#x27;);</span><br><span class="line">        elements.forEach(function (element) &#123;</span><br><span class="line">            element.style.color = &#x27;var(--font-color)&#x27;;</span><br><span class="line">            element.style.setProperty(&#x27;color&#x27;, &#x27;var(--font-color)&#x27;, &#x27;important&#x27;);</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125; else if (pageHeader &amp;&amp; pageHeader.classList.contains(&#x27;not-top-img&#x27;)) &#123;</span><br><span class="line">      const elements = document.querySelectorAll(&#x27;#he-plugin-simple .sw-bar-slim-location&#x27;);</span><br><span class="line">        elements.forEach(function (element) &#123;</span><br><span class="line">            element.style.color = &#x27;var(--font-color)&#x27;;</span><br><span class="line">            element.style.setProperty(&#x27;color&#x27;, &#x27;var(--font-color)&#x27;, &#x27;important&#x27;);</span><br><span class="line">        &#125;);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;);</span><br></pre></td></tr></table></figure><ol start="2"><li>修改<code>[Blogroot]\themes\anzhiyu\source\_extra\clock\clock.css</code>文件，可以接替换为如下样式：</li></ol><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/*心知天气 */</span></span><br><span class="line"><span class="selector-id">#he-plugin-simple</span> &#123;</span><br><span class="line">  <span class="attribute">z-index</span>: <span class="number">92</span>;</span><br><span class="line">  <span class="attribute">transition</span>: <span class="number">0.3s</span>;</span><br><span class="line">  <span class="attribute">position</span>: relative;</span><br><span class="line">  <span class="attribute">left</span>: -<span class="number">110%</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-id">#he-plugin-simple</span> <span class="selector-class">.sw-bar-slim-location</span>,</span><br><span class="line"><span class="selector-id">#he-plugin-simple</span> <span class="selector-class">.sw-bar-slim-temperature</span> &#123;</span><br><span class="line">  <span class="attribute">font-family</span>: <span class="string">&quot;base&quot;</span>;</span><br><span class="line">  <span class="attribute">font-size</span>: <span class="number">1.1rem</span>;</span><br><span class="line">  <span class="attribute">color</span>: <span class="built_in">var</span>(--light-grey);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-tag">body</span><span class="selector-pseudo">:has</span>(<span class="selector-id">#sidebar-menus</span><span class="selector-class">.open</span>) <span class="selector-id">#he-plugin-simple</span> &#123;</span><br><span class="line">  <span class="attribute">z-index</span>: <span class="number">104</span>;</span><br><span class="line">  <span class="attribute">left</span>: <span class="number">95px</span> <span class="meta">!important</span>;</span><br><span class="line">  <span class="attribute">opacity</span>: <span class="number">1</span>;</span><br><span class="line">  <span class="attribute">display</span>: block;</span><br><span class="line">  <span class="attribute">transition</span>: <span class="number">0.3s</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-id">#page-header</span><span class="selector-class">.nav-fixed</span> <span class="selector-id">#he-plugin-simple</span> <span class="selector-class">.sw-bar-slim-location</span>, </span><br><span class="line"><span class="selector-id">#page-header</span><span class="selector-class">.nav-fixed</span> <span class="selector-id">#he-plugin-simple</span> <span class="selector-class">.sw-bar-slim-temperature</span> &#123;</span><br><span class="line">  <span class="attribute">color</span>: <span class="built_in">var</span>(--font-color);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-attr">[data-theme=<span class="string">&quot;dark&quot;</span>]</span> <span class="selector-id">#he-plugin-simple</span> <span class="selector-class">.sw-bar-slim-locationy</span>,</span><br><span class="line"><span class="selector-attr">[data-theme=<span class="string">&quot;dark&quot;</span>]</span> <span class="selector-id">#he-plugin-simple</span> <span class="selector-class">.sw-bar-slim-temperature</span> &#123;</span><br><span class="line">  <span class="attribute">color</span>: <span class="built_in">var</span>(--font-color);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-tag">body</span><span class="selector-attr">[data-type=music]</span> <span class="selector-id">#he-plugin-simple</span> <span class="selector-class">.sw-bar-slim-location</span>,</span><br><span class="line"><span class="selector-tag">body</span><span class="selector-attr">[data-type=music]</span> <span class="selector-id">#he-plugin-simple</span> <span class="selector-class">.sw-bar-slim-temperature</span> &#123;</span><br><span class="line">  <span class="attribute">color</span>: <span class="built_in">var</span>(--anzhiyu-white) <span class="meta">!important</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-tag">body</span><span class="selector-attr">[data-type=games]</span> <span class="selector-id">#he-plugin-simple</span> <span class="selector-class">.sw-bar-slim-location</span>,</span><br><span class="line"><span class="selector-tag">body</span><span class="selector-attr">[data-type=games]</span> <span class="selector-id">#he-plugin-simple</span> <span class="selector-class">.sw-bar-slim-temperature</span> &#123;</span><br><span class="line">  <span class="attribute">color</span>: <span class="built_in">var</span>(--font-colore);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-id">#page-header</span><span class="selector-class">.not-top-img</span> <span class="selector-id">#he-plugin-simple</span> <span class="selector-class">.sw-bar-slim-location</span>, </span><br><span class="line"><span class="selector-id">#page-header</span><span class="selector-class">.not-top-img</span> <span class="selector-id">#he-plugin-simple</span> <span class="selector-class">.sw-bar-slim-temperature</span> &#123;</span><br><span class="line">  <span class="attribute">color</span>: <span class="built_in">var</span>(--font-color);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-tag">div</span><span class="selector-class">.sw-ui-main-title</span> &gt; <span class="selector-tag">p</span> &gt; <span class="selector-tag">a</span>,</span><br><span class="line"><span class="selector-tag">div</span><span class="selector-class">.sw-ui-brand</span> &gt; <span class="selector-tag">a</span> &#123;</span><br><span class="line">    <span class="attribute">color</span>: unset <span class="meta">!important</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@media</span> screen <span class="keyword">and</span> (<span class="attribute">max-width</span>: <span class="number">1400px</span>) &#123;</span><br><span class="line">  <span class="selector-id">#he-plugin-simple</span> &#123;</span><br><span class="line">    <span class="attribute">display</span>: none;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@media</span> screen <span class="keyword">and</span> (<span class="attribute">min-width</span>: <span class="number">1400px</span>) <span class="keyword">and</span> (<span class="attribute">max-width</span>: <span class="number">1690px</span>) &#123;</span><br><span class="line">  <span class="selector-id">#he-plugin-simple</span> &#123;</span><br><span class="line">    <span class="attribute">left</span>: <span class="number">262px</span> <span class="meta">!important</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="开启天气功能"><a href="#开启天气功能" class="headerlink" title="开启天气功能"></a>开启天气功能</h2><p>最后，在<code>[Blogroot]\_config.anzhiyu.yml</code>中将<code>nav.clock</code>设置为<code>true</code>即可开启天气功能。</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">nav:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">travelling:</span> <span class="literal">false</span></span><br><span class="line">  <span class="attr">clock:</span> <span class="literal">true</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Hexo </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 美化 </tag>
            
            <tag> 魔改 </tag>
            
            <tag> AnZhiYu </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>为博客添加一个游戏收藏页</title>
      <link href="//posts/59357/"/>
      <url>//posts/59357/</url>
      
        <content type="html"><![CDATA[<div class="note warning flat"><p>注意，该内容需修改主题文件，本文操作步骤为 anzhiyu 主题 1.6.12版本</p></div><h1 id="原文地址"><a href="#原文地址" class="headerlink" title="原文地址"></a>原文地址</h1><blockquote><p><a href="https://blog.kouseki.cn/posts/e7dd.html">https://blog.kouseki.cn/posts/e7dd.html</a></p></blockquote><h1 id="写在前面"><a href="#写在前面" class="headerlink" title="写在前面"></a>写在前面</h1><p>游戏作为第九艺术，是如今最具创意和影响力的艺术形式之一。它不仅仅是一种娱乐方式，更是一种沉浸式的体验，通过精美的画面、动人的音乐、丰富的剧情和独特的玩法，将玩家带入一个充满想象力的世界。在这个世界中，玩家可以扮演各种角色，体验不同的人生，感受各种情感。游戏不仅能够带给人们欢乐和刺激，还能够启发人们的创造力和思考能力。</p><p>如果你是一个热爱游戏的博客作者，或者是一个喜欢分享游戏的玩家，新建一个游戏页用于展示你喜爱的游戏，或是与读者分享你的游戏感悟，评测，经验。</p><p>本文提供为hexo博客新建一个游戏展示页的教程。基于主题“我的装备”页进行修改。</p><h1 id="效果预览"><a href="#效果预览" class="headerlink" title="效果预览"></a>效果预览</h1><p>预览页面：<a class="btn-anzhiyu " href="https://blog.randench.cn/games/"   title="游戏厅"><i class="anzhiyufont anzhiyu-icon-circle-arrow-right"></i><span>游戏厅</span></a></p><h1 id="修改步骤"><a href="#修改步骤" class="headerlink" title="修改步骤"></a>修改步骤</h1><h2 id="1-修改文件"><a href="#1-修改文件" class="headerlink" title="1. 修改文件"></a>1. 修改文件</h2><p>在\themes\anzhiyu\layout\page.pug中新增以下内容</p><figure class="highlight diff"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">      when &#x27;music&#x27;</span><br><span class="line">        include includes/page/music.pug</span><br><span class="line"><span class="addition">+     when &#x27;games&#x27;</span></span><br><span class="line"><span class="addition">+       include includes/page/games.pug</span></span><br><span class="line">      default</span><br><span class="line">        include includes/page/default-page.pug</span><br></pre></td></tr></table></figure><h2 id="2-新建文件"><a href="#2-新建文件" class="headerlink" title="2. 新建文件"></a>2. 新建文件</h2><p>新建<code>[Blogroot]\themes\anzhiyu\layout\includes\page\games.pug</code>文件，内容如下：</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">#games</span><br><span class="line">  if site.data.games</span><br><span class="line">    each i in site.data.games</span><br><span class="line">      .author-content.author-content-item.GamesPage.single(style = `background: url($&#123;i.top_background&#125;) left 37% / cover no-repeat !important;`)</span><br><span class="line">        .card-content</span><br><span class="line">          .author-content-item-tips=i.class_name</span><br><span class="line">          span.author-content-item-title=i.description</span><br><span class="line">          .content-bottom</span><br><span class="line">            .tips=i.tip</span><br><span class="line">          .banner-button-group</span><br><span class="line">            a.banner-button(href=i.buttonLink)</span><br><span class="line">              i.anzhiyufont.anzhiyu-icon-arrow-circle-right(style=&#x27;font-size: 1.3rem&#x27;)</span><br><span class="line">              span.banner-button-text=i.buttonText</span><br><span class="line">      each item in i.good_games</span><br><span class="line">        .goodgames-item</span><br><span class="line">          h2.goodgames-title= item.title</span><br><span class="line">          .goodgames-item-description= item.description</span><br><span class="line">          .games-item</span><br><span class="line">            .games-item-content</span><br><span class="line">              each iten, indey in item.games_list</span><br><span class="line">                .games-item-content-item</span><br><span class="line">                  .games-item-content-item-cover</span><br><span class="line">                    img.games-item-content-item-image(data-lazy-src=url_for(iten.image) onerror=`this.onerror=null;this.src=&#x27;` + url_for(theme.error_img.flink) + `&#x27;` alt=iten.name)</span><br><span class="line">                  .games-item-content-item-info</span><br><span class="line">                    .games-item-content-item-name(onclick=`rm.rightmenuCopyText(&quot;$&#123;iten.name&#125;&quot;);anzhiyu.snackbarShow(&quot;$&#123;_p(&#x27;Snackbar.copy_games_name&#x27;) + &quot; 【&quot; + iten.name + &quot;】&quot;&#125;&quot;);` title=iten.name)= iten.name</span><br><span class="line">                    .games-item-content-item-specification= iten.specification</span><br><span class="line">                    .games-item-content-item-description= iten.description</span><br><span class="line">                    .games-item-content-item-toolbar</span><br><span class="line">                      if iten.link.includes(&#x27;https://&#x27;) || iten.link.includes(&#x27;http://&#x27;)</span><br><span class="line">                        a.games-item-content-item-link(href= iten.link, target=&#x27;_blank&#x27;) 详情</span><br><span class="line">                        .bber-reply(onclick=&quot;rm.rightMenuCommentText(&quot; + `&#x27;$&#123;iten.name + &quot; &quot; + iten.specification + &quot; &quot; + iten.description&#125;&#x27;` + &quot;)&quot;)</span><br><span class="line">                          i.anzhiyufont.anzhiyu-icon-message</span><br><span class="line">                      else  </span><br><span class="line">                        a.games-item-content-item-link(href= iten.link, target=&#x27;_blank&#x27;) 查看文章</span><br><span class="line">                        .bber-reply(onclick=&quot;rm.rightMenuCommentText(&quot; + `&#x27;$&#123;iten.name + &quot; &quot; + iten.specification + &quot; &quot; + iten.description&#125;&#x27;` + &quot;)&quot;)</span><br><span class="line">                          i.anzhiyufont.anzhiyu-icon-message</span><br></pre></td></tr></table></figure><p>新建<code>[Blogroot]\source\_data\games.yml</code>并参考以下格式输入内容</p><figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="bullet">-</span> <span class="attr">class_name:</span> <span class="string">游戏世界</span></span><br><span class="line">  <span class="attr">description:</span> <span class="string">我的游戏世界</span></span><br><span class="line">  <span class="attr">tip:</span> <span class="string">跟</span> <span class="string">RE</span> <span class="string">一起探索世界</span></span><br><span class="line">  <span class="attr">top_background:</span> <span class="string">https://th.bing.com/th/id/R.13a97ef4830efa5e0b87134d622719f3?rik=G7RaJFpxg5PtkA&amp;riu=http%3a%2f%2fupload.techweb.com.cn%2fs%2f640%2f2019%2f0530%2f1559208230699.jpg&amp;ehk=j1G8rMX98TRX52EkLgI5jW1p7lIQp4I8Si1nqEggFRs%3d&amp;risl=&amp;pid=ImgRaw&amp;r=0&amp;sres=1&amp;sresct=1</span></span><br><span class="line">  <span class="attr">buttonText:</span> <span class="string">Steam</span></span><br><span class="line">  <span class="attr">buttonLink:</span> <span class="string">https://steamcommunity.com/</span></span><br><span class="line">  <span class="attr">good_games:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">title:</span> <span class="string">风景一绝</span></span><br><span class="line">      <span class="attr">description:</span> <span class="string">不会错过的风景</span></span><br><span class="line">      <span class="attr">games_list:</span></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">怪物猎人：世界</span></span><br><span class="line">          <span class="attr">specification:</span> <span class="string">CAPCOM</span> <span class="string">Co.,</span> <span class="string">Ltd.</span></span><br><span class="line">          <span class="attr">description:</span> <span class="string">&quot;在新建构的「Monster Hunter: World」中, 可以体验到你一直期盼的极致猎人生活。&quot;</span></span><br><span class="line">          <span class="attr">image:</span> <span class="string">https://cdn.max-c.com/heybox/dailynews/img/94376ca41326836587a137d5999733e5.jpg</span></span><br><span class="line">          <span class="attr">link:</span> <span class="string">https://www.xiaoheihe.cn/games/detail/582010</span></span><br><span class="line"></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">title:</span> <span class="string">我的最爱</span></span><br><span class="line">      <span class="attr">description:</span> <span class="string">我不能没有它了</span></span><br><span class="line">      <span class="attr">games_list:</span></span><br><span class="line">        <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">GTA:5</span></span><br><span class="line">          <span class="attr">specification:</span> <span class="string">Rockstar</span> <span class="string">Games</span></span><br><span class="line">          <span class="attr">description:</span> <span class="string">谁还在买GTA5</span></span><br><span class="line">          <span class="attr">image:</span> <span class="string">https://imgheybox.max-c.com/heybox/game/header/271590_dXCCk.jpg</span></span><br><span class="line">          <span class="attr">link:</span> <span class="string">https://www.xiaoheihe.cn/games/detail/271590</span></span><br></pre></td></tr></table></figure><p>新建<code>\themes\anzhiyu\source\css\_page\games.styl</code>文件，内容如下：</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 游戏世界</span></span><br><span class="line"><span class="selector-class">.goodgames-title</span></span><br><span class="line">  <span class="attribute">margin</span>: <span class="number">1rem</span> <span class="number">0</span></span><br><span class="line">  <span class="attribute">line-height</span>: <span class="number">1</span>;</span><br><span class="line"><span class="selector-class">.games-item</span></span><br><span class="line">  <span class="selector-class">.games-item-content</span></span><br><span class="line">    <span class="attribute">display</span>: flex</span><br><span class="line">    <span class="attribute">flex-direction</span>: row</span><br><span class="line">    <span class="attribute">flex-wrap</span>: wrap</span><br><span class="line">    <span class="attribute">margin</span>: <span class="number">0</span> -<span class="number">8px</span></span><br><span class="line">    <span class="selector-class">.games-item-content-item</span></span><br><span class="line">      <span class="attribute">width</span>: <span class="built_in">calc</span>(<span class="number">25%</span> - <span class="number">12px</span>)</span><br><span class="line">      <span class="attribute">border-radius</span>: <span class="number">12px</span></span><br><span class="line">      <span class="attribute">border</span>: <span class="built_in">var</span>(--style-border-always)</span><br><span class="line">      <span class="attribute">overflow</span>: hidden</span><br><span class="line">      <span class="attribute">margin</span>: <span class="number">8px</span> <span class="number">6px</span></span><br><span class="line">      <span class="attribute">background</span>: <span class="built_in">var</span>(--anzhiyu-card-bg)</span><br><span class="line">      <span class="attribute">box-shadow</span>: <span class="built_in">var</span>(--anzhiyu-shadow-border)</span><br><span class="line">      <span class="attribute">min-height</span>: <span class="number">400px</span></span><br><span class="line">      <span class="attribute">position</span>: relative</span><br><span class="line">      +<span class="built_in">maxWidth1200</span>()</span><br><span class="line">        <span class="attribute">width</span>: <span class="built_in">calc</span>(<span class="number">50%</span> - <span class="number">12px</span>)</span><br><span class="line">      +<span class="built_in">maxWidth768</span>()</span><br><span class="line">        <span class="attribute">width</span>: <span class="number">100%</span></span><br><span class="line">      </span><br><span class="line">      <span class="selector-class">.games-item-content-item-info</span></span><br><span class="line">        <span class="attribute">padding</span>: <span class="number">8px</span> <span class="number">16px</span> <span class="number">16px</span> <span class="number">16px</span></span><br><span class="line">        <span class="attribute">margin-top</span>: <span class="number">12px</span></span><br><span class="line"></span><br><span class="line">      <span class="selector-class">.games-item-content-item-name</span></span><br><span class="line">        <span class="attribute">font-size</span>: <span class="number">18px</span></span><br><span class="line">        <span class="attribute">font-weight</span>: bold</span><br><span class="line">        <span class="attribute">line-height</span>: <span class="number">1</span></span><br><span class="line">        <span class="attribute">margin-bottom</span>: <span class="number">8px</span></span><br><span class="line">        <span class="attribute">white-space</span>: nowrap</span><br><span class="line">        <span class="attribute">overflow</span>: visable</span><br><span class="line">        <span class="attribute">text-overflow</span>: ellipsis</span><br><span class="line">        <span class="attribute">width</span>: fit-content</span><br><span class="line">        <span class="attribute">cursor</span> pointer</span><br><span class="line">        <span class="selector-pseudo">&amp;:hover</span></span><br><span class="line">          <span class="attribute">color</span>: <span class="built_in">var</span>(--anzhiyu-main)</span><br><span class="line"></span><br><span class="line">      <span class="selector-class">.games-item-content-item-specification</span></span><br><span class="line">        <span class="attribute">font-size</span>: <span class="number">12px</span></span><br><span class="line">        <span class="attribute">color</span>: <span class="built_in">var</span>(--anzhiyu-secondtext)</span><br><span class="line">        <span class="attribute">line-height</span>: <span class="number">16px</span></span><br><span class="line">        <span class="attribute">margin-bottom</span>: <span class="number">5px</span></span><br><span class="line">        <span class="attribute">white-space</span>: nowrap</span><br><span class="line">        <span class="attribute">overflow</span>: hidden</span><br><span class="line">        <span class="attribute">text-overflow</span>: ellipsis</span><br><span class="line"></span><br><span class="line">      <span class="selector-class">.games-item-content-item-description</span></span><br><span class="line">        <span class="attribute">line-height</span>: <span class="number">20px</span></span><br><span class="line">        <span class="attribute">color</span>: <span class="built_in">var</span>(--anzhiyu-secondtext)</span><br><span class="line">        <span class="attribute">height</span>: <span class="number">60px</span></span><br><span class="line">        <span class="attribute">display</span>: -webkit-box</span><br><span class="line">        <span class="attribute">overflow</span>: hidden</span><br><span class="line">        -webkit-line-clamp: <span class="number">3</span></span><br><span class="line">        -webkit-box-orient: vertical</span><br><span class="line">        <span class="attribute">font-size</span>: <span class="number">14px</span></span><br><span class="line"></span><br><span class="line">      <span class="selector-tag">a</span><span class="selector-class">.games-item-content-item-link</span></span><br><span class="line">        <span class="attribute">font-size</span>: <span class="number">12px</span></span><br><span class="line">        <span class="attribute">background</span>: <span class="built_in">var</span>(--anzhiyu-gray-op)</span><br><span class="line">        <span class="attribute">padding</span>: <span class="number">4px</span> <span class="number">8px</span></span><br><span class="line">        <span class="attribute">border-radius</span>: <span class="number">8px</span></span><br><span class="line">        <span class="attribute">cursor</span>: pointer</span><br><span class="line"></span><br><span class="line">        <span class="selector-pseudo">&amp;:hover</span></span><br><span class="line">          <span class="attribute">background</span>: <span class="built_in">var</span>(--anzhiyu-main)</span><br><span class="line">          <span class="attribute">color</span>: <span class="built_in">var</span>(--anzhiyu-white)</span><br><span class="line"></span><br><span class="line">      <span class="selector-class">.games-item-content-item-cover</span></span><br><span class="line">        <span class="attribute">width</span>: <span class="number">100%</span></span><br><span class="line">        <span class="attribute">height</span>: <span class="number">200px</span></span><br><span class="line">        <span class="attribute">background</span>: <span class="built_in">var</span>(--anzhiyu-secondbg)</span><br><span class="line">        <span class="attribute">display</span>: flex</span><br><span class="line">        <span class="attribute">justify-content</span>: center</span><br><span class="line">        <span class="attribute">align-items</span>: center;</span><br><span class="line"></span><br><span class="line">      <span class="selector-tag">img</span><span class="selector-class">.games-item-content-item-image</span></span><br><span class="line">        <span class="attribute">object-fit</span>: cover</span><br><span class="line">        <span class="attribute">height</span>: <span class="number">100%</span></span><br><span class="line">        <span class="attribute">width</span>: <span class="number">100%</span></span><br><span class="line">       <span class="comment">// border-radius: 0 </span></span><br><span class="line">       <span class="comment">// 若需要去除图片圆角可以将这里的注释去掉</span></span><br><span class="line"></span><br><span class="line">      <span class="selector-class">.games-item-content-item-toolbar</span></span><br><span class="line">        <span class="attribute">display</span>: flex</span><br><span class="line">        <span class="attribute">justify-content</span>: space-between</span><br><span class="line">        <span class="attribute">position</span>: absolute</span><br><span class="line">        <span class="attribute">bottom</span>: <span class="number">12px</span></span><br><span class="line">        <span class="attribute">left</span>: <span class="number">0</span></span><br><span class="line">        <span class="attribute">width</span>: <span class="number">100%</span></span><br><span class="line">        <span class="attribute">padding</span>: <span class="number">0</span> <span class="number">16px</span></span><br><span class="line"></span><br><span class="line"><span class="selector-tag">body</span><span class="selector-attr">[data-type=<span class="string">&quot;games&quot;</span>]</span> <span class="selector-id">#web_bg</span></span><br><span class="line">  <span class="attribute">background</span>: <span class="built_in">var</span>(--anzhiyu-background);</span><br><span class="line"><span class="selector-tag">body</span><span class="selector-attr">[data-type=<span class="string">&quot;games&quot;</span>]</span> <span class="selector-id">#page</span></span><br><span class="line">  <span class="attribute">border</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">box-shadow</span>: none <span class="meta">!important</span>;</span><br><span class="line">  <span class="attribute">padding</span>: <span class="number">0</span> <span class="meta">!important</span>;</span><br><span class="line">  <span class="attribute">background</span>: <span class="number">0</span> <span class="number">0</span> <span class="meta">!important</span>;</span><br><span class="line"><span class="selector-tag">body</span><span class="selector-attr">[data-type=<span class="string">&quot;games&quot;</span>]</span> <span class="selector-id">#page</span> <span class="selector-class">.page-title</span></span><br><span class="line">  <span class="attribute">display</span>: none;</span><br></pre></td></tr></table></figure><h2 id="3-新建页面"><a href="#3-新建页面" class="headerlink" title="3. 新建页面"></a>3. 新建页面</h2><p>用<code>hexo new page games</code>新建<code>[Blogroot]\source\games\index.md</code>文件，并将内容设置为如下样式：</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">---</span><br><span class="line">title: 游戏世界</span><br><span class="line">date: 2024-08-19 21:07:54</span><br><span class="line">type: games</span><br><span class="line">aside: false</span><br><span class="line">comments: true</span><br><span class="line">---</span><br></pre></td></tr></table></figure><h1 id="拓展修改"><a href="#拓展修改" class="headerlink" title="拓展修改"></a>拓展修改</h1><p>按如上步骤修改后，你会发现此时的游戏足迹清单背景只能设置为图片，并不能和我一样设置为视频背景。这就需要额外的修改了，我这里直接改动pug文件，将其设置为如果<code>games.yml</code>中的<code>top_background</code>字段以<code>.mp4</code>结尾，则使用视频背景，否则使用图片背景，如有其他需要，可以尝试自行修改。</p><p>修改<code>[Blogroot]\themes\anzhiyu\layout\includes\page\games.pug</code>文件</p><figure class="highlight diff"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">    each i in site.data.games</span><br><span class="line"><span class="deletion">-     .author-content.author-content-item.GamesPage.single(style = `background: url($&#123;i.top_background&#125;) left 37% / cover no-repeat !important;`)</span></span><br><span class="line"><span class="addition">+     - const hasVideo = i.top_background.endsWith(&#x27;.mp4&#x27;)</span></span><br><span class="line"><span class="addition">+     .author-content.author-content-item.GamesPage.single(style=`padding: $&#123;hasVideo ? &#x27;0&#x27; : &#x27;&#x27;&#125;;`)</span></span><br><span class="line"><span class="addition">+       if hasVideo</span></span><br><span class="line"><span class="addition">+         video.video-source(id=&quot;TopGif&quot; width=&quot;100%&quot; height=&quot;100%&quot; controls</span></span><br><span class="line"><span class="addition">+                            style=&quot;object-fit:cover&quot; webkit-playsinline=&quot;true&quot;</span></span><br><span class="line"><span class="addition">+                            x-webkit-airplay=&quot;true&quot; playsinline=&quot;true&quot;</span></span><br><span class="line"><span class="addition">+                            x5-video-player-type=&quot;h5&quot; x5-video-orientation=&quot;h5&quot;</span></span><br><span class="line"><span class="addition">+                            x5-video-player-fullscreen=&quot;true&quot; preload=&quot;auto&quot;</span></span><br><span class="line"><span class="addition">+                            autoplay loop muted)</span></span><br><span class="line"><span class="addition">+           source(src=i.top_background type=&quot;video/mp4&quot;)</span></span><br><span class="line"><span class="addition">+       else</span></span><br><span class="line"><span class="addition">+         div(style=`background: url($&#123;i.top_background&#125;) left 37% / cover no-repeat !important;`)</span></span><br><span class="line">        .card-content</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Hexo </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 美化 </tag>
            
            <tag> 魔改 </tag>
            
            <tag> AnZhiYu </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>使用第三方托管平台部署博客</title>
      <link href="//posts/39058/"/>
      <url>//posts/39058/</url>
      
        <content type="html"><![CDATA[<h1 id="写在前面"><a href="#写在前面" class="headerlink" title="写在前面"></a>写在前面</h1><p>为了实现Serverless架构，部署博客到第三方托管平台是个不错的选择，同时也可以提升博客访问速度。<br>本文将介绍如何使用GitHub Pages，Vercel，Netlify和Zeabur第三方托管平台部署博客。</p><h1 id="常见托管平台优劣比较"><a href="#常见托管平台优劣比较" class="headerlink" title="常见托管平台优劣比较"></a>常见托管平台优劣比较</h1><table><thead><tr><th align="left">托管网站</th><th align="left">优点</th><th>缺点</th></tr></thead><tbody><tr><td align="left"><a href="https://gitee.com/">Gitee</a></td><td align="left">国内服务，速度可观，部署方式类同GitHub。</td><td>容量小，且对图片滥用管理更加严格，静态页面部署后需要手动刷新。<span class='p yellow'>一般推荐</span></td></tr><tr><td align="left"><a href="https://github.com/">GitHub</a></td><td align="left">Github免费服务，可用Github Action自动部署，操作简单。</td><td>国内访问速度较慢，时常出现超时等情况。<span class='p yellow'>一般推荐</span></td></tr><tr><td align="left"><a href="https://vercel.com/">Vercel</a></td><td align="left">速度较快，支持监测github仓库变动后持续部署，操作简单。<span class='p green'>推荐</span></td><td>近年来IP屡次被墙，需要解析到自定义域名才能正常访问。</td></tr><tr><td align="left"><a href="https://www.netlify.com/">Netlify</a></td><td align="left">速度较快，支持监测github仓库变动后持续部署，操作简单。<span class='p green'>推荐</span></td><td>线路支持不全面，国内部分地区可能依然较慢 。</td></tr><tr><td align="left"><a href="https://zeabur.com/">Zeabur</a></td><td align="left">速度较快，有中文文档，支持监测github仓库变动后持续部署，操作简单。<span class='p yellow'>一般推荐</span></td><td>免费线路只有海外，国内线路需要收费，免费计划环境随时可能会被删除。</td></tr><tr><td align="left"><a href="https://railway.app/">Railway</a></td><td align="left">基于Docker的云原生应用托管平台，同时支持部署数据库和缓存服务。</td><td>仓库管理比较严格，部署镜像站容易被封号，免费额度较小，依靠Docker部署，持续化部署可能会额度不足。 <span class='p yellow'>一般推荐</span></td></tr><tr><td align="left"><a href="https://webify.cloudbase.net/">Webify</a></td><td align="left">腾讯云在关闭coding的静态页面功能后推出的平替产品，背靠大厂好乘凉，速度有保障。</td><td>需要收费。 <span class='p red'>不推荐</span></td></tr></tbody></table><h1 id="部署方法"><a href="#部署方法" class="headerlink" title="部署方法"></a>部署方法</h1><p>近期 Gitee Pages 服务维护中，因此本文不做详细说明。Webify和Railway因为额度问题暂时不考虑使用，同样不做说明。<br>本文将以 GitHub Pages，Vercel，Netlify，Zeabur 四个平台部署博客。</p><div class="tabs" id="部署方法"><ul class="nav-tabs"><button type="button" class="tab  active" data-href="部署方法-1">GitHub Pages</button><button type="button" class="tab " data-href="部署方法-2">Vercel</button><button type="button" class="tab " data-href="部署方法-3">Netlify</button><button type="button" class="tab " data-href="部署方法-4">Zeabur</button></ul><div class="tab-contents"><div class="tab-item-content active" id="部署方法-1"><div class="note info flat"><p>建议使用GitHub Pages部署博客，这样就无需每次再将博客文件上传到GitHub Pages仓库。<br>详见<a href="https://blog.randench.cn/posts/57208/">使用Github Action实现全自动部署</a></p></div><ol><li>注册GitHub账号，并创建一个仓库，仓库名为<code>username.github.io</code>，其中<code>username</code>为你的GitHub用户名。</li><li>将博客<code>[Blogroot]/public/</code>文件夹下所有内容上传至仓库或者使用<a href="https://github.com/hexojs/hexo-deployer-git">hexo-deployer-git</a>插件自动部署，具体步骤可参考<a href="https://hexo.io/zh-cn/docs/github-pages">官方文档</a>。</li><li>访问<code>https://username.github.io</code>即可访问你的博客。</li><li>在<code>[Blogroot]/source/</code>文件夹中新建 <code>CNAME</code> 文件，并将你的域名写入其中，如：<code>blog.example.com</code>，重新上传至仓库。</li><li>在<code>项目-Settings-Pages-Custom domain</code>中绑定自定义域名（此时应已自动填写CNAME文件中的域名），并等待域名解析生效。<br><img src="https://cdn.randench.cn/image/24/08/25bf85559607084a.png" alt="域名解析中"></li><li>访问<code>https://blog.example.com</code>即可访问你的博客。</li></ol></div><div class="tab-item-content" id="部署方法-2"><div class="note info flat"><p>在此步骤前最好先完成GitHub Pages部署博客，这样方便导入项目。</p></div><ol><li>访问<a href="https://vercel.com/">Vercel官网</a>，点击右上角的sign up进行注册（最好直接用Github账号注册，方便导入项目）</li><li>进入到项目管理页面后点击<code>Add New...</code>按钮，选择<code>Project</code>，选择你要部署的博客仓库，点击<code>Import</code>按钮，<code>Framework Preset</code>选择<code>Other</code>，点击<code>Deploy</code>按钮，等待部署完成。<br><img src="https://cdn.randench.cn/image/24/08/fbdcb497a53313e5.png" alt="Vercel项目管理页面"><br><img src="https://cdn.randench.cn/image/24/08/a95d8c626521e9c7.png" alt="Vercel导入项目"><br><img src="https://cdn.randench.cn/image/24/08/8088389925724590.png" alt="Vercel部署项目"></li><li>因为国内Vercel无法访问，需要绑定自定义域名。在<code>项目-Settings-Domains</code>添加自己的域名，然后在运营商处添加<code>CNAME</code>解析记录<code>cname-china.vercel-dns.com.</code>。<br><img src="https://cdn.randench.cn/image/24/08/99bc101a828dc959.png" alt="Vercel绑定域名"></li><li>等到域名解析生效，就可以用自己的域名访问博客了。</li></ol><div class="note info flat"><p>国内访问Vercel速度较慢，解析时可以选用加速DNS，例如<br><code>vercel.cdn.yt-blog.top</code>和<code>cname-china.vercel-dns.com</code></p></div></div><div class="tab-item-content" id="部署方法-3"><div class="note info flat"><p>在此步骤前最好先完成GitHub Pages部署博客，这样方便导入项目。</p></div><ol><li>访问<a href="https://netlify.com/">Netlify官网</a>，点击<code>Sign up</code>进行注册（最好直接用Github账号注册，方便导入项目）</li><li>进入到项目管理页面后点击<code>Add new site-Import an existing project</code>，选择你要部署的博客仓库（这里我直接使用GitHub），选择username.github.io项目导入，<code>Site name</code>按喜好填写，点击<code>Deploy site</code>按钮，等待部署完成。<br><img src="https://cdn.randench.cn/image/24/08/e431e005df3421b5.png" alt="Netlify项目管理页面"><br><img src="https://cdn.randench.cn/image/24/08/e36b740741df0501.png" alt="Netlify导入项目"><br><img src="https://cdn.randench.cn/image/24/08/cc33492bc1a33233.png" alt="Github Pages项目导入"><br><img src="https://cdn.randench.cn/image/24/08/47b2238e96b98b95.png" alt="Netlify部署项目"></li><li>部署完后，在<code>Domain management</code>中绑定自定义域名，点击<code>Save</code>按钮。<br><img src="https://cdn.randench.cn/image/24/08/57569bcef4299e50.png" alt="Netlify绑定域名"></li><li>点击<code>Awaiting External DNS</code>查看需要解析到的网址，在运营商处添加<code>CNAME</code>解析记录<code>[你的网站给出的网址].netlify.app.</code>。<br><img src="https://cdn.randench.cn/image/24/08/f1f954544bfa0719.png" alt="Netlify解析域名"></li><li>等到域名解析生效，就可以用自己的域名访问博客了。</li></ol></div><div class="tab-item-content" id="部署方法-4"><div class="note info flat"><p>在此步骤前最好先完成GitHub Pages部署博客，这样方便导入项目。</p></div><ol><li>访问<a href="https://zeabur.com/">Zeabur官网</a>，点击<code>Get Started</code>进行注册（最好直接用Github账号注册，方便导入项目）</li><li>进入到<a href="https://dash.zeabur.com/projects">项目管理页面</a>后点击<code>创建项目</code>，选择服务地区（免费的只有德国和美国），选择<code>从Github仓库部署</code>，选择你的博客仓库，会自动识别为<code>Static-Hexo</code>，点击部署。<br><img src="https://cdn.randench.cn/image/24/08/05d73987cc68c744.png" alt="Zeabur服务器选择"><br><img src="https://cdn.randench.cn/image/24/08/5c179dec14b4b950.png" alt="Zeabur选择项目"><br><img src="https://cdn.randench.cn/image/24/08/e540aabeae67607f.png" alt="Zeaburi部署项目"></li><li>部署完成找到<code>项目-网络-自定义域名</code>绑定自己的域名，点击<code>Create Domain</code>按钮。<br><img src="https://cdn.randench.cn/image/24/08/d95ac9c01c82f46d.png" alt="Zeabur绑定域名"></li><li>在运营商处添加<code>CNAME</code>解析记录<code>ewr1.cname.zeabur-dns.com.</code>。</li><li>等到域名解析生效，就可以用自己的域名访问博客了。</li></ol></div></div><div class="tab-to-top"><button type="button" aria-label="scroll to top"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i></button></div></div>]]></content>
      
      
      <categories>
          
          <category> Hexo </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 教程 </tag>
            
            <tag> 实用 </tag>
            
            <tag> Serverless </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>在网页上加入自定义徽标</title>
      <link href="//posts/46303/"/>
      <url>//posts/46303/</url>
      
        <content type="html"><![CDATA[<h1 id="写在前面"><a href="#写在前面" class="headerlink" title="写在前面"></a>写在前面</h1><p>本文介绍了如何在网页加入自定义徽标，丰富网站信息。<br>使用 <a href="https://shields.io/">徽标生成网站</a> 生成徽标<br>使用 <a href="https://simpleicons.org/">SimpleIcons</a> 查询图标</p><h1 id="原文出处"><a href="#原文出处" class="headerlink" title="原文出处"></a>原文出处</h1><blockquote><p><a href="https://akilar.top/posts/e87ad7f8/">https://akilar.top/posts/e87ad7f8/</a></p></blockquote><h1 id="效果预览"><a href="#效果预览" class="headerlink" title="效果预览"></a>效果预览</h1><p><img src="https://cdn.randench.cn/image/24/08/d61885292fd8e89c.png" alt="在网页上加入自定义徽标"></p><h1 id="步骤"><a href="#步骤" class="headerlink" title="步骤"></a>步骤</h1><p>直接网址访问填写相关参数即可生成svg图标，基本填写格式为：<br><code>https://img.shields.io/badge/前段文字-后段文字-颜色?style=xxx&amp;logo=xxx</code></p><div class="tabs" id="示例"><ul class="nav-tabs"><button type="button" class="tab  active" data-href="示例-1">参数说明</button><button type="button" class="tab " data-href="示例-2">代码示例</button><button type="button" class="tab " data-href="示例-3">样式预览</button></ul><div class="tab-contents"><div class="tab-item-content active" id="示例-1"><p>仅仅如此肯定是不能令人满意的，还可以继续添加样式。<br><a href="https://shields.io/">shields.io</a>提供直接在URL内添加样式属性的功能。使用<code>?</code>引用，使用<code>&amp;</code>连接各属性。</p><table><thead><tr><th align="center">属性</th><th align="center">说明</th><th align="center">示例</th></tr></thead><tbody><tr><td align="center">style</td><td align="center">徽标样式，默认提供了五种样式： plastic,flat,flat-square, for-the-badge,social</td><td align="center">?style&#x3D;flat-square</td></tr><tr><td align="center">label</td><td align="center">覆盖默认的左侧文本 （空格或特殊字符需要转URL编码！）</td><td align="center">?label&#x3D;healthinesses</td></tr><tr><td align="center">logo</td><td align="center">给左侧标签前插入图标 可以访问<a href="https://simpleicons.org/">simpleicons</a>查询图标</td><td align="center">?logo&#x3D;Hexo</td></tr><tr><td align="center">logo</td><td align="center">自定义图标， 限制较多，不推荐</td><td align="center">?logo&#x3D;data:image&#x2F;png;base64,url</td></tr><tr><td align="center">logoColor</td><td align="center">设置徽标的颜色 （支持十六进制、rgb、 rgba、hsl、hsla 和 css 命名颜色）。 支持命名徽标， 但不支持自定义徽标。</td><td align="center">?logoColor&#x3D;violet</td></tr><tr><td align="center">logoWidth</td><td align="center">给图标提供的水平空间</td><td align="center">?logoWidth&#x3D;40</td></tr><tr><td align="center">link</td><td align="center">徽标指向的链接， 此时需要用object标签 引用才能生效 写法看示例代码</td><td align="center">?link&#x3D;<a href="http://example.com/">http://example.com</a></td></tr><tr><td align="center">labelColor</td><td align="center">左侧部分背景色， （支持十六进制、rgb、 rgba、hsl、hsla 和 css 命名颜色）</td><td align="center">?labelColor&#x3D;abcdef 或者?colorA&#x3D;abcdef</td></tr><tr><td align="center">color</td><td align="center">右侧部分背景色， （支持十六进制、rgb、 rgba、hsl、hsla 和 css 命名颜色）</td><td align="center">?color&#x3D;fedcba或者?colorB&#x3D;fedcba</td></tr></tbody></table></div><div class="tab-item-content" id="示例-2"><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 普通样式 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;https://img.shields.io/badge/Frame-Hexo-blue&quot;</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 五种style预览 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;https://img.shields.io/badge/Frame-Hexo-blue?logo=Hexo&amp;style=plastic&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;https://img.shields.io/badge/Frame-Hexo-blue?logo=Hexo&amp;style=flat&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;https://img.shields.io/badge/Frame-Hexo-blue?logo=Hexo&amp;style=flat-square&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;https://img.shields.io/badge/Frame-Hexo-blue?logo=Hexo&amp;style=for-the-badge&quot;</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;https://img.shields.io/badge/Frame-Hexo-blue?logo=Hexo&amp;style=social&quot;</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 添加图标和自定义label --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;https://img.shields.io/badge/Frame-Hexo-blue?logo=Hexo&amp;label=框架&quot;</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 添加图标和图标宽度 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;https://img.shields.io/badge/Frame-Hexo-blue?logo=Hexo&amp;logoWidth=30&quot;</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 图标、label、message三部分颜色自定义 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;https://img.shields.io/badge/Frame-Hexo-blue?logo=Hexo&amp;label=框架&amp;logoColor=violet&amp;labalColor=#1fd041&amp;color=rgb(222, 31, 31)&quot;</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 给标签添加链接 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">object</span> <span class="attr">data</span>=<span class="string">&quot;https://img.shields.io/badge/Frame-Hexo-blue?logo=Hexo&amp;link=https://hexo.io/&amp;https://hexo.io/zh-cn/docs/&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">object</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!-- 也可以通过嵌套a标签来实现添加链接 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">a</span> <span class="attr">target</span>=<span class="string">&quot;_blank&quot;</span> <span class="attr">href</span>=<span class="string">&quot;https://hexo.io&quot;</span> <span class="attr">title</span>=<span class="string">&quot;框架采用Hexo&quot;</span>&gt;</span><span class="tag">&lt;<span class="name">img</span> <span class="attr">src</span>=<span class="string">&quot;https://img.shields.io/badge/Frame-Hexo-blue&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br></pre></td></tr></table></figure></div><div class="tab-item-content" id="示例-3"><ol><li>普通样式<img no-lazy class="inline" src="https://img.shields.io/badge/Frame-Hexo-blue" style="height:1.5em"/></li><li>五种style预览<img no-lazy class="inline" src="https://img.shields.io/badge/Frame-Hexo-blue?logo=Hexo&style=plastic" style="height:1.5em"/><img no-lazy class="inline" src="https://img.shields.io/badge/Frame-Hexo-blue?logo=Hexo&style=flat" style="height:1.5em"/><img no-lazy class="inline" src="https://img.shields.io/badge/Frame-Hexo-blue?logo=Hexo&style=flat-square" style="height:1.5em"/><img no-lazy class="inline" src="https://img.shields.io/badge/Frame-Hexo-blue?logo=Hexo&style=for-the-badge" style="height:1.5em"/><img no-lazy class="inline" src="https://img.shields.io/badge/Frame-Hexo-blue?logo=Hexo&style=social" style="height:1.5em"/></li><li>添加图标和自定义label<img no-lazy class="inline" src="https://img.shields.io/badge/Frame-Hexo-blue?logo=Hexo&label=框架" style="height:1.5em"/></li><li>添加图标和图标宽度<img no-lazy class="inline" src="https://img.shields.io/badge/Frame-Hexo-blue?logo=Hexo&logoWidth=30" style="height:1.5em"/></li><li>图标、label、message三部分颜色自定义<img no-lazy class="inline" src="https://img.shields.io/badge/Frame-Hexo-blue?logo=Hexo&label=框架&logoColor=violet&labalColor=#1fd041&color=rgb(222" style="height:1.5em"/></li><li>给标签添加链接 <object data="https://img.shields.io/badge/Frame-Hexo-blue?logo=Hexo&link=https://hexo.io/&https://hexo.io/zh-cn/docs/"></object></li><li>用a标签嵌套img标签 <a target="_blank" href="https://hexo.io" title="框架采用Hexo"><img no-lazy class="inline" src="https://img.shields.io/badge/Frame-Hexo-blue" style="height:1.5em"/></a></li></ol></div></div><div class="tab-to-top"><button type="button" aria-label="scroll to top"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i></button></div></div><p>特别的，也支持base64编码的自定义图标和现有的图标<br>可以从 <a href="https://simpleicons.org/">SimpleIcons</a> 查询可以直接使用的图标</p><div class="tabs" id="特例"><ul class="nav-tabs"><button type="button" class="tab  active" data-href="特例-1">Github徽标</button><button type="button" class="tab " data-href="特例-2">Vercel徽标</button><button type="button" class="tab " data-href="特例-3">Netlify徽标</button></ul><div class="tab-contents"><div class="tab-item-content active" id="特例-1"><img no-lazy class="inline" src="https://cdn.randench.cn/image/24/08/3f9b026530152ee9.svg" style="height:1.5em"/><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://img.shields.io/badge/Source-Github-d021d6?style=flat&amp;logo=github</span><br></pre></td></tr></table></figure></div><div class="tab-item-content" id="特例-2"><img no-lazy class="inline" src="https://cdn.randench.cn/image/24/08/6c6d122ddceab247.svg" style="height:1.5em"/><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://img.shields.io/badge/Source-Vercel-purple?style=flat&amp;logo=vercel</span><br></pre></td></tr></table></figure></div><div class="tab-item-content" id="特例-3"><img no-lazy class="inline" src="https://cdn.randench.cn/image/24/08/77bf25d8f59c2837.svg" style="height:1.5em"/><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://img.shields.io/badge/Source-Netlify-GREEN?style=flat&amp;logo=netlify</span><br></pre></td></tr></table></figure></div></div><div class="tab-to-top"><button type="button" aria-label="scroll to top"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i></button></div></div><div class="tabs" id="base64"><ul class="nav-tabs"><button type="button" class="tab  active" data-href="base64-1">ICP备案徽标</button><button type="button" class="tab " data-href="base64-2">萌ICP备案徽标</button><button type="button" class="tab " data-href="base64-3">又拍云CDN徽标</button><button type="button" class="tab " data-href="base64-4">Zeabur徽标</button></ul><div class="tab-contents"><div class="tab-item-content active" id="base64-1"><img no-lazy class="inline" src="https://cdn.randench.cn/image/24/08/d00470983c906bab.svg" style="height:1.5em"/><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://img.shields.io/badge/苏ICP备-2024064902号-e1d492?style=flat&amp;logo=data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAdCAYAAAC9pNwMAAABS2lUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4KPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNS42LWMxNDIgNzkuMTYwOTI0LCAyMDE3LzA3LzEzLTAxOjA2OjM5ICAgICAgICAiPgogPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4KICA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIi8+CiA8L3JkZjpSREY+CjwveDp4bXBtZXRhPgo8P3hwYWNrZXQgZW5kPSJyIj8+nhxg7wAACNlJREFUSInF1mmMVeUdx/Hv2e+5+519mJWBYQZkGxZZxLKJqBXGoLS1iXWrmihotFXaJiTWWlsbl6q1aetWd5u0VkKjNG4YEJSlOCibDLMwM8x679z9nnPP1jcVJUxf+7z6J8+LT37/Z4VvaQhfFS8+sBXbctCDGrVTKlBUH4mxAbI9Hfj0IJLsp6paJ5/tmn20N/D0wKDRMq9F/c3M2U1/V0vDfWMFh+tv/Ig1zYPMabDImPJ52OaXO87W580KggCiiOsJOJ6I3wcNFaaeNKxrt72f2fLGu4FpJ/sDQABRzD22fH7/Yze069vGc6mrDLNIJCDik10sxz2by3VdPM87xzkP9jwPTZFRVI1YUJKH+oy7n3tbvv/P2wW/UQxRWe6w4ZJRptYLHDoCuz8v5cP92XbI762O+h6UVWHnUFbPpU0fEb2A60mMJ7MUi9b/b7UgKhiZMaIxm8YLplLMDPz8hl/EH+rs8TNlUpFf32uyZJGLPDwCiTGUyTWodTN49eUCdz2YwXb9NNcObp1X98WDoufynzMVCEKGn27ayPTWBi5ad8P5iQUkJEnFLjqM9Z+hrVX0vfDe6K2dPRWsW2bwyp9EUifSJB84gdxrkR0eRgv1o/3I4fbbprJ6scqamzVO9pffec1S5ZWY2Nfz5qEy/FqOC2Y3s3j53HMSi18VRjFPwSwg+1RfVbl115vvJrsfej7UGIsYPPGgQ7JXoO+Xx5B3dHEomyJ9x1qiQozkr95h5937aFnVyouPlgJK+Ss7Fxz64OTSxSX+LHYxT2IsRW5kbGI4oHcR0jqoqTjV9se3I7/f8rS/ClS23GxSXhph6L5d9Akm7qqZhHWBQGUJ+CWGFzcg7e7m6D3/ZuW1Ea5YKdA3EojuONi813TqNi+YPYOKUhXDtCeGL26/hakLLiEcdsaHRkRAoLRc4fJrmhnekyF0apgZowWSwwkaa+rw3f8WA1GZZsPP5JEChX8dhZTN6iU6kAcs5s+dHd183SJ0VVKL57pfw6YdRQw23aeWTns47DPTALWlRTR7kMLew6hGgYqUhWXYFFUdPZ6lUBahLA8hVcOftckfi7No7VRAAQqsX1dybfvG1qwriM9mM5mJ4e4jO5Cc01dPqixbr8tWGBQUL4vjGigEEShi+xUmZ2RiR/sJ1pbS8NkgZrKAGw0TsgQsQyFaF/nfYTGprAlMFysbA1pI3mhkR6snhGsaymYGvPyFEb9IdbUE2AzFFTwpRqCtBY0wmdER+hZW4j63gcJj38V+/ErSUZXsYBfjIZHIRW0c2Z8BskCAqN+CbBJBFnyyKjR+Ez57nBxLqpfMUeSISElMBFz6x2Q6OxzWrYjyxWVzEewioU3LCS5vQY6nMUrLwNaxXvoQ59IloFSx54PPAZtQLExVZZDxsVE8J4dn6v4JYatgbSjk0owPw7RGH2ADMo88Z7L20ip8f7gC7fAo0q4+0rt7kEQDvaghVZbiPHUHcyeXcfLjT3jmpR7AYsnSScya3UR8bARVMck7Y/cB75/X6rDf3Fg2dw2jKZm5dXGm1LuAzO5DCo9v6aT0ibco5kzOvLOP+NGTFJtDpPYeZKijk/Rn3QxsfZV7txwhX7ABiZUXBsGvIvguQApNQQva9RMmTvZ2dpVUls+tX/UD7GN/Y8Ws05w6rQF+9vyzg1vZjbvMRJhXiRSU8DpTFFe0QE8S6SfPkOkZoktrB2oAhZWrwljxOPmchiSMYOWNoxNuruFU5vWeXdsojiUon345113dBBQBmTYlTimgdB8nfPo4WjaNFgN9OMEkJ02dnadVt5ki54Esqy+bzKJltVhSPbI3iN2zCyMTeXNCuG7Omm2Zok7PR2+R7jvD8ouruHhmCrB5jVZeYxLdrTP4sr4Vtd9g4MA4qc4c+6cu5NPamfw4P59t2WrA4YdXKkASf7SFivo6PDdEPmf1fRM++zp1bH/0r4I1dD1ODtOWaW4IsvPjL7nqXhloQiSPwjjgMYkMASyGEBkjhISCQwkwzve/18AbT+pk8pVY4UacQi9y+gyZ0eRAw4qHa89LXEx1LXMSPfhDJYRb59BtlLKg2WPT2l6qYl1svtGkrLYckyA1S+t5+2ATm37WCui0LSynsckDNH5zTxAchbQtkx08hDHYiW6NgC0enHBzEZ102UDH8QORdEckjEzZrNWkRydzyx17uGnDXqbUnGZ6dRPjSY91q2TqwjFuvTxLo5Zn5Qo/pumRSFcTLQtybEhGE0fQrDhhJ0VvH2lTnnHPhGtsmWan469apERjI2MH3qN7+7MEfH6ql29CbV7PvsMG32k6yU2XDhEKyZw66eJaRdrXR7CzCcqUNC3zwgymPJRCH4KRRLINimpL14A5Y4GDeOqbsPRVcfuN7Xj44pav/hFfrNT2kr2rsqf2Ibp5pEA14ZIImUyW3t5REkkTXRGQ/DGGhtLginhqCWknQDE5hKf5UFSF9Lj020Q2ul5V1AR2hr+8vuP8Vlc2zMPRxoSjnx7XBC14sDoydahSGq7KdO/HFyrBchxCVfX4fDKp4T7SCQejYODZLrYgIqgKFsNIgQqEYob8mW6yiUyb7Z64LVK/+B85xznnJ3AWzqTzuIX46mr5wLs+UUTyIriBCjRNxguHMJIFDLEEvXEOVRWnSJ0+jCd4CJoGjoedM1CLcXQziW3nMV2TSMBeOx7vWZvPt1r+cMPzE8KunaUkFn0vNrvtqXj34c1W6gzxlEQ6naIoBahtnkMwoFMwIVzSRNguMt53Aj2s4nkSlgPoGqLkICsRNF0gl8rYWuP8+11/w/OOJDEhHPKLCIpOXmi+M9AgP+maiesLifF2T1Rn5ZNj5Lo/Qc/GcPMmhdoqlEgIGzCK4PiCmJKK68p4KfF3qYGuF0qCRUkJTzleUbvQyWRTuE5xYthxQbBs7EISAbkzUFG3VfXXbK2YFi3X/eryfKKnqVBItNjJxDzH8erddC4SqWwcN5WyTtlyO1RP/Lh3eHD76MB40swmiDVJyDLYRhpc5+ub6tse/wWKbvSQEAw1awAAAABJRU5ErkJggg==</span><br></pre></td></tr></table></figure></div><div class="tab-item-content" id="base64-2"><img no-lazy class="inline" src="https://cdn.randench.cn/image/24/08/47cf4d14ead2d03f.svg" style="height:1.5em"/><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://img.shields.io/badge/%E8%90%8CICP%E5%A4%87-20249022-fe1384?style-flat&amp;logo=data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAABS2lUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4KPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNS42LWMxNDIgNzkuMTYwOTI0LCAyMDE3LzA3LzEzLTAxOjA2OjM5ICAgICAgICAiPgogPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4KICA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIi8+CiA8L3JkZjpSREY+CjwveDp4bXBtZXRhPgo8P3hwYWNrZXQgZW5kPSJyIj8+nhxg7wAAByxJREFUSInl1nlwVeUZx/HPuTckkD0kQFiCEEIUlNUCAqKoSBV1AIt1ikpVLFbLONjWGUXbmWrbweJMy7hUxbbTjsUq6KCiWEvr0kE2WVK2QCKBJCxJgEASsienfxwqMob+3Zm+f93z3vM+32f5vc9z+H9bwVcfOp/YQ+1prhhEZS1VDQzqQ1MjiQmIC5Liwm3lBWpqFimrulb/7A/067vM2IsOBZ2h8MhJQW6KMDNVsKeaizKEyUlsKueqgWJ39AMJF3QpDCNYr1SaEig/lWNX2Z1h6dH5/lVyGdVIZFf7MHo9bEfh9rCg/+8NyHlN77QTsnpQ0i2y08VK+BosfhbW0cHxqmSfFd9qW+l9Pi+5WltFdGTsOBbO5dJcdh3lN5+xff0Y2zuelXjRsyYUrjOu4BVJaavlpbWIJRBLOM+J81O95AAnTtM9vNHGknut3zdT48FutJE3koWTuG4oSXH+VsInX3B9IdcVUNfCuv08t4GjO6NspOa3BNcOXx1eOugVHQnrTMkTuyWrC/BjRZO9uPYTpw7HhTWkXcLd45l9GblpHD7NWzt5ZTMXZ/OdkTy+lvR07rmcmWffq6pn9W5e/oymfcT6kJbXHiydMyVYkL/x66n+ZMcctQfjhgxl6UIGZ3Ooltd2RIZqjqKRS0ew9cFIA1cO5urlLHuPZWsZPJiZw7gqn0VT2HCIR9+jvCQhfHPrLGyE2Hng2roBxHnmJoZnc9drbD3I6QaaWkjpSVoeu4+x5XB05qMDqCenHz37UHmcFRv54ZuMeoYrB/L0DPRgZ0WfrsXVKzPX3nYykrn3dUZl8+Q0Qox/gc/L6ZlKzxQefo+UROpa6Z4VCedkPd8YyJYHI3u5T/HAShZNQxsXZfR3pCtwRW066VEeOuIUVUf77+9jTw2pycTOJml7Je1t9EgiI5X2jkgyze1fCSSdtjhBiJCkpKyuI+5oTdAtkTCgVwrbKsl8ko6QjO40tZ67EpkpdIbRf20dkbPpPTjdwsSX6I5dJYy4hoQAaZQdDy4A1iEMI613T6LtBPXJpPakrjGqc1Y6CTFq62htJp5KRwPJKWSkU3WKiiPEEqO6xgM6oZmctJhDXYH7Z59xuCyKpK6R26ZE+ys3MWYoN1/Mc5uoqmbEQJ6fTc/ulJ3i/lUc+YIfzeKhKzjVHN31A3XRHddKSrf6/6DOV3VTcw1hVKfkxOhaPDAe1UwfwmNTqT1Drxw+nE9xNXetIjHG2vnoxoT+rNrN2Of58Rp6JZ+ldKes5kjX4G7dKuikpoERfaltYnQ/DOSS3hEAFk9lXQkLnmf7Ib65lPJT3HU1+46Tm8rYvgzKYVA2h+vQIMjvewHwdSN20MiOSmZczO4a1hSzYi77T7CiiPF5JMTZexjJ5OagkwNV9M+MnJ09nKU3smgyQ3PYWoEO4fUjii4QceJmevJuMeP6csUAln4atcbSGoqOUpjD30uZNwnpHNtN3lC+NZa1xeT34pGVTJ3PL9+Ohs6GQ8gVtHZs6VLVwZhBReGwoXvt3THM/hP0SWVnCR8f4PMjkffjB/DQS8waxpHFfFgaaeHZDRRtJn0yP5tF31ymFVJ2nN27GD66KBzca2/XEWdkUpD3Fmd4tYj0FMS54Q9UnuaDUv6yE/24ewWP/DU6N/d1fvousYEs28DyLVEvGDOAt/egmSkXv2VYn3NBfpXbua6J8hMFFvy2RHsL+57gmX+w/AN651PfEDWQzLRI+afqIqOxFDJT6Rbn9Bmad3PnTH5wIxOXkJTWGiz57hCDsyqDWVldRNzeyOh+paaPfpFKnvqQX88iZwDVx0lLJqUHbe3EkZ1Odm+yUqK2GHYKmhvIG8fyeTz9IY5x67jnFPapdPDkl6jzwEF9IDjZJlgwfbG+o2u8+g4rd7D/UYI41TXnevV5K4j2q6uESckUP8rvNrH6fUH/sRXB9AlPONMSDZ8uazwoi56JjEyvdftV88jinhf4uIzmJRQOoOYgja0RKAiIBZxpjvZH5tP0c97axcLlyBXOuWZemJTYFFbUCU+1dl3j8PGSyFhnJ7EkYcWh7/njqpep5xfzWTyZZ7dEg73xOJKiGqf3YenNLBjLTz7i539COg/OvSOYO2GFo/VRG0Zwe0YX4Ns3R7NXSCxBeM8IthXfZvGf3xCWc/kkXvg2vVP4YB/rDzC1gGlDo+50/xvs2khKPrNnzAzmTH5HbzR0fkkKro93Ab5vx9kfaGgT3lLA5EyWbRpoTdHbSreOppGJV/PwlRTksK+aZz5l6z+RLBgxaau5k2cJelTKzmRQMq0d51J8UxL+23d1TDTcj7WQllZu4YwxDo+eZc22X9mwd6gN65GIFmQzampxcMOoR1xeuMbpVoqromsXdG3+wmCiekNtfSSmiUNWu2zgap+WjlZW8X11TeNkpWwICvNfCm8u3Cmxg4PN0VdmEJw7/7+0/g32RaqCbhRecAAAAABJRU5ErkJggg==</span><br></pre></td></tr></table></figure></div><div class="tab-item-content" id="base64-3"><img no-lazy class="inline" src="https://cdn.randench.cn/image/24/08/952c4f1a40da39dc.svg" style="height:1.5em"/><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://img.shields.io/badge/CDN-%E5%8F%88%E6%8B%8D%E4%BA%91-00b6ff?style=flat&amp;logo=data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAB4AAAAeCAYAAAA7MK6iAAABS2lUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4KPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNS42LWMxNDIgNzkuMTYwOTI0LCAyMDE3LzA3LzEzLTAxOjA2OjM5ICAgICAgICAiPgogPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4KICA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIi8+CiA8L3JkZjpSREY+CjwveDp4bXBtZXRhPgo8P3hwYWNrZXQgZW5kPSJyIj8+nhxg7wAABs1JREFUSInllv2PVFcZxz/n3LfZmdmd3ZndZWGhhV0qYLaFEgzQpog12tZYbVRCSa00mLap6Q+aNERp5QcVlRhi0GjaGElromI08aU1tMRXWmspRaEVbIDtdimwy77M7uy83Xvn3nP84c7b7oD/QE8yyT13znO/z/f7nOcF3m9L1B4OnNYYEoSG165kGZkukLLjdEmXiew4yum7+4qK31u2rduLFXOgEEoQCrQs9RjepaW2f35Nu/9QqRh4Fi4jrkHCMmhTitlCBcOIoP768CoAzGt5owFLQBKfad/Yflau+Mo4qY0IE8qAUbXUgKT9ctFZVJAzqzcivLN+/JGY0H6HKD0riKGvw7gFWAFtUmMTyFPF5C+Gded2LBmBaB2BAigRyeMJ0jGPgxtiyX+MtW18/ZL1DLEMK/TER9eb+Z2GQGU1CK0b8gKy9uCYYJmQcUCgUm+U0qeGw/R2pIwAdbPvAiE0aAGux0MDc7eJAJ57V7+GZYAQjLDo8yd0z6lAqQ5bBbh+iF8JWxmP5XwSJrhCyz9NJU7mdHwwknOBWEKAAq0EuIrPrKp8d3lb+M/HT/qvlsN2pKNRSoDUXAxSN+eKlWMPD7jrFi3pZc4NeHUh4+zcNMW5q/z47dLhi4X4IHYt2hFDBBFDpUmYJXoNb+y23tzPHlgRfu2F8bZ9s4W2zdgSpap2OopbzsysPUHX85YIcdU1YnxLX5pT0+59w+X4NqwmpgIIgUCxNF4+vsaY2bsknjtq+yYTnsGhMx33H8127SFp03KTBBAT/H3U+qTIZe9ambFfagHOl0OOjJs/wjCZdwtCARI2d899Z0iP7Rkv2J0ngu49xUCvu1R2+sJS6g4MAyF11deasY5+CjBs3jE6f3KrMXlDC/Cfr0xuuegtWYIpmjwXUA7YcbP69tb2ypPfO5naPyJ7d4fKioLUDihdVxZEpI4ApGiEyoKLM8aydyx5J/CXeTE+m5PbkFZV4qpBoPlAJnh7R7rw5G8vm9+/4PfvDg0rSiMdgYraeQ0xGVZu78o9tSUx9ViK0pUGc0CbTNtdu1oYG7Geu+vFAaLbqz0+3B1sf2WKnhcvJ79MvCn21JiKiGIAt6amn9scK+4brpiskOHMKRU/jCSS2xG8ddVbVcOrM54KrBvqoERyO4YqLTaKb76ct7+JtufHfuEyYKIkeoKKpN12ySs1QF28qkJmrL8FuBwqv7HTEELC4b/Fks/EjPgcDq05TeO8EJrhSten35KLDjpmhfd8/QBNYY6clp0twC1LAmGQLJdyCF08gub/MtYCECZni+JBTyYwrKS7ML2UbrxplEwpHeoJHkk9IPO/z3QluKen/GC/MXuM8PrIQkc3+sY298hAwsIQbSvnAWuwpSq3AGesyhhh08EwZKBdHi+EDjEkyxLBm9dtNYjqXx5DTnHvsCeXFCoi1fh6VPEsEYy3ACf1zN9qlRE0whAcdzM/GCk5Hz+W1dv+U0jubFy+aqdpFsCD9en8r4ba9fDLU6mfI8wo7Zqc65Ccru3q6dQtC79EVb6AUc1lQzJakP2jOvUSZrqKUgu0QMvqNgBkyOpk7ndfXKruP+11Pf5uwdgqHYWqHwIIGTTLh88tBN7a3/3i+VF/ZtyzujAFut57a0d0A1sDpdzoUkfMdCTNs4Pm3MG1nfL1Fy7bjxwtxn6IXfOzauNDZ6w8u67Pf/7IQuDB3hSfCMtPHDoX/hTDaJKxXgzR1ca/PjnzxOL47IGgXOYG2+U9f/Gyw1Op31yYsz6LKcEEpZryyPe5d1B+dWnf4rrwdeATo+P0yfBQr53cOVHp2oIjWpo/LgwlZp/etdo78MeJ9DeO5cUmM+fflNcdy9E2ONGkoWvZIQSUFGt63ZNb+hPPzPr1S9KUTlYndizDl1Zan+qOlXNUqobVD2gPMubcyP4PlR57Ix979MhI+9fLRsfH8qJ7OYYNhkZo1dRfNATQ3ebmdq2073KFQTmgFfjG7jjprjgrMsncPb2FDXEKkwRV8BCEGbD7g2LNmdnYwLPn257Gro6kNMaixlQlwJckVXbyvszsBseJTU+VqA4JC4DdisavwNUy2Ia4sCk5OdRvzLxCBXAVj64NdvTGtbf337ETaBvMa3V9EQ2BFbgpkf/XnbHpIUuHF2YrYMqGgPNi3OxJIZQgjYmNidIdYwHfyjpZ3ZGtHN6fXXbOVfE0MebncHXMAUiL4uRHlpQP3pJW+04OC3KhST+tw8k152oJeEpQNGxWx0tP+WGeK0Xbcb3SWCYpTS80ul0lECi0EF6n8LNJOzjThvuHobj/603dTnFcORQDQcf1y937bP0Pc6b8FW3Czt0AAAAASUVORK5CYII=</span><br></pre></td></tr></table></figure></div><div class="tab-item-content" id="base64-4"><img no-lazy class="inline" src="https://cdn.randench.cn/image/24/08/6b5d5d9ee6f7c595.svg" style="height:1.5em"/><figure class="highlight text"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://img.shields.io/badge/Source-Netlify-GREEN?style=flat&amp;logo=data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIzMS4yMjkiIGhlaWdodD0iMjQuNDAzIiB2aWV3Qm94PSIwIDAgMzEuMjI5IDI0LjQwMyI+IDxnIGlkPSJHcm91cF8zNzE2IiBkYXRhLW5hbWU9Ikdyb3VwIDM3MTYiIHRyYW5zZm9ybT0idHJhbnNsYXRlKC0yODkuNzQxIC0xMzEuOTYpIj48ZyBpZD0iR3JvdXBfMSIgZGF0YS1uYW1lPSJHcm91cCAxIiB0cmFuc2Zvcm09InRyYW5zbGF0ZSgyODkuNzQxIDEzMS45NikiPjxwYXRoIGlkPSJQYXRoXzEiIGRhdGEtbmFtZT0iUGF0aCAxIiBkPSJNMzAxLjg3NSwxNTEuODQ4aDE5LjF2OC45NjNIMjg5Ljc0MXYtOC45NjNoOC43NzlsMTIuMDg3LTYuNDc3SDI4OS43NDF2LTguOTYzaDMxLjIyOXY4Ljk2M1oiIHRyYW5zZm9ybT0idHJhbnNsYXRlKC0yODkuNzQxIC0xMzYuNDA4KSIgZmlsbD0iI2ZmZiIvPjxyZWN0IGlkPSJSZWN0YW5nbGVfMSIgZGF0YS1uYW1lPSJSZWN0YW5nbGUgMSIgd2lkdGg9IjIwLjc2MSIgaGVpZ2h0PSI4Ljk2MyIgZmlsbD0iIzYzMDBmZiIvPjxyZWN0IGlkPSJSZWN0YW5nbGVfMiIgZGF0YS1uYW1lPSJSZWN0YW5nbGUgMiIgd2lkdGg9IjE4Ljk5OSIgaGVpZ2h0PSI4Ljk2MyIgdHJhbnNmb3JtPSJ0cmFuc2xhdGUoMTIuMjMxIDE1LjQ0KSIgZmlsbD0iI2Y0MCIvPjwvZz48L2c+PC9zdmc+</span><br></pre></td></tr></table></figure></div></div><div class="tab-to-top"><button type="button" aria-label="scroll to top"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i></button></div></div>]]></content>
      
      
      <categories>
          
          <category> Hexo </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 美化 </tag>
            
            <tag> 魔改 </tag>
            
            <tag> AnZhiYu </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>如何在maven中添加自动混淆</title>
      <link href="//posts/2739/"/>
      <url>//posts/2739/</url>
      
        <content type="html"><![CDATA[<h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>最近在项目中使用了allatori进行代码混淆，但是每次打包完jar文件后还需要手动混淆，这让我很不爽，所以想着能不能在maven中自动进行代码混淆，直接打包出混淆后的jar文件。</p><h1 id="步骤"><a href="#步骤" class="headerlink" title="步骤"></a>步骤</h1><h2 id="1-下载allatori混淆器，并解压到工作目录"><a href="#1-下载allatori混淆器，并解压到工作目录" class="headerlink" title="1. 下载allatori混淆器，并解压到工作目录"></a>1. 下载allatori混淆器，并解压到工作目录</h2><blockquote><p>下载地址：<a href="https://www.allatori.com/">https://www.allatori.com/</a></p></blockquote><p>将其解压并放到工作目录，例如我将下载好的allatori.jar解压到放到了<code>[root]\allatori\lib</code>目录下。<br>然后在<code>[root]\allatori\</code>目录下创建<code>allatori.xml</code>配置文件，具体内容可以查看其官方文档结合你的项目情况进行配置。</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">config</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">input</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">jar</span> <span class="attr">in</span>=<span class="string">&quot;xxx-origin.jar&quot;</span> <span class="attr">out</span>=<span class="string">&quot;xxx-obfuscated.jar&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">input</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">ignore-classes</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--不混淆 引入的第三方jar包--&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">class</span> <span class="attr">template</span>=<span class="string">&quot;class *org*&quot;</span> /&gt;</span></span><br><span class="line"><span class="comment">&lt;!--不混淆的类--&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">class</span> <span class="attr">template</span>=<span class="string">&quot;class com.*&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">ignore-classes</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!-- 保存类名字--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">keep-names</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">class</span> <span class="attr">template</span>=<span class="string">&quot;class *&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">keep-names</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;log-file&quot;</span> <span class="attr">value</span>=<span class="string">&quot;log.xml&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;classes-naming&quot;</span> <span class="attr">value</span>=<span class="string">&quot;custom(configuration/ClassNaming.txt)&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;methods-naming&quot;</span> <span class="attr">value</span>=<span class="string">&quot;custom(configuration/MethodNaming.txt)&quot;</span>/&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">property</span> <span class="attr">name</span>=<span class="string">&quot;packages-naming&quot;</span> <span class="attr">value</span>=<span class="string">&quot;custom(configuration/PackageNaming.txt)&quot;</span> /&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">config</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="2-修改pom-xml文件"><a href="#2-修改pom-xml文件" class="headerlink" title="2. 修改pom.xml文件"></a>2. 修改pom.xml文件</h2><p>1.在项目信息中插入<code>name</code></p><figure class="highlight diff"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">    &lt;groupId&gt;xxx.xxx&lt;/groupId&gt;</span><br><span class="line">    &lt;artifactId&gt;xxx&lt;/artifactId&gt;</span><br><span class="line">    &lt;version&gt;V0.x.x&lt;/version&gt;</span><br><span class="line"><span class="addition">+   &lt;name&gt;xxx&lt;/name&gt;</span></span><br></pre></td></tr></table></figure><ol start="2"><li>在<code>properties</code>·标签下添加<code>customArtifactFile</code></li></ol><figure class="highlight diff"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">    &lt;properties&gt;</span><br><span class="line">        &lt;maven.compiler.source&gt;8&lt;/maven.compiler.source&gt;</span><br><span class="line">        &lt;maven.compiler.target&gt;8&lt;/maven.compiler.target&gt;</span><br><span class="line">        &lt;project.build.sourceEncoding&gt;UTF-8&lt;/project.build.sourceEncoding&gt;</span><br><span class="line"><span class="addition">+       &lt;customArtifactFile&gt;$&#123;project.build.directory&#125;/$&#123;project.name&#125;-$&#123;project.version&#125;-origin.jar&lt;/customArtifactFile&gt;</span></span><br><span class="line">    &lt;/properties&gt;</span><br></pre></td></tr></table></figure><ol start="3"><li>在<code>plugin</code>标签下添加插件，此处为了便于阅读，我去除了缩进，实际使用时请保持一致。</li></ol><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- 移动文件到target目录 --&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">plugin</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.apache.maven.plugins<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>maven-resources-plugin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>2.6<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">executions</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">execution</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">id</span>&gt;</span>copy-and-filter-allatori-config<span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">phase</span>&gt;</span>package<span class="tag">&lt;/<span class="name">phase</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">goals</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">goal</span>&gt;</span>copy-resources<span class="tag">&lt;/<span class="name">goal</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">goals</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">outputDirectory</span>&gt;</span>$&#123;basedir&#125;/target<span class="tag">&lt;/<span class="name">outputDirectory</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">resources</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">resource</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">directory</span>&gt;</span>allatori<span class="tag">&lt;/<span class="name">directory</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">includes</span>&gt;</span></span><br><span class="line">                            <span class="tag">&lt;<span class="name">include</span>&gt;</span>allatori.xml<span class="tag">&lt;/<span class="name">include</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;/<span class="name">includes</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">filtering</span>&gt;</span>true<span class="tag">&lt;/<span class="name">filtering</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;/<span class="name">resource</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">resources</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">execution</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- 这里我用文件夹存放了混淆类名、方法名、包名配置文件，所以需要再移动文件夹到目标目录，若不需要可以删除 --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">execution</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">id</span>&gt;</span>copy-and-filter-allatori-folder<span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">phase</span>&gt;</span>package<span class="tag">&lt;/<span class="name">phase</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">goals</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">goal</span>&gt;</span>copy-resources<span class="tag">&lt;/<span class="name">goal</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">goals</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">outputDirectory</span>&gt;</span>$&#123;basedir&#125;/target/configuration<span class="tag">&lt;/<span class="name">outputDirectory</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">resources</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">resource</span>&gt;</span></span><br><span class="line">                        <span class="tag">&lt;<span class="name">directory</span>&gt;</span>allatori/configuration<span class="tag">&lt;/<span class="name">directory</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;/<span class="name">resource</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">resources</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">execution</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">executions</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">plugin</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.codehaus.mojo<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>exec-maven-plugin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.2.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">executions</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- Run Allatori --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">execution</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">id</span>&gt;</span>run-allatori<span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">phase</span>&gt;</span>package<span class="tag">&lt;/<span class="name">phase</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">goals</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">goal</span>&gt;</span>exec<span class="tag">&lt;/<span class="name">goal</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">goals</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">executable</span>&gt;</span>java<span class="tag">&lt;/<span class="name">executable</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">arguments</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">argument</span>&gt;</span>-Xms128m<span class="tag">&lt;/<span class="name">argument</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">argument</span>&gt;</span>-Xmx512m<span class="tag">&lt;/<span class="name">argument</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">argument</span>&gt;</span>-jar<span class="tag">&lt;/<span class="name">argument</span>&gt;</span></span><br><span class="line">                        <span class="comment">&lt;!-- 这里需要修改为你下载的allatori.jar路径 --&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">argument</span>&gt;</span>allatori/lib/allatori.jar<span class="tag">&lt;/<span class="name">argument</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">argument</span>&gt;</span>$&#123;basedir&#125;/target/allatori.xml<span class="tag">&lt;/<span class="name">argument</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">arguments</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">execution</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">executions</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br></pre></td></tr></table></figure><h2 id="3-打包"><a href="#3-打包" class="headerlink" title="3. 打包"></a>3. 打包</h2><p>执行<code>mvn clean package</code>命令，即可完成打包，打包后的jar文件会自动进行混淆，最终会生成一个未混淆的jar文件和成一个混淆后的jar文件，命名规则为<code>xxx-version-origin.jar</code>和<code>xxx-version-obfuscated.jar</code>。</p><h2 id="4-补充说明"><a href="#4-补充说明" class="headerlink" title="4. 补充说明"></a>4. 补充说明</h2><p>allatori混淆后的jar文件用压缩工具打开后，会发现有压缩文件注释中有一行<code>This file is obfuscated by Allatori Obfuscator</code>，这行注释是混淆器的标识，可以用来判断混淆后的文件是否正确。<br>如果想删除混淆器标识，可以使用压缩工具的压缩选项，将<code>This file is obfuscated by Allatori Obfuscator</code>这一行注释去除即可。或者我直接写了一个<a href="https://cloud.randench.cn/f/x3hd/CommentRemover.jar">CommentRemover.jar</a>用于删除注释，直接在maven中使用即可。</p><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">plugin</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">groupId</span>&gt;</span>org.codehaus.mojo<span class="tag">&lt;/<span class="name">groupId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">artifactId</span>&gt;</span>exec-maven-plugin<span class="tag">&lt;/<span class="name">artifactId</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">version</span>&gt;</span>1.2.1<span class="tag">&lt;/<span class="name">version</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">executions</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- Run Allatori --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">execution</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">id</span>&gt;</span>run-allatori<span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">phase</span>&gt;</span>package<span class="tag">&lt;/<span class="name">phase</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">goals</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">goal</span>&gt;</span>exec<span class="tag">&lt;/<span class="name">goal</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">goals</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">executable</span>&gt;</span>java<span class="tag">&lt;/<span class="name">executable</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">arguments</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">argument</span>&gt;</span>-Xms128m<span class="tag">&lt;/<span class="name">argument</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">argument</span>&gt;</span>-Xmx512m<span class="tag">&lt;/<span class="name">argument</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">argument</span>&gt;</span>-jar<span class="tag">&lt;/<span class="name">argument</span>&gt;</span></span><br><span class="line">                        <span class="comment">&lt;!-- 这里需要修改为你下载的allatori.jar路径 --&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">argument</span>&gt;</span>allatori/lib/allatori.jar<span class="tag">&lt;/<span class="name">argument</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">argument</span>&gt;</span>$&#123;basedir&#125;/target/allatori.xml<span class="tag">&lt;/<span class="name">argument</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">arguments</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">execution</span>&gt;</span></span><br><span class="line">        <span class="comment">&lt;!-- Run CommentRemover --&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">execution</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">id</span>&gt;</span>run-comment-remover<span class="tag">&lt;/<span class="name">id</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">phase</span>&gt;</span>package<span class="tag">&lt;/<span class="name">phase</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">goals</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">goal</span>&gt;</span>exec<span class="tag">&lt;/<span class="name">goal</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">goals</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">configuration</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">executable</span>&gt;</span>java<span class="tag">&lt;/<span class="name">executable</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">arguments</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">argument</span>&gt;</span>-jar<span class="tag">&lt;/<span class="name">argument</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">argument</span>&gt;</span>allatori/lib/CommentRemover.jar<span class="tag">&lt;/<span class="name">argument</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">argument</span>&gt;</span>$&#123;basedir&#125;/target/$&#123;project.name&#125;-$&#123;project.version&#125;-obfuscated.jar<span class="tag">&lt;/<span class="name">argument</span>&gt;</span></span><br><span class="line">                    <span class="tag">&lt;<span class="name">argument</span>&gt;</span>$&#123;basedir&#125;/target/$&#123;project.name&#125;-$&#123;project.version&#125;.jar<span class="tag">&lt;/<span class="name">argument</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;/<span class="name">arguments</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;/<span class="name">configuration</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">execution</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">executions</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">plugin</span>&gt;</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> 编程 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Java </tag>
            
            <tag> Maven </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>AnzhiYu主题音乐馆添加歌曲下载</title>
      <link href="//posts/52470/"/>
      <url>//posts/52470/</url>
      
        <content type="html"><![CDATA[<div class="note warning flat"><p>本文修改主题为<code>AnZhiYu</code>主题，若使用其他主题，请自行确认修改位置。</p></div><div class="note success flat"><p>该方法通过外部引入，无需修改主题源文件。</p></div><h1 id="写在前面"><a href="#写在前面" class="headerlink" title="写在前面"></a>写在前面</h1><p><code>AnZhiYu</code>主题自动生成的的音乐馆页面只提供了音乐的播放功能，并不能直接下载歌曲（虽然你可以自己用开发者工具抓包下载，但这不是一个好习惯）。因此，我们需要在音乐馆页面添加歌曲下载的功能。但是，<code>AnZhiYu</code>主题的音乐馆页面是通过<code>Aplayer</code>插件生成的，因此直接修改主题文件无法直接修改播放页面。故我们另辟蹊径，通过修改其在此页面外挂的按钮来添加歌曲下载功能。</p><h1 id="预览"><a href="#预览" class="headerlink" title="预览"></a>预览</h1><p><img src="https://cdn.randench.cn/image/24/08/25ce5c90313467fe.jpg"></p><h1 id="修改"><a href="#修改" class="headerlink" title="修改"></a>修改</h1><h2 id="添加下载按钮"><a href="#添加下载按钮" class="headerlink" title="添加下载按钮"></a>添加下载按钮</h2><p>修改<code>[BlogRoot]\themes\anzhiyu\layout\includes\page\music.pug</code>文件，添加下载按钮和下载加载动画。</p><figure class="highlight diff"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">#anMusic-page</span><br><span class="line">#anMusicBtnGetSong(title=&quot;随机单曲，打开异世界的大门&quot;)</span><br><span class="line">    i(class=&quot;anzhiyufont anzhiyu-icon-shuffle&quot;)</span><br><span class="line">#anMusicRefreshBtn(title=&quot;立即刷新最新歌单&quot;)</span><br><span class="line">    i(class=&quot;anzhiyufont anzhiyu-icon-arrows-rotate&quot;)</span><br><span class="line">#anMusicSwitching(title=&quot;切换歌单&quot;)</span><br><span class="line">    i(class=&quot;anzhiyufont anzhiyu-icon-repeat&quot;)</span><br><span class="line"><span class="addition">+ #anMusicDownloadBtn(title=&quot;下载歌曲&quot;)</span></span><br><span class="line"><span class="addition">+   i(class=&quot;fa-solid fa-download&quot;)</span></span><br><span class="line"><span class="addition">+ #download-loader</span></span><br><span class="line"><span class="addition">+   i(class=&quot;fa-solid fa-spin&quot;)</span></span><br><span class="line">#anMusic-page-meting</span><br></pre></td></tr></table></figure><h2 id="调整样式"><a href="#调整样式" class="headerlink" title="调整样式"></a>调整样式</h2><p>修改<code>[BlogRoot]\themes\anzhiyu\source\css\_page\music.styl</code>文件，调整下载按钮的样式。<br>从76行左右开始，调整如下代码，调整下载按钮的样式。</p><figure class="highlight diff"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><span class="line">@media screen and (max-width: 1400px)</span><br><span class="line">  body</span><br><span class="line">    #anMusic-page</span><br><span class="line"><span class="deletion">-     #anMusicSwitching, #anMusicRefreshBtn, #anMusicBtnGetSong</span></span><br><span class="line"><span class="addition">+     #anMusicSwitching, #anMusicRefreshBtn, #anMusicBtnGetSong, #anMusicDownloadBtn</span></span><br><span class="line">        right 7vw</span><br><span class="line">      #anMusicSwitching</span><br><span class="line">        bottom: 100px</span><br><span class="line">      #anMusicRefreshBtn</span><br><span class="line">        bottom: 160px</span><br><span class="line">      #anMusicBtnGetSong</span><br><span class="line">        bottom: 220px</span><br><span class="line"><span class="addition">+     #anMusicDownloadBtn</span></span><br><span class="line"><span class="addition">+       bottom: 280px</span></span><br><span class="line"></span><br><span class="line">#anMusic-page</span><br><span class="line"><span class="deletion">- #anMusicRefreshBtn, #anMusicBtnGetSong, #anMusicSwitching</span></span><br><span class="line"><span class="addition">+ #anMusicRefreshBtn, #anMusicBtnGetSong, #anMusicSwitching, #anMusicDownloadBtn</span></span><br><span class="line">    position: fixed;</span><br><span class="line">    display: flex;</span><br><span class="line">    width: 50px;</span><br><span class="line">    height: 50px;</span><br><span class="line">    bottom: 100px;</span><br><span class="line">    padding: 5px;</span><br><span class="line">    background: var(--anzhiyu-white-op);</span><br><span class="line">    backdrop-filter: saturate(180%) blur(20px);</span><br><span class="line">    -webkit-backdrop-filter: blur(20px);</span><br><span class="line">    border-radius: 50%;</span><br><span class="line">    color: #fff;</span><br><span class="line">    text-align: center;</span><br><span class="line">    justify-content: center;</span><br><span class="line">    align-items: center;</span><br><span class="line">    cursor: pointer;</span><br><span class="line">    z-index 2</span><br><span class="line">  #anMusicBtnGetSong</span><br><span class="line">    right: 11vw;</span><br><span class="line">  #anMusicRefreshBtn</span><br><span class="line">    right: 7vw;</span><br><span class="line">  #anMusicSwitching</span><br><span class="line">    right: 15vw;</span><br><span class="line"><span class="addition">+ #anMusicDownloadBtn</span></span><br><span class="line"><span class="addition">+   right: 19vw;</span></span><br><span class="line">  +maxWidth768()</span><br><span class="line">    div#anMusicBtnGetSong</span><br><span class="line">      right: 80px;</span><br><span class="line">      bottom: 150px;</span><br><span class="line">    div#anMusicRefreshBtn</span><br><span class="line">      right: 20px;</span><br><span class="line">      bottom: 150px;</span><br><span class="line">    div#anMusicSwitching</span><br><span class="line">      right: 140px;</span><br><span class="line">      bottom: 150px;</span><br><span class="line"><span class="addition">+   div#anMusicDownloadBtn</span></span><br><span class="line"><span class="addition">+     right: 200px;</span></span><br><span class="line"><span class="addition">+     bottom: 150px;</span></span><br></pre></td></tr></table></figure><p>添加<code>[BlogRoot]\themes\anzhiyu\source\css\custom\music.css</code>文件或者修改你自定义的CSS文件，添加如下代码，添加点击下载按钮后的动画效果。</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-id">#download-loader</span> &#123;</span><br><span class="line">    <span class="attribute">display</span>: none;</span><br><span class="line">    <span class="attribute">border</span>: <span class="number">16px</span> solid <span class="number">#f3f3f3</span>; <span class="comment">/* Light grey */</span></span><br><span class="line">    <span class="attribute">border-top</span>: <span class="number">16px</span> solid <span class="number">#3498db</span>; <span class="comment">/* Blue */</span></span><br><span class="line">    <span class="attribute">border-radius</span>: <span class="number">50%</span>;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">120px</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">120px</span>;</span><br><span class="line">    <span class="attribute">animation</span>: loader-spin <span class="number">2s</span> linear infinite;</span><br><span class="line">    <span class="attribute">position</span>: fixed;</span><br><span class="line">    <span class="attribute">top</span>: <span class="number">50%</span>;</span><br><span class="line">    <span class="attribute">left</span>: <span class="number">50%</span>;</span><br><span class="line">    <span class="attribute">transform</span>: <span class="built_in">translate</span>(-<span class="number">50%</span>, -<span class="number">50%</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@keyframes</span> loader-spin &#123;</span><br><span class="line">    <span class="number">0%</span> &#123; <span class="attribute">transform</span>: <span class="built_in">rotate</span>(<span class="number">0deg</span>); &#125;</span><br><span class="line">    <span class="number">100%</span> &#123; <span class="attribute">transform</span>: <span class="built_in">rotate</span>(<span class="number">360deg</span>); &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="添加下载功能"><a href="#添加下载功能" class="headerlink" title="添加下载功能"></a>添加下载功能</h2><p>修改<code>[BlogRoot]\themes\anzhiyu\source\js\utils.js</code>文件，添加下载歌曲的功能。</p><p>在约879行左右，添加如下代码，加入下载歌曲按钮的监听事件。</p><figure class="highlight diff"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">  // 监听音乐背景改变</span><br><span class="line">  addEventListenerMusic: function () &#123;</span><br><span class="line">    const anMusicPage = document.getElementById(&quot;anMusic-page&quot;);</span><br><span class="line">    const aplayerIconMenu = anMusicPage.querySelector(&quot;.aplayer-info .aplayer-time .aplayer-icon-menu&quot;);</span><br><span class="line">    const anMusicBtnGetSong = anMusicPage.querySelector(&quot;#anMusicBtnGetSong&quot;);</span><br><span class="line">    const anMusicRefreshBtn = anMusicPage.querySelector(&quot;#anMusicRefreshBtn&quot;);</span><br><span class="line">    const anMusicSwitchingBtn = anMusicPage.querySelector(&quot;#anMusicSwitching&quot;);</span><br><span class="line"><span class="addition">+   const anMusicDownloadBtn = anMusicPage.querySelector(&quot;#anMusicDownloadBtn&quot;);</span></span><br><span class="line">    const metingAplayer = anMusicPage.querySelector(&quot;meting-js&quot;).aplayer;</span><br></pre></td></tr></table></figure><p>在约904行左右，添加如下代码，先用fetch请求歌曲的下载地址，然后用createObjectURL将歌曲数据转化为blob对象，最后用a标签下载歌曲。</p><div class="note warning flat"><p>注意：由于使用了fetch请求下载地址，因此你的音乐资源地址需要支持跨域请求，否则可能下载失败。</p></div><figure class="highlight diff"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br></pre></td><td class="code"><pre><span class="line">    // 监听增加单曲按钮</span><br><span class="line">    anMusicBtnGetSong.addEventListener(&quot;click&quot;, () =&gt; &#123;</span><br><span class="line">      if (changeMusicListFlag) &#123;</span><br><span class="line">        const anMusicPage = document.getElementById(&quot;anMusic-page&quot;);</span><br><span class="line">        const metingAplayer = anMusicPage.querySelector(&quot;meting-js&quot;).aplayer;</span><br><span class="line">        const allAudios = metingAplayer.list.audios;</span><br><span class="line">        const randomIndex = Math.floor(Math.random() * allAudios.length);</span><br><span class="line">        // 随机播放一首</span><br><span class="line">        metingAplayer.list.switch(randomIndex);</span><br><span class="line">      &#125; else &#123;</span><br><span class="line">        anzhiyu.cacheAndPlayMusic();</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;);</span><br><span class="line">    anMusicRefreshBtn.addEventListener(&quot;click&quot;, () =&gt; &#123;</span><br><span class="line">      localStorage.removeItem(&quot;musicData&quot;);</span><br><span class="line">      anzhiyu.snackbarShow(&quot;已移除相关缓存歌曲&quot;);</span><br><span class="line">    &#125;);</span><br><span class="line">    anMusicSwitchingBtn.addEventListener(&quot;click&quot;, () =&gt; &#123;</span><br><span class="line">      anzhiyu.changeMusicList();</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line"><span class="addition">+   anMusicDownloadBtn.addEventListener(&quot;click&quot;, async () =&gt; &#123;</span></span><br><span class="line"><span class="addition">+     // 下载当前播放的歌曲</span></span><br><span class="line"><span class="addition">+     const loader = document.getElementById(&#x27;download-loader&#x27;);</span></span><br><span class="line"><span class="addition">+     const timeout = 10000; // 超时时间设置为10秒</span></span><br><span class="line"><span class="addition">+     loader.style.display = &#x27;block&#x27;; // 显示加载动画</span></span><br><span class="line"><span class="addition">+     const controller = new AbortController();</span></span><br><span class="line"><span class="addition">+     const timeoutId = setTimeout(() =&gt; controller.abort(), timeout);</span></span><br><span class="line"><span class="addition">+</span></span><br><span class="line"><span class="addition">+     const anMusicPage = document.getElementById(&quot;anMusic-page&quot;);</span></span><br><span class="line"><span class="addition">+     const metingAplayer = anMusicPage.querySelector(&quot;meting-js&quot;).aplayer;</span></span><br><span class="line"><span class="addition">+     const currentSong = metingAplayer.list.audios[metingAplayer.list.index];</span></span><br><span class="line"><span class="addition">+     const downloadUrl = currentSong.url;</span></span><br><span class="line"><span class="addition">+</span></span><br><span class="line"><span class="addition">+     let format = &#x27;&#x27;;</span></span><br><span class="line"><span class="addition">+     if (downloadUrl.endsWith(&#x27;.flac&#x27;)) &#123;</span></span><br><span class="line"><span class="addition">+       format = &#x27;.flac&#x27;;</span></span><br><span class="line"><span class="addition">+     &#125; else if (downloadUrl.endsWith(&#x27;.mp3&#x27;)) &#123;</span></span><br><span class="line"><span class="addition">+       format = &#x27;.mp3&#x27;;</span></span><br><span class="line"><span class="addition">+     &#125; else if (downloadUrl.endsWith(&#x27;.m4a&#x27;)) &#123;</span></span><br><span class="line"><span class="addition">+       format = &#x27;.m4a&#x27;;</span></span><br><span class="line"><span class="addition">+     &#125; else if (downloadUrl.endsWith(&#x27;.ogg&#x27;)) &#123;</span></span><br><span class="line"><span class="addition">+       format = &#x27;.ogg&#x27;;</span></span><br><span class="line"><span class="addition">+     &#125; else if (downloadUrl.endsWith(&#x27;.wav&#x27;)) &#123;</span></span><br><span class="line"><span class="addition">+       format = &#x27;.wav&#x27;;</span></span><br><span class="line"><span class="addition">+     &#125; else &#123;</span></span><br><span class="line"><span class="addition">+       format = &#x27;.mp3&#x27;;</span></span><br><span class="line"><span class="addition">+     &#125;</span></span><br><span class="line"><span class="addition">+</span></span><br><span class="line"><span class="addition">+     downloadName = currentSong.name + &quot; - &quot; + currentSong.artist + format;</span></span><br><span class="line"><span class="addition">+     console.log(&quot;下载地址：&quot;, downloadUrl);</span></span><br><span class="line"><span class="addition">+     console.log(&quot;文件名：&quot;, downloadName);</span></span><br><span class="line"><span class="addition">+</span></span><br><span class="line"><span class="addition">+     try &#123;</span></span><br><span class="line"><span class="addition">+       const response = await fetch(downloadUrl, &#123; signal: controller.signal &#125;);</span></span><br><span class="line"><span class="addition">+       clearTimeout(timeoutId);</span></span><br><span class="line"><span class="addition">+</span></span><br><span class="line"><span class="addition">+       if (!response.ok) &#123;</span></span><br><span class="line"><span class="addition">+         throw new Error(`网络错误，状态码: $&#123;response.status&#125;`);</span></span><br><span class="line"><span class="addition">+       &#125;</span></span><br><span class="line"><span class="addition">+</span></span><br><span class="line"><span class="addition">+       const blob = await response.blob();</span></span><br><span class="line"><span class="addition">+       const downloadLink = document.createElement(&quot;a&quot;);</span></span><br><span class="line"><span class="addition">+       const objectUrl = URL.createObjectURL(blob);</span></span><br><span class="line"><span class="addition">+       downloadLink.href = objectUrl;</span></span><br><span class="line"><span class="addition">+       downloadLink.download = downloadName;</span></span><br><span class="line"><span class="addition">+       downloadLink.click();</span></span><br><span class="line"><span class="addition">+       URL.revokeObjectURL(downloadLink.href); // 释放内存</span></span><br><span class="line"><span class="addition">+</span></span><br><span class="line"><span class="addition">+     &#125; catch (error) &#123;</span></span><br><span class="line"><span class="addition">+       if (error.name === &#x27;AbortError&#x27;) &#123;</span></span><br><span class="line"><span class="addition">+         if (GLOBAL_CONFIG.Snackbar !== undefined) &#123;</span></span><br><span class="line"><span class="addition">+           anzhiyu.snackbarShow(&quot;下载超时，请稍后再试&quot;);</span></span><br><span class="line"><span class="addition">+         &#125;</span></span><br><span class="line"><span class="addition">+       &#125; else &#123;</span></span><br><span class="line"><span class="addition">+         if (GLOBAL_CONFIG.Snackbar !== undefined) &#123;</span></span><br><span class="line"><span class="addition">+           anzhiyu.snackbarShow(&quot;下载失败&quot; + error.message);</span></span><br><span class="line"><span class="addition">+         &#125;</span></span><br><span class="line"><span class="addition">+       &#125;</span></span><br><span class="line"><span class="addition">+     &#125; finally &#123;</span></span><br><span class="line"><span class="addition">+       loader.style.display = &#x27;none&#x27;; // 隐藏加载动画</span></span><br><span class="line"><span class="addition">+     &#125;</span></span><br><span class="line"><span class="addition">+   &#125;);</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Hexo </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 美化 </tag>
            
            <tag> 魔改 </tag>
            
            <tag> AnZhiYu </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>首页背景图渐进式加载</title>
      <link href="//posts/40741/"/>
      <url>//posts/40741/</url>
      
        <content type="html"><![CDATA[<div class="note warning flat"><p>本文修改主题为<code>AnZhiYu</code>主题，若使用其他主题，请自行确认修改位置。</p></div><div class="note success flat"><p>该方法通过外部引入，无需修改主题源文件。</p></div><h1 id="原文出处"><a href="#原文出处" class="headerlink" title="原文出处"></a>原文出处</h1><blockquote><p><a href="https://blog.kouseki.cn/posts/4f72.html">https://blog.kouseki.cn/posts/4f72.html</a><br><a href="https://satera.cn/posts/6a8fb549/">https://satera.cn/posts/6a8fb549/</a><br><a href="https://blhorizon.github.io/posts/29ff7730.html">https://blhorizon.github.io/posts/29ff7730.html</a></p></blockquote><h1 id="效果预览"><a href="#效果预览" class="headerlink" title="效果预览"></a>效果预览</h1><details class="folding-tag" ><summary> 查看图片 </summary>              <div class='content'>              <p><img src="https://cdn.randench.cn/image/24/08/d96aab1af1f91d28.gif" alt="效果预览"></p>              </div>            </details><h1 id="修改步骤"><a href="#修改步骤" class="headerlink" title="修改步骤"></a>修改步骤</h1><p>以本站使用的主题<code>anzhiyu</code>为例(butterfly通用)，为首页顶部图配置渐进式加载。这个方法应该也同样适用于一图流的博客背景，有需要的朋友可以自己研究一下~</p><h2 id="1-图片加载JS"><a href="#1-图片加载JS" class="headerlink" title="1. 图片加载JS"></a>1. 图片加载JS</h2><p>新建文件<code>[Blogroot]\source\js\imgloaded.js</code>新增以下内容，并按照注释配置自己的图片，可以是图片直链也可以是本地路径。这里可以获取 <a href="https://blog.jixiaob.cn/?post=93">随机二次元背景图</a> 。需要注意的是，在本地部署可能首页背景图不能显示，远程部署就可以解决了。</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 首页头图加载优化</span></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> 实现medium的渐进加载背景的效果</span></span><br><span class="line"><span class="comment">*/</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (!<span class="variable language_">window</span>.<span class="property">ProgressiveLoad</span>) &#123;</span><br><span class="line"><span class="comment">// 定义ProgressiveLoad类</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">ProgressiveLoad</span> &#123;</span><br><span class="line">    <span class="title function_">constructor</span>(<span class="params">smallSrc, largeSrc</span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">smallSrc</span> = smallSrc;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">largeSrc</span> = largeSrc;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">initScrollListener</span>(),</span><br><span class="line">    <span class="variable language_">this</span>.<span class="title function_">initTpl</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 这里的1是滚动全程渐变 改为0.3就是前30%渐变后固定前30%产生的渐变效果</span></span><br><span class="line">    <span class="title function_">initScrollListener</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">window</span>.<span class="title function_">addEventListener</span>(<span class="string">&quot;scroll&quot;</span>, (<span class="function">()=&gt;</span>&#123;</span><br><span class="line">        <span class="keyword">var</span> e = <span class="title class_">Math</span>.<span class="title function_">min</span>(<span class="variable language_">window</span>.<span class="property">scrollY</span> / <span class="variable language_">window</span>.<span class="property">innerHeight</span>, <span class="number">0.7</span>);</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">container</span>.<span class="property">style</span>.<span class="title function_">setProperty</span>(<span class="string">&quot;--process&quot;</span>, e)</span><br><span class="line">    &#125;</span><br><span class="line">    ))</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@description</span> 生成ui模板</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    <span class="title function_">initTpl</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">container</span> = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&#x27;div&#x27;</span>);</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">smallStage</span> = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&#x27;div&#x27;</span>);</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">largeStage</span> = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&#x27;div&#x27;</span>);</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">video</span> = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&#x27;div&#x27;</span>);</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">smallImg</span> = <span class="keyword">new</span> <span class="title class_">Image</span>();</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">largeImg</span> = <span class="keyword">new</span> <span class="title class_">Image</span>();</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">container</span>.<span class="property">className</span> = <span class="string">&#x27;pl-container&#x27;</span>;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">container</span>.<span class="property">style</span>.<span class="title function_">setProperty</span>(<span class="string">&quot;--process&quot;</span>, <span class="number">0</span>),</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">smallStage</span>.<span class="property">className</span> = <span class="string">&#x27;pl-img pl-blur&#x27;</span>;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">largeStage</span>.<span class="property">className</span> = <span class="string">&#x27;pl-img&#x27;</span>;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">video</span>.<span class="property">className</span> = <span class="string">&#x27;pl-video&#x27;</span>;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">container</span>.<span class="title function_">appendChild</span>(<span class="variable language_">this</span>.<span class="property">smallStage</span>);</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">container</span>.<span class="title function_">appendChild</span>(<span class="variable language_">this</span>.<span class="property">largeStage</span>);</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">container</span>.<span class="title function_">appendChild</span>(<span class="variable language_">this</span>.<span class="property">video</span>);</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">smallImg</span>.<span class="property">onload</span> = <span class="variable language_">this</span>.<span class="property">_onSmallLoaded</span>.<span class="title function_">bind</span>(<span class="variable language_">this</span>);</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">largeImg</span>.<span class="property">onload</span> = <span class="variable language_">this</span>.<span class="property">_onLargeLoaded</span>.<span class="title function_">bind</span>(<span class="variable language_">this</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@description</span> 加载背景</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    <span class="title function_">progressiveLoad</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">smallImg</span>.<span class="property">src</span> = <span class="variable language_">this</span>.<span class="property">smallSrc</span>;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">largeImg</span>.<span class="property">src</span> = <span class="variable language_">this</span>.<span class="property">largeSrc</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@description</span> 大图加载完成</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    <span class="title function_">_onLargeLoaded</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">largeStage</span>.<span class="property">classList</span>.<span class="title function_">add</span>(<span class="string">&#x27;pl-visible&#x27;</span>);</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">largeStage</span>.<span class="property">style</span>.<span class="property">backgroundImage</span> = <span class="string">`url(&#x27;<span class="subst">$&#123;<span class="variable language_">this</span>.largeSrc&#125;</span>&#x27;)`</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@description</span> 小图加载完成</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    <span class="title function_">_onSmallLoaded</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">smallStage</span>.<span class="property">classList</span>.<span class="title function_">add</span>(<span class="string">&#x27;pl-visible&#x27;</span>);</span><br><span class="line">    <span class="variable language_">this</span>.<span class="property">smallStage</span>.<span class="property">style</span>.<span class="property">backgroundImage</span> = <span class="string">`url(&#x27;<span class="subst">$&#123;<span class="variable language_">this</span>.smallSrc&#125;</span>&#x27;)`</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> <span class="title function_">executeLoad</span> = (<span class="params">config, target</span>) =&gt; &#123;</span><br><span class="line">    <span class="comment">// console.log(&#x27;执行渐进背景替换&#x27;);</span></span><br><span class="line">    <span class="keyword">const</span> isMobile = <span class="variable language_">window</span>.<span class="title function_">matchMedia</span>(<span class="string">&#x27;(max-width: 767px)&#x27;</span>).<span class="property">matches</span>;</span><br><span class="line">    <span class="keyword">const</span> loader = <span class="keyword">new</span> <span class="title class_">ProgressiveLoad</span>(</span><br><span class="line">    isMobile ? config.<span class="property">mobileSmallSrc</span> : config.<span class="property">smallSrc</span>,</span><br><span class="line">    isMobile ? config.<span class="property">mobileLargeSrc</span> : config.<span class="property">largeSrc</span></span><br><span class="line">    );</span><br><span class="line">    <span class="comment">// 和背景图颜色保持一致，防止高斯模糊后差异较大</span></span><br><span class="line">    <span class="keyword">if</span> (target.<span class="property">children</span>[<span class="number">0</span>]) &#123;</span><br><span class="line">    target.<span class="title function_">insertBefore</span>(loader.<span class="property">container</span>, target.<span class="property">children</span>[<span class="number">0</span>]);</span><br><span class="line">    &#125;</span><br><span class="line">    loader.<span class="title function_">progressiveLoad</span>();</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> config = &#123;</span><br><span class="line">    <span class="attr">smallSrc</span>: <span class="string">&#x27;https://www.loliapi.com/acg/&#x27;</span>, <span class="comment">// 小图链接 尽可能配置小于100k的图片</span></span><br><span class="line">    <span class="attr">largeSrc</span>: <span class="string">&#x27;https://www.loliapi.com/acg/&#x27;</span>, <span class="comment">// 大图链接 最终显示的图片</span></span><br><span class="line">    <span class="attr">mobileSmallSrc</span>: <span class="string">&#x27;https://www.loliapi.com/acg/&#x27;</span>, <span class="comment">// 手机端小图链接 尽可能配置小于100k的图片</span></span><br><span class="line">    <span class="attr">mobileLargeSrc</span>: <span class="string">&#x27;https://www.loliapi.com/acg/&#x27;</span>, <span class="comment">// 手机端大图链接 最终显示的图片</span></span><br><span class="line">    <span class="attr">enableRoutes</span>: [<span class="string">&#x27;/&#x27;</span>],</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">initProgressiveLoad</span>(<span class="params">config</span>) &#123;</span><br><span class="line">    <span class="comment">// 每次加载前先清除已有的元素</span></span><br><span class="line">    <span class="keyword">const</span> container = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;.pl-container&#x27;</span>); </span><br><span class="line">    <span class="keyword">if</span> (container) &#123;</span><br><span class="line">    container.<span class="title function_">remove</span>(); </span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">const</span> target = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;page-header&#x27;</span>);</span><br><span class="line">    <span class="keyword">if</span> (target &amp;&amp; target.<span class="property">classList</span>.<span class="title function_">contains</span>(<span class="string">&#x27;full_page&#x27;</span>)) &#123;</span><br><span class="line">    <span class="title function_">executeLoad</span>(config, target);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">onPJAXComplete</span>(<span class="params">config</span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> target = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;page-header&#x27;</span>);</span><br><span class="line">    <span class="keyword">if</span> (target &amp;&amp; target.<span class="property">classList</span>.<span class="title function_">contains</span>(<span class="string">&#x27;full_page&#x27;</span>)) &#123;</span><br><span class="line">    <span class="title function_">initProgressiveLoad</span>(config);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable language_">document</span>.<span class="title function_">addEventListener</span>(<span class="string">&quot;DOMContentLoaded&quot;</span>, <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="title function_">initProgressiveLoad</span>(config);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="variable language_">document</span>.<span class="title function_">addEventListener</span>(<span class="string">&quot;pjax:complete&quot;</span>, <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="title function_">onPJAXComplete</span>(config);</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="2-新建样式文件"><a href="#2-新建样式文件" class="headerlink" title="2. 新建样式文件"></a>2. 新建样式文件</h2><p>新建文件<code>[Blogroot]\source\css\imgloaded.css</code>新增以下内容，并按照注释自行决定调整内容</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* 首页头图加载 */</span></span><br><span class="line"><span class="selector-class">.pl-container</span> &#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">100%</span>;</span><br><span class="line">  <span class="attribute">position</span>: relative;</span><br><span class="line">  <span class="attribute">overflow</span>: hidden;</span><br><span class="line">  <span class="attribute">will-change</span>: transform;</span><br><span class="line">  <span class="comment">/* 添加性能优化 */</span></span><br><span class="line">  <span class="attribute">animation</span>: blur-to-clear <span class="number">2s</span> <span class="built_in">cubic-bezier</span>(.<span class="number">62</span>, .<span class="number">21</span>, .<span class="number">25</span>, <span class="number">1</span>) <span class="number">0s</span> <span class="number">1</span> normal backwards running, scale <span class="number">1.5s</span> <span class="built_in">cubic-bezier</span>(.<span class="number">62</span>, .<span class="number">21</span>, .<span class="number">25</span>, <span class="number">1</span>) <span class="number">0s</span> <span class="number">1</span> both;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.pl-img</span> &#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">100%</span>;</span><br><span class="line">  <span class="attribute">position</span>: absolute;</span><br><span class="line">  <span class="attribute">background-position</span>: center;</span><br><span class="line">  <span class="attribute">background-size</span>: cover;</span><br><span class="line">  <span class="attribute">background-repeat</span>: no-repeat;</span><br><span class="line">  <span class="attribute">opacity</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">transition</span>: opacity <span class="number">1s</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@keyframes</span> blur-to-clear &#123;</span><br><span class="line">  <span class="number">0%</span> &#123;</span><br><span class="line">    <span class="attribute">filter</span>: <span class="built_in">blur</span>(<span class="number">50px</span>);</span><br><span class="line">    <span class="attribute">opacity</span>: <span class="number">1</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="number">100%</span> &#123;</span><br><span class="line">    <span class="attribute">filter</span>: <span class="built_in">blur</span>(<span class="number">0</span>);</span><br><span class="line">    <span class="attribute">opacity</span>: <span class="number">1</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@keyframes</span> scale &#123;</span><br><span class="line">  <span class="number">0%</span> &#123;</span><br><span class="line">    <span class="attribute">transform</span>: <span class="built_in">scale</span>(<span class="number">1.5</span>) <span class="built_in">translateZ</span>(<span class="number">0</span>);</span><br><span class="line">    <span class="attribute">opacity</span>: <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="selector-tag">to</span> &#123;</span><br><span class="line">    <span class="attribute">transform</span>: <span class="built_in">scale</span>(<span class="number">1</span>) <span class="built_in">translateZ</span>(<span class="number">0</span>);</span><br><span class="line">    <span class="attribute">opacity</span>: <span class="number">1</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.pl-visible</span> &#123;</span><br><span class="line">  <span class="attribute">opacity</span>: <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.pl-blur</span> &#123;</span><br><span class="line">  <span class="comment">/* 小图锯齿多，增加高斯模糊 */</span></span><br><span class="line">  <span class="attribute">filter</span>: <span class="built_in">blur</span>(<span class="number">50px</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="3-引入JS和CSS"><a href="#3-引入JS和CSS" class="headerlink" title="3. 引入JS和CSS"></a>3. 引入JS和CSS</h2><p>在<code>_config.anzhiyu.yml</code>主题配置文件下<code>inject</code>配置项中<code>head</code>和<code>bottom</code>处引入两个文件</p><figure class="highlight diff"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">inject:</span><br><span class="line">  head:</span><br><span class="line"><span class="addition">+   - &lt;link rel=&quot;stylesheet&quot; href=&quot;/css/imgloaded.css?1&quot;&gt;</span></span><br><span class="line"></span><br><span class="line">  bottom:</span><br><span class="line"><span class="addition">+   - &lt;script async data-pjax src=&quot;/js/imgloaded.js?1&quot;&gt;&lt;/script&gt; # 首页图片渐进式加载</span></span><br></pre></td></tr></table></figure><h2 id="4-配置顶图"><a href="#4-配置顶图" class="headerlink" title="4. 配置顶图"></a>4. 配置顶图</h2><p>配置顶图，务必记得在主题配置文件中开启顶部图的功能，也可以像我这样配置空链接。因为js文件已经接替了图片加载功能，此处不需要配置图片（当然你也可以配置上）</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">index_img:</span> <span class="string">&quot;background: url() top / cover no-repeat&quot;</span></span><br></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> config = &#123;</span><br><span class="line">  <span class="attr">smallSrc</span>: <span class="string">&#x27;/img/xiaotu.jpg&#x27;</span>, <span class="comment">// 小图链接 尽可能配置小于100k的图片</span></span><br><span class="line">  <span class="attr">largeSrc</span>: <span class="string">&#x27;/img/tu.jpg&#x27;</span>, <span class="comment">// 大图链接 最终显示的图片</span></span><br><span class="line">  <span class="attr">mobileSmallSrc</span>: <span class="string">&#x27;/img/sjxt.jpg&#x27;</span>, <span class="comment">// 手机端小图链接 尽可能配置小于100k的图片</span></span><br><span class="line">  <span class="attr">mobileLargeSrc</span>: <span class="string">&#x27;/img/sjdt.jpg&#x27;</span>, <span class="comment">// 手机端大图链接 最终显示的图片</span></span><br><span class="line">  <span class="attr">enableRoutes</span>: [<span class="string">&#x27;/&#x27;</span>],</span><br><span class="line">  &#125;;</span><br></pre></td></tr></table></figure><h1 id="图片懒加载配置修改"><a href="#图片懒加载配置修改" class="headerlink" title="图片懒加载配置修改"></a>图片懒加载配置修改</h1><p>为了使图片模糊效果更加平滑，可以尝试修改<code>lazyload</code>配置项。<br>在主题配置文件中找到<code>lazyload</code>，将<code>field</code>项改为<code>post</code>，<code>blur</code>维持<code>true</code></p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">lazyload:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">field:</span> <span class="string">post</span> <span class="comment"># site/post</span></span><br><span class="line">  <span class="attr">placeholder:</span></span><br><span class="line">  <span class="attr">blur:</span> <span class="literal">true</span></span><br><span class="line">  <span class="attr">progressive:</span> <span class="literal">true</span></span><br></pre></td></tr></table></figure><h1 id="常见问题"><a href="#常见问题" class="headerlink" title="常见问题"></a>常见问题</h1><ul><li>首页图下方的有个奇怪的边界的情况(还有一图流的时候，自行设计渐变)</li><li>如果大图的下边界有不透明度变化，模糊小图，小图会超出不透明度范围，露出小图</li><li>如果开了夜间模式，是因为由夜间模式的阅读模式叠加一层0.3的alpha，具体是<code>[Blogroot]\themes\anzhiyu\source\css\_mode\darkmode.styl</code>文件里的<code>background-color: alpha($dark-black, 0.3)</code>，改为  <figure class="highlight styl"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="attribute">background-image</span>: <span class="built_in">linear-gradient</span>(</span><br><span class="line">  to <span class="attribute">bottom</span>,</span><br><span class="line">  <span class="built_in">rgba</span>(<span class="variable">$dark</span>-black, <span class="number">0.1</span>) <span class="number">0%</span>, </span><br><span class="line">  <span class="built_in">rgba</span>(<span class="variable">$dark</span>-black, <span class="number">0</span>) <span class="number">75%</span>,</span><br><span class="line">  <span class="built_in">rgba</span>(<span class="variable">$dark</span>-black, <span class="number">0</span>) <span class="number">100%</span>  </span><br><span class="line">);</span><br></pre></td></tr></table></figure></li></ul><h1 id="拓展修改"><a href="#拓展修改" class="headerlink" title="拓展修改"></a>拓展修改</h1><p>此方法修改后，首页背景图的加载效果可以达到较好的效果，但其他页面并不会加载首页的背景图，如果需要所有页面都加载，则需要进一步修改。<br>这里我选择直接将背景图挂载到 #web_bg 元素下，直接当做背景，这样可以实现所有页面都加载首页背景图。</p><h2 id="修改步骤-1"><a href="#修改步骤-1" class="headerlink" title="修改步骤"></a>修改步骤</h2><p>修改<code>[Blogroot]\themes\anzhiyu\layout\includes\layout.pug</code>文件</p><div class="note info flat"><p>此步骤是因为JS文件中挂载元素会先检查有无full_page属性，所以需要先将header元素加上full_page属性。你也可以选择去除属性检查，直接挂载到 #web_bg 元素下，忽略此步骤。</p></div><figure class="highlight diff"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">    #web_bg</span><br><span class="line"><span class="addition">+     header#web-header(class=&quot;full_page&quot;)</span></span><br><span class="line">    #an_music_bg</span><br></pre></td></tr></table></figure><p>修改<code>[Blogroot]\source\css\imgloaded.css</code>文件，前面部分修改如下：</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">body</span><span class="selector-attr">[style*=<span class="string">&quot;--animate: true&quot;</span>]</span> <span class="selector-id">#nav</span>,</span><br><span class="line"><span class="selector-tag">body</span><span class="selector-attr">[style*=<span class="string">&quot;--animate: true&quot;</span>]</span> <span class="selector-id">#scroll-down</span>,</span><br><span class="line"><span class="selector-tag">body</span><span class="selector-attr">[style*=<span class="string">&quot;--animate: true&quot;</span>]</span> <span class="selector-id">#site-info</span> &#123;</span><br><span class="line">  -webkit-<span class="attribute">animation</span>: scale <span class="number">2.2s</span> <span class="built_in">cubic-bezier</span>(.<span class="number">6</span>, .<span class="number">1</span>, .<span class="number">25</span>, <span class="number">1</span>) .<span class="number">5s</span> <span class="number">1</span> backwards;</span><br><span class="line">  <span class="attribute">animation</span>: scale <span class="number">2.2s</span> <span class="built_in">cubic-bezier</span>(.<span class="number">6</span>, .<span class="number">1</span>, .<span class="number">25</span>, <span class="number">1</span>) .<span class="number">5s</span> <span class="number">1</span> backwards</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@media</span> screen <span class="keyword">and</span> (<span class="attribute">max-width</span>: <span class="number">768px</span>) &#123;</span><br><span class="line">  <span class="selector-class">.pl-container</span> &#123;</span><br><span class="line">    <span class="attribute">top</span>: <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@media</span> screen <span class="keyword">and</span> (<span class="attribute">min-width</span>: <span class="number">768px</span>) &#123;</span><br><span class="line"></span><br><span class="line">  <span class="selector-id">#page-header</span><span class="selector-class">.full_page</span>,</span><br><span class="line">  <span class="selector-id">#web-header</span><span class="selector-class">.full_page</span>,</span><br><span class="line">  <span class="selector-class">.pl-container</span> &#123;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">100vh</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="selector-id">#page-header</span><span class="selector-class">.full_page</span><span class="selector-class">.expand-to-full</span>,</span><br><span class="line">  <span class="selector-id">#web-header</span><span class="selector-class">.full_page</span><span class="selector-class">.expand-to-full</span>,</span><br><span class="line">  <span class="selector-class">.pl-container</span><span class="selector-class">.expand-to-full</span> &#123;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">50vh</span> <span class="meta">!important</span></span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="selector-class">.pl-container</span> &#123;</span><br><span class="line">    <span class="attribute">will-change</span>: opacity, transform, filter;</span><br><span class="line">    <span class="attribute">opacity</span>: <span class="built_in">calc</span>(<span class="number">1</span> - <span class="built_in">var</span>(--process) * <span class="number">1</span>) <span class="meta">!important</span>;</span><br><span class="line">    <span class="attribute">transform</span>: <span class="built_in">scale</span>(<span class="built_in">calc</span>(<span class="number">1</span> + <span class="built_in">var</span>(--process) * .<span class="number">1</span>));</span><br><span class="line">    <span class="attribute">filter</span>: <span class="built_in">blur</span>(<span class="built_in">calc</span>(<span class="built_in">var</span>(--process) * <span class="number">10px</span>));</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.pl-container</span> &#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">100%</span>;</span><br><span class="line">  <span class="attribute">left</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">position</span>: fixed;</span><br><span class="line">  <span class="attribute">z-index</span>: -<span class="number">2</span>;</span><br><span class="line">  <span class="attribute">overflow</span>: hidden;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-tag">body</span><span class="selector-attr">[style*=<span class="string">&quot;--animate: true&quot;</span>]</span> <span class="selector-class">.pl-container</span> &#123;</span><br><span class="line">  <span class="attribute">will-change</span>: transform;</span><br><span class="line">  <span class="attribute">animation</span>: blur-to-clear <span class="number">2.5s</span> <span class="built_in">cubic-bezier</span>(.<span class="number">6</span>, .<span class="number">25</span>, .<span class="number">25</span>, <span class="number">1</span>) <span class="number">0s</span> <span class="number">1</span> backwards, </span><br><span class="line">             scale <span class="number">2.2s</span> <span class="built_in">cubic-bezier</span>(.<span class="number">6</span>, .<span class="number">1</span>, .<span class="number">25</span>, <span class="number">1</span>) .<span class="number">5s</span> <span class="number">1</span> backwards;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-attr">[data-theme=dark]</span> <span class="selector-class">.pl-container</span> &#123;</span><br><span class="line">  <span class="attribute">filter</span>: <span class="built_in">brightness</span>(<span class="number">0.6</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>修改<code>[Blogroot]\themes\anzhiyu\source\js\imgloaded.js</code>整体内容如下：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 首页头图加载优化</span></span><br><span class="line"><span class="comment">/**</span></span><br><span class="line"><span class="comment"> * <span class="doctag">@description</span> 实现medium的渐进加载背景的效果</span></span><br><span class="line"><span class="comment"> */</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">getRandomImage</span>(<span class="params">platform</span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> num = <span class="title class_">Math</span>.<span class="title function_">floor</span>(<span class="title class_">Math</span>.<span class="title function_">random</span>() * <span class="number">300</span>) + <span class="number">100</span>;</span><br><span class="line">  <span class="keyword">if</span> (platform === <span class="string">&#x27;pc&#x27;</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">`https://img.loliapi.com/i/pc/img<span class="subst">$&#123;num&#125;</span>.webp`</span>;</span><br><span class="line">  &#125; <span class="keyword">else</span> <span class="keyword">if</span> (platform === <span class="string">&#x27;pe&#x27;</span>) &#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="string">`https://img.loliapi.com/i/pe/img<span class="subst">$&#123;num&#125;</span>.webp`</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 判断initLargeSrc和initSmallSrc是否已经定义，如果没有定义则随机获取图片链接</span></span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">typeof</span> initLargeSrc === <span class="string">&#x27;undefined&#x27;</span>) &#123;</span><br><span class="line">  initLargeSrc = <span class="title function_">getRandomImage</span>(<span class="string">&#x27;pc&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">typeof</span> initSmallSrc === <span class="string">&#x27;undefined&#x27;</span>) &#123;</span><br><span class="line">  initSmallSrc = <span class="title function_">getRandomImage</span>(<span class="string">&#x27;pe&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> (!<span class="variable language_">window</span>.<span class="property">ProgressiveLoad</span>) &#123;</span><br><span class="line">  <span class="comment">// 定义ProgressiveLoad类</span></span><br><span class="line">  <span class="keyword">class</span> <span class="title class_">ProgressiveLoad</span> &#123;</span><br><span class="line">    <span class="title function_">constructor</span>(<span class="params">smallSrc, largeSrc</span>) &#123;</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">smallSrc</span> = smallSrc;</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">largeSrc</span> = largeSrc;</span><br><span class="line">      <span class="variable language_">this</span>.<span class="title function_">initTpl</span>();</span><br><span class="line">      <span class="variable language_">this</span>.<span class="title function_">initScrollListener</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 这里的1是滚动全程渐变 改为0.3就是前30%渐变后固定前30%产生的渐变效果</span></span><br><span class="line">    <span class="title function_">initScrollListener</span>(<span class="params"></span>) &#123;</span><br><span class="line">      <span class="keyword">const</span> header = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;page-header&#x27;</span>);</span><br><span class="line">      <span class="keyword">if</span> (header &amp;&amp; header.<span class="property">classList</span>.<span class="title function_">contains</span>(<span class="string">&#x27;full_page&#x27;</span>)) &#123;</span><br><span class="line">        <span class="variable language_">document</span>.<span class="property">body</span>.<span class="property">style</span>.<span class="title function_">setProperty</span>(<span class="string">&#x27;--animate&#x27;</span>, <span class="string">&#x27;true&#x27;</span>);</span><br><span class="line">        <span class="variable language_">window</span>.<span class="title function_">addEventListener</span>(<span class="string">&quot;scroll&quot;</span>, (<span class="function">()=&gt;</span>&#123;</span><br><span class="line">            <span class="keyword">var</span> e = <span class="title class_">Math</span>.<span class="title function_">min</span>(<span class="variable language_">window</span>.<span class="property">scrollY</span> / <span class="variable language_">window</span>.<span class="property">innerHeight</span>, <span class="number">0.7</span>);</span><br><span class="line">            <span class="variable language_">this</span>.<span class="property">container</span>.<span class="property">style</span>.<span class="title function_">setProperty</span>(<span class="string">&quot;--process&quot;</span>, e)</span><br><span class="line">        &#125;</span><br><span class="line">      ))</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="variable language_">this</span>.<span class="property">container</span>.<span class="property">style</span>.<span class="title function_">setProperty</span>(<span class="string">&quot;--process&quot;</span>, <span class="number">0.7</span>)</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@description</span> 生成ui模板</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="title function_">initTpl</span>(<span class="params"></span>) &#123;</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">container</span> = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&#x27;div&#x27;</span>);</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">smallStage</span> = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&#x27;div&#x27;</span>);</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">largeStage</span> = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&#x27;div&#x27;</span>);</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">video</span> = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&#x27;div&#x27;</span>);</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">smallImg</span> = <span class="keyword">new</span> <span class="title class_">Image</span>();</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">largeImg</span> = <span class="keyword">new</span> <span class="title class_">Image</span>();</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">container</span>.<span class="property">className</span> = <span class="string">&#x27;pl-container&#x27;</span>;</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">container</span>.<span class="property">style</span>.<span class="title function_">setProperty</span>(<span class="string">&quot;--process&quot;</span>, <span class="number">0</span>),</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">smallStage</span>.<span class="property">className</span> = <span class="string">&#x27;pl-img pl-blur&#x27;</span>;</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">largeStage</span>.<span class="property">className</span> = <span class="string">&#x27;pl-img&#x27;</span>;</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">video</span>.<span class="property">className</span> = <span class="string">&#x27;pl-video&#x27;</span>;</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">container</span>.<span class="title function_">appendChild</span>(<span class="variable language_">this</span>.<span class="property">smallStage</span>);</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">container</span>.<span class="title function_">appendChild</span>(<span class="variable language_">this</span>.<span class="property">largeStage</span>);</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">container</span>.<span class="title function_">appendChild</span>(<span class="variable language_">this</span>.<span class="property">video</span>);</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">smallImg</span>.<span class="property">onload</span> = <span class="variable language_">this</span>.<span class="property">_onSmallLoaded</span>.<span class="title function_">bind</span>(<span class="variable language_">this</span>);</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">largeImg</span>.<span class="property">onload</span> = <span class="variable language_">this</span>.<span class="property">_onLargeLoaded</span>.<span class="title function_">bind</span>(<span class="variable language_">this</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@description</span> 加载背景</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="title function_">progressiveLoad</span>(<span class="params"></span>) &#123;</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">smallImg</span>.<span class="property">src</span> = <span class="variable language_">this</span>.<span class="property">smallSrc</span>;</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">largeImg</span>.<span class="property">src</span> = <span class="variable language_">this</span>.<span class="property">largeSrc</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@description</span> 大图加载完成</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="title function_">_onLargeLoaded</span>(<span class="params"></span>) &#123;</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">largeStage</span>.<span class="property">classList</span>.<span class="title function_">add</span>(<span class="string">&#x27;pl-visible&#x27;</span>);</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">largeStage</span>.<span class="property">style</span>.<span class="property">backgroundImage</span> = <span class="string">`url(&#x27;<span class="subst">$&#123;<span class="variable language_">this</span>.largeSrc&#125;</span>&#x27;)`</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">/**</span></span><br><span class="line"><span class="comment">     * <span class="doctag">@description</span> 小图加载完成</span></span><br><span class="line"><span class="comment">     */</span></span><br><span class="line">    <span class="title function_">_onSmallLoaded</span>(<span class="params"></span>) &#123;</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">smallStage</span>.<span class="property">classList</span>.<span class="title function_">add</span>(<span class="string">&#x27;pl-visible&#x27;</span>);</span><br><span class="line">      <span class="variable language_">this</span>.<span class="property">smallStage</span>.<span class="property">style</span>.<span class="property">backgroundImage</span> = <span class="string">`url(&#x27;<span class="subst">$&#123;<span class="variable language_">this</span>.smallSrc&#125;</span>&#x27;)`</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> <span class="title function_">executeLoad</span> = (<span class="params">config, target</span>) =&gt; &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&#x27;执行渐进背景替换&#x27;</span>);</span><br><span class="line">    <span class="keyword">const</span> isMobile = <span class="variable language_">window</span>.<span class="title function_">matchMedia</span>(<span class="string">&#x27;(max-width: 767px)&#x27;</span>).<span class="property">matches</span>;</span><br><span class="line">    <span class="keyword">const</span> loader = <span class="keyword">new</span> <span class="title class_">ProgressiveLoad</span>(</span><br><span class="line">      isMobile ? config.<span class="property">mobileSmallSrc</span> : config.<span class="property">smallSrc</span>,</span><br><span class="line">      isMobile ? config.<span class="property">mobileLargeSrc</span> : config.<span class="property">largeSrc</span></span><br><span class="line">    );</span><br><span class="line">    <span class="comment">// 和背景图颜色保持一致，防止高斯模糊后差异较大</span></span><br><span class="line">    <span class="keyword">if</span> (target.<span class="property">children</span>.<span class="property">length</span> &gt; <span class="number">0</span>) &#123;</span><br><span class="line">      target.<span class="title function_">insertBefore</span>(loader.<span class="property">container</span>, target.<span class="property">children</span>[<span class="number">0</span>]);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      target.<span class="title function_">appendChild</span>(loader.<span class="property">container</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    loader.<span class="title function_">progressiveLoad</span>();</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">const</span> config = &#123;</span><br><span class="line">    <span class="attr">smallSrc</span>: initLargeSrc, <span class="comment">// 小图链接 尽可能配置小于100k的图片</span></span><br><span class="line">    <span class="attr">largeSrc</span>: initLargeSrc, <span class="comment">// 大图链接 最终显示的图片</span></span><br><span class="line">    <span class="attr">mobileSmallSrc</span>: initSmallSrc, <span class="comment">// 手机端小图链接 尽可能配置小于100k的图片</span></span><br><span class="line">    <span class="attr">mobileLargeSrc</span>: initSmallSrc, <span class="comment">// 手机端大图链接 最终显示的图片</span></span><br><span class="line">    <span class="attr">enableRoutes</span>: [<span class="string">&#x27;/&#x27;</span>],</span><br><span class="line">  &#125;;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">function</span> <span class="title function_">initProgressiveLoad</span>(<span class="params">config</span>) &#123;</span><br><span class="line">    <span class="comment">// 每次加载前先清除已有的元素</span></span><br><span class="line">    <span class="keyword">const</span> container = <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;.pl-container&#x27;</span>); </span><br><span class="line">    <span class="keyword">if</span> (container) &#123;</span><br><span class="line">      container.<span class="title function_">remove</span>(); </span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">const</span> target = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;web-header&#x27;</span>);</span><br><span class="line">    <span class="keyword">if</span> (target &amp;&amp; target.<span class="property">classList</span>.<span class="title function_">contains</span>(<span class="string">&#x27;full_page&#x27;</span>)) &#123;</span><br><span class="line">      <span class="title function_">executeLoad</span>(config, target);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">function</span> <span class="title function_">onPJAXComplete</span>(<span class="params">config</span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> target = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;web-header&#x27;</span>);</span><br><span class="line">    <span class="keyword">if</span> (target &amp;&amp; target.<span class="property">classList</span>.<span class="title function_">contains</span>(<span class="string">&#x27;full_page&#x27;</span>)) &#123;</span><br><span class="line">      <span class="title function_">initProgressiveLoad</span>(config);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="variable language_">document</span>.<span class="title function_">addEventListener</span>(<span class="string">&quot;DOMContentLoaded&quot;</span>, <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="title function_">initProgressiveLoad</span>(config);</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="variable language_">document</span>.<span class="title function_">addEventListener</span>(<span class="string">&quot;pjax:complete&quot;</span>, <span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="title function_">initProgressiveLoad</span>(config);</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>修改<code>#web_bg</code>的css样式，将其改为背景图样式，可以加在你的自定义样式文件中</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-id">#web_bg</span> &#123;</span><br><span class="line">    <span class="attribute">position</span>: fixed;</span><br><span class="line">    <span class="attribute">transform</span>: <span class="built_in">rotate</span>(<span class="number">0deg</span>);</span><br><span class="line">    <span class="attribute">top</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">left</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">100vw</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">100vh</span>;</span><br><span class="line">    <span class="attribute">display</span>: flex;</span><br><span class="line">    <span class="attribute">align-items</span>: center;</span><br><span class="line">    <span class="attribute">justify-content</span>: center;</span><br><span class="line">    <span class="attribute">z-index</span>: -<span class="number">2</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Hexo </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 美化 </tag>
            
            <tag> 魔改 </tag>
            
            <tag> AnZhiYu </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>为主页文章卡片添加擦亮动画效果</title>
      <link href="//posts/56742/"/>
      <url>//posts/56742/</url>
      
        <content type="html"><![CDATA[<div class="note warning flat"><p>本文修改主题为<code>AnZhiYu</code>主题，若使用其他主题，请自行确认修改位置。</p></div><div class="note success flat"><p>该方法通过外部引入，无需修改主题源文件。</p></div><h1 id="效果预览"><a href="#效果预览" class="headerlink" title="效果预览"></a>效果预览</h1><p><img src="https://cdn.randench.cn/image/24/08/b8f5a4019de97d73.gif" alt="擦亮动画"></p><h1 id="修改步骤"><a href="#修改步骤" class="headerlink" title="修改步骤"></a>修改步骤</h1><ol><li><p>新建文件<code>source/css/home.css</code>或在已引入的css中新增以下内容</p> <figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-id">#recent-posts</span> &gt; <span class="selector-class">.recent-post-item</span><span class="selector-pseudo">:not</span>(<span class="selector-tag">a</span>)<span class="selector-pseudo">::before</span> &#123;</span><br><span class="line"><span class="attribute">content</span>: <span class="string">&quot;&quot;</span>;</span><br><span class="line"><span class="attribute">position</span>: absolute;</span><br><span class="line"><span class="attribute">top</span>: <span class="number">0</span>;</span><br><span class="line"><span class="attribute">left</span>: <span class="number">0</span>;</span><br><span class="line"><span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line"><span class="attribute">height</span>: <span class="number">200%</span>;</span><br><span class="line"><span class="attribute">background</span>: <span class="built_in">linear-gradient</span>(to right, transparent, white, transparent);</span><br><span class="line"><span class="attribute">transform</span>: <span class="built_in">translateX</span>(-<span class="number">200%</span>);</span><br><span class="line"><span class="attribute">transition</span>: transform <span class="number">0.5s</span> linear;</span><br><span class="line"><span class="attribute">z-index</span>: <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-id">#recent-posts</span> &gt; <span class="selector-class">.recent-post-item</span><span class="selector-pseudo">:not</span>(<span class="selector-tag">a</span>)<span class="selector-pseudo">:hover</span><span class="selector-pseudo">::before</span> &#123;</span><br><span class="line"><span class="attribute">transform</span>: <span class="built_in">translateX</span>(<span class="number">100%</span>) <span class="built_in">skewX</span>(-<span class="number">60deg</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>在<code>_config.anzhiyu.yml</code>主题配置文件下<code>inject</code>配置项中<code>head</code>处引入样式</p> <figure class="highlight diff"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">inject:</span><br><span class="line">  head:</span><br><span class="line"><span class="addition">+   - &lt;link rel=&quot;stylesheet&quot; href=&quot;/css/home.css&quot;&gt; # 首页文章卡片擦亮效果</span></span><br></pre></td></tr></table></figure></li></ol>]]></content>
      
      
      <categories>
          
          <category> Hexo </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 美化 </tag>
            
            <tag> 魔改 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>在侧边栏添加个性定位欢迎信息</title>
      <link href="//posts/55850/"/>
      <url>//posts/55850/</url>
      
        <content type="html"><![CDATA[<div class="note warning flat"><p>本文修改主题为<code>AnZhiYu</code>主题和<code>Butterfly</code>主题，若使用其他主题，请自行确认修改位置。</p></div><h1 id="原文出处"><a href="#原文出处" class="headerlink" title="原文出处"></a>原文出处</h1><blockquote><p><a href="https://blog.kouseki.cn/posts/da2a.html">https://blog.kouseki.cn/posts/da2a.html</a></p></blockquote><h1 id="效果预览"><a href="#效果预览" class="headerlink" title="效果预览"></a>效果预览</h1><p><img src="https://cdn.randench.cn/image/24/08/53a1101ee121e122.jpg"></p><h1 id="申请Token"><a href="#申请Token" class="headerlink" title="申请Token"></a>申请Token</h1><ol><li>打开<a href="https://lbs.qq.com/dev/console/application/mine">腾讯位置服务</a>，登录你的账号</li><li>点击创建应用，填一下名称和类型，随意即可</li><li>点击添加Key，key名称随意，勾选WebServiceAPI，此处白名单可以自选<br><img src="https://cdn.randench.cn/image/24/08/788d0b070303823b.jpg"></li><li>例如我选的是域名白名单，注意此处本地部署<code>localhost</code>是有效的，需带上端口号。</li><li>部署至公网填写域名即可，不需要端口号。</li><li>记录下得到的Key</li></ol><h1 id="修改步骤"><a href="#修改步骤" class="headerlink" title="修改步骤"></a>修改步骤</h1><h2 id="1-新建文件"><a href="#1-新建文件" class="headerlink" title="1. 新建文件"></a>1. 新建文件</h2><p>在<code>hexo</code>目录下新建<code>source/js/welcome.js</code>文件，新增以下内容(若没有js文件夹直接新建即可)。</p><div class="note info flat"><p>原文中的js为了实现jsonp请求还引入了jQuery，有些浪费，故此处修改js实现去掉jQuery依赖。</p></div><div class="note warning flat"><p>请修改第3行的<code>key</code>为你申请到的key，以及第40行的<code>经纬度</code>为你自己的经纬度。</p></div><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">fetchIpLocation</span>(<span class="params">callback</span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> script = <span class="variable language_">document</span>.<span class="title function_">createElement</span>(<span class="string">&#x27;script&#x27;</span>);</span><br><span class="line">    <span class="keyword">const</span> key = <span class="string">&#x27;XXXXX&#x27;</span>; <span class="comment">// 请修改为你申请到的key</span></span><br><span class="line">    <span class="keyword">const</span> url = <span class="string">`https://apis.map.qq.com/ws/location/v1/ip?key=<span class="subst">$&#123;key&#125;</span>&amp;output=jsonp&amp;callback=callbackFunction`</span>;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 定义全局回调函数</span></span><br><span class="line">    <span class="variable language_">window</span>.<span class="property">callbackFunction</span> = <span class="keyword">function</span> (<span class="params">res</span>) &#123;</span><br><span class="line">        ipLocation = res;</span><br><span class="line">        <span class="title function_">callback</span>();</span><br><span class="line">        <span class="comment">// 移除script标签和回调函数</span></span><br><span class="line">        <span class="variable language_">document</span>.<span class="property">body</span>.<span class="title function_">removeChild</span>(script);</span><br><span class="line">        <span class="keyword">delete</span> <span class="variable language_">window</span>.<span class="property">callbackFunction</span>;</span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    script.<span class="property">src</span> = url;</span><br><span class="line">    <span class="variable language_">document</span>.<span class="property">body</span>.<span class="title function_">appendChild</span>(script);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">getDistance</span>(<span class="params">e1, n1, e2, n2</span>) &#123;</span><br><span class="line">    <span class="keyword">const</span> R = <span class="number">6371</span></span><br><span class="line">    <span class="keyword">const</span> &#123; sin, cos, asin, <span class="variable constant_">PI</span>, hypot &#125; = <span class="title class_">Math</span></span><br><span class="line">    <span class="keyword">let</span> <span class="title function_">getPoint</span> = (<span class="params">e, n</span>) =&gt; &#123;</span><br><span class="line">        e *= <span class="variable constant_">PI</span> / <span class="number">180</span></span><br><span class="line">        n *= <span class="variable constant_">PI</span> / <span class="number">180</span></span><br><span class="line">        <span class="keyword">return</span> &#123; <span class="attr">x</span>: <span class="title function_">cos</span>(n) * <span class="title function_">cos</span>(e), <span class="attr">y</span>: <span class="title function_">cos</span>(n) * <span class="title function_">sin</span>(e), <span class="attr">z</span>: <span class="title function_">sin</span>(n) &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">let</span> a = <span class="title function_">getPoint</span>(e1, n1)</span><br><span class="line">    <span class="keyword">let</span> b = <span class="title function_">getPoint</span>(e2, n2)</span><br><span class="line">    <span class="keyword">let</span> c = <span class="title function_">hypot</span>(a.<span class="property">x</span> - b.<span class="property">x</span>, a.<span class="property">y</span> - b.<span class="property">y</span>, a.<span class="property">z</span> - b.<span class="property">z</span>)</span><br><span class="line">    <span class="keyword">let</span> r = <span class="title function_">asin</span>(c / <span class="number">2</span>) * <span class="number">2</span> * R</span><br><span class="line">    <span class="keyword">return</span> <span class="title class_">Math</span>.<span class="title function_">round</span>(r);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">showWelcome</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">if</span> (!ipLocation) &#123;</span><br><span class="line">        <span class="title function_">fetchIpLocation</span>(showWelcome);</span><br><span class="line">        <span class="keyword">return</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">let</span> dist = <span class="title function_">getDistance</span>(<span class="number">118.796000</span>, <span class="number">32.058300</span>, ipLocation.<span class="property">result</span>.<span class="property">location</span>.<span class="property">lng</span>, ipLocation.<span class="property">result</span>.<span class="property">location</span>.<span class="property">lat</span>); <span class="comment">//这里记得换成自己的经纬度</span></span><br><span class="line">    <span class="keyword">let</span> pos = ipLocation.<span class="property">result</span>.<span class="property">ad_info</span>.<span class="property">nation</span>;</span><br><span class="line">    <span class="keyword">let</span> ip;</span><br><span class="line">    <span class="keyword">let</span> posdesc;</span><br><span class="line">    <span class="comment">//根据国家、省份、城市信息自定义欢迎语</span></span><br><span class="line">    <span class="keyword">switch</span> (ipLocation.<span class="property">result</span>.<span class="property">ad_info</span>.<span class="property">nation</span>) &#123;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&quot;日本&quot;</span>:</span><br><span class="line">            posdesc = <span class="string">&quot;よろしく，一起去看樱花吗&quot;</span>;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&quot;美国&quot;</span>:</span><br><span class="line">            posdesc = <span class="string">&quot;Let us live in peace!&quot;</span>;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&quot;英国&quot;</span>:</span><br><span class="line">            posdesc = <span class="string">&quot;想同你一起夜乘伦敦眼&quot;</span>;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&quot;俄罗斯&quot;</span>:</span><br><span class="line">            posdesc = <span class="string">&quot;干了这瓶伏特加！&quot;</span>;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&quot;法国&quot;</span>:</span><br><span class="line">            posdesc = <span class="string">&quot;C&#x27;est La Vie&quot;</span>;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&quot;德国&quot;</span>:</span><br><span class="line">            posdesc = <span class="string">&quot;Die Zeit verging im Fluge.&quot;</span>;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&quot;澳大利亚&quot;</span>:</span><br><span class="line">            posdesc = <span class="string">&quot;一起去大堡礁吧！&quot;</span>;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&quot;加拿大&quot;</span>:</span><br><span class="line">            posdesc = <span class="string">&quot;拾起一片枫叶赠予你&quot;</span>;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="keyword">case</span> <span class="string">&quot;中国&quot;</span>:</span><br><span class="line">            pos = ipLocation.<span class="property">result</span>.<span class="property">ad_info</span>.<span class="property">province</span> + <span class="string">&quot; &quot;</span> + ipLocation.<span class="property">result</span>.<span class="property">ad_info</span>.<span class="property">city</span> + <span class="string">&quot; &quot;</span> + ipLocation.<span class="property">result</span>.<span class="property">ad_info</span>.<span class="property">district</span>;</span><br><span class="line">            ip = ipLocation.<span class="property">result</span>.<span class="property">ip</span>;</span><br><span class="line">            <span class="keyword">switch</span> (ipLocation.<span class="property">result</span>.<span class="property">ad_info</span>.<span class="property">province</span>) &#123;</span><br><span class="line">                <span class="keyword">case</span> <span class="string">&quot;北京市&quot;</span>:</span><br><span class="line">                    posdesc = <span class="string">&quot;北——京——欢迎你~~~&quot;</span>;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="string">&quot;天津市&quot;</span>:</span><br><span class="line">                    posdesc = <span class="string">&quot;讲段相声吧&quot;</span>;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="string">&quot;河北省&quot;</span>:</span><br><span class="line">                    posdesc = <span class="string">&quot;山势巍巍成壁垒，天下雄关铁马金戈由此向，无限江山&quot;</span>;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="string">&quot;山西省&quot;</span>:</span><br><span class="line">                    posdesc = <span class="string">&quot;展开坐具长三尺，已占山河五百余&quot;</span>;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="string">&quot;内蒙古自治区&quot;</span>:</span><br><span class="line">                    posdesc = <span class="string">&quot;天苍苍，野茫茫，风吹草低见牛羊&quot;</span>;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="string">&quot;辽宁省&quot;</span>:</span><br><span class="line">                    posdesc = <span class="string">&quot;我想吃烤鸡架！&quot;</span>;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="string">&quot;吉林省&quot;</span>:</span><br><span class="line">                    posdesc = <span class="string">&quot;状元阁就是东北烧烤之王&quot;</span>;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="string">&quot;黑龙江省&quot;</span>:</span><br><span class="line">                    posdesc = <span class="string">&quot;很喜欢哈尔滨大剧院&quot;</span>;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="string">&quot;上海市&quot;</span>:</span><br><span class="line">                    posdesc = <span class="string">&quot;众所周知，中国只有两个城市&quot;</span>;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="string">&quot;江苏省&quot;</span>:</span><br><span class="line">                    <span class="keyword">switch</span> (ipLocation.<span class="property">result</span>.<span class="property">ad_info</span>.<span class="property">city</span>) &#123;</span><br><span class="line">                        <span class="keyword">case</span> <span class="string">&quot;南京市&quot;</span>:</span><br><span class="line">                            posdesc = <span class="string">&quot;博主家乡~ 欢迎来玩~&quot;</span>;</span><br><span class="line">                            <span class="keyword">break</span>;</span><br><span class="line">                        <span class="keyword">case</span> <span class="string">&quot;苏州市&quot;</span>:</span><br><span class="line">                            posdesc = <span class="string">&quot;上有天堂，下有苏杭&quot;</span>;</span><br><span class="line">                            <span class="keyword">break</span>;</span><br><span class="line">                        <span class="attr">default</span>:</span><br><span class="line">                            posdesc = <span class="string">&quot;散装是必须要散装的&quot;</span>;</span><br><span class="line">                            <span class="keyword">break</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="string">&quot;浙江省&quot;</span>:</span><br><span class="line">                    posdesc = <span class="string">&quot;东风渐绿西湖柳，雁已还人未南归&quot;</span>;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="string">&quot;河南省&quot;</span>:</span><br><span class="line">                    <span class="keyword">switch</span> (ipLocation.<span class="property">result</span>.<span class="property">ad_info</span>.<span class="property">city</span>) &#123;</span><br><span class="line">                        <span class="keyword">case</span> <span class="string">&quot;郑州市&quot;</span>:</span><br><span class="line">                            posdesc = <span class="string">&quot;豫州之域，天地之中&quot;</span>;</span><br><span class="line">                            <span class="keyword">break</span>;</span><br><span class="line">                        <span class="keyword">case</span> <span class="string">&quot;南阳市&quot;</span>:</span><br><span class="line">                            posdesc = <span class="string">&quot;臣本布衣，躬耕于南阳此南阳非彼南阳！&quot;</span>;</span><br><span class="line">                            <span class="keyword">break</span>;</span><br><span class="line">                        <span class="keyword">case</span> <span class="string">&quot;驻马店市&quot;</span>:</span><br><span class="line">                            posdesc = <span class="string">&quot;峰峰有奇石，石石挟仙气嵖岈山的花很美哦！&quot;</span>;</span><br><span class="line">                            <span class="keyword">break</span>;</span><br><span class="line">                        <span class="keyword">case</span> <span class="string">&quot;开封市&quot;</span>:</span><br><span class="line">                            posdesc = <span class="string">&quot;刚正不阿包青天&quot;</span>;</span><br><span class="line">                            <span class="keyword">break</span>;</span><br><span class="line">                        <span class="keyword">case</span> <span class="string">&quot;洛阳市&quot;</span>:</span><br><span class="line">                            posdesc = <span class="string">&quot;洛阳牡丹甲天下&quot;</span>;</span><br><span class="line">                            <span class="keyword">break</span>;</span><br><span class="line">                        <span class="attr">default</span>:</span><br><span class="line">                            posdesc = <span class="string">&quot;可否带我品尝河南烩面啦？&quot;</span>;</span><br><span class="line">                            <span class="keyword">break</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="string">&quot;安徽省&quot;</span>:</span><br><span class="line">                    posdesc = <span class="string">&quot;蚌埠住了，芜湖起飞&quot;</span>;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="string">&quot;福建省&quot;</span>:</span><br><span class="line">                    posdesc = <span class="string">&quot;井邑白云间，岩城远带山&quot;</span>;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="string">&quot;江西省&quot;</span>:</span><br><span class="line">                    posdesc = <span class="string">&quot;落霞与孤鹜齐飞，秋水共长天一色&quot;</span>;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="string">&quot;山东省&quot;</span>:</span><br><span class="line">                    posdesc = <span class="string">&quot;遥望齐州九点烟，一泓海水杯中泻&quot;</span>;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="string">&quot;湖北省&quot;</span>:</span><br><span class="line">                    <span class="keyword">switch</span> (ipLocation.<span class="property">result</span>.<span class="property">ad_info</span>.<span class="property">city</span>) &#123;</span><br><span class="line">                        <span class="keyword">case</span> <span class="string">&quot;黄冈市&quot;</span>:</span><br><span class="line">                            posdesc = <span class="string">&quot;红安将军县！辈出将才！&quot;</span>;</span><br><span class="line">                            <span class="keyword">break</span>;</span><br><span class="line">                        <span class="attr">default</span>:</span><br><span class="line">                            posdesc = <span class="string">&quot;来碗热干面~&quot;</span>;</span><br><span class="line">                            <span class="keyword">break</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="string">&quot;湖南省&quot;</span>:</span><br><span class="line">                    posdesc = <span class="string">&quot;74751，长沙斯塔克&quot;</span>;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="string">&quot;广东省&quot;</span>:</span><br><span class="line">                    <span class="keyword">switch</span> (ipLocation.<span class="property">result</span>.<span class="property">ad_info</span>.<span class="property">city</span>) &#123;</span><br><span class="line">                        <span class="keyword">case</span> <span class="string">&quot;广州市&quot;</span>:</span><br><span class="line">                            posdesc = <span class="string">&quot;看小蛮腰，喝早茶了嘛~&quot;</span>;</span><br><span class="line">                            <span class="keyword">break</span>;</span><br><span class="line">                        <span class="keyword">case</span> <span class="string">&quot;深圳市&quot;</span>:</span><br><span class="line">                            posdesc = <span class="string">&quot;今天你逛商场了嘛~&quot;</span>;</span><br><span class="line">                            <span class="keyword">break</span>;</span><br><span class="line">                        <span class="keyword">case</span> <span class="string">&quot;阳江市&quot;</span>:</span><br><span class="line">                            posdesc = <span class="string">&quot;阳春合水！&quot;</span>;</span><br><span class="line">                            <span class="keyword">break</span>;</span><br><span class="line">                        <span class="attr">default</span>:</span><br><span class="line">                            posdesc = <span class="string">&quot;来两斤福建人~&quot;</span>;</span><br><span class="line">                            <span class="keyword">break</span>;</span><br><span class="line">                    &#125;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="string">&quot;广西壮族自治区&quot;</span>:</span><br><span class="line">                    posdesc = <span class="string">&quot;桂林山水甲天下&quot;</span>;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="string">&quot;海南省&quot;</span>:</span><br><span class="line">                    posdesc = <span class="string">&quot;朝观日出逐白浪，夕看云起收霞光&quot;</span>;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="string">&quot;四川省&quot;</span>:</span><br><span class="line">                    posdesc = <span class="string">&quot;康康川妹子&quot;</span>;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="string">&quot;贵州省&quot;</span>:</span><br><span class="line">                    posdesc = <span class="string">&quot;茅台，学生，再塞200&quot;</span>;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="string">&quot;云南省&quot;</span>:</span><br><span class="line">                    posdesc = <span class="string">&quot;玉龙飞舞云缠绕，万仞冰川直耸天&quot;</span>;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="string">&quot;西藏自治区&quot;</span>:</span><br><span class="line">                    posdesc = <span class="string">&quot;躺在茫茫草原上，仰望蓝天&quot;</span>;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="string">&quot;陕西省&quot;</span>:</span><br><span class="line">                    posdesc = <span class="string">&quot;来份臊子面加馍&quot;</span>;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="string">&quot;甘肃省&quot;</span>:</span><br><span class="line">                    posdesc = <span class="string">&quot;羌笛何须怨杨柳，春风不度玉门关&quot;</span>;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="string">&quot;青海省&quot;</span>:</span><br><span class="line">                    posdesc = <span class="string">&quot;牛肉干和老酸奶都好好吃&quot;</span>;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="string">&quot;宁夏回族自治区&quot;</span>:</span><br><span class="line">                    posdesc = <span class="string">&quot;大漠孤烟直，长河落日圆&quot;</span>;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="string">&quot;新疆维吾尔自治区&quot;</span>:</span><br><span class="line">                    posdesc = <span class="string">&quot;驼铃古道丝绸路，胡马犹闻唐汉风&quot;</span>;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="string">&quot;台湾省&quot;</span>:</span><br><span class="line">                    posdesc = <span class="string">&quot;我在这头，大陆在那头&quot;</span>;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="string">&quot;香港特别行政区&quot;</span>:</span><br><span class="line">                    posdesc = <span class="string">&quot;永定贼有残留地鬼嚎，迎击光非岁玉&quot;</span>;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="keyword">case</span> <span class="string">&quot;澳门特别行政区&quot;</span>:</span><br><span class="line">                    posdesc = <span class="string">&quot;性感荷官，在线发牌&quot;</span>;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">                <span class="attr">default</span>:</span><br><span class="line">                    posdesc = <span class="string">&quot;带我去你的城市逛逛吧！&quot;</span>;</span><br><span class="line">                    <span class="keyword">break</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">        <span class="attr">default</span>:</span><br><span class="line">            posdesc = <span class="string">&quot;带我去你的国家逛逛吧&quot;</span>;</span><br><span class="line">            <span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//根据本地时间切换欢迎语</span></span><br><span class="line">    <span class="keyword">let</span> timeChange;</span><br><span class="line">    <span class="keyword">let</span> date = <span class="keyword">new</span> <span class="title class_">Date</span>();</span><br><span class="line">    <span class="keyword">if</span> (date.<span class="title function_">getHours</span>() &gt;= <span class="number">5</span> &amp;&amp; date.<span class="title function_">getHours</span>() &lt; <span class="number">11</span>) timeChange = <span class="string">&quot;&lt;span&gt;🌤️ 早上好，一日之计在于晨&lt;/span&gt;&quot;</span>;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (date.<span class="title function_">getHours</span>() &gt;= <span class="number">11</span> &amp;&amp; date.<span class="title function_">getHours</span>() &lt; <span class="number">13</span>) timeChange = <span class="string">&quot;&lt;span&gt;☀️ 中午好，记得午休喔~&lt;/span&gt;&quot;</span>;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (date.<span class="title function_">getHours</span>() &gt;= <span class="number">13</span> &amp;&amp; date.<span class="title function_">getHours</span>() &lt; <span class="number">17</span>) timeChange = <span class="string">&quot;&lt;span&gt;🕞 下午好，饮茶先啦！&lt;/span&gt;&quot;</span>;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (date.<span class="title function_">getHours</span>() &gt;= <span class="number">17</span> &amp;&amp; date.<span class="title function_">getHours</span>() &lt; <span class="number">19</span>) timeChange = <span class="string">&quot;&lt;span&gt;🚶‍♂️ 即将下班，记得按时吃饭~&lt;/span&gt;&quot;</span>;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (date.<span class="title function_">getHours</span>() &gt;= <span class="number">19</span> &amp;&amp; date.<span class="title function_">getHours</span>() &lt; <span class="number">24</span>) timeChange = <span class="string">&quot;&lt;span&gt;🌙 晚上好，夜生活嗨起来！&lt;/span&gt;&quot;</span>;</span><br><span class="line">    <span class="keyword">else</span> timeChange = <span class="string">&quot;夜深了，早点休息，少熬夜&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 新增ipv6显示为指定内容</span></span><br><span class="line">    <span class="keyword">if</span> (ip.<span class="title function_">includes</span>(<span class="string">&quot;:&quot;</span>)) &#123;</span><br><span class="line">        ip = <span class="string">&quot;&lt;br&gt;好复杂，咱看不懂~(ipv6)&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">try</span> &#123;</span><br><span class="line">        <span class="comment">//自定义文本和需要放的位置</span></span><br><span class="line">        <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;welcome-info&quot;</span>).<span class="property">innerHTML</span> =</span><br><span class="line">            <span class="string">`欢迎来自 &lt;b&gt;&lt;span style=&quot;color: var(--kouseki-ip-color);font-size: var(--kouseki-gl-size)&quot;&gt;<span class="subst">$&#123;pos&#125;</span>&lt;/span&gt;&lt;/b&gt; 的小友💖&lt;br&gt;<span class="subst">$&#123;posdesc&#125;</span>🍂&lt;br&gt;当前位置距博主约 &lt;b&gt;&lt;span style=&quot;color: var(--kouseki-ip-color)&quot;&gt;<span class="subst">$&#123;dist&#125;</span>&lt;/span&gt;&lt;/b&gt; 公里！&lt;br&gt;您的IP地址为：&lt;b&gt;&lt;span&gt;<span class="subst">$&#123;ip&#125;</span>&lt;/span&gt;&lt;/b&gt;&lt;br&gt;<span class="subst">$&#123;timeChange&#125;</span> &lt;br&gt;`</span>;</span><br><span class="line">    &#125; <span class="keyword">catch</span> (err) &#123;</span><br><span class="line">        <span class="variable language_">console</span>.<span class="title function_">log</span>(<span class="string">&quot;Pjax无法获取元素&quot;</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// window.onload = showWelcome;</span></span><br><span class="line"><span class="comment">// window.onload = fetchIpLocation(showWelcome);</span></span><br><span class="line"><span class="variable language_">window</span>.<span class="property">onload</span> = <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="title function_">fetchIpLocation</span>(showWelcome);</span><br><span class="line">&#125;;</span><br><span class="line"><span class="comment">// 如果使用了pjax在加上下面这行代码</span></span><br><span class="line"><span class="variable language_">document</span>.<span class="title function_">addEventListener</span>(<span class="string">&#x27;pjax:complete&#x27;</span>, <span class="keyword">function</span> (<span class="params"></span>) &#123;</span><br><span class="line">    <span class="title function_">fetchIpLocation</span>(showWelcome);</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><p>在<code>hexo</code>目录下新建<code>source/css/welcome.css</code>文件，或者直接在你的自定义样式文件中新增以下内容，，这块可以根据自己的喜好去修改~</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-id">#welcome-info</span> &#123;</span><br><span class="line">    <span class="attribute">overflow</span>: hidden;</span><br><span class="line">    <span class="attribute">border-radius</span>: <span class="number">14px</span>;</span><br><span class="line">    <span class="attr">--kouseki-welcome-color</span>: <span class="number">#49B1F5</span>;</span><br><span class="line">    <span class="attr">--kouseki-ip-color</span>: <span class="number">#49B1F5</span>;</span><br><span class="line">    <span class="attr">--kouseki-gl-size</span>: <span class="number">16px</span><span class="meta">!important</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="2-引入样式"><a href="#2-引入样式" class="headerlink" title="2. 引入样式"></a>2. 引入样式</h2><p>在<code>_config.anzhiyu.yml</code>主题配置文件下<code>inject</code>配置项中的<code>head</code>引入<code>welcome.css</code>，并在<code>bottom</code>引入<code>welcome.js</code></p><figure class="highlight diff"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">inject:</span><br><span class="line">    head:</span><br><span class="line">    - &lt;link rel=&quot;stylesheet&quot; href=&quot;/css/welcome.css&quot;&gt;</span><br><span class="line">    bottom:</span><br><span class="line"><span class="addition">+   - &lt;script defer=&quot;true&quot; src=&quot;/js/welcome.js&quot;&gt;&lt;/script&gt; # 个性定位欢迎信息</span></span><br></pre></td></tr></table></figure><p>在<code>_config.anzhiyu.yml</code>主题配置文件下<code>aside</code>配置项中添加以下内容</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">card_announcement:</span></span><br><span class="line">    <span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line">    <span class="attr">content:</span> <span class="string">&lt;div</span> <span class="string">id=&quot;welcome-info&quot;&gt;&lt;/div&gt;</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Hexo </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 美化 </tag>
            
            <tag> 魔改 </tag>
            
            <tag> AnZhiYu </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>使用Github Action实现全自动部署</title>
      <link href="//posts/57208/"/>
      <url>//posts/57208/</url>
      
        <content type="html"><![CDATA[<h1 id="为什么使用-Github-Action"><a href="#为什么使用-Github-Action" class="headerlink" title="为什么使用 Github Action"></a>为什么使用 Github Action</h1><p>每次部署Hexo都需要运行指令三件套，随着文章越来越多，编译的时间也随之越来越长，通过Github Action，我们只需要在每次完成博客的编写或修改以后，将改动直接push到远程仓库，之后的编译部署的工作统统交给CI来完成即可。</p><h1 id="常量声明"><a href="#常量声明" class="headerlink" title="常量声明"></a>常量声明</h1><table><thead><tr><th align="left">常量名</th><th align="left">常量释义</th></tr></thead><tbody><tr><td align="left"><strong>[Blogroot]</strong></td><td align="left">本地存放博客源码的文件夹路径</td></tr><tr><td align="left"><strong>[SourceRepo]</strong></td><td align="left">存放博客源码的私有仓库名</td></tr><tr><td align="left"><strong>[SiteBlogRepo]</strong></td><td align="left">存放编译好的博客页面的公有仓库名 Site指站点，教程中会替换成 Github、Gitee、Coding</td></tr><tr><td align="left"><strong>[SiteUsername]</strong></td><td align="left">用户名 Site指站点，教程中会替换成 Github、Gitee、Coding</td></tr><tr><td align="left"><strong>[SiteToken]</strong></td><td align="left">申请到的令牌码 Site指站点，教程中会替换成 Github、Gitee、Coding</td></tr><tr><td align="left"><strong>[GithubEmail]</strong></td><td align="left">与github绑定的主邮箱，建议使用Gmail</td></tr><tr><td align="left"><strong>[TokenUser]</strong></td><td align="left">Coding配置特有的令牌用户名</td></tr></tbody></table><h1 id="Github-Action使用教程"><a href="#Github-Action使用教程" class="headerlink" title="Github Action使用教程"></a>Github Action使用教程</h1><h2 id="获取Token"><a href="#获取Token" class="headerlink" title="获取Token"></a>获取Token</h2><p>为了确保交由<code>Github Action</code>来持续部署时，<code>Github Action</code>具备足够的权限来进行<code>hexo deploy</code>操作,需要先获取<code>Token</code></p><p><img src="https://cdn.randench.cn/image/24/08/c079dec6173cc6b2.jpg"></p><p><img src="https://cdn.randench.cn/image/24/08/a9f903618538b942.jpg"></p><p><img src="https://cdn.randench.cn/image/24/08/f4c11d07831e7263.jpg"></p><div class="note warning flat"><p><code>token</code>只会显示这一次，之后将无法查看，所以务必保证你已经记录下了<code>Token</code>。之后如果忘记了就只能重新生成重新配置了。</p></div><h1 id="创建存放源码的私有仓库"><a href="#创建存放源码的私有仓库" class="headerlink" title="创建存放源码的私有仓库"></a>创建存放源码的私有仓库</h1><p>我们需要创建一个用来存放<code>Hexo</code>博客源码的私有仓库<code>[SourceRepo]</code>，这点不再赘述。</p><div class="note info flat"><p>这里之所以是私有仓库，是因为在接下来的配置中会用到<code>Token</code>，如果<code>Token</code>被盗用，别人可以肆意操作你的github仓库内容，为了避免这一风险，才选择的博客源码闭源。</p></div><h1 id="配置Github-Action"><a href="#配置Github-Action" class="headerlink" title="配置Github Action"></a>配置Github Action</h1><ol><li><p>在<code>[Blogroot]</code>新建<code>.github</code>文件夹,注意开头是有个<code>.</code>的。然后在<code>.github</code>内新建<code>workflows</code>文件夹，再在<code>workflows</code>文件夹内新建<code>autodeploy.yml</code>,在<code>[Blogroot]/.github/workflows/autodeploy.yml</code>里面输入</p> <figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 当有改动推送到master分支时，启动Action</span></span><br><span class="line"><span class="attr">name:</span> <span class="string">自动部署</span></span><br><span class="line"></span><br><span class="line"><span class="attr">on:</span></span><br><span class="line"><span class="attr">push:</span></span><br><span class="line">    <span class="attr">branches:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">master</span> <span class="comment">#2020年10月后github新建仓库默认分支改为main，注意更改</span></span><br><span class="line"></span><br><span class="line"><span class="attr">release:</span></span><br><span class="line">    <span class="attr">types:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">published</span></span><br><span class="line"></span><br><span class="line"><span class="attr">jobs:</span></span><br><span class="line"><span class="attr">deploy:</span></span><br><span class="line">    <span class="attr">runs-on:</span> <span class="string">ubuntu-latest</span></span><br><span class="line">    <span class="attr">steps:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">检查分支</span></span><br><span class="line">    <span class="attr">uses:</span> <span class="string">actions/checkout@v2</span></span><br><span class="line">    <span class="attr">with:</span></span><br><span class="line">        <span class="attr">ref:</span> <span class="string">master</span> <span class="comment">#2020年10月后github新建仓库默认分支改为main，注意更改</span></span><br><span class="line"></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">安装</span> <span class="string">Node</span></span><br><span class="line">    <span class="attr">uses:</span> <span class="string">actions/setup-node@v1</span></span><br><span class="line">    <span class="attr">with:</span></span><br><span class="line">        <span class="attr">node-version:</span> <span class="string">&quot;20.x&quot;</span> <span class="comment">#action使用的node版本，建议大版本和本地保持一致。可以在本地用node -v查询版本号。</span></span><br><span class="line"></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">安装</span> <span class="string">Hexo</span></span><br><span class="line">    <span class="attr">run:</span> <span class="string">|</span></span><br><span class="line"><span class="string">        export TZ=&#x27;Asia/Shanghai&#x27;</span></span><br><span class="line"><span class="string">        npm install hexo-cli -g</span></span><br><span class="line"><span class="string"></span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">缓存</span> <span class="string">Hexo</span></span><br><span class="line">    <span class="attr">uses:</span> <span class="string">actions/cache@v1</span></span><br><span class="line">    <span class="attr">id:</span> <span class="string">cache</span></span><br><span class="line">    <span class="attr">with:</span></span><br><span class="line">        <span class="attr">path:</span> <span class="string">node_modules</span></span><br><span class="line">        <span class="attr">key:</span> <span class="string">$&#123;&#123;runner.OS&#125;&#125;-$&#123;&#123;hashFiles(&#x27;**/package-lock.json&#x27;)&#125;&#125;</span></span><br><span class="line"></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">安装依赖</span></span><br><span class="line">    <span class="attr">if:</span> <span class="string">steps.cache.outputs.cache-hit</span> <span class="type">!=</span> <span class="string">&#x27;true&#x27;</span></span><br><span class="line">    <span class="attr">run:</span> <span class="string">|</span></span><br><span class="line"><span class="string">        npm install --save</span></span><br><span class="line"><span class="string"></span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">生成静态文件</span></span><br><span class="line">    <span class="attr">run:</span> <span class="string">|</span></span><br><span class="line"><span class="string">        hexo clean</span></span><br><span class="line"><span class="string">        hexo bangumi -u # 如果安装了hexo-bilibili-bangumi则需要此命令</span></span><br><span class="line"><span class="string">        hexo generate</span></span><br><span class="line"><span class="string">        gulp</span></span><br><span class="line"><span class="string"></span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">部署</span> <span class="comment">#此处master:master 指从本地的master分支提交到远程仓库的master分支，若远程仓库没有对应分支则新建一个。如有其他需要，可以根据自己的需求更改。</span></span><br><span class="line">    <span class="attr">run:</span> <span class="string">|</span></span><br><span class="line"><span class="string">        cd ./public</span></span><br><span class="line"><span class="string">        git init</span></span><br><span class="line"><span class="string">        git config --global user.name &#x27;$&#123;&#123; secrets.GITHUBUSERNAME &#125;&#125;&#x27;</span></span><br><span class="line"><span class="string">        git config --global user.email &#x27;$&#123;&#123; secrets.GITHUBEMAIL &#125;&#125;&#x27;</span></span><br><span class="line"><span class="string">        git add .</span></span><br><span class="line"><span class="string">        git commit -m &quot;$&#123;&#123; github.event.head_commit.message &#125;&#125; $(date +&quot;%Z %Y-%m-%d %A %H:%M:%S&quot;) Updated By Github Actions&quot;</span></span><br><span class="line"><span class="string">        git remote add origin git@github.com:RandomEnch/randomench.github.io.git</span></span><br><span class="line"><span class="string">        git push --force --quiet &quot;https://$&#123;&#123; secrets.GITHUBUSERNAME &#125;&#125;:$&#123;&#123; secrets.GITHUBTOKEN &#125;&#125;@github.com/$&#123;&#123; secrets.GITHUBUSERNAME &#125;&#125;/$&#123;&#123; secrets.GITHUBUSERNAME &#125;&#125;.github.io.git&quot; master:master</span></span><br><span class="line"><span class="string"></span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">name:</span> <span class="string">刷新jsdeliver缓存</span> <span class="comment"># 用于刷新jsdeliver的缓存，如果不使用jsdeliver加速资源可删除</span></span><br><span class="line">    <span class="attr">run:</span> <span class="string">|</span></span><br><span class="line"><span class="string">        curl https://purge.jsdelivr.net/gh/$&#123;&#123; secrets.GITHUBUSERNAME &#125;&#125;/$&#123;&#123; secrets.GITHUBUSERNAME &#125;&#125;.github.io/css/index.css</span></span><br><span class="line"><span class="string">        curl https://purge.jsdelivr.net/gh/$&#123;&#123; secrets.GITHUBUSERNAME &#125;&#125;/$&#123;&#123; secrets.GITHUBUSERNAME &#125;&#125;.github.io/js/main.js</span></span><br><span class="line"><span class="string">        curl https://purge.jsdelivr.net/gh/$&#123;&#123; secrets.GITHUBUSERNAME &#125;&#125;/$&#123;&#123; secrets.GITHUBUSERNAME &#125;&#125;.github.io/js/utils.js</span></span><br><span class="line"><span class="string">        curl https://purge.jsdelivr.net/gh/$&#123;&#123; secrets.GITHUBUSERNAME &#125;&#125;/$&#123;&#123; secrets.GITHUBUSERNAME &#125;&#125;.github.io/js/tw_cn.js</span></span><br><span class="line"><span class="string">        curl https://purge.jsdelivr.net/gh/$&#123;&#123; secrets.GITHUBUSERNAME &#125;&#125;/$&#123;&#123; secrets.GITHUBUSERNAME &#125;&#125;.github.io/js/search/local-search.js</span></span><br></pre></td></tr></table></figure></li></ol>  <div class="note info flat"><p>注意最后一行的<code>master:master</code>指从本地的master分支提交到远程仓库的master分支,需要根据你自己的实际情况进行调整。本地分支可以在git bash中看到。线上分支可以在提交仓库中查看。因为“政治正确”的原因，github在2020年10月将默认分支改为main。而git软件在本地默认创建的分支依然是master，所以若你线上仓库默认分支是main，这里应该写成master:main，表示从本地的master推送到远程的main。</p></div><ol start="2"><li>之后需要自己到仓库的Settings-&gt;Secrets and variables-&gt;Actions 下添加环境变量，变量名参考脚本中出现的，依次添加<code>GITHUBUSERNAME</code>、<code>GITHUBEMAIL</code>、<code>GITHUBTOKEN</code>。变量具体内容释义可以查看本文开头。</li></ol><h1 id="重新设置远程仓库和分支"><a href="#重新设置远程仓库和分支" class="headerlink" title="重新设置远程仓库和分支"></a>重新设置远程仓库和分支</h1><ol><li><p>删除或者先把<code>[Blogroot]/themes/butterfly/.git</code>移动到非博客文件夹目录下,原因是主题文件夹下的<code>.git</code>文件夹的存在会导致其被识别成子项目，从而无法被上传到源码仓库。</p></li><li><p>添加屏蔽项<br>  因为能够使用指令进行安装的内容不包括在需要提交的源码内，所有我们需要将这些内容添加到屏蔽项，表示不上传到github上。这样可以显著减少需要提交的文件量和加快提交速度。<br>  打开<code>[Blogroot]/.gitignore</code>,输入以下内容：</p> <figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">.DS_Store</span><br><span class="line">Thumbs.db</span><br><span class="line">db.json</span><br><span class="line">*.log</span><br><span class="line">node_modules/</span><br><span class="line">public/</span><br><span class="line">.deploy*/</span><br><span class="line">.deploy_git*/</span><br><span class="line">.idea</span><br><span class="line">themes/butterfly/.git</span><br></pre></td></tr></table></figure></li></ol><p>  如果不是<code>butterfly</code>主题，记得替换最后一行内容为你自己当前使用的主题。</p><ol start="3"><li><p>在博客根目录<code>[Blogroot]</code>路径下运行指令将博客源码提交到github上。牢记下方的三行指令，以后都是通过这个指令进行提交。</p> <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">git init <span class="comment">#初始化</span></span><br><span class="line">git remote add origin git@github.com:[GithubUsername]/[SourceRepo].git <span class="comment">#[SourceRepo]为存放源码的github私有仓库</span></span><br><span class="line">git checkout -b master <span class="comment"># 切换到master分支，</span></span><br><span class="line"><span class="comment">#2020年10月后github新建仓库默认分支改为main，注意更改</span></span><br><span class="line"><span class="comment"># 如果不是，后面的所有设置的分支记得保持一致</span></span><br><span class="line">git add .</span><br><span class="line">git commit -m <span class="string">&quot;first commit&quot;</span> <span class="comment">#引号内的内容可以自行更改作为提交记录。</span></span><br><span class="line">git push origin master</span><br><span class="line"><span class="comment">#2020年10月后github新建仓库默认分支改为main，注意更改</span></span><br></pre></td></tr></table></figure></li></ol><h1 id="查看部署情况"><a href="#查看部署情况" class="headerlink" title="查看部署情况"></a>查看部署情况</h1><p>此时，打开GIthub存放源码的私有仓库，找到action。根据刚刚的Commit记录找到相应的任务，点击Deploy查看部署情况，若全部打钩，恭喜你，你现在可以享受自动部署的快感了。</p><p><img src="https://cdn.randench.cn/image/24/08/c19fcb660bf246d4.jpg"></p><p><img src="https://cdn.randench.cn/image/24/08/a46a82e012473714.jpg"></p>]]></content>
      
      
      <categories>
          
          <category> Hexo </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 教程 </tag>
            
            <tag> 实用 </tag>
            
            <tag> git </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>使用npm和jsdelivr加速你的资源</title>
      <link href="//posts/1196/"/>
      <url>//posts/1196/</url>
      
        <content type="html"><![CDATA[<h1 id="jsdelivr"><a href="#jsdelivr" class="headerlink" title="jsdelivr"></a>jsdelivr</h1><p><a href="https://www.jsdelivr.com/?docs=gh">jsdelivr</a>是一个免费的CDN服务，可以利用它配合github来为页面静态资源提供加速，有效提升资源加载速度。</p><div class="note warning flat"><p>jsdelivr有文件大小限制，单文件最大为50M，如果你的文件超过50M，就会访问失败。</p></div><p>要使用jsdelivr加速文件，你需要将文件托管在GitHub上，并通过jsdelivr提供的CDN服务来访问这些文件。以下是如何操作的步骤：</p><h2 id="创建仓库"><a href="#创建仓库" class="headerlink" title="创建仓库"></a>创建仓库</h2><p>在GitHub上创建一个新的仓库，并将你想要加速的文件上传到这个仓库中。确保文件的权限设置允许公开访问。</p><h2 id="使用jsdelivr"><a href="#使用jsdelivr" class="headerlink" title="使用jsdelivr"></a>使用jsdelivr</h2><p>访问jsdelivr的网站，并使用以下格式的URL来访问你的文件：</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://cdn.jsdelivr.net/gh/用户名/仓库名@发布标签/文件路径</span><br></pre></td></tr></table></figure><p>例如：我的项目仓库为<code>https://github.com/RandomEnch/randomench.github.io</code>，我要加速的文件为<code>/js/custom.js</code>，我要发布的版本为<code>latest</code>，那么我可以这样访问：</p><p>要使用jsdelivr就使用如下网址</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">https://cdn.jsdelivr.net/gh/RandomEnch/randomench.github.io@latest/js/custom.js</span><br><span class="line">https://cdn.jsdelivr.net/gh/RandomEnch/randomench.github.io@latest/css/custom.js</span><br></pre></td></tr></table></figure><p>在配置文件中修改本地资源为网址即可</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">inject:</span></span><br><span class="line"><span class="attr">head:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">&lt;link</span> <span class="string">rel=&quot;stylesheet&quot;</span> <span class="string">href=&quot;https://cdn.jsdelivr.net/gh/RandomEnch/randomench.github.io@latest/css/randomench.css&quot;&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="attr">bottom:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">&lt;script</span> <span class="string">defer</span> <span class="string">src=&quot;https://cdn.jsdelivr.net/gh/RandomEnch/randomench.github.io@latest/live2d-widget/autoload.js&quot;&gt;&lt;/script&gt;</span>  <span class="comment"># live2d</span></span><br></pre></td></tr></table></figure><h1 id="npm"><a href="#npm" class="headerlink" title="npm"></a>npm</h1><h2 id="注册账号"><a href="#注册账号" class="headerlink" title="注册账号"></a>注册账号</h2><ol><li>首先需要注册一个npm的账号。访问<a href="https://www.npmjs.com/signup/">npm注册页面</a></li><li>完成邮箱验证，注册完成后进入账号管理界面:头像-&gt;Account，拉倒最上方，你会看到<code>You have not verified your email address</code>字样的提示，点击以后按提示步骤验证你的邮箱。</li></ol><h2 id="发布npm包"><a href="#发布npm包" class="headerlink" title="发布npm包"></a>发布npm包</h2><ol><li><p>在本地新建一个文件夹，用于存放需要加速的文件，或者直接上传整个网站目录</p></li><li><p>文件夹内打开终端，输入以下指令切换回原生源</p> <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm config <span class="built_in">set</span> registry https://registry.npmjs.org</span><br></pre></td></tr></table></figure></li><li><p>添加本地npm用户设置</p> <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 仅第一次使用需要添加用户，之后会提示你输入你的npm账号密码以及注册邮箱</span></span><br><span class="line">npm adduser</span><br><span class="line"><span class="comment"># 非第一次使用直接登录即可，之后会提示你输入你的npm账号密码以及注册邮箱</span></span><br><span class="line">npm login</span><br></pre></td></tr></table></figure></li><li><p>运行npm初始化指令，把整个图床仓库打包，按照指示进行配置，<em>注意需要事先确认你的包名没有和别人已发布的包重复</em>，可以在<a href="https://www.npmjs.com/">npm官网</a>搜索相应包名，搜不到就说明还没被占用。</p> <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm init</span><br></pre></td></tr></table></figure><p> <img src="https://npm.elemecdn.com/akilar-candyassets/image/6000c029.png"></p><p> 最后会输出一段package.json，请求确认，输入yes即可</p></li><li><p>然后输入发布指令，我们就可以把包发布到npm上了。</p> <figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm publish</span><br></pre></td></tr></table></figure></li></ol><h2 id="使用npm的加速cdn网址访问资源"><a href="#使用npm的加速cdn网址访问资源" class="headerlink" title="使用npm的加速cdn网址访问资源"></a>使用npm的加速cdn网址访问资源</h2><p>npm的资源引用和jsdelivr很相似，例如我在<code>[AssetsRepo]</code>仓库里存放的<code>/img/index.png</code></p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">jsDelivr链接</span><br><span class="line">https://cdn.jsdelivr.net/gh/[GithubUserName]/[AssetsRepo]/img/index.png</span><br><span class="line">npm链接</span><br><span class="line">https://npm.elemecdn.com/[NpmPackageName]/img/index.png</span><br></pre></td></tr></table></figure><div class="note success flat"><p>可以看到Npm只需要提供包名即可。这也是一开始要求包名不重复的原因之一</p></div><p>Npm依然有100MB的包大小限制，但是NPM有丰富的国内节点。可以挑选一个使用。</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">【jsd出品，网宿国内节点】</span><br><span class="line">https://npm.elemecdn.com/:package@:version/:file</span><br><span class="line">【百度出品，网宿国内节点】</span><br><span class="line">https://code.bdstatic.com/npm/:package@:version/:file</span><br><span class="line">【饿了么出品，网宿国内节点】</span><br><span class="line">https://shadow.elemecdn.com/npm/:package@:version/:file</span><br></pre></td></tr></table></figure><p>当然你也可以利用<a href="https://unpkg.com/">unpkg</a>。(UNPKG是一个内容源自npm的全球快速CDN。它部署在cloudflare上，在大陆地区访问到的是香港节点。所以速度也不错。)</p><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">https://unpkg.com/:package@:version/:file</span><br></pre></td></tr></table></figure><h1 id="使用npm作为图床"><a href="#使用npm作为图床" class="headerlink" title="使用npm作为图床"></a>使用npm作为图床</h1><div class="note warning flat"><p>npm作为图床，虽然可以加速静态资源，但也有一些限制，例如：</p><ol><li>单文件大小限制为50M，如果你的文件超过50M，就会访问失败。</li><li>不能直接访问文件，只能通过cdn加速。</li><li>不能直接上传文件，需要先上传到github仓库，然后再发布到npm。</li><li>上传文件需要手动更新版本号，并且需要在本地进行操作。</li><li>上传文件往往需要梯子才能正常上传。</li></ol></div><h2 id="配置PicGo-PicX"><a href="#配置PicGo-PicX" class="headerlink" title="配置PicGo&#x2F;PicX"></a>配置PicGo&#x2F;PicX</h2><p>这一步是为了实现图片上传至Github仓库。但不推荐直接以此方案当做图床</p><div class="note success flat"><ol><li>GitHub图床仓库大小不能超过 1G。因为GitHub原则上是反对仓库图床化的，当仓库超过 1G 后会有人工审核仓库内容，如果发现用来做图床，轻则删库重则封号，需注意。</li><li>因为jsDelivr加速的单文件大小为50M。这也就限制了单张图片大小上限。</li></ol></div><div class="tabs" id="img"><ul class="nav-tabs"><button type="button" class="tab  active" data-href="img-1">PicGo</button><button type="button" class="tab " data-href="img-2">PicX</button></ul><div class="tab-contents"><div class="tab-item-content active" id="img-1"><ol><li><p>首先创建一个图床仓库用来存放图片，仓库名随意。以下会以<code>[AssetsRepo]</code>指代这个静态资源仓库。</p></li><li><p>访问<a href="https://github.com/settings/tokens">Github-&gt;头像（右上角）-&gt;Settings-&gt;Developer Settings-&gt;Personal access tokens</a>-&gt;<code>generate new token (Classic)</code>,创建的<code>Token</code>名称随意，但必须勾选<code>repo</code>项。</p></li></ol><p>  <code>token</code>只会显示这一次，之后将无法查看，所以务必保证你已经记录下了<code>Token</code>。之后如果忘记了就只能重新生成重新配置了。</p><ol start="3"><li><p>下载Picgo软件，可以直接访问Picgo的github仓库，在<a href="https://github.com/Molunerfinn/picgo/releases">release</a>中下载最新版本的安装包。<br>  <a href="https://github.com/Molunerfinn/picgo"><img src="https://github-readme-stats.vercel.app/api/pin/?username=Molunerfinn&repo=picgo&show_owner=true"></a> </p></li><li><p>打开Picgo，找到图床设置，选择Github图床，根据指示填写对应内容。</p></li></ol><ul><li>设定仓库名：[UserName]&#x2F;[AssetsRepo]</li><li>设定分支名：2020年10月后github新建仓库默认分支改为<code>main</code>,在这之前的是<code>master</code>。</li><li>设定Token：填入第二步时申请到的<code>Token</code></li><li>指定存储路径：这是存放图片的路径，这里可以直接写<code>/</code>表示存放在根目录。</li><li>设定自定义域名：在图片上传后，PicGo会按照<code>自定义域名+指定储存路径+上传的图片名</code>的方式生成访问链接，并放到粘贴板上，例如要使用<code>jsDelivr</code>加速，则设置为<code>https://cdn.jsdelivr.net/gh/[UserName]/[AssetsRepo]</code>，上传完毕后，我们就可以通过<code>https://cdn.jsdelivr.net/gh/[UserName]/[AssetsRepo]/指定存储路径/图片名</code>加速访问我们的图片了。</li></ul></div><div class="tab-item-content" id="img-2"><ol><li><p>首先创建一个图床仓库用来存放图片，仓库名随意。以下会以<code>[AssetsRepo]</code>指代这个静态资源仓库。</p></li><li><p>访问<a href="https://github.com/settings/tokens">Github-&gt;头像（右上角）-&gt;Settings-&gt;Developer Settings-&gt;Personal access tokens</a>-&gt;<code>generate new token (Classic)</code>,创建的<code>Token</code>名称随意，但必须勾选<code>repo</code>项。<br>  <code>token</code>只会显示这一次，之后将无法查看，所以务必保证你已经记录下了<code>Token</code>。之后如果忘记了就只能重新生成重新配置了。  </p></li><li><p><a href="https://picx.xpoet.cn/">PicX官网</a>就已经提供了构建好的项目，可以通过直接在官方提供的网站填入<code>Token</code>来使用。<br>  <a href="https://github.com/XPoet/picx"><img src="https://github-readme-stats.vercel.app/api/pin/?username=XPoet&repo=picx&show_owner=true"></a></p></li></ol></div></div><div class="tab-to-top"><button type="button" aria-label="scroll to top"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i></button></div></div><h2 id="上传npm"><a href="#上传npm" class="headerlink" title="上传npm"></a>上传npm</h2><p>基本步骤与本地资源相同，改动第三步即可</p><p>找到我们之前创建的图床仓库，在本地合适的位置把它<code>clone</code>下来。找个空文件夹打开终端输入</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">git <span class="built_in">clone</span> git@github.com:[username]/[AssetsRepo].git</span><br><span class="line"><span class="comment">#或者</span></span><br><span class="line">git <span class="built_in">clone</span> https://github.com/[username]/[AssetsRepo].git</span><br></pre></td></tr></table></figure><p>如果每次都要在本地进行<code>npm publish</code>的话，npm的提交是整个包一起上传的，不存在增量更新，耗时不说，而且还往往需要架梯子才能正常上传。所以我们可以把它交给github action来完成。</p><ul><li><p>在<a href="https://www.npmjs.com/">npm官网</a>-&gt;头像-&gt;Access Tokens-&gt;Generate New Token,勾选Automation选项，<code>Token</code>只会显示这一次，之后如果忘记了就只能重新生成重新配置了。</p><p><img src="https://npm.elemecdn.com/akilar-candyassets/image/0158bc90.png"></p></li><li><p>在github的[AssetsRepo]仓库设置项里添加一个名为<code>NPM_TOKEN</code>的<code>secrets</code>，把获取的Npm的Access token输入进去。</p><p><img src="https://npm.elemecdn.com/akilar-candyassets/image/c6dbbfb5.png"></p></li><li><p>在本地的<code>[AssetsRepo]</code>文件夹下新建<code>[AssetsRepo]/.github/workflows/autopublish.yml</code></p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">name:</span> <span class="string">Node.js</span> <span class="string">Package</span></span><br><span class="line"><span class="comment"># 监测图床分支，2020年10月后github新建仓库默认分支改为main，记得更改</span></span><br><span class="line"><span class="attr">on:</span></span><br><span class="line"><span class="attr">push:</span></span><br><span class="line">    <span class="attr">branches:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">master</span></span><br><span class="line"></span><br><span class="line"><span class="attr">jobs:</span></span><br><span class="line"><span class="attr">publish-npm:</span></span><br><span class="line">    <span class="attr">runs-on:</span> <span class="string">ubuntu-latest</span></span><br><span class="line">    <span class="attr">steps:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">uses:</span> <span class="string">actions/checkout@v2</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">uses:</span> <span class="string">actions/setup-node@v1</span></span><br><span class="line">        <span class="attr">with:</span></span><br><span class="line">        <span class="attr">node-version:</span> <span class="string">&quot;12.x&quot;</span></span><br><span class="line">        <span class="attr">registry-url:</span> <span class="string">https://registry.npmjs.org/</span></span><br><span class="line">    <span class="bullet">-</span> <span class="attr">run:</span> <span class="string">npm</span> <span class="string">publish</span></span><br><span class="line">        <span class="attr">env:</span></span><br><span class="line">        <span class="attr">NODE_AUTH_TOKEN:</span> <span class="string">$&#123;&#123;secrets.npm_token&#125;&#125;</span></span><br></pre></td></tr></table></figure></li><li><p>在本地的<code>[AssetsRepo]</code>文件夹下打开终端，运行以下指令，上传新增内容至github，即可触发部署。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 将更改提交</span></span><br><span class="line">git add .</span><br><span class="line">git commit -m <span class="string">&quot;npm publish&quot;</span></span><br><span class="line"><span class="comment"># 更新package版本号</span></span><br><span class="line">npm version patch</span><br><span class="line"><span class="comment"># 推送至github触发action</span></span><br><span class="line">git push</span><br></pre></td></tr></table></figure></li></ul><div class="note warning flat"><p>此处的四行指令顺序严格。<br>每次更新npm图床都需要先修改<code>[AssetsRepo]\package.json</code>里的<code>version</code>,也就是版本号。<br>而<code>npm version patch</code>即为更新package.json里的版本号的指令，效果是末尾版本号+1，例如<code>0.0.1=&gt;0.0.2</code>、<code>1.1.3=&gt;1.1.4</code>。免去了打开<code>package.json</code>再修改版本号的麻烦。（大版本更新还是需要手动改的）<br>更新npm图床务必要记得更新<code>package.json</code>里的版本号！</p></div>]]></content>
      
      
      <categories>
          
          <category> Hexo </category>
          
          <category> 实用 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 实用 </tag>
            
            <tag> git </tag>
            
            <tag> cdn </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>使用gulp压缩静态资源</title>
      <link href="//posts/30457/"/>
      <url>//posts/30457/</url>
      
        <content type="html"><![CDATA[<h1 id="写在前面"><a href="#写在前面" class="headerlink" title="写在前面"></a>写在前面</h1><p>gulp能够帮助用户自动压缩静态资源，配合各类下属插件，能够压缩包括css、js、html乃至各类格式的图片文件。（图片文件的压缩往往只能节省几十KB，效果远远不如imagine、tinypng等压缩方式，所以此处不再写使用gulp压缩图片的内容）。为了加快网站的加载速度，压缩静态资源是十分必要的。</p><h1 id="配置教程"><a href="#配置教程" class="headerlink" title="配置教程"></a>配置教程</h1><h2 id="安装Gulp插件"><a href="#安装Gulp插件" class="headerlink" title="安装Gulp插件"></a>安装Gulp插件</h2><p>在博客根目录<code>[Blogroot]</code>打开终端，输入：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">npm install --global gulp-cli <span class="comment">#全局安装gulp指令集</span></span><br><span class="line">npm install gulp --save <span class="comment">#安装gulp插件</span></span><br></pre></td></tr></table></figure><h2 id="安装下属插件"><a href="#安装下属插件" class="headerlink" title="安装下属插件"></a>安装下属插件</h2><ul><li><p>压缩HTML：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">npm install gulp-htmlclean --save-dev</span><br><span class="line">npm install gulp-html-minifier-terser --save-dev</span><br><span class="line"><span class="comment"># 用gulp-html-minifier-terser可以压缩HTML中的ES6语法</span></span><br></pre></td></tr></table></figure></li><li><p>压缩CSS：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install gulp-clean-css --save-dev</span><br></pre></td></tr></table></figure></li><li><p>压缩JS</p><p>方案一：为了适配绝大多数浏览器（<del>IE：就是老子</del>），可以将ES6语法降为ES5语法。则使用<a href="https://github.com/babel/gulp-babel">gulp-babel</a>，这一方案在压缩部分使用了ES6的js以后，由于强制降级导致变量生命周期的变动，会引发一系列迷之bug，需要手动再去添加屏蔽项以选择不压缩对应的js，十分麻烦，故不予采用。</p><p>方案二：<a href="https://github.com/duan602728596/gulp-terser">gulp-terser</a>只会直接压缩js代码，所以不存在因为语法变动导致的错误 。<br>事实上，当我们使用<code>jsdelivr</code>的<code>CDN</code>服务时，只需要在<code>css</code>或者<code>js</code>的后缀前添加<code>.min</code>, 例如 <code>example.js-&gt;example.min.js</code>, <code>JsDelivr</code> 就会自动使用 <code>terser</code> 帮我们压缩好代码。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install gulp-terser --save-dev</span><br></pre></td></tr></table></figure></li><li><p>压缩字体</p><div class="tip cogs"><p>字体文件作为最让人又爱又恨的静态资源，为了保证站点文字匹配，全字库字体包往往超过15MB，这对博客的加载速度造成了巨大压力。fontmin可以遍历博客内用到的字符，并将字体包内这些字符的字体样式提取出来输出为新的字体包。</p></div><div class="note warning flat"><p>font-min仅支持压缩ttf格式的字体包</p></div><div class="note danger flat"><p>font-min已经过于老旧，压缩时可能会出现一些问题，如果需要压缩字体，可以查看文章<a href="https://blog.randench.cn/posts/61148/">网站字体压缩</a></p></div><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">npm install gulp-fontmin --save-dev</span><br></pre></td></tr></table></figure></li></ul><h2 id="创建Gulp任务脚本"><a href="#创建Gulp任务脚本" class="headerlink" title="创建Gulp任务脚本"></a>创建Gulp任务脚本</h2><p>在博客根目录<code>[Blogroot]</code>下新建<code>gulpfile.js</code>,打开<code>[Blogroot]\gulpfile.js</code>,输入以下内容：</p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//用到的各个插件</span></span><br><span class="line"><span class="keyword">var</span> gulp = <span class="built_in">require</span>(<span class="string">&#x27;gulp&#x27;</span>);</span><br><span class="line"><span class="keyword">var</span> cleanCSS = <span class="built_in">require</span>(<span class="string">&#x27;gulp-clean-css&#x27;</span>);</span><br><span class="line"><span class="keyword">var</span> htmlmin = <span class="built_in">require</span>(<span class="string">&#x27;gulp-html-minifier-terser&#x27;</span>);</span><br><span class="line"><span class="keyword">var</span> htmlclean = <span class="built_in">require</span>(<span class="string">&#x27;gulp-htmlclean&#x27;</span>);</span><br><span class="line"><span class="keyword">var</span> fontmin = <span class="built_in">require</span>(<span class="string">&#x27;gulp-fontmin&#x27;</span>);</span><br><span class="line"><span class="comment">// gulp-tester</span></span><br><span class="line"><span class="keyword">var</span> terser = <span class="built_in">require</span>(<span class="string">&#x27;gulp-terser&#x27;</span>);</span><br><span class="line"><span class="comment">// 压缩js</span></span><br><span class="line">gulp.<span class="title function_">task</span>(<span class="string">&#x27;compress&#x27;</span>, <span class="title function_">async</span>() =&gt;&#123;</span><br><span class="line">  gulp.<span class="title function_">src</span>([<span class="string">&#x27;./public/**/*.js&#x27;</span>, <span class="string">&#x27;!./public/**/*.min.js&#x27;</span>])</span><br><span class="line">    .<span class="title function_">pipe</span>(<span class="title function_">terser</span>())</span><br><span class="line">    .<span class="title function_">pipe</span>(gulp.<span class="title function_">dest</span>(<span class="string">&#x27;./public&#x27;</span>))</span><br><span class="line">&#125;);</span><br><span class="line"><span class="comment">//压缩css</span></span><br><span class="line">gulp.<span class="title function_">task</span>(<span class="string">&#x27;minify-css&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> gulp.<span class="title function_">src</span>([<span class="string">&#x27;./public/**/*.css&#x27;</span>])</span><br><span class="line">        .<span class="title function_">pipe</span>(<span class="title function_">cleanCSS</span>(&#123;</span><br><span class="line">            <span class="attr">compatibility</span>: <span class="string">&#x27;ie11&#x27;</span></span><br><span class="line">        &#125;))</span><br><span class="line">        .<span class="title function_">pipe</span>(gulp.<span class="title function_">dest</span>(<span class="string">&#x27;./public&#x27;</span>));</span><br><span class="line">&#125;);</span><br><span class="line"><span class="comment">//压缩html</span></span><br><span class="line">gulp.<span class="title function_">task</span>(<span class="string">&#x27;minify-html&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> gulp.<span class="title function_">src</span>(<span class="string">&#x27;./public/**/*.html&#x27;</span>)</span><br><span class="line">        .<span class="title function_">pipe</span>(<span class="title function_">htmlclean</span>())</span><br><span class="line">        .<span class="title function_">pipe</span>(<span class="title function_">htmlmin</span>(&#123;</span><br><span class="line">            <span class="attr">removeComments</span>: <span class="literal">true</span>, <span class="comment">//清除html注释</span></span><br><span class="line">            <span class="attr">collapseWhitespace</span>: <span class="literal">true</span>, <span class="comment">//压缩html</span></span><br><span class="line">            <span class="attr">collapseBooleanAttributes</span>: <span class="literal">true</span>,</span><br><span class="line">            <span class="comment">//省略布尔属性的值，例如：&lt;input checked=&quot;true&quot;/&gt; ==&gt; &lt;input /&gt;</span></span><br><span class="line">            <span class="attr">removeEmptyAttributes</span>: <span class="literal">true</span>,</span><br><span class="line">            <span class="comment">//删除所有空格作属性值，例如：&lt;input id=&quot;&quot; /&gt; ==&gt; &lt;input /&gt;</span></span><br><span class="line">            <span class="attr">removeScriptTypeAttributes</span>: <span class="literal">true</span>,</span><br><span class="line">            <span class="comment">//删除&lt;script&gt;的type=&quot;text/javascript&quot;</span></span><br><span class="line">            <span class="attr">removeStyleLinkTypeAttributes</span>: <span class="literal">true</span>,</span><br><span class="line">            <span class="comment">//删除&lt;style&gt;和&lt;link&gt;的 type=&quot;text/css&quot;</span></span><br><span class="line">            <span class="attr">minifyJS</span>: <span class="literal">true</span>, <span class="comment">//压缩页面 JS</span></span><br><span class="line">            <span class="attr">minifyCSS</span>: <span class="literal">true</span>, <span class="comment">//压缩页面 CSS</span></span><br><span class="line">            <span class="attr">minifyURLs</span>: <span class="literal">true</span>  <span class="comment">//压缩页面URL</span></span><br><span class="line">        &#125;))</span><br><span class="line">        .<span class="title function_">pipe</span>(gulp.<span class="title function_">dest</span>(<span class="string">&#x27;./public&#x27;</span>))</span><br><span class="line">&#125;);</span><br><span class="line"><span class="comment">//压缩字体</span></span><br><span class="line"><span class="comment">//由于font-min已经过于老旧，局限性较大，且可能存在问题，此处注释掉，不予采用</span></span><br><span class="line"><span class="comment">// function minifyFont(text, cb) &#123;</span></span><br><span class="line"><span class="comment">//   gulp</span></span><br><span class="line"><span class="comment">//     .src(&#x27;./public/fonts/*.ttf&#x27;) //原字体所在目录</span></span><br><span class="line"><span class="comment">//     .pipe(fontmin(&#123;</span></span><br><span class="line"><span class="comment">//       text: text</span></span><br><span class="line"><span class="comment">//     &#125;))</span></span><br><span class="line"><span class="comment">//     .pipe(gulp.dest(&#x27;./public/fontsdest/&#x27;)) //压缩后的输出目录</span></span><br><span class="line"><span class="comment">//     .on(&#x27;end&#x27;, cb);</span></span><br><span class="line"><span class="comment">// &#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// gulp.task(&#x27;mini-font&#x27;, (cb) =&gt; &#123;</span></span><br><span class="line"><span class="comment">//   var buffers = [];</span></span><br><span class="line"><span class="comment">//   gulp</span></span><br><span class="line"><span class="comment">//     .src([&#x27;./public/**/*.html&#x27;]) //HTML文件所在目录请根据自身情况修改</span></span><br><span class="line"><span class="comment">//     .on(&#x27;data&#x27;, function(file) &#123;</span></span><br><span class="line"><span class="comment">//       buffers.push(file.contents);</span></span><br><span class="line"><span class="comment">//     &#125;)</span></span><br><span class="line"><span class="comment">//     .on(&#x27;end&#x27;, function() &#123;</span></span><br><span class="line"><span class="comment">//       var text = Buffer.concat(buffers).toString(&#x27;utf-8&#x27;);</span></span><br><span class="line"><span class="comment">//       minifyFont(text, cb);</span></span><br><span class="line"><span class="comment">//     &#125;);</span></span><br><span class="line"><span class="comment">// &#125;);</span></span><br><span class="line"><span class="comment">// 运行gulp命令时依次执行以下任务</span></span><br><span class="line"><span class="comment">// gulp.task(&#x27;default&#x27;, gulp.parallel(</span></span><br><span class="line"><span class="comment">//   &#x27;compress&#x27;, &#x27;minify-css&#x27;, &#x27;minify-html&#x27;,&#x27;mini-font&#x27;</span></span><br><span class="line"><span class="comment">// ))</span></span><br><span class="line">gulp.<span class="title function_">task</span>(<span class="string">&#x27;default&#x27;</span>, gulp.<span class="title function_">parallel</span>(</span><br><span class="line">  <span class="string">&#x27;compress&#x27;</span>, <span class="string">&#x27;minify-css&#x27;</span>, <span class="string">&#x27;minify-html&#x27;</span></span><br><span class="line">))</span><br></pre></td></tr></table></figure><h2 id="使用方法"><a href="#使用方法" class="headerlink" title="使用方法"></a>使用方法</h2><p>在每次运行完<code>hexo generate</code>生成静态页面后，运行<code>gulp</code>对其进行压缩。指令流程如下：</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">hexo clean</span><br><span class="line">hexo generate</span><br><span class="line">gulp</span><br></pre></td></tr></table></figure><h2 id="补充说明"><a href="#补充说明" class="headerlink" title="补充说明"></a>补充说明</h2><p>关于font-min的补充说明，在本文中，是通过读取所有编译好的html文件（<code>./public/**/*.html</code>）中的字符，然后匹配原有字体包内<code>./public/fonts/*.ttf</code>字体样式，输出压缩后的字体包到<code>./public/fontsdest/</code>目录。所以最终引用字体的相对路径应该是<code>/fontsdest/*.ttf</code>。而本地测试时，如果没有运行gulp，自然也就不会输出压缩字体包到public目录，也就看不到字体样式。</p>]]></content>
      
      
      <categories>
          
          <category> Hexo </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 教程 </tag>
            
            <tag> 实用 </tag>
            
            <tag> git </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>版权样式修改</title>
      <link href="//posts/23686/"/>
      <url>//posts/23686/</url>
      
        <content type="html"><![CDATA[<div class="note warning flat"><p>本文修改主题为<code>Butterfly</code>主题，若使用其他主题，请自行确认修改位置。</p></div><h1 id="原文出处"><a href="#原文出处" class="headerlink" title="原文出处"></a>原文出处</h1><blockquote><p><a href="https://akilar.top/posts/8322f8e6/">https://akilar.top/posts/8322f8e6/</a></p></blockquote><h1 id="效果预览"><a href="#效果预览" class="headerlink" title="效果预览"></a>效果预览</h1><p><img src="https://cdn.randench.cn/image/24/08/281aec93709ad5ea.png" alt="版权样式"></p><h1 id="修改步骤"><a href="#修改步骤" class="headerlink" title="修改步骤"></a>修改步骤</h1><ol><li><p>修改<code>[Blogroot]\themes\butterfly\layout\includes\post\post-copyright.pug</code>,直接复制以下内容替换原文件内容。此处多次用到了三元运算符作为默认项设置，在确保有主题配置文件的默认项的情况下，也可以在相应文章的<code>front-matter</code>中重新定义作者，原文链接，开源许可协议等内容。</p> <figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">if theme.post_copyright.enable &amp;&amp; page.copyright !== false</span><br><span class="line">  - let author = page.copyright_author ? page.copyright_author : config.author</span><br><span class="line">  - let url = page.copyright_url ? page.copyright_url : page.permalink</span><br><span class="line">  - let license = page.license ? page.license : theme.post_copyright.license</span><br><span class="line">  - let license_url = page.license_url ? page.license_url : theme.post_copyright.license_url</span><br><span class="line">  .post-copyright</span><br><span class="line">    .post-copyright__title</span><br><span class="line">      span.post-copyright-info</span><br><span class="line">        h #[=page.title]</span><br><span class="line">    .post-copyright__type</span><br><span class="line">      span.post-copyright-info</span><br><span class="line">        a(href=url_for(url))= theme.post_copyright.decode ? decodeURI(url) : url</span><br><span class="line">    .post-copyright-m</span><br><span class="line">      .post-copyright-m-info</span><br><span class="line">        .post-copyright-a</span><br><span class="line">            h 作者</span><br><span class="line">            .post-copyright-cc-info</span><br><span class="line">                h=author</span><br><span class="line">        .post-copyright-c</span><br><span class="line">            h 发布于</span><br><span class="line">            .post-copyright-cc-info</span><br><span class="line">                h=date(page.date, config.date_format)</span><br><span class="line">        .post-copyright-u</span><br><span class="line">            h 更新于</span><br><span class="line">            .post-copyright-cc-info</span><br><span class="line">                h=date(page.updated, config.date_format)</span><br><span class="line">        .post-copyright-c</span><br><span class="line">            h 许可协议</span><br><span class="line">            .post-copyright-cc-info</span><br><span class="line">                a.icon(rel=&#x27;noopener&#x27; target=&#x27;_blank&#x27; title=&#x27;Creative Commons&#x27; href=&#x27;https://   creativecommons.org/&#x27;)</span><br><span class="line">                  i.fab.fa-creative-commons</span><br><span class="line">                a(rel=&#x27;noopener&#x27; target=&#x27;_blank&#x27; title=license href=url_for(license_url))=license</span><br></pre></td></tr></table></figure></li><li><p>修改<code>[Blogroot]\themes\butterfly\source\css\_layout\post.styl</code>,直接复制以下内容，替换原文件。</p> <figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="title">beautify</span><span class="params">()</span></span></span><br><span class="line">  <span class="built_in">headStyle</span>(fontsize)</span><br><span class="line">    <span class="attribute">padding-left</span>: <span class="built_in">unit</span>(fontsize + <span class="number">12</span>, <span class="string">&#x27;px&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="selector-pseudo">&amp;:before</span></span><br><span class="line">      <span class="attribute">margin-left</span>: <span class="built_in">unit</span>((<span class="built_in">-</span>(fontsize + <span class="number">6</span>)), <span class="string">&#x27;px&#x27;</span>)</span><br><span class="line">      <span class="attribute">font-size</span>: <span class="built_in">unit</span>(fontsize, <span class="string">&#x27;px&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="selector-pseudo">&amp;:hover</span></span><br><span class="line">      <span class="attribute">padding-left</span>: <span class="built_in">unit</span>(fontsize + <span class="number">18</span>, <span class="string">&#x27;px&#x27;</span>)</span><br><span class="line"></span><br><span class="line">  <span class="selector-tag">h1</span>,</span><br><span class="line">  <span class="selector-tag">h2</span>,</span><br><span class="line">  <span class="selector-tag">h3</span>,</span><br><span class="line">  <span class="selector-tag">h4</span>,</span><br><span class="line">  <span class="selector-tag">h5</span>,</span><br><span class="line">  <span class="selector-tag">h6</span></span><br><span class="line">    <span class="attribute">transition</span>: all .<span class="number">2s</span> ease-out</span><br><span class="line"></span><br><span class="line">    <span class="selector-pseudo">&amp;:before</span></span><br><span class="line">      <span class="attribute">position</span>: absolute</span><br><span class="line">      <span class="attribute">top</span>: <span class="built_in">calc</span>(<span class="number">50%</span> - <span class="number">7px</span>)</span><br><span class="line">      <span class="attribute">color</span>: <span class="variable">$title</span>-prefix-icon-color</span><br><span class="line">      <span class="attribute">content</span>: <span class="variable">$title</span>-prefix-icon</span><br><span class="line">      <span class="attribute">line-height</span>: <span class="number">1</span></span><br><span class="line">      <span class="attribute">transition</span>: all .<span class="number">2s</span> ease-out</span><br><span class="line">      <span class="keyword">@extend</span> <span class="selector-class">.fontawesomeIcon</span></span><br><span class="line"></span><br><span class="line">    <span class="selector-pseudo">&amp;:hover</span></span><br><span class="line">      <span class="selector-pseudo">&amp;:before</span></span><br><span class="line">        <span class="attribute">color</span>: <span class="variable">$light</span>-blue</span><br><span class="line"></span><br><span class="line">  <span class="selector-tag">h1</span></span><br><span class="line">    <span class="built_in">headStyle</span>(<span class="number">20</span>)</span><br><span class="line"></span><br><span class="line">  <span class="selector-tag">h2</span></span><br><span class="line">    <span class="built_in">headStyle</span>(<span class="number">18</span>)</span><br><span class="line"></span><br><span class="line">  <span class="selector-tag">h3</span></span><br><span class="line">    <span class="built_in">headStyle</span>(<span class="number">16</span>)</span><br><span class="line"></span><br><span class="line">  <span class="selector-tag">h4</span></span><br><span class="line">    <span class="built_in">headStyle</span>(<span class="number">14</span>)</span><br><span class="line"></span><br><span class="line">  <span class="selector-tag">h5</span></span><br><span class="line">    <span class="built_in">headStyle</span>(<span class="number">12</span>)</span><br><span class="line"></span><br><span class="line">  <span class="selector-tag">h6</span></span><br><span class="line">    <span class="built_in">headStyle</span>(<span class="number">12</span>)</span><br><span class="line"></span><br><span class="line">  <span class="selector-tag">ol</span>,</span><br><span class="line">  <span class="selector-tag">ul</span></span><br><span class="line">    <span class="selector-tag">p</span></span><br><span class="line">      <span class="attribute">margin</span>: <span class="number">0</span> <span class="number">0</span> <span class="number">8px</span></span><br><span class="line"></span><br><span class="line">  <span class="selector-tag">li</span></span><br><span class="line">    <span class="selector-pseudo">&amp;::marker</span></span><br><span class="line">      <span class="attribute">color</span>: <span class="variable">$light</span>-blue</span><br><span class="line">      <span class="attribute">font-weight</span>: <span class="number">600</span></span><br><span class="line">      <span class="attribute">font-size</span>: <span class="number">1.05em</span></span><br><span class="line"></span><br><span class="line">    <span class="selector-pseudo">&amp;:hover</span></span><br><span class="line">      <span class="selector-pseudo">&amp;::marker</span></span><br><span class="line">        <span class="attribute">color</span>: <span class="built_in">var</span>(--pseudo-hover)</span><br><span class="line"></span><br><span class="line">  <span class="selector-tag">ul</span> &gt; <span class="selector-tag">li</span></span><br><span class="line">    <span class="attribute">list-style-type</span>: circle</span><br><span class="line"></span><br><span class="line"><span class="selector-id">#article-container</span></span><br><span class="line">  <span class="attribute">word-wrap</span>: break-word</span><br><span class="line">  <span class="attribute">overflow-wrap</span>: break-word</span><br><span class="line"></span><br><span class="line">  <span class="selector-tag">a</span></span><br><span class="line">    <span class="attribute">color</span>: <span class="variable">$theme</span>-link-color</span><br><span class="line"></span><br><span class="line">    <span class="selector-pseudo">&amp;:hover</span></span><br><span class="line">      <span class="attribute">text-decoration</span>: underline</span><br><span class="line"></span><br><span class="line">  <span class="selector-tag">img</span></span><br><span class="line">    <span class="attribute">display</span>: block</span><br><span class="line">    <span class="attribute">margin</span>: <span class="number">0</span> auto <span class="number">20px</span></span><br><span class="line">    <span class="attribute">max-width</span>: <span class="number">100%</span></span><br><span class="line">    <span class="attribute">transition</span>: filter <span class="number">375ms</span> ease-in .<span class="number">2s</span></span><br><span class="line"></span><br><span class="line">  <span class="selector-tag">p</span></span><br><span class="line">    <span class="attribute">margin</span>: <span class="number">0</span> <span class="number">0</span> <span class="number">16px</span></span><br><span class="line"></span><br><span class="line">  <span class="selector-tag">iframe</span></span><br><span class="line">    <span class="attribute">margin</span>: <span class="number">0</span> <span class="number">0</span> <span class="number">20px</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> <span class="built_in">hexo-config</span>(<span class="string">&#x27;anchor&#x27;</span>)</span><br><span class="line">    <span class="selector-tag">a</span><span class="selector-class">.headerlink</span></span><br><span class="line">      <span class="selector-pseudo">&amp;:after</span></span><br><span class="line">        <span class="keyword">@extend</span> <span class="selector-class">.fontawesomeIcon</span></span><br><span class="line">        <span class="attribute">float</span>: right</span><br><span class="line">        <span class="attribute">color</span>: <span class="built_in">var</span>(--headline-presudo)</span><br><span class="line">        <span class="attribute">content</span>: <span class="string">&#x27;\f0c1&#x27;</span></span><br><span class="line">        <span class="attribute">font-size</span>: .<span class="number">95em</span></span><br><span class="line">        <span class="attribute">opacity</span>: <span class="number">0</span></span><br><span class="line">        <span class="attribute">transition</span>: all .<span class="number">3s</span></span><br><span class="line"></span><br><span class="line">      <span class="selector-pseudo">&amp;:hover</span></span><br><span class="line">        <span class="selector-pseudo">&amp;:after</span></span><br><span class="line">          <span class="attribute">color</span>: <span class="built_in">var</span>(--pseudo-hover)</span><br><span class="line"></span><br><span class="line">    <span class="selector-tag">h1</span>,</span><br><span class="line">    <span class="selector-tag">h2</span>,</span><br><span class="line">    <span class="selector-tag">h3</span>,</span><br><span class="line">    <span class="selector-tag">h4</span>,</span><br><span class="line">    <span class="selector-tag">h5</span>,</span><br><span class="line">    <span class="selector-tag">h6</span></span><br><span class="line">      <span class="selector-pseudo">&amp;:hover</span></span><br><span class="line">        <span class="selector-tag">a</span><span class="selector-class">.headerlink</span></span><br><span class="line">          <span class="selector-pseudo">&amp;:after</span></span><br><span class="line">            <span class="attribute">opacity</span>: <span class="number">1</span></span><br><span class="line"></span><br><span class="line">  <span class="selector-tag">ol</span>,</span><br><span class="line">  <span class="selector-tag">ul</span></span><br><span class="line">    <span class="selector-tag">ol</span>,</span><br><span class="line">    <span class="selector-tag">ul</span></span><br><span class="line">      <span class="attribute">padding-left</span>: <span class="number">20px</span></span><br><span class="line"></span><br><span class="line">    <span class="selector-tag">li</span></span><br><span class="line">      <span class="attribute">margin</span>: <span class="number">4px</span> <span class="number">0</span></span><br><span class="line"></span><br><span class="line">    <span class="selector-tag">p</span></span><br><span class="line">      <span class="attribute">margin</span>: <span class="number">0</span> <span class="number">0</span> <span class="number">8px</span></span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> <span class="built_in">hexo-config</span>(<span class="string">&#x27;beautify.enable&#x27;</span>)</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">hexo-config</span>(<span class="string">&#x27;beautify.field&#x27;</span>) == <span class="string">&#x27;site&#x27;</span></span><br><span class="line">      <span class="built_in">beautify</span>()</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> <span class="built_in">hexo-config</span>(<span class="string">&#x27;beautify.field&#x27;</span>) == <span class="string">&#x27;post&#x27;</span></span><br><span class="line">      &amp;<span class="selector-class">.post-content</span></span><br><span class="line">        <span class="built_in">beautify</span>()</span><br><span class="line"></span><br><span class="line">  &gt; <span class="selector-pseudo">:last-child</span></span><br><span class="line">    <span class="attribute">margin-bottom</span>: <span class="number">0</span> <span class="meta">!important</span></span><br><span class="line"></span><br><span class="line"><span class="selector-id">#post</span></span><br><span class="line">  <span class="selector-class">.tag_share</span></span><br><span class="line">    <span class="selector-class">.post-meta</span></span><br><span class="line">      &amp;__tag-list</span><br><span class="line">        <span class="attribute">display</span>: inline-block</span><br><span class="line"></span><br><span class="line">      &amp;__tags</span><br><span class="line">        <span class="attribute">display</span>: inline-block</span><br><span class="line">        <span class="attribute">margin</span>: <span class="number">8px</span> <span class="number">8px</span> <span class="number">8px</span> <span class="number">0</span></span><br><span class="line">        <span class="attribute">padding</span>: <span class="number">0</span> <span class="number">12px</span></span><br><span class="line">        <span class="attribute">width</span>: fit-content</span><br><span class="line">        <span class="attribute">border</span>: <span class="number">1px</span> solid <span class="variable">$light</span>-blue</span><br><span class="line">        <span class="attribute">border-radius</span>: <span class="number">12px</span></span><br><span class="line">        <span class="attribute">color</span>: <span class="variable">$light</span>-blue</span><br><span class="line">        <span class="attribute">font-size</span>: .<span class="number">85em</span></span><br><span class="line">        <span class="attribute">transition</span>: all .<span class="number">2s</span> ease-in-out</span><br><span class="line"></span><br><span class="line">        <span class="selector-pseudo">&amp;:hover</span></span><br><span class="line">          <span class="attribute">background</span>: <span class="variable">$light</span>-blue</span><br><span class="line">          <span class="attribute">color</span>: <span class="built_in">var</span>(--white)</span><br><span class="line"></span><br><span class="line">    <span class="selector-class">.post_share</span></span><br><span class="line">      <span class="attribute">display</span>: inline-block</span><br><span class="line">      <span class="attribute">float</span>: right</span><br><span class="line">      <span class="attribute">margin</span>: <span class="number">8px</span> <span class="number">0</span></span><br><span class="line">      <span class="attribute">width</span>: fit-content</span><br><span class="line"></span><br><span class="line">      <span class="selector-class">.social-share</span></span><br><span class="line">        <span class="attribute">font-size</span>: .<span class="number">85em</span></span><br><span class="line"></span><br><span class="line">        <span class="selector-class">.social-share-icon</span></span><br><span class="line">          <span class="attribute">margin</span>: <span class="number">0</span> <span class="number">4px</span></span><br><span class="line">          <span class="attribute">width</span>: w = <span class="number">1.85em</span></span><br><span class="line">          <span class="attribute">height</span>: w</span><br><span class="line">          <span class="attribute">font-size</span>: <span class="number">1.2em</span></span><br><span class="line">          <span class="attribute">line-height</span>: w</span><br><span class="line"></span><br><span class="line">  <span class="selector-class">.post-copyright</span></span><br><span class="line">    <span class="attribute">position</span>: relative</span><br><span class="line">    <span class="attribute">margin</span>: <span class="number">40px</span> <span class="number">0</span> <span class="number">10px</span></span><br><span class="line">    <span class="attribute">padding</span>: <span class="number">10px</span> <span class="number">16px</span></span><br><span class="line">    <span class="attribute">border</span>: <span class="number">1px</span> solid <span class="built_in">var</span>(--light-grey)</span><br><span class="line">    <span class="attribute">transition</span>: box-shadow .<span class="number">3s</span> ease-in-out</span><br><span class="line">    <span class="attribute">overflow</span>: hidden</span><br><span class="line">    <span class="attribute">border-radius</span>: <span class="number">12px</span><span class="meta">!important</span></span><br><span class="line">    <span class="attribute">background-color</span>: <span class="built_in">rgb</span>(<span class="number">239</span> <span class="number">241</span> <span class="number">243</span>)</span><br><span class="line"></span><br><span class="line">    <span class="selector-pseudo">&amp;:before</span></span><br><span class="line">      <span class="attribute">background</span> <span class="built_in">var</span>(--heo-post-blockquote-bg)</span><br><span class="line">      <span class="attribute">position</span> absolute</span><br><span class="line">      <span class="attribute">right</span> -<span class="number">26px</span></span><br><span class="line">      <span class="attribute">top</span> -<span class="number">120px</span></span><br><span class="line">      <span class="attribute">content</span> <span class="string">&#x27;\f25e&#x27;</span></span><br><span class="line">      <span class="attribute">font-size</span> <span class="number">200px</span></span><br><span class="line">      <span class="attribute">font-family</span> <span class="string">&#x27;Font Awesome 5 Brands&#x27;</span></span><br><span class="line">      <span class="attribute">opacity</span> .<span class="number">2</span></span><br><span class="line"></span><br><span class="line">    <span class="selector-pseudo">&amp;:hover</span></span><br><span class="line">      <span class="attribute">box-shadow</span>: <span class="number">0</span> <span class="number">0</span> <span class="number">8px</span> <span class="number">0</span> <span class="built_in">rgba</span>(<span class="number">232</span>, <span class="number">237</span>, <span class="number">250</span>, .<span class="number">6</span>), <span class="number">0</span> <span class="number">2px</span> <span class="number">4px</span> <span class="number">0</span> <span class="built_in">rgba</span>(<span class="number">232</span>, <span class="number">237</span>, <span class="number">250</span>, .<span class="number">5</span>)</span><br><span class="line"></span><br><span class="line">    <span class="selector-class">.post-copyright</span></span><br><span class="line">      &amp;-meta</span><br><span class="line">        <span class="attribute">color</span>: <span class="variable">$light</span>-blue</span><br><span class="line">        <span class="attribute">font-weight</span>: bold</span><br><span class="line"></span><br><span class="line">      &amp;-info</span><br><span class="line">        <span class="attribute">padding-left</span>: <span class="number">6px</span></span><br><span class="line"></span><br><span class="line">        <span class="selector-tag">a</span></span><br><span class="line">          <span class="attribute">text-decoration</span>: none</span><br><span class="line">          <span class="attribute">word-break</span>: break-word</span><br><span class="line"></span><br><span class="line">          <span class="selector-pseudo">&amp;:hover</span></span><br><span class="line">            <span class="attribute">text-decoration</span>: none</span><br><span class="line"></span><br><span class="line">  <span class="selector-class">.post-copyright-cc-info</span></span><br><span class="line">    <span class="attribute">color</span>: <span class="variable">$theme</span>-color;</span><br><span class="line"></span><br><span class="line">  <span class="selector-class">.post-outdate-notice</span></span><br><span class="line">    <span class="attribute">position</span>: relative</span><br><span class="line">    <span class="attribute">margin</span>: <span class="number">0</span> <span class="number">0</span> <span class="number">20px</span></span><br><span class="line">    <span class="attribute">padding</span>: .<span class="number">5em</span> <span class="number">1.2em</span></span><br><span class="line">    <span class="attribute">border-radius</span>: <span class="number">3px</span></span><br><span class="line">    <span class="attribute">background-color</span>: <span class="variable">$noticeOutdate</span>-bg</span><br><span class="line">    <span class="attribute">color</span>: <span class="variable">$noticeOutdate</span>-color</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">hexo-config</span>(<span class="string">&#x27;noticeOutdate.style&#x27;</span>) == <span class="string">&#x27;flat&#x27;</span></span><br><span class="line">      <span class="attribute">padding</span>: .<span class="number">5em</span> <span class="number">1em</span> .<span class="number">5em</span> <span class="number">2.6em</span></span><br><span class="line">      <span class="attribute">border-left</span>: <span class="number">5px</span> solid <span class="variable">$noticeOutdate</span>-border</span><br><span class="line"></span><br><span class="line">      <span class="selector-pseudo">&amp;:before</span></span><br><span class="line">        <span class="keyword">@extend</span> <span class="selector-class">.fontawesomeIcon</span></span><br><span class="line">        <span class="attribute">position</span>: absolute</span><br><span class="line">        <span class="attribute">top</span>: <span class="number">50%</span></span><br><span class="line">        <span class="attribute">left</span>: .<span class="number">9em</span></span><br><span class="line">        <span class="attribute">color</span>: <span class="variable">$noticeOutdate</span>-border</span><br><span class="line">        <span class="attribute">content</span>: <span class="string">&#x27;\f071&#x27;</span></span><br><span class="line">        <span class="attribute">transform</span>: <span class="built_in">translateY</span>(-<span class="number">50%</span>)</span><br><span class="line"></span><br><span class="line">  <span class="selector-class">.ads-wrap</span></span><br><span class="line">    <span class="attribute">margin</span>: <span class="number">40px</span> <span class="number">0</span></span><br><span class="line"><span class="selector-class">.post-copyright-m-info</span></span><br><span class="line">  <span class="selector-class">.post-copyright-a</span>,</span><br><span class="line">  <span class="selector-class">.post-copyright-c</span>,</span><br><span class="line">  <span class="selector-class">.post-copyright-u</span></span><br><span class="line">    <span class="attribute">display</span> inline-block</span><br><span class="line">    <span class="attribute">width</span> fit-content</span><br><span class="line">    <span class="attribute">padding</span> <span class="number">2px</span> <span class="number">5px</span></span><br><span class="line"><span class="selector-attr">[data-theme=<span class="string">&quot;dark&quot;</span>]</span></span><br><span class="line">  <span class="selector-id">#post</span></span><br><span class="line">    <span class="selector-class">.post-copyright</span></span><br><span class="line">      <span class="attribute">background-color</span> <span class="number">#07080a</span></span><br><span class="line">      <span class="attribute">text-shadow</span> <span class="number">#bfbeb8</span> <span class="number">0</span> <span class="number">0</span> <span class="number">2px</span></span><br><span class="line">      <span class="attribute">border</span> <span class="number">1px</span> solid <span class="built_in">rgb</span>(<span class="number">19</span> <span class="number">18</span> <span class="number">18</span> / <span class="number">35%</span>)</span><br><span class="line">      <span class="attribute">box-shadow</span> <span class="number">0</span> <span class="number">0</span> <span class="number">5px</span> <span class="built_in">rgb</span>(<span class="number">20</span>, <span class="number">120</span>, <span class="number">210</span>)</span><br><span class="line">      <span class="attribute">animation</span> flashlight <span class="number">1s</span> linear infinite alternate</span><br><span class="line">  <span class="selector-class">.post-copyright-info</span></span><br><span class="line">    <span class="attribute">color</span> <span class="number">#e0e0e4</span></span><br><span class="line"></span><br><span class="line"><span class="selector-id">#post</span></span><br><span class="line">  <span class="selector-class">.post-copyright__title</span></span><br><span class="line">    <span class="attribute">font-size</span> <span class="number">22px</span></span><br><span class="line">  <span class="selector-class">.post-copyright__notice</span></span><br><span class="line">    <span class="attribute">font-size</span> <span class="number">15px</span></span><br><span class="line">  <span class="selector-class">.post-copyright</span></span><br><span class="line">    <span class="attribute">box-shadow</span> <span class="number">2px</span> <span class="number">2px</span> <span class="number">5px</span></span><br></pre></td></tr></table></figure></li><li><p>默认项的配置</p><ul><li>作者：<code>[Blogroot]\_config.yml</code>中的<code>author</code>配置项</li></ul> <figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Site</span></span><br><span class="line"><span class="attr">title:</span> <span class="string">Akilarの糖果屋</span></span><br><span class="line"><span class="attr">subtitle:</span> <span class="string">Akilar.top</span></span><br><span class="line"><span class="attr">description:</span></span><br><span class="line"><span class="attr">keywords:</span></span><br><span class="line"><span class="attr">author:</span> <span class="string">Akilar</span> <span class="comment">#默认作者</span></span><br><span class="line"><span class="attr">language:</span> <span class="string">zh-CN</span></span><br><span class="line"><span class="attr">timezone:</span> <span class="string">&#x27;&#x27;</span></span><br></pre></td></tr></table></figure><ul><li>许可协议：<code>[Blogroot]\_config.butterfly.yml</code>中的<code>license</code>和<code>license_url</code>配置项</li></ul> <figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">post_copyright:</span></span><br><span class="line"><span class="attr">enable:</span> <span class="literal">true</span></span><br><span class="line"><span class="attr">decode:</span> <span class="literal">true</span></span><br><span class="line"><span class="attr">license:</span> <span class="string">CC</span> <span class="string">BY-NC-SA</span> <span class="number">4.0</span></span><br><span class="line"><span class="attr">license_url:</span> <span class="string">https://creativecommons.org/licenses/by-nc-sa/4.0/</span></span><br></pre></td></tr></table></figure></li><li><p>页面覆写配置项，修改对应文章的<code>front-matter</code></p> <figure class="highlight markdown"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">---</span><br><span class="line">title: Copyright-beautify # 文章名称</span><br><span class="line">date: 2021-03-02 13:52:46 # 文章发布日期</span><br><span class="line">updated: 2021-03-02 13:52:46 # 文章更新日期</span><br><span class="line">copyright<span class="emphasis">_author: RandomEnch # 作者覆写</span></span><br><span class="line"><span class="emphasis">copyright_</span>url: https://blog.randench.cn/ # 原文链接覆写</span><br><span class="line">license: # 许可协议名称覆写</span><br><span class="line"><span class="section">license<span class="emphasis">_url: # 许可协议链接覆写</span></span></span><br><span class="line"><span class="emphasis"><span class="section">---</span></span></span><br></pre></td></tr></table></figure></li></ol>]]></content>
      
      
      <categories>
          
          <category> Hexo </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 美化 </tag>
            
            <tag> 魔改 </tag>
            
            <tag> Butterfly </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>twikoo评论块气泡风格美化</title>
      <link href="//posts/1514/"/>
      <url>//posts/1514/</url>
      
        <content type="html"><![CDATA[<div class="note warning flat"><p>本文修改主题为<code>Butterfly</code>主题，若使用其他主题，请自行确认修改位置。</p></div><div class="note success flat"><p>该方法通过外部引入，无需修改主题源文件。</p></div><h1 id="原文出处"><a href="#原文出处" class="headerlink" title="原文出处"></a>原文出处</h1><blockquote><p><a href="https://akilar.top/posts/d99b5f01/">https://akilar.top/posts/d99b5f01/</a></p></blockquote><h1 id="效果预览"><a href="#效果预览" class="headerlink" title="效果预览"></a>效果预览</h1><p><img src="https://cdn.randench.cn/image/24/08/dbce2d03ea0bb651.png"></p><h1 id="修改步骤"><a href="#修改步骤" class="headerlink" title="修改步骤"></a>修改步骤</h1><ol><li><p>新建<code>[Blogroot]\themes\butterfly\source\css\custom\twikoo_beautify.css</code></p> <figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">/* 自定义twikoo评论输入框高度 */</span></span><br><span class="line"><span class="selector-class">.tk-input</span> <span class="selector-class">.el-textarea__inner</span> &#123;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">130px</span> <span class="meta">!important</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/* 输入评论时自动隐藏输入框背景图片 */</span></span><br><span class="line"><span class="selector-class">.tk-input</span> <span class="selector-class">.el-textarea__inner</span><span class="selector-pseudo">:focus</span> &#123;</span><br><span class="line">  <span class="attribute">background-image</span>: none <span class="meta">!important</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/* 调整楼中楼样式 ，整体左移，贴合气泡化效果 */</span></span><br><span class="line"><span class="selector-class">.tk-replies</span> &#123;</span><br><span class="line">  <span class="attribute">left</span>: -<span class="number">70px</span>;</span><br><span class="line">  <span class="attribute">width</span>: <span class="built_in">calc</span>(<span class="number">100%</span> + <span class="number">70px</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/* 头像宽度调整 rem单位与全局字体大小挂钩，需配合自己情况调整大小以保证头像显示完整*/</span></span><br><span class="line"><span class="selector-class">.tk-replies</span> <span class="selector-class">.tk-avatar</span> &#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">2.5rem</span> <span class="meta">!important</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">2.5rem</span> <span class="meta">!important</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.tk-replies</span> <span class="selector-class">.tk-avatar</span> <span class="selector-tag">img</span> &#123;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">2.5rem</span> <span class="meta">!important</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">2.5rem</span> <span class="meta">!important</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/* 回复框左移，避免窄屏时出框 */</span></span><br><span class="line"><span class="selector-class">.tk-comments-container</span> <span class="selector-class">.tk-submit</span> &#123;</span><br><span class="line">  <span class="attribute">position</span>: relative;</span><br><span class="line">  <span class="attribute">left</span>: -<span class="number">70px</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/* 评论块气泡化修改 */</span></span><br><span class="line"><span class="selector-class">.tk-content</span> &#123;</span><br><span class="line">  <span class="attribute">background</span>: <span class="number">#00a6ff</span>; <span class="comment">/*默认模式访客气泡配色*/</span></span><br><span class="line">  <span class="attribute">padding</span>: <span class="number">10px</span>;</span><br><span class="line">  <span class="attribute">color</span>: <span class="number">#fff</span>; <span class="comment">/*默认模式访客气泡字体配色*/</span></span><br><span class="line">  <span class="attribute">border-radius</span>: <span class="number">10px</span>;</span><br><span class="line">  <span class="attribute">font-size</span>: <span class="number">16px</span> <span class="meta">!important</span>;</span><br><span class="line">  <span class="attribute">width</span>: fit-content;</span><br><span class="line">  <span class="attribute">max-width</span>: <span class="number">100%</span>;</span><br><span class="line">  <span class="attribute">position</span>: relative <span class="meta">!important</span>;</span><br><span class="line">  <span class="attribute">overflow</span>: visible <span class="meta">!important</span>;</span><br><span class="line">  <span class="attribute">max-height</span>: none <span class="meta">!important</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/* 修复图片出框 */</span></span><br><span class="line"><span class="selector-class">.tk-content</span> <span class="selector-tag">img</span> &#123;</span><br><span class="line">  <span class="attribute">max-width</span>: <span class="number">100%</span> <span class="meta">!important</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/* 修复过长文本出框 */</span></span><br><span class="line"><span class="selector-class">.tk-content</span> pre &#123;</span><br><span class="line">  <span class="attribute">white-space</span>: pre-wrap;</span><br><span class="line">  <span class="attribute">word-wrap</span>: break-word;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.tk-content</span> <span class="selector-tag">a</span> &#123;</span><br><span class="line">  <span class="attribute">color</span>: <span class="number">#eeecaa</span>; <span class="comment">/*默认模式超链接配色*/</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.tk-content</span><span class="selector-pseudo">::before</span> &#123;</span><br><span class="line">  <span class="attribute">content</span>: <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">position</span>: absolute;</span><br><span class="line">  <span class="attribute">top</span>: <span class="number">20px</span>;</span><br><span class="line">  <span class="attribute">left</span>: -<span class="number">13px</span>;</span><br><span class="line">  <span class="attribute">border-top</span>: <span class="number">2px</span> solid transparent;</span><br><span class="line">  <span class="attribute">border-bottom</span>: <span class="number">20px</span> solid transparent;</span><br><span class="line">  <span class="attribute">border-right</span>: <span class="number">15px</span> solid <span class="number">#00a6ff</span>; <span class="comment">/*默认模式访客气泡小三角配色*/</span></span><br><span class="line">  <span class="attribute">border-left</span>: <span class="number">0px</span> solid transparent;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.tk-master</span> <span class="selector-class">.tk-content</span> &#123;</span><br><span class="line">  <span class="attribute">background</span>: <span class="number">#ff8080</span>; <span class="comment">/*默认模式博主气泡配色*/</span></span><br><span class="line">  <span class="attribute">color</span>: <span class="number">#fff</span>; <span class="comment">/*默认模式博主气泡字体配色*/</span></span><br><span class="line">  <span class="attribute">width</span>: fit-content;</span><br><span class="line">  <span class="attribute">max-width</span>: <span class="number">100%</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.tk-master</span> <span class="selector-class">.tk-content</span> <span class="selector-tag">a</span> &#123;</span><br><span class="line">  <span class="attribute">color</span>: <span class="number">#eeecaa</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.tk-master</span> <span class="selector-class">.tk-content</span><span class="selector-pseudo">::before</span> &#123;</span><br><span class="line">  <span class="attribute">content</span>: <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">position</span>: absolute;</span><br><span class="line">  <span class="attribute">top</span>: <span class="number">20px</span>;</span><br><span class="line">  <span class="attribute">left</span>: -<span class="number">13px</span>;</span><br><span class="line">  <span class="attribute">border-top</span>: <span class="number">2px</span> solid transparent;</span><br><span class="line">  <span class="attribute">border-bottom</span>: <span class="number">20px</span> solid transparent;</span><br><span class="line">  <span class="attribute">border-right</span>: <span class="number">15px</span> solid <span class="number">#ff8080</span>; <span class="comment">/*默认模式博主气泡小三角配色*/</span></span><br><span class="line">  <span class="attribute">border-left</span>: <span class="number">0px</span> solid transparent;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.tk-row</span><span class="selector-attr">[data-v-d82ce9a0]</span> &#123;</span><br><span class="line">  <span class="attribute">max-width</span>: <span class="number">100%</span>;</span><br><span class="line">  <span class="attribute">width</span>: fit-content;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.tk-avatar</span> &#123;</span><br><span class="line">  <span class="attribute">border-radius</span>: <span class="number">50%</span>;</span><br><span class="line">  <span class="attribute">margin-top</span>: <span class="number">10px</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/* 夜间模式配色，具体比照上方默认模式class */</span></span><br><span class="line"><span class="selector-attr">[data-theme=<span class="string">&quot;dark&quot;</span>]</span> <span class="selector-class">.tk-content</span> &#123;</span><br><span class="line">  <span class="attribute">background</span>: <span class="number">#000</span>;</span><br><span class="line">  <span class="attribute">color</span>: <span class="number">#fff</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-attr">[data-theme=<span class="string">&quot;dark&quot;</span>]</span> <span class="selector-class">.tk-content</span> <span class="selector-tag">a</span> &#123;</span><br><span class="line">  <span class="attribute">color</span>: <span class="number">#dfa036</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-attr">[data-theme=<span class="string">&quot;dark&quot;</span>]</span> <span class="selector-class">.tk-content</span><span class="selector-pseudo">::before</span> &#123;</span><br><span class="line">  <span class="attribute">border-right</span>: <span class="number">15px</span> solid <span class="number">#000</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-attr">[data-theme=<span class="string">&quot;dark&quot;</span>]</span> <span class="selector-class">.tk-master</span> <span class="selector-class">.tk-content</span> &#123;</span><br><span class="line">  <span class="attribute">background</span>: <span class="number">#000</span>;</span><br><span class="line">  <span class="attribute">color</span>: <span class="number">#fff</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-attr">[data-theme=<span class="string">&quot;dark&quot;</span>]</span> <span class="selector-class">.tk-master</span> <span class="selector-class">.tk-content</span> <span class="selector-tag">a</span> &#123;</span><br><span class="line">  <span class="attribute">color</span>: <span class="number">#dfa036</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-attr">[data-theme=<span class="string">&quot;dark&quot;</span>]</span> <span class="selector-class">.tk-master</span> <span class="selector-class">.tk-content</span><span class="selector-pseudo">::before</span> &#123;</span><br><span class="line">  <span class="attribute">border-top</span>: <span class="number">2px</span> solid transparent;</span><br><span class="line">  <span class="attribute">border-bottom</span>: <span class="number">20px</span> solid transparent;</span><br><span class="line">  <span class="attribute">border-right</span>: <span class="number">15px</span> solid <span class="number">#000</span>;</span><br><span class="line">  <span class="attribute">border-left</span>: <span class="number">0px</span> solid transparent;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/* 自适应内容 */</span></span><br><span class="line"><span class="keyword">@media</span> screen <span class="keyword">and</span> (<span class="attribute">min-width</span>: <span class="number">1024px</span>) &#123;</span><br><span class="line">  <span class="comment">/* 设置宽度上限，避免挤压博主头像 */</span></span><br><span class="line">  <span class="selector-class">.tk-content</span> &#123;</span><br><span class="line">    <span class="attribute">max-width</span>: <span class="number">75%</span>;</span><br><span class="line">    <span class="attribute">width</span>: fit-content;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="selector-class">.tk-master</span> <span class="selector-class">.tk-content</span> &#123;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">75%</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="selector-class">.tk-master</span> <span class="selector-class">.tk-content</span><span class="selector-pseudo">::before</span> &#123;</span><br><span class="line">    <span class="attribute">left</span>: <span class="number">100%</span>;</span><br><span class="line">    <span class="attribute">border-left</span>: <span class="number">15px</span> solid <span class="number">#ff8080</span>;</span><br><span class="line">    <span class="attribute">border-right</span>: <span class="number">0px</span> solid transparent;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="selector-class">.tk-master</span> <span class="selector-class">.tk-avatar</span> &#123;</span><br><span class="line">    <span class="attribute">position</span>: relative;</span><br><span class="line">    <span class="attribute">left</span>: <span class="built_in">calc</span>(<span class="number">75%</span> + <span class="number">70px</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="selector-class">.tk-master</span> <span class="selector-class">.tk-row</span><span class="selector-attr">[data-v-d82ce9a0]</span> &#123;</span><br><span class="line">    <span class="attribute">position</span>: relative;</span><br><span class="line">    <span class="attribute">top</span>: <span class="number">0px</span>;</span><br><span class="line">    <span class="attribute">left</span>: <span class="built_in">calc</span>(<span class="number">75%</span> - <span class="number">230px</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="selector-attr">[data-theme=<span class="string">&quot;dark&quot;</span>]</span> <span class="selector-class">.tk-master</span> <span class="selector-class">.tk-content</span><span class="selector-pseudo">::before</span> &#123;</span><br><span class="line">    <span class="attribute">border-left</span>: <span class="number">15px</span> solid <span class="number">#000</span>;</span><br><span class="line">    <span class="attribute">border-right</span>: <span class="number">0px</span> solid transparent;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/* 设备名称常态隐藏，悬停评论时显示 */</span></span><br><span class="line"><span class="selector-class">.tk-extras</span> &#123;</span><br><span class="line">  <span class="attribute">opacity</span>: <span class="number">0</span>;</span><br><span class="line">  -ms-<span class="attribute">filter</span>: <span class="string">&quot;progid:DXImageTransform.Microsoft.Alpha(Opacity=0)&quot;</span>;</span><br><span class="line">  <span class="attribute">filter</span>: <span class="built_in">alpha</span>(opacity=<span class="number">0</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.tk-content</span><span class="selector-pseudo">:hover</span> + <span class="selector-class">.tk-extras</span> &#123;</span><br><span class="line">  -webkit-<span class="attribute">animation</span>: tk-extras-fadeIn <span class="number">0.5s</span> linear;</span><br><span class="line">  -moz-<span class="attribute">animation</span>: tk-extras-fadeIn <span class="number">0.5s</span> linear;</span><br><span class="line">  -o-<span class="attribute">animation</span>: tk-extras-fadeIn <span class="number">0.5s</span> linear;</span><br><span class="line">  -ms-<span class="attribute">animation</span>: tk-extras-fadeIn <span class="number">0.5s</span> linear;</span><br><span class="line">  <span class="attribute">animation</span>: tk-extras-fadeIn <span class="number">0.5s</span> linear;</span><br><span class="line">  -webkit-<span class="attribute">animation-fill-mode</span>: forwards;</span><br><span class="line">  -moz-<span class="attribute">animation-fill-mode</span>: forwards;</span><br><span class="line">  -o-<span class="attribute">animation-fill-mode</span>: forwards;</span><br><span class="line">  -ms-<span class="attribute">animation-fill-mode</span>: forwards;</span><br><span class="line">  <span class="attribute">animation-fill-mode</span>: forwards;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">@-moz-keyframes</span> tk-extras-fadeIn &#123;</span><br><span class="line">  <span class="selector-tag">from</span> &#123;</span><br><span class="line">    <span class="attribute">opacity</span>: <span class="number">0</span>;</span><br><span class="line">    -ms-<span class="attribute">filter</span>: <span class="string">&quot;progid:DXImageTransform.Microsoft.Alpha(Opacity=0)&quot;</span>;</span><br><span class="line">    <span class="attribute">filter</span>: <span class="built_in">alpha</span>(opacity=<span class="number">0</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="selector-tag">to</span> &#123;</span><br><span class="line">    <span class="attribute">opacity</span>: <span class="number">1</span>;</span><br><span class="line">    -ms-<span class="attribute">filter</span>: none;</span><br><span class="line">    <span class="attribute">filter</span>: none;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">@-webkit-keyframes</span> tk-extras-fadeIn &#123;</span><br><span class="line">  <span class="selector-tag">from</span> &#123;</span><br><span class="line">    <span class="attribute">opacity</span>: <span class="number">0</span>;</span><br><span class="line">    -ms-<span class="attribute">filter</span>: <span class="string">&quot;progid:DXImageTransform.Microsoft.Alpha(Opacity=0)&quot;</span>;</span><br><span class="line">    <span class="attribute">filter</span>: <span class="built_in">alpha</span>(opacity=<span class="number">0</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="selector-tag">to</span> &#123;</span><br><span class="line">    <span class="attribute">opacity</span>: <span class="number">1</span>;</span><br><span class="line">    -ms-<span class="attribute">filter</span>: none;</span><br><span class="line">    <span class="attribute">filter</span>: none;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">@-o-keyframes</span> tk-extras-fadeIn &#123;</span><br><span class="line">  <span class="selector-tag">from</span> &#123;</span><br><span class="line">    <span class="attribute">opacity</span>: <span class="number">0</span>;</span><br><span class="line">    -ms-<span class="attribute">filter</span>: <span class="string">&quot;progid:DXImageTransform.Microsoft.Alpha(Opacity=0)&quot;</span>;</span><br><span class="line">    <span class="attribute">filter</span>: <span class="built_in">alpha</span>(opacity=<span class="number">0</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="selector-tag">to</span> &#123;</span><br><span class="line">    <span class="attribute">opacity</span>: <span class="number">1</span>;</span><br><span class="line">    -ms-<span class="attribute">filter</span>: none;</span><br><span class="line">    <span class="attribute">filter</span>: none;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">@keyframes</span> tk-extras-fadeIn &#123;</span><br><span class="line">  <span class="selector-tag">from</span> &#123;</span><br><span class="line">    <span class="attribute">opacity</span>: <span class="number">0</span>;</span><br><span class="line">    -ms-<span class="attribute">filter</span>: <span class="string">&quot;progid:DXImageTransform.Microsoft.Alpha(Opacity=0)&quot;</span>;</span><br><span class="line">    <span class="attribute">filter</span>: <span class="built_in">alpha</span>(opacity=<span class="number">0</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="selector-tag">to</span> &#123;</span><br><span class="line">    <span class="attribute">opacity</span>: <span class="number">1</span>;</span><br><span class="line">    -ms-<span class="attribute">filter</span>: none;</span><br><span class="line">    <span class="attribute">filter</span>: none;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li><li><p>修改<code>[Blogroot]\_config.butterfly.yml</code>的<code>inject</code>配置项</p> <figure class="highlight diff"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">  inject:</span><br><span class="line">    head:</span><br><span class="line"><span class="addition">+     - &lt;link rel=&quot;stylesheet&quot; href=&quot;/css/custom/twikoo_beautify.css&quot; media=&quot;defer&quot; onload=&quot;this.media=&#x27;all&#x27;&quot;&gt;</span></span><br></pre></td></tr></table></figure></li></ol>]]></content>
      
      
      <categories>
          
          <category> Hexo </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 美化 </tag>
            
            <tag> 魔改 </tag>
            
            <tag> Butterfly </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>右下角菜单打开评论板块</title>
      <link href="//posts/2844/"/>
      <url>//posts/2844/</url>
      
        <content type="html"><![CDATA[<div class="note warning flat"><p>本文修改主题为<code>Butterfly</code>主题，若使用其他主题，请自行确认修改位置。</p></div><h1 id="原文出处"><a href="#原文出处" class="headerlink" title="原文出处"></a>原文出处</h1><blockquote><p><a href="https://akilar.top/posts/397b8b90/">https://akilar.top/posts/397b8b90/</a></p></blockquote><h1 id="效果预览"><a href="#效果预览" class="headerlink" title="效果预览"></a>效果预览</h1><details class="folding-tag" ><summary> 查看图片 </summary>              <div class='content'>              <p><img src="https://cdn.randench.cn/image/24/08/92f7d66fcd2dd242.gif" alt="效果预览"></p>              </div>            </details><h1 id="修改步骤"><a href="#修改步骤" class="headerlink" title="修改步骤"></a>修改步骤</h1><h2 id="1-新建文件"><a href="#1-新建文件" class="headerlink" title="1. 新建文件"></a>1. 新建文件</h2><p>新建<code>[Blogroot]\themes\butterfly\source\css\custom\fixed_comment.css</code></p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-tag">div</span><span class="selector-id">#post-comment</span><span class="selector-class">.fixedcomment</span> &#123;</span><br><span class="line">    <span class="attribute">position</span>: fixed;</span><br><span class="line">    <span class="attribute">top</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">60%</span>;</span><br><span class="line">    <span class="attribute">right</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">padding</span>: <span class="number">25px</span> <span class="number">30px</span> <span class="number">20px</span> <span class="number">20px</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">100vh</span>;</span><br><span class="line">    <span class="attribute">overflow</span>: scroll;</span><br><span class="line">    <span class="attribute">z-index</span>: <span class="number">90</span>;</span><br><span class="line">    <span class="attribute">background</span>: <span class="built_in">rgba</span>(<span class="number">222</span>, <span class="number">222</span>, <span class="number">222</span>, <span class="number">0.95</span>);</span><br><span class="line">    <span class="attribute">box-shadow</span>:<span class="number">3px</span> <span class="number">2px</span> <span class="number">14px</span> <span class="number">#464340</span>;</span><br><span class="line">    <span class="attribute">animation</span>: fixedright <span class="number">0.5s</span> linear;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-tag">div</span><span class="selector-id">#post-comment</span><span class="selector-class">.fixedcomment</span>::-webkit-scrollbar &#123;</span><br><span class="line"><span class="attribute">width</span>: <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-tag">div</span><span class="selector-id">#quit-board</span>&#123;</span><br><span class="line">  <span class="attribute">display</span>: none;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-tag">div</span><span class="selector-id">#quit-board</span><span class="selector-class">.fixedcomment</span> &#123;</span><br><span class="line">  <span class="attribute">position</span>: fixed;</span><br><span class="line">  <span class="attribute">display</span>:block<span class="meta">!important</span>;</span><br><span class="line">  <span class="attribute">left</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">top</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">40%</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">100vh</span>;</span><br><span class="line">  <span class="attribute">z-index</span>: <span class="number">89</span><span class="meta">!important</span>;</span><br><span class="line">  <span class="attribute">background</span>: <span class="built_in">rgba</span>(<span class="number">25</span>,<span class="number">25</span>,<span class="number">25</span>,<span class="number">0.3</span>);</span><br><span class="line">  <span class="attribute">filter</span>: <span class="built_in">blur</span>(<span class="number">4px</span>) <span class="meta">!important</span>;</span><br><span class="line">  <span class="attribute">animation</span>: fixedleft <span class="number">0.5s</span> linear;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*手机端样式适配*/</span></span><br><span class="line"><span class="keyword">@media</span> screen <span class="keyword">and</span> (<span class="attribute">max-width</span>: <span class="number">768px</span>) &#123;</span><br><span class="line">  <span class="selector-tag">div</span><span class="selector-id">#post-comment</span><span class="selector-class">.fixedcomment</span> &#123;</span><br><span class="line">      <span class="attribute">width</span>: <span class="number">90%</span>;</span><br><span class="line">      <span class="attribute">right</span>: <span class="number">0</span>;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="selector-tag">div</span><span class="selector-id">#quit-board</span><span class="selector-class">.fixedcomment</span> &#123;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">10%</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/*动画效果*/</span></span><br><span class="line"><span class="keyword">@keyframes</span> fixedright &#123;</span><br><span class="line">  <span class="selector-tag">from</span> &#123;<span class="attribute">right</span>:-<span class="number">50%</span>;&#125;</span><br><span class="line">  <span class="selector-tag">to</span> &#123;<span class="attribute">right</span>:<span class="number">0</span>;&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">@keyframes</span> fixedleft &#123;</span><br><span class="line">  <span class="selector-tag">from</span> &#123;<span class="attribute">left</span>:-<span class="number">50%</span>;&#125;</span><br><span class="line">  <span class="selector-tag">to</span> &#123;<span class="attribute">left</span>:<span class="number">0</span>;&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">/* 夜间模式匹配 */</span></span><br><span class="line"><span class="selector-attr">[data-theme=<span class="string">&quot;dark&quot;</span>]</span></span><br><span class="line">  <span class="selector-tag">div</span><span class="selector-id">#post-comment</span><span class="selector-class">.fixedcomment</span> &#123;</span><br><span class="line">      <span class="attribute">background</span>: <span class="built_in">rgba</span>(<span class="number">35</span>, <span class="number">35</span>, <span class="number">35</span>, <span class="number">0.95</span>);</span><br><span class="line">      <span class="attribute">box-shadow</span>:<span class="number">3px</span> <span class="number">2px</span> <span class="number">12px</span> <span class="number">#90a1a4</span>;</span><br><span class="line">  &#125;</span><br><span class="line"><span class="selector-attr">[data-theme=<span class="string">&quot;dark&quot;</span>]</span></span><br><span class="line">  <span class="selector-tag">div</span><span class="selector-id">#quit-board</span><span class="selector-class">.fixedcomment</span> &#123;</span><br><span class="line">    <span class="attribute">background</span>: <span class="built_in">rgba</span>(<span class="number">147</span>, <span class="number">146</span>, <span class="number">128</span>, <span class="number">0.3</span>);</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure><p>新建<code>[Blogroot]\themes\butterfly\source\js\custom\fixed_comment.js</code></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//移除FixedComment类，保持原生样式，确保不与最新评论跳转冲突</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">RemoveFixedComment</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">var</span> activedItems = <span class="variable language_">document</span>.<span class="title function_">querySelectorAll</span>(<span class="string">&#x27;.fixedcomment&#x27;</span>);</span><br><span class="line">  <span class="keyword">if</span> (activedItems) &#123;</span><br><span class="line">    <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; activedItems.<span class="property">length</span>; i++) &#123;</span><br><span class="line">      activedItems[i].<span class="property">classList</span>.<span class="title function_">remove</span>(<span class="string">&#x27;fixedcomment&#x27;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//给post-comment添加fixedcomment类</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">AddFixedComment</span>(<span class="params"></span>)&#123;</span><br><span class="line">  <span class="keyword">var</span> commentBoard = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;post-comment&#x27;</span>);</span><br><span class="line">  <span class="keyword">var</span> quitBoard = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;quit-board&#x27;</span>);</span><br><span class="line">  commentBoard.<span class="property">classList</span>.<span class="title function_">add</span>(<span class="string">&#x27;fixedcomment&#x27;</span>);</span><br><span class="line">  quitBoard.<span class="property">classList</span>.<span class="title function_">add</span>(<span class="string">&#x27;fixedcomment&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//创建一个蒙版，作为退出键使用</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">CreateQuitBoard</span>(<span class="params"></span>)&#123;</span><br><span class="line">  <span class="keyword">var</span> quitBoard = <span class="string">`&lt;div id=&quot;quit-board&quot; onclick=&quot;RemoveFixedComment()&quot;&gt;&lt;/div&gt;`</span></span><br><span class="line">  <span class="keyword">var</span> commentBoard = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;post-comment&#x27;</span>);</span><br><span class="line">  commentBoard.<span class="title function_">insertAdjacentHTML</span>(<span class="string">&quot;beforebegin&quot;</span>,quitBoard)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">FixedCommentBtn</span>(<span class="params"></span>)&#123;</span><br><span class="line">  <span class="comment">//第一步，判断当前是否存在FixedComment类，存在则移除，不存在则添加</span></span><br><span class="line">  <span class="comment">// 获取评论区对象</span></span><br><span class="line">  <span class="keyword">var</span> commentBoard = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;post-comment&#x27;</span>);</span><br><span class="line">  <span class="comment">// 若评论区存在</span></span><br><span class="line">  <span class="keyword">if</span> (commentBoard) &#123;</span><br><span class="line">      <span class="comment">// 判断是否存在fixedcomment类</span></span><br><span class="line">      <span class="keyword">if</span> (commentBoard.<span class="property">className</span>.<span class="title function_">indexOf</span>(<span class="string">&#x27;fixedcomment&#x27;</span>) &gt; -<span class="number">1</span>)&#123;</span><br><span class="line">        <span class="comment">// 存在则移除</span></span><br><span class="line">        <span class="title class_">RemoveFixedComment</span>();</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="comment">// 不存在则添加</span></span><br><span class="line">        <span class="title class_">CreateQuitBoard</span>();</span><br><span class="line">        <span class="title class_">AddFixedComment</span>();</span><br><span class="line">      &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// 若不存在评论区则跳转至留言板(留言板路径记得改为自己的)</span></span><br><span class="line">  <span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="comment">// 判断是否开启了pjax，尽量不破坏全局吸底音乐刷新</span></span><br><span class="line">      <span class="keyword">if</span> (pjax)&#123;</span><br><span class="line">        pjax.<span class="title function_">loadUrl</span>(<span class="string">&quot;/comments/#post-comment&quot;</span>);</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="variable language_">window</span>.<span class="property">location</span>.<span class="property">href</span> = <span class="string">&quot;/comments/#post-comment&quot;</span>;</span><br><span class="line">      &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">//切换页面先初始化一遍，确保开始时是原生状态。所以要加pjax重载。</span></span><br><span class="line"><span class="title class_">RemoveFixedComment</span>();</span><br></pre></td></tr></table></figure><h2 id="2-修改文件"><a href="#2-修改文件" class="headerlink" title="2. 修改文件"></a>2. 修改文件</h2><p>修改<code>[Blogroot]\_config.butterfly.yml</code>的<code>inject</code>配置项，添加引入的js和css</p><div class="tip warning faa-horizontal animated-hover"><p>注意：fixed_comment.js 有前置依赖且需要排除 pjax ，故插入 js 时应当加入 data-pjax 和 defer 标签</p></div><figure class="highlight diff"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">  inject:</span><br><span class="line">    head:</span><br><span class="line"><span class="addition">+     - &lt;link rel=&quot;stylesheet&quot; href=&quot;/css/custom/fixed_comment.css&quot; media=&quot;defer&quot; onload=&quot;this.media=&#x27;all&#x27;&quot;&gt;</span></span><br><span class="line">    bottom:</span><br><span class="line"><span class="addition">+     - &lt;script data-pjax defer src=&quot;/js/custom/fixed_comment.js&quot;&gt;&lt;/script&gt;</span></span><br></pre></td></tr></table></figure><p>修改<code>[Blogroot]\themes\butterfly\layout\includes\rightside.pug</code>，大约第36行的位置</p><figure class="highlight diff"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">  if commentsJsLoad</span><br><span class="line"><span class="deletion">-   a#to_comment(href=&quot;#post-comment&quot; title=_p(&quot;rightside.scroll_to_comment&quot;))</span></span><br><span class="line"><span class="addition">+   button#to_comment(type=&quot;button&quot; title=_p(&quot;rightside.scroll_to_comment&quot;)     onclick=&quot;FixedCommentBtn();&quot;)</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Hexo </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 美化 </tag>
            
            <tag> 魔改 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>打赏按钮投币彩蛋效果</title>
      <link href="//posts/7800/"/>
      <url>//posts/7800/</url>
      
        <content type="html"><![CDATA[<div class="note warning flat"><p>本文修改主题为<code>Butterfly</code>主题，若使用其他主题，请自行确认修改位置。</p></div><h1 id="原文出处"><a href="#原文出处" class="headerlink" title="原文出处"></a>原文出处</h1><blockquote><p><a href="https://akilar.top/posts/23fdf850/">https://akilar.top/posts/23fdf850/</a></p></blockquote><h1 id="效果预览"><a href="#效果预览" class="headerlink" title="效果预览"></a>效果预览</h1><details class="folding-tag" ><summary> 查看图片 </summary>              <div class='content'>              <p><img src="https://cdn.randench.cn/image/24/08/8a3b257a36dea374.gif" alt="打赏按钮投币彩蛋效果预览"></p>              </div>            </details><h1 id="修改步骤"><a href="#修改步骤" class="headerlink" title="修改步骤"></a>修改步骤</h1><h2 id="1-修改文件"><a href="#1-修改文件" class="headerlink" title="1. 修改文件"></a>1. 修改文件</h2><p>修改<code>[Blogroot]\themes\butterfly\layout\includes\post\reward.pug</code>，整体替换为以下内容</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">link(rel=&#x27;stylesheet&#x27; href=url_for(theme.CDN.coin_css) media=&quot;defer&quot; onload=&quot;this.media=&#x27;all&#x27;&quot;)</span><br><span class="line">.post-reward</span><br><span class="line">  button.tip-button.reward-button</span><br><span class="line">    span.tip-button__text= _p(&#x27;donate&#x27;)</span><br><span class="line">    .coin-wrapper</span><br><span class="line">      .coin</span><br><span class="line">        .coin__middle</span><br><span class="line">        .coin__back</span><br><span class="line">        .coin__front</span><br><span class="line">    .reward-main</span><br><span class="line">      ul.reward-all</span><br><span class="line">        each item in theme.reward.QR_code</span><br><span class="line">          - var clickTo = (item.itemlist||item).link ? (item.itemlist||item).link : (item.itemlist||item).img</span><br><span class="line">          li.reward-item</span><br><span class="line">            a(href=clickTo target=&#x27;_blank&#x27;)</span><br><span class="line">              img.post-qr-code-img(src=url_for((item.itemlist||item).img) alt=(item.itemlist||item).text)</span><br><span class="line">            .post-qr-code-desc=(item.itemlist||item).text</span><br><span class="line">if theme.reward.coinAudio</span><br><span class="line">  - var coinAudio = theme.reward.coinAudio ? url_for(theme.reward.coinAudio) : &#x27;https://npm.elemecdn.com/akilar-candyassets@1.0.16/audio/coin.mp3&#x27;</span><br><span class="line">  audio#coinAudio(src=coinAudio)</span><br><span class="line">script(defer src=url_for(theme.CDN.coin_js))</span><br></pre></td></tr></table></figure><h2 id="2-新建文件"><a href="#2-新建文件" class="headerlink" title="2. 新建文件"></a>2. 新建文件</h2><p>新建<code>[Blogroot]\themes\butterfly\source\css\coin.css</code></p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.tip-button</span> &#123;</span><br><span class="line">  <span class="attribute">border</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">border-radius</span>: <span class="number">0.25rem</span>;</span><br><span class="line">  <span class="attribute">cursor</span>: pointer;</span><br><span class="line">  <span class="attribute">font-size</span>: <span class="number">20px</span>;</span><br><span class="line">  <span class="attribute">font-weight</span>: <span class="number">600</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">2.6rem</span>;</span><br><span class="line">  <span class="attribute">margin-bottom</span>: -<span class="number">4rem</span>;</span><br><span class="line">  <span class="attribute">outline</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">position</span>: relative;</span><br><span class="line">  <span class="attribute">top</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">transform-origin</span>: <span class="number">0%</span> <span class="number">100%</span>;</span><br><span class="line">  <span class="attribute">transition</span>: transform <span class="number">50ms</span> ease-in-out;</span><br><span class="line">  <span class="attribute">width</span>: auto;</span><br><span class="line">  -webkit-tap-highlight-<span class="attribute">color</span>: transparent;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.tip-button</span><span class="selector-pseudo">:active</span> &#123;</span><br><span class="line">  <span class="attribute">transform</span>: <span class="built_in">rotate</span>(<span class="number">4deg</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.tip-button</span><span class="selector-class">.clicked</span> &#123;</span><br><span class="line">  <span class="attribute">animation</span>: <span class="number">150ms</span> ease-in-out <span class="number">1</span> shake;</span><br><span class="line">  <span class="attribute">pointer-events</span>: none;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.tip-button</span><span class="selector-class">.clicked</span> <span class="selector-class">.tip-button__text</span> &#123;</span><br><span class="line">  <span class="attribute">opacity</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">transition</span>: opacity <span class="number">100ms</span> linear <span class="number">200ms</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.tip-button</span><span class="selector-class">.clicked</span><span class="selector-pseudo">::before</span> &#123;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">0.5rem</span>;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">60%</span>;</span><br><span class="line">  <span class="attribute">background</span>: $button-hover-color;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.tip-button</span><span class="selector-class">.clicked</span> <span class="selector-class">.coin</span> &#123;</span><br><span class="line">  <span class="attribute">transition</span>: margin-bottom <span class="number">1s</span> linear <span class="number">200ms</span>;</span><br><span class="line">  <span class="attribute">margin-bottom</span>: <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.tip-button</span><span class="selector-class">.shrink-landing</span><span class="selector-pseudo">::before</span> &#123;</span><br><span class="line">  <span class="attribute">transition</span>: width <span class="number">200ms</span> ease-in;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">0</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.tip-button</span><span class="selector-class">.coin-landed</span><span class="selector-pseudo">::after</span> &#123;</span><br><span class="line">  <span class="attribute">opacity</span>: <span class="number">1</span>;</span><br><span class="line">  <span class="attribute">transform</span>: <span class="built_in">scale</span>(<span class="number">1</span>);</span><br><span class="line">  <span class="attribute">transform-origin</span>: <span class="number">50%</span> <span class="number">100%</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.tip-button</span><span class="selector-class">.coin-landed</span> <span class="selector-class">.coin-wrapper</span> &#123;</span><br><span class="line">  <span class="attribute">background</span>: <span class="built_in">radial-gradient</span>(circle at <span class="number">35%</span> <span class="number">97%</span>, <span class="built_in">rgba</span>(<span class="number">3</span>, <span class="number">16</span>, <span class="number">50</span>, <span class="number">0.4</span>) <span class="number">0.04rem</span>, transparent <span class="number">0.04rem</span>), <span class="built_in">radial-gradient</span>(circle at <span class="number">45%</span> <span class="number">92%</span>, <span class="built_in">rgba</span>(<span class="number">3</span>, <span class="number">16</span>, <span class="number">50</span>, <span class="number">0.4</span>) <span class="number">0.04rem</span>, transparent <span class="number">0.02rem</span>), <span class="built_in">radial-gradient</span>(circle at <span class="number">55%</span> <span class="number">98%</span>, <span class="built_in">rgba</span>(<span class="number">3</span>, <span class="number">16</span>, <span class="number">50</span>, <span class="number">0.4</span>) <span class="number">0.04rem</span>, transparent <span class="number">0.04rem</span>), <span class="built_in">radial-gradient</span>(circle at <span class="number">65%</span> <span class="number">96%</span>, <span class="built_in">rgba</span>(<span class="number">3</span>, <span class="number">16</span>, <span class="number">50</span>, <span class="number">0.4</span>) <span class="number">0.06rem</span>, transparent <span class="number">0.06rem</span>);</span><br><span class="line">  <span class="attribute">background-position</span>: center bottom;</span><br><span class="line">  <span class="attribute">background-size</span>: <span class="number">100%</span>;</span><br><span class="line">  <span class="attribute">bottom</span>: -<span class="number">1rem</span>;</span><br><span class="line">  <span class="attribute">opacity</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">transform</span>: <span class="built_in">scale</span>(<span class="number">2</span>) <span class="built_in">translateY</span>(-<span class="number">10px</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.tip-button__text</span> &#123;</span><br><span class="line">  <span class="attribute">color</span>: <span class="number">#fff</span>;</span><br><span class="line">  <span class="attribute">margin-right</span>: <span class="number">1.8rem</span>;</span><br><span class="line">  <span class="attribute">opacity</span>: <span class="number">1</span>;</span><br><span class="line">  <span class="attribute">position</span>: relative;</span><br><span class="line">  <span class="attribute">transition</span>: opacity <span class="number">100ms</span> linear <span class="number">500ms</span>;</span><br><span class="line">  <span class="attribute">z-index</span>: <span class="number">3</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.tip-button</span><span class="selector-pseudo">::before</span> &#123;</span><br><span class="line">  <span class="attribute">border-radius</span>: <span class="number">0.25rem</span>;</span><br><span class="line">  <span class="attribute">bottom</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">content</span>: <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">  <span class="attribute">display</span>: block;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">100%</span>;</span><br><span class="line">  <span class="attribute">left</span>: <span class="number">50%</span>;</span><br><span class="line">  <span class="attribute">position</span>: absolute;</span><br><span class="line">  <span class="attribute">transform</span>: <span class="built_in">translateX</span>(-<span class="number">50%</span>);</span><br><span class="line">  <span class="attribute">transition</span>: height <span class="number">250ms</span> ease-in-out <span class="number">400ms</span>, width <span class="number">250ms</span> ease-in-out <span class="number">300ms</span>;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">  <span class="attribute">z-index</span>: <span class="number">2</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.tip-button</span><span class="selector-pseudo">::after</span> &#123;</span><br><span class="line">  <span class="attribute">bottom</span>: -<span class="number">1rem</span>;</span><br><span class="line">  <span class="attribute">color</span>: white;</span><br><span class="line">  <span class="attribute">content</span>: <span class="string">&#x27;ヾ(≧O≦)〃嗷~&#x27;</span>; <span class="comment">/*点击后显示的内容*/</span></span><br><span class="line">  <span class="attribute">height</span>: <span class="number">110%</span>;</span><br><span class="line">  <span class="attribute">left</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">opacity</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">position</span>: absolute;</span><br><span class="line">  <span class="attribute">pointer-events</span>: none;</span><br><span class="line">  <span class="attribute">text-align</span>: center;</span><br><span class="line">  <span class="attribute">transform</span>: <span class="built_in">scale</span>(<span class="number">0</span>);</span><br><span class="line">  <span class="attribute">transform-origin</span>: <span class="number">50%</span> <span class="number">20%</span>;</span><br><span class="line">  <span class="attribute">transition</span>: transform <span class="number">200ms</span> <span class="built_in">cubic-bezier</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0.35</span>, <span class="number">1.43</span>);</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">  <span class="attribute">z-index</span>: <span class="number">1</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.coin-wrapper</span> &#123;</span><br><span class="line">  <span class="attribute">background</span>: none;</span><br><span class="line">  <span class="attribute">bottom</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">18rem</span>;</span><br><span class="line">  <span class="attribute">left</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">opacity</span>: <span class="number">1</span>;</span><br><span class="line">  <span class="attribute">overflow</span>: hidden;</span><br><span class="line">  <span class="attribute">pointer-events</span>: none;</span><br><span class="line">  <span class="attribute">position</span>: absolute;</span><br><span class="line">  <span class="attribute">transform</span>: none;</span><br><span class="line">  <span class="attribute">transform-origin</span>: <span class="number">50%</span> <span class="number">100%</span>;</span><br><span class="line">  <span class="attribute">transition</span>: opacity <span class="number">200ms</span> linear <span class="number">100ms</span>, transform <span class="number">300ms</span> ease-out;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.coin</span> &#123;</span><br><span class="line">  <span class="attr">--front-y-multiplier</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attr">--back-y-multiplier</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attr">--coin-y-multiplier</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attr">--coin-x-multiplier</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attr">--coin-scale-multiplier</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attr">--coin-rotation-multiplier</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attr">--shine-opacity-multiplier</span>: <span class="number">0.4</span>;</span><br><span class="line">  <span class="attr">--shine-bg-multiplier</span>: <span class="number">50%</span>;</span><br><span class="line">  <span class="attribute">bottom</span>: <span class="built_in">calc</span>(<span class="built_in">var</span>(--coin-y-multiplier) * <span class="number">1rem</span> - <span class="number">3.5rem</span>);</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">3.5rem</span>;</span><br><span class="line">  <span class="attribute">margin-bottom</span>: <span class="number">3.05rem</span>;</span><br><span class="line">  <span class="attribute">position</span>: absolute;</span><br><span class="line">  <span class="attribute">right</span>: <span class="built_in">calc</span>(<span class="built_in">var</span>(--coin-x-multiplier) * <span class="number">34%</span> + <span class="number">16%</span>);</span><br><span class="line">  <span class="attribute">transform</span>: <span class="built_in">translateX</span>(<span class="number">50%</span>) <span class="built_in">scale</span>(<span class="built_in">calc</span>(<span class="number">0.4</span> + <span class="built_in">var</span>(--coin-scale-multiplier))) <span class="built_in">rotate</span>(<span class="built_in">calc</span>(<span class="built_in">var</span>(--coin-rotation-multiplier) * -<span class="number">1deg</span>));</span><br><span class="line">  <span class="attribute">transition</span>: opacity <span class="number">100ms</span> linear <span class="number">200ms</span>;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">3.5rem</span>;</span><br><span class="line">  <span class="attribute">z-index</span>: <span class="number">3</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.coin__front</span>, <span class="selector-class">.coin__middle</span>, <span class="selector-class">.coin__back</span>, <span class="selector-class">.coin</span><span class="selector-pseudo">::before</span>, <span class="selector-class">.coin__front</span><span class="selector-pseudo">::after</span>, <span class="selector-class">.coin__back</span><span class="selector-pseudo">::after</span> &#123;</span><br><span class="line">  <span class="attribute">border-radius</span>: <span class="number">50%</span>;</span><br><span class="line">  <span class="attribute">box-sizing</span>: border-box;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">100%</span>;</span><br><span class="line">  <span class="attribute">left</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">position</span>: absolute;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">  <span class="attribute">z-index</span>: <span class="number">3</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.coin__front</span> &#123;</span><br><span class="line">  <span class="attribute">background</span>: <span class="built_in">radial-gradient</span>(circle at <span class="number">50%</span> <span class="number">50%</span>, transparent <span class="number">50%</span>, <span class="built_in">rgba</span>(<span class="number">115</span>, <span class="number">124</span>, <span class="number">153</span>, <span class="number">0.4</span>) <span class="number">54%</span>, <span class="number">#c2cadf</span> <span class="number">54%</span>), <span class="built_in">linear-gradient</span>(<span class="number">210deg</span>, <span class="number">#8590b3</span> <span class="number">32%</span>, transparent <span class="number">32%</span>), <span class="built_in">linear-gradient</span>(<span class="number">150deg</span>, <span class="number">#8590b3</span> <span class="number">32%</span>, transparent <span class="number">32%</span>), <span class="built_in">linear-gradient</span>(to right, <span class="number">#8590b3</span> <span class="number">22%</span>, transparent <span class="number">22%</span>, transparent <span class="number">78%</span>, <span class="number">#8590b3</span> <span class="number">78%</span>), <span class="built_in">linear-gradient</span>(to bottom, <span class="number">#fcfaf9</span> <span class="number">44%</span>, transparent <span class="number">44%</span>, transparent <span class="number">65%</span>, <span class="number">#fcfaf9</span> <span class="number">65%</span>, <span class="number">#fcfaf9</span> <span class="number">71%</span>, <span class="number">#8590b3</span> <span class="number">71%</span>), <span class="built_in">linear-gradient</span>(to right, transparent <span class="number">28%</span>, <span class="number">#fcfaf9</span> <span class="number">28%</span>, <span class="number">#fcfaf9</span> <span class="number">34%</span>, <span class="number">#8590b3</span> <span class="number">34%</span>, <span class="number">#8590b3</span> <span class="number">40%</span>, <span class="number">#fcfaf9</span> <span class="number">40%</span>, <span class="number">#fcfaf9</span> <span class="number">47%</span>, <span class="number">#8590b3</span> <span class="number">47%</span>, <span class="number">#8590b3</span> <span class="number">53%</span>, <span class="number">#fcfaf9</span> <span class="number">53%</span>, <span class="number">#fcfaf9</span> <span class="number">60%</span>, <span class="number">#8590b3</span> <span class="number">60%</span>, <span class="number">#8590b3</span> <span class="number">66%</span>, <span class="number">#fcfaf9</span> <span class="number">66%</span>, <span class="number">#fcfaf9</span> <span class="number">72%</span>, transparent <span class="number">72%</span>);</span><br><span class="line">  <span class="attribute">background-color</span>: <span class="number">#8590b3</span>;</span><br><span class="line">  <span class="attribute">background-size</span>: <span class="number">100%</span> <span class="number">100%</span>;</span><br><span class="line">  <span class="attribute">transform</span>: <span class="built_in">translateY</span>(<span class="built_in">calc</span>(<span class="built_in">var</span>(--front-y-multiplier) * <span class="number">0.3181818182rem</span> / <span class="number">2</span>)) <span class="built_in">scaleY</span>(<span class="built_in">var</span>(--front-scale-multiplier));</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.coin__front</span><span class="selector-pseudo">::after</span> &#123;</span><br><span class="line">  <span class="attribute">background</span>: <span class="built_in">rgba</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0.2</span>);</span><br><span class="line">  <span class="attribute">content</span>: <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">  <span class="attribute">opacity</span>: <span class="built_in">var</span>(--front-y-multiplier);</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.coin__middle</span> &#123;</span><br><span class="line">  <span class="attribute">background</span>: <span class="number">#737c99</span>;</span><br><span class="line">  <span class="attribute">transform</span>: <span class="built_in">translateY</span>(<span class="built_in">calc</span>(<span class="built_in">var</span>(--middle-y-multiplier) * <span class="number">0.3181818182rem</span> / <span class="number">2</span>)) <span class="built_in">scaleY</span>(<span class="built_in">var</span>(--middle-scale-multiplier));</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.coin__back</span> &#123;</span><br><span class="line">  <span class="attribute">background</span>: <span class="built_in">radial-gradient</span>(circle at <span class="number">50%</span> <span class="number">50%</span>, transparent <span class="number">50%</span>, <span class="built_in">rgba</span>(<span class="number">115</span>, <span class="number">124</span>, <span class="number">153</span>, <span class="number">0.4</span>) <span class="number">54%</span>, <span class="number">#c2cadf</span> <span class="number">54%</span>), <span class="built_in">radial-gradient</span>(circle at <span class="number">50%</span> <span class="number">40%</span>, <span class="number">#fcfaf9</span> <span class="number">23%</span>, transparent <span class="number">23%</span>), <span class="built_in">radial-gradient</span>(circle at <span class="number">50%</span> <span class="number">100%</span>, <span class="number">#fcfaf9</span> <span class="number">35%</span>, transparent <span class="number">35%</span>);</span><br><span class="line">  <span class="attribute">background-color</span>: <span class="number">#8590b3</span>;</span><br><span class="line">  <span class="attribute">background-size</span>: <span class="number">100%</span> <span class="number">100%</span>;</span><br><span class="line">  <span class="attribute">transform</span>: <span class="built_in">translateY</span>(<span class="built_in">calc</span>(<span class="built_in">var</span>(--back-y-multiplier) * <span class="number">0.3181818182rem</span> / <span class="number">2</span>)) <span class="built_in">scaleY</span>(<span class="built_in">var</span>(--back-scale-multiplier));</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.coin__back</span><span class="selector-pseudo">::after</span> &#123;</span><br><span class="line">  <span class="attribute">background</span>: <span class="built_in">rgba</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0.2</span>);</span><br><span class="line">  <span class="attribute">content</span>: <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">  <span class="attribute">opacity</span>: <span class="built_in">var</span>(--back-y-multiplier);</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.coin</span><span class="selector-pseudo">::before</span> &#123;</span><br><span class="line">  <span class="attribute">background</span>: <span class="built_in">radial-gradient</span>(circle at <span class="number">25%</span> <span class="number">65%</span>, transparent <span class="number">50%</span>, <span class="built_in">rgba</span>(<span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0.9</span>) <span class="number">90%</span>), <span class="built_in">linear-gradient</span>(<span class="number">55deg</span>, transparent <span class="built_in">calc</span>(<span class="built_in">var</span>(--shine-bg-multiplier) + <span class="number">0%</span>), <span class="number">#e9f4ff</span> <span class="built_in">calc</span>(<span class="built_in">var</span>(--shine-bg-multiplier) + <span class="number">0%</span>), transparent <span class="built_in">calc</span>(<span class="built_in">var</span>(--shine-bg-multiplier) + <span class="number">50%</span>));</span><br><span class="line">  <span class="attribute">content</span>: <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">  <span class="attribute">opacity</span>: <span class="built_in">var</span>(--shine-opacity-multiplier);</span><br><span class="line">  <span class="attribute">transform</span>: <span class="built_in">translateY</span>(<span class="built_in">calc</span>(<span class="built_in">var</span>(--middle-y-multiplier) * <span class="number">0.3181818182rem</span> / -<span class="number">2</span>)) <span class="built_in">scaleY</span>(<span class="built_in">var</span>(--middle-scale-multiplier)) <span class="built_in">rotate</span>(<span class="built_in">calc</span>(<span class="built_in">var</span>(--coin-rotation-multiplier) * <span class="number">1deg</span>));</span><br><span class="line">  <span class="attribute">z-index</span>: <span class="number">10</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.coin</span><span class="selector-pseudo">::after</span> &#123;</span><br><span class="line">  <span class="attribute">background</span>: <span class="number">#737c99</span>;</span><br><span class="line">  <span class="attribute">content</span>: <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">0.3181818182rem</span>;</span><br><span class="line">  <span class="attribute">left</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">position</span>: absolute;</span><br><span class="line">  <span class="attribute">top</span>: <span class="number">50%</span>;</span><br><span class="line">  <span class="attribute">transform</span>: <span class="built_in">translateY</span>(-<span class="number">50%</span>);</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">  <span class="attribute">z-index</span>: <span class="number">2</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@keyframes</span> shake &#123;</span><br><span class="line">  <span class="number">0%</span> &#123;</span><br><span class="line">    <span class="attribute">transform</span>: <span class="built_in">rotate</span>(<span class="number">4deg</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="number">66%</span> &#123;</span><br><span class="line">    <span class="attribute">transform</span>: <span class="built_in">rotate</span>(-<span class="number">4deg</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="number">100%</span> &#123;</span><br><span class="line">    <span class="attribute">transform</span>: <span class="built_in">rotate</span>();</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><p>新建<code>[Blogroot]\themes\butterfly\source\js\coin.js</code></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">var</span> tipButtons = <span class="variable language_">document</span>.<span class="title function_">querySelectorAll</span>(<span class="string">&#x27;.tip-button&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">coinAudio</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">var</span> coinAudio = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;coinAudio&quot;</span>);</span><br><span class="line">  <span class="keyword">if</span> (coinAudio) &#123;</span><br><span class="line">    coinAudio.<span class="title function_">play</span>();<span class="comment">//有音频时播放</span></span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// Loop through all buttons (allows for multiple buttons on page)</span></span><br><span class="line">tipButtons.<span class="title function_">forEach</span>(<span class="function">(<span class="params">button</span>) =&gt;</span> &#123;</span><br><span class="line">  <span class="keyword">var</span> coin = button.<span class="title function_">querySelector</span>(<span class="string">&#x27;.coin&#x27;</span>)</span><br><span class="line"></span><br><span class="line">  <span class="comment">// The larger the number, the slower the animation</span></span><br><span class="line">  coin.<span class="property">maxMoveLoopCount</span> = <span class="number">90</span></span><br><span class="line"></span><br><span class="line">  button.<span class="title function_">addEventListener</span>(<span class="string">&#x27;click&#x27;</span>, <span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="regexp">/Android|webOS|BlackBerry/i</span>.<span class="title function_">test</span>(navigator.<span class="property">userAgent</span>)) <span class="keyword">return</span> <span class="literal">true</span>; <span class="comment">//媒体选择</span></span><br><span class="line">    <span class="keyword">if</span> (button.<span class="property">clicked</span>) <span class="keyword">return</span></span><br><span class="line">    button.<span class="property">classList</span>.<span class="title function_">add</span>(<span class="string">&#x27;clicked&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Wait to start flipping th coin because of the button tilt animation</span></span><br><span class="line">    <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">      <span class="comment">// Randomize the flipping speeds just for fun</span></span><br><span class="line">      coin.<span class="property">sideRotationCount</span> = <span class="title class_">Math</span>.<span class="title function_">floor</span>(<span class="title class_">Math</span>.<span class="title function_">random</span>() * <span class="number">5</span>) * <span class="number">90</span></span><br><span class="line">      coin.<span class="property">maxFlipAngle</span> = (<span class="title class_">Math</span>.<span class="title function_">floor</span>(<span class="title class_">Math</span>.<span class="title function_">random</span>() * <span class="number">4</span>) + <span class="number">3</span>) * <span class="title class_">Math</span>.<span class="property">PI</span></span><br><span class="line">      button.<span class="property">clicked</span> = <span class="literal">true</span></span><br><span class="line">      <span class="title function_">flipCoin</span>()</span><br><span class="line">      <span class="title function_">coinAudio</span>()</span><br><span class="line">    &#125;, <span class="number">50</span>)</span><br><span class="line">  &#125;)</span><br><span class="line"></span><br><span class="line">  <span class="keyword">var</span> <span class="title function_">flipCoin</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">    coin.<span class="property">moveLoopCount</span> = <span class="number">0</span></span><br><span class="line">    <span class="title function_">flipCoinLoop</span>()</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">var</span> <span class="title function_">resetCoin</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">    coin.<span class="property">style</span>.<span class="title function_">setProperty</span>(<span class="string">&#x27;--coin-x-multiplier&#x27;</span>, <span class="number">0</span>)</span><br><span class="line">    coin.<span class="property">style</span>.<span class="title function_">setProperty</span>(<span class="string">&#x27;--coin-scale-multiplier&#x27;</span>, <span class="number">0</span>)</span><br><span class="line">    coin.<span class="property">style</span>.<span class="title function_">setProperty</span>(<span class="string">&#x27;--coin-rotation-multiplier&#x27;</span>, <span class="number">0</span>)</span><br><span class="line">    coin.<span class="property">style</span>.<span class="title function_">setProperty</span>(<span class="string">&#x27;--shine-opacity-multiplier&#x27;</span>, <span class="number">0.4</span>)</span><br><span class="line">    coin.<span class="property">style</span>.<span class="title function_">setProperty</span>(<span class="string">&#x27;--shine-bg-multiplier&#x27;</span>, <span class="string">&#x27;50%&#x27;</span>)</span><br><span class="line">    coin.<span class="property">style</span>.<span class="title function_">setProperty</span>(<span class="string">&#x27;opacity&#x27;</span>, <span class="number">1</span>)</span><br><span class="line">    <span class="comment">// Delay to give the reset animation some time before you can click again</span></span><br><span class="line">    <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">      button.<span class="property">clicked</span> = <span class="literal">false</span></span><br><span class="line">    &#125;, <span class="number">300</span>)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">var</span> <span class="title function_">flipCoinLoop</span> = (<span class="params"></span>) =&gt; &#123;</span><br><span class="line">    coin.<span class="property">moveLoopCount</span>++</span><br><span class="line">    <span class="keyword">var</span> percentageCompleted = coin.<span class="property">moveLoopCount</span> / coin.<span class="property">maxMoveLoopCount</span></span><br><span class="line">    coin.<span class="property">angle</span> = -coin.<span class="property">maxFlipAngle</span> * <span class="title class_">Math</span>.<span class="title function_">pow</span>((percentageCompleted - <span class="number">1</span>), <span class="number">2</span>) + coin.<span class="property">maxFlipAngle</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">// Calculate the scale and position of the coin moving through the air</span></span><br><span class="line">    coin.<span class="property">style</span>.<span class="title function_">setProperty</span>(<span class="string">&#x27;--coin-y-multiplier&#x27;</span>, -<span class="number">11</span> * <span class="title class_">Math</span>.<span class="title function_">pow</span>(percentageCompleted * <span class="number">2</span> - <span class="number">1</span>, <span class="number">4</span>) + <span class="number">11</span>)</span><br><span class="line">    coin.<span class="property">style</span>.<span class="title function_">setProperty</span>(<span class="string">&#x27;--coin-x-multiplier&#x27;</span>, percentageCompleted)</span><br><span class="line">    coin.<span class="property">style</span>.<span class="title function_">setProperty</span>(<span class="string">&#x27;--coin-scale-multiplier&#x27;</span>, percentageCompleted * <span class="number">0.6</span>)</span><br><span class="line">    coin.<span class="property">style</span>.<span class="title function_">setProperty</span>(<span class="string">&#x27;--coin-rotation-multiplier&#x27;</span>, percentageCompleted * coin.<span class="property">sideRotationCount</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Calculate the scale and position values for the different coin faces</span></span><br><span class="line">    <span class="comment">// The math uses sin/cos wave functions to similate the circular motion of 3D spin</span></span><br><span class="line">    coin.<span class="property">style</span>.<span class="title function_">setProperty</span>(<span class="string">&#x27;--front-scale-multiplier&#x27;</span>, <span class="title class_">Math</span>.<span class="title function_">max</span>(<span class="title class_">Math</span>.<span class="title function_">cos</span>(coin.<span class="property">angle</span>), <span class="number">0</span>))</span><br><span class="line">    coin.<span class="property">style</span>.<span class="title function_">setProperty</span>(<span class="string">&#x27;--front-y-multiplier&#x27;</span>, <span class="title class_">Math</span>.<span class="title function_">sin</span>(coin.<span class="property">angle</span>))</span><br><span class="line"></span><br><span class="line">    coin.<span class="property">style</span>.<span class="title function_">setProperty</span>(<span class="string">&#x27;--middle-scale-multiplier&#x27;</span>, <span class="title class_">Math</span>.<span class="title function_">abs</span>(<span class="title class_">Math</span>.<span class="title function_">cos</span>(coin.<span class="property">angle</span>), <span class="number">0</span>))</span><br><span class="line">    coin.<span class="property">style</span>.<span class="title function_">setProperty</span>(<span class="string">&#x27;--middle-y-multiplier&#x27;</span>, <span class="title class_">Math</span>.<span class="title function_">cos</span>((coin.<span class="property">angle</span> + <span class="title class_">Math</span>.<span class="property">PI</span> / <span class="number">2</span>) % <span class="title class_">Math</span>.<span class="property">PI</span>))</span><br><span class="line"></span><br><span class="line">    coin.<span class="property">style</span>.<span class="title function_">setProperty</span>(<span class="string">&#x27;--back-scale-multiplier&#x27;</span>, <span class="title class_">Math</span>.<span class="title function_">max</span>(<span class="title class_">Math</span>.<span class="title function_">cos</span>(coin.<span class="property">angle</span> - <span class="title class_">Math</span>.<span class="property">PI</span>), <span class="number">0</span>))</span><br><span class="line">    coin.<span class="property">style</span>.<span class="title function_">setProperty</span>(<span class="string">&#x27;--back-y-multiplier&#x27;</span>, <span class="title class_">Math</span>.<span class="title function_">sin</span>(coin.<span class="property">angle</span> - <span class="title class_">Math</span>.<span class="property">PI</span>))</span><br><span class="line"></span><br><span class="line">    coin.<span class="property">style</span>.<span class="title function_">setProperty</span>(<span class="string">&#x27;--shine-opacity-multiplier&#x27;</span>, <span class="number">4</span> * <span class="title class_">Math</span>.<span class="title function_">sin</span>((coin.<span class="property">angle</span> + <span class="title class_">Math</span>.<span class="property">PI</span> / <span class="number">2</span>) % <span class="title class_">Math</span>.<span class="property">PI</span>) - <span class="number">3.2</span>)</span><br><span class="line">    coin.<span class="property">style</span>.<span class="title function_">setProperty</span>(<span class="string">&#x27;--shine-bg-multiplier&#x27;</span>, -<span class="number">40</span> * (<span class="title class_">Math</span>.<span class="title function_">cos</span>((coin.<span class="property">angle</span> + <span class="title class_">Math</span>.<span class="property">PI</span> / <span class="number">2</span>) % <span class="title class_">Math</span>.<span class="property">PI</span>) - <span class="number">0.5</span>) + <span class="string">&#x27;%&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment">// Repeat animation loop</span></span><br><span class="line">    <span class="keyword">if</span> (coin.<span class="property">moveLoopCount</span> &lt; coin.<span class="property">maxMoveLoopCount</span>) &#123;</span><br><span class="line">      <span class="keyword">if</span> (coin.<span class="property">moveLoopCount</span> === coin.<span class="property">maxMoveLoopCount</span> - <span class="number">6</span>) button.<span class="property">classList</span>.<span class="title function_">add</span>(<span class="string">&#x27;shrink-landing&#x27;</span>)</span><br><span class="line">      <span class="variable language_">window</span>.<span class="title function_">requestAnimationFrame</span>(flipCoinLoop)</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      button.<span class="property">classList</span>.<span class="title function_">add</span>(<span class="string">&#x27;coin-landed&#x27;</span>)</span><br><span class="line">      coin.<span class="property">style</span>.<span class="title function_">setProperty</span>(<span class="string">&#x27;opacity&#x27;</span>, <span class="number">0</span>)</span><br><span class="line">      <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">        button.<span class="property">classList</span>.<span class="title function_">remove</span>(<span class="string">&#x27;clicked&#x27;</span>, <span class="string">&#x27;shrink-landing&#x27;</span>, <span class="string">&#x27;coin-landed&#x27;</span>)</span><br><span class="line">        <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">          <span class="title function_">resetCoin</span>()</span><br><span class="line">        &#125;, <span class="number">300</span>)</span><br><span class="line">      &#125;, <span class="number">1500</span>)</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><h2 id="3-引入文件"><a href="#3-引入文件" class="headerlink" title="3. 引入文件"></a>3. 引入文件</h2><p>修改<code>_config.butterfly.yml</code>,添加音频文件配置项，添加CDN配置项</p><figure class="highlight diff"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">  # Sponsor/reward</span><br><span class="line">  # Sponsor/reward</span><br><span class="line">  reward:</span><br><span class="line">    enable: true</span><br><span class="line"><span class="addition">+   coinAudio: https://npm.elemecdn.com/akilar-candyassets@1.0.16/audio/coin.mp3</span></span><br><span class="line">    QR_code:</span><br><span class="line">    。</span><br><span class="line">    。</span><br><span class="line">    。</span><br><span class="line">  CDN:</span><br><span class="line">    # main</span><br><span class="line">    main_css: /css/index.css</span><br><span class="line">    jquery: https://npm.elemecdn.com/jquery@latest/dist/jquery.min.js</span><br><span class="line">    main: /js/main.js</span><br><span class="line">    utils:/js/utils.js</span><br><span class="line"><span class="addition">+    # 打赏按钮投币效果</span></span><br><span class="line"><span class="addition">+   coin_js: /js/coin.js</span></span><br><span class="line"><span class="addition">+   coin_css: /css/coin.css</span></span><br></pre></td></tr></table></figure><h2 id="4-样式调整"><a href="#4-样式调整" class="headerlink" title="4. 样式调整"></a>4. 样式调整</h2><p>现在的打赏按钮样式需要稍作适配，当前若提示语太长，悬停时会无法显示完全。需要微调一下,修改<code>[Blogroot]\themes\butterfly\source\css\_layout\reward.styl</code>，整体替换为以下内容</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.post-reward</span></span><br><span class="line">  <span class="attribute">position</span>: relative</span><br><span class="line">  <span class="attribute">margin-top</span>: <span class="number">4rem</span></span><br><span class="line">  <span class="attribute">width</span>: <span class="number">100%</span></span><br><span class="line">  <span class="attribute">text-align</span>: center</span><br><span class="line"></span><br><span class="line">  <span class="selector-class">.reward-button</span></span><br><span class="line">    <span class="attribute">display</span>: inline-block</span><br><span class="line">    <span class="attribute">padding</span>: .<span class="number">2rem</span> <span class="number">1.2rem</span></span><br><span class="line">    <span class="attribute">background</span>: <span class="built_in">var</span>(--btn-bg)</span><br><span class="line">    <span class="attribute">color</span>: <span class="built_in">var</span>(--btn-color)</span><br><span class="line">    <span class="attribute">cursor</span>: pointer</span><br><span class="line">    <span class="attribute">transition</span>: all .<span class="number">4s</span></span><br><span class="line"></span><br><span class="line">    <span class="selector-pseudo">&amp;:hover</span></span><br><span class="line">      <span class="attribute">box-shadow</span>: inset <span class="number">15em</span> <span class="number">0</span> <span class="number">0</span> <span class="number">0</span> <span class="built_in">var</span>(--btn-hover-color)</span><br><span class="line"></span><br><span class="line">      <span class="selector-class">.reward-main</span></span><br><span class="line">        <span class="attribute">display</span>: block</span><br><span class="line"></span><br><span class="line">    <span class="selector-class">.reward-main</span></span><br><span class="line">      <span class="attribute">position</span>: absolute</span><br><span class="line">      <span class="attribute">bottom</span>: <span class="number">40px</span></span><br><span class="line">      <span class="attribute">left</span>: -<span class="number">25%</span></span><br><span class="line">      <span class="attribute">z-index</span>: <span class="number">100</span></span><br><span class="line">      <span class="attribute">display</span>: none</span><br><span class="line">      <span class="attribute">padding</span>: <span class="number">0</span> <span class="number">0</span> <span class="number">15px</span></span><br><span class="line">      <span class="attribute">width</span>: <span class="number">150%</span></span><br><span class="line"></span><br><span class="line">      <span class="selector-class">.reward-all</span></span><br><span class="line">        <span class="attribute">display</span>: inline-block</span><br><span class="line">        <span class="attribute">margin</span>: <span class="number">0</span></span><br><span class="line">        <span class="attribute">padding</span>: <span class="number">1rem</span> .<span class="number">5rem</span></span><br><span class="line">        <span class="attribute">border-radius</span>: <span class="number">4px</span></span><br><span class="line">        <span class="attribute">background</span>: <span class="built_in">var</span>(--reward-pop)</span><br><span class="line"></span><br><span class="line">        <span class="selector-pseudo">&amp;:before</span></span><br><span class="line">          <span class="attribute">position</span>: absolute</span><br><span class="line">          <span class="attribute">bottom</span>: -<span class="number">10px</span></span><br><span class="line">          <span class="attribute">left</span>: <span class="number">0</span></span><br><span class="line">          <span class="attribute">width</span>: <span class="number">100%</span></span><br><span class="line">          <span class="attribute">height</span>: <span class="number">20px</span></span><br><span class="line">          <span class="attribute">content</span>: <span class="string">&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line">        <span class="selector-pseudo">&amp;:after</span></span><br><span class="line">          <span class="attribute">position</span>: absolute</span><br><span class="line">          <span class="attribute">right</span>: <span class="number">0</span></span><br><span class="line">          <span class="attribute">bottom</span>: <span class="number">2px</span></span><br><span class="line">          <span class="attribute">left</span>: <span class="number">0</span></span><br><span class="line">          <span class="attribute">margin</span>: <span class="number">0</span> auto</span><br><span class="line">          <span class="attribute">width</span>: <span class="number">0</span></span><br><span class="line">          <span class="attribute">height</span>: <span class="number">0</span></span><br><span class="line">          <span class="attribute">border-top</span>: <span class="number">13px</span> solid <span class="built_in">var</span>(--reward-pop)</span><br><span class="line">          <span class="attribute">border-right</span>: <span class="number">13px</span> solid transparent</span><br><span class="line">          <span class="attribute">border-left</span>: <span class="number">13px</span> solid transparent</span><br><span class="line">          <span class="attribute">content</span>: <span class="string">&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line">        <span class="selector-class">.reward-item</span></span><br><span class="line">          <span class="attribute">display</span>: inline-block</span><br><span class="line">          <span class="attribute">padding</span>: <span class="number">0</span> <span class="number">8px</span></span><br><span class="line">          <span class="attribute">list-style-type</span>: none</span><br><span class="line">          <span class="attribute">vertical-align</span>: top</span><br><span class="line"></span><br><span class="line">          <span class="selector-tag">img</span></span><br><span class="line">            <span class="attribute">width</span>: <span class="number">130px</span></span><br><span class="line">            <span class="attribute">height</span>: <span class="number">130px</span></span><br><span class="line"></span><br><span class="line">          <span class="selector-class">.post-qr-code-desc</span></span><br><span class="line">            <span class="attribute">padding-top</span>: .<span class="number">4rem</span></span><br><span class="line">            <span class="attribute">width</span>: <span class="number">130px</span></span><br><span class="line">            <span class="attribute">color</span>: <span class="variable">$reward</span>-pop-up-color</span><br></pre></td></tr></table></figure><p>还可以针对自己的情况适度调整以下内容</p><ul><li><p>修改悬停打赏按钮时的颜色填充长度</p><figure class="highlight diff"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">  .reward-button</span><br><span class="line">    display: inline-block</span><br><span class="line">    padding: .2rem 1.2rem</span><br><span class="line">    background: var(--btn-bg)</span><br><span class="line">    color: var(--btn-color)</span><br><span class="line">    cursor: pointer</span><br><span class="line">    transition: all .4s</span><br><span class="line"></span><br><span class="line">    &amp;:hover</span><br><span class="line"><span class="deletion">-     box-shadow: inset 9em 0 0 0 var(--btn-hover-color)</span></span><br><span class="line"><span class="addition">+     box-shadow: inset 20em 0 0 0 var(--btn-hover-color)</span></span><br></pre></td></tr></table></figure></li><li><p>修改打赏二维码的样式（仅针对2张二维码的情况，单张不用改动。两张以上需要自己调试这两个参数）</p><figure class="highlight diff"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">  .reward-main</span><br><span class="line">    position: absolute</span><br><span class="line">    bottom: 40px</span><br><span class="line"><span class="deletion">-   left: 0</span></span><br><span class="line"><span class="addition">+   left: -25%</span></span><br><span class="line">    z-index: 100</span><br><span class="line">    display: none</span><br><span class="line">    padding: 0 0 15px</span><br><span class="line"><span class="deletion">-   width: 100%</span></span><br><span class="line"><span class="addition">+   width: 150%</span></span><br></pre></td></tr></table></figure></li></ul><h1 id="适配-Anzhiyu-主题"><a href="#适配-Anzhiyu-主题" class="headerlink" title="适配 Anzhiyu 主题"></a>适配 Anzhiyu 主题</h1><p>Anzhiyu 主题的打赏按钮样式与 Butterfly 主题有些许不同，需要单独适配。</p><h2 id="效果预览-1"><a href="#效果预览-1" class="headerlink" title="效果预览"></a>效果预览</h2><details class="folding-tag" ><summary> 查看图片 </summary>              <div class='content'>              <p><img src="https://cdn.randench.cn/image/24/08/4d763d668d01fc2c.gif" alt="打赏按钮投币彩蛋效果预览"></p>              </div>            </details><h2 id="修改步骤-1"><a href="#修改步骤-1" class="headerlink" title="修改步骤"></a>修改步骤</h2><p>修改<code>[Blogroot]\themes\anzhiyu\layout\includes\post\reward.pug</code>，整体替换为以下内容</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line">link(rel=&#x27;stylesheet&#x27; href=url_for(theme.CDN.coin_css) media=&quot;defer&quot; onload=&quot;this.media=&#x27;all&#x27;&quot;)</span><br><span class="line">script.</span><br><span class="line">  // 点击按钮时取消hover属性</span><br><span class="line">  let clickedElement = null;</span><br><span class="line"></span><br><span class="line">  function toggleClickEffect(event) &#123;</span><br><span class="line">      const element = event.currentTarget;</span><br><span class="line">      </span><br><span class="line">      if (clickedElement === element) &#123;</span><br><span class="line">          // 如果点击的是已经点击的元素，则取消 clicked 状态</span><br><span class="line">          clickedElement.classList.remove(&#x27;clicked&#x27;);</span><br><span class="line">          clickedElement = null;</span><br><span class="line">      &#125; else &#123;</span><br><span class="line">          // 否则，设置 clicked 状态</span><br><span class="line">          if (clickedElement) &#123;</span><br><span class="line">              clickedElement.classList.remove(&#x27;clicked&#x27;);</span><br><span class="line">          &#125;</span><br><span class="line">          element.classList.add(&#x27;clicked&#x27;);</span><br><span class="line">          clickedElement = element;</span><br><span class="line">      &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  // 处理鼠标移开事件</span><br><span class="line">  document.addEventListener(&#x27;mousemove&#x27;, (event) =&gt; &#123;</span><br><span class="line">      if (clickedElement &amp;&amp; !clickedElement.contains(event.target)) &#123;</span><br><span class="line">          clickedElement.classList.remove(&#x27;clicked&#x27;);</span><br><span class="line">          clickedElement = null;</span><br><span class="line">      &#125;</span><br><span class="line">  &#125;);</span><br><span class="line">//- .post-reward(onclick=&#x27;anzhiyu.addRewardMask()&#x27;)</span><br><span class="line">.post-reward(onclick=&#x27;toggleClickEffect(event)&#x27;)</span><br><span class="line">  //- .reward-button.button--animated(title=&#x27;打赏作者&#x27;)</span><br><span class="line">  //-   i.anzhiyufont.anzhiyu-icon-hand-heart-fill</span><br><span class="line">  //-   | 打赏作者</span><br><span class="line">  button.tip-button.reward-button</span><br><span class="line">    span.tip-button__text= &#x27;打赏&#x27;</span><br><span class="line">    .coin-wrapper</span><br><span class="line">      .coin</span><br><span class="line">        .coin__middle</span><br><span class="line">        .coin__back</span><br><span class="line">        .coin__front</span><br><span class="line">  .reward-main</span><br><span class="line">    .reward-all</span><br><span class="line">      span.reward-title 感谢你赐予我前进的力量</span><br><span class="line">      ul.reward-group</span><br><span class="line">        each item in theme.reward.QR_code</span><br><span class="line">          - var clickTo = item.link ? item.link : item.img</span><br><span class="line">          li.reward-item</span><br><span class="line">            a(href=url_for(clickTo) target=&#x27;_blank&#x27;)</span><br><span class="line">              img.post-qr-code-img(src=url_for(item.img) alt=item.text)</span><br><span class="line">            .post-qr-code-desc=item.text</span><br><span class="line">      //- a.reward-main-btn(href=&#x27;/about/#about-reward&#x27; target=&#x27;_blank&#x27;)</span><br><span class="line">      //-   .reward-text 赞赏者名单</span><br><span class="line">      //-   .reward-dec 因为你们的支持让我意识到写文章的价值🙏</span><br><span class="line">#quit-box(onclick=&quot;anzhiyu.removeRewardMask()&quot; style=&quot;display: none&quot;)</span><br><span class="line">if theme.reward.coinAudio</span><br><span class="line">  - var coinAudio = theme.reward.coinAudio ? url_for(theme.reward.coinAudio) : &#x27;https://npm.elemecdn.com/akilar-candyassets@1.0.16/audio/coin.mp3&#x27;</span><br><span class="line">  audio#coinAudio(src=coinAudio)</span><br><span class="line">script(defer src=url_for(theme.CDN.coin_js))</span><br></pre></td></tr></table></figure><p>修改<code>[Blogroot]\themes\anzhiyu\source\css\_layout\reward.styl</code>，整体替换为以下内容</p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.post-reward</span></span><br><span class="line">  <span class="attribute">position</span>: relative;</span><br><span class="line">  <span class="attribute">text-align</span>: center;</span><br><span class="line">  <span class="attribute">margin-top</span>: <span class="number">0rem</span>;</span><br><span class="line">  <span class="attribute">display</span>: flex;</span><br><span class="line">  <span class="attribute">justify-content</span>: center;</span><br><span class="line">  <span class="selector-pseudo">&amp;:hover</span></span><br><span class="line">    <span class="selector-class">.reward-button</span></span><br><span class="line">      <span class="attribute">color</span>: <span class="built_in">var</span>(--anzhiyu-white);</span><br><span class="line">      <span class="attribute">background</span>: <span class="built_in">var</span>(--anzhiyu-theme);</span><br><span class="line">      <span class="attribute">box-shadow</span>: none;</span><br><span class="line">      </span><br><span class="line">    <span class="selector-class">.reward-main</span></span><br><span class="line">      <span class="attribute">display</span>: flex <span class="meta">!important</span>;</span><br><span class="line">      <span class="attribute">justify-content</span>: left;</span><br><span class="line"></span><br><span class="line">  <span class="comment">/* Clicked 状态的样式 */</span></span><br><span class="line">  &amp;<span class="selector-class">.clicked</span></span><br><span class="line">    <span class="selector-class">.reward-main</span></span><br><span class="line">      <span class="attribute">display</span>: none <span class="meta">!important</span></span><br><span class="line"></span><br><span class="line">  <span class="comment">/* Hover 状态不能同时存在于 clicked 状态 */</span></span><br><span class="line">  &amp;<span class="selector-class">.clicked</span><span class="selector-pseudo">:hover</span></span><br><span class="line">    <span class="selector-class">.reward-main</span></span><br><span class="line">      <span class="attribute">display</span>: none <span class="meta">!important</span></span><br><span class="line"></span><br><span class="line">  &amp; &gt; *</span><br><span class="line">    <span class="attribute">pointer-events</span>: auto</span><br><span class="line"></span><br><span class="line">  <span class="selector-class">.reward-button</span> </span><br><span class="line">    <span class="attribute">border-radius</span>: <span class="number">8px</span></span><br><span class="line">    <span class="attribute">background</span>: <span class="built_in">var</span>(--anzhiyu-red);</span><br><span class="line">    <span class="attribute">color</span>: <span class="built_in">var</span>(--anzhiyu-white);</span><br><span class="line">    <span class="attribute">padding</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">margin-right</span>: <span class="number">0.5rem</span>;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">126px</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">40px</span>;</span><br><span class="line">    <span class="attribute">line-height</span>: <span class="number">39px</span>;</span><br><span class="line">    <span class="attribute">box-shadow</span>: <span class="built_in">var</span>(--anzhiyu-shadow-red);</span><br><span class="line">    <span class="attribute">display</span>: inline-block;</span><br><span class="line">    <span class="attribute">cursor</span>: pointer;</span><br><span class="line">    <span class="attribute">transition</span>: all <span class="number">0.4s</span> ease <span class="number">0s</span>;</span><br><span class="line"></span><br><span class="line">  <span class="selector-class">.reward-main</span></span><br><span class="line">    <span class="attribute">position</span>: absolute;</span><br><span class="line">    <span class="attribute">bottom</span>: <span class="number">40px</span>;</span><br><span class="line">    <span class="keyword">if</span> <span class="built_in">hexo-config</span>(<span class="string">&#x27;ptool.enable&#x27;</span>) == true &amp;&amp; <span class="built_in">hexo-config</span>(<span class="string">&#x27;ptool.mode&#x27;</span>)</span><br><span class="line">      <span class="attribute">left</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">      <span class="attribute">left</span>: -<span class="number">70%</span>;</span><br><span class="line">    <span class="attribute">z-index</span>: <span class="number">90</span>;</span><br><span class="line">    <span class="attribute">display</span>: none;</span><br><span class="line">    <span class="attribute">padding</span>: <span class="number">0px</span> <span class="number">0px</span> <span class="number">15px</span>;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">    <span class="selector-class">.reward-all</span></span><br><span class="line">      <span class="attribute">border-radius</span>: <span class="number">12px</span>;</span><br><span class="line">      <span class="attribute">background</span>: <span class="built_in">var</span>(--anzhiyu-background);</span><br><span class="line">      <span class="attribute">border</span>: <span class="built_in">var</span>(--style-border-always);</span><br><span class="line">      <span class="attribute">padding</span>: <span class="number">0.8rem</span>;</span><br><span class="line">      <span class="attribute">display</span>: flex;</span><br><span class="line">      <span class="attribute">margin</span>: <span class="number">0px</span>;</span><br><span class="line">      <span class="attribute">box-shadow</span>: <span class="built_in">var</span>(--anzhiyu-shadow-border);</span><br><span class="line">      <span class="attribute">flex-direction</span>: column;</span><br><span class="line">      <span class="attribute">align-items</span>: center;</span><br><span class="line">      <span class="selector-pseudo">&amp;::before</span> </span><br><span class="line">        <span class="attribute">position</span>: absolute;</span><br><span class="line">        <span class="attribute">bottom</span>: -<span class="number">10px</span>;</span><br><span class="line">        <span class="attribute">left</span>: <span class="number">0px</span>;</span><br><span class="line">        <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">        <span class="attribute">height</span>: <span class="number">20px</span>;</span><br><span class="line">        <span class="attribute">content</span>: <span class="string">&quot;&quot;</span>;</span><br><span class="line"></span><br><span class="line">      <span class="selector-class">.reward-title</span></span><br><span class="line">        <span class="attribute">font-weight</span>: bold;</span><br><span class="line">        <span class="attribute">color</span>: <span class="built_in">var</span>(--anzhiyu-red);</span><br><span class="line">      <span class="selector-class">.reward-group</span></span><br><span class="line">        <span class="attribute">display</span>: flex;</span><br><span class="line">        <span class="attribute">margin-top</span>: <span class="number">0.5rem</span>;</span><br><span class="line">        <span class="attribute">padding</span>: <span class="number">0</span>;</span><br><span class="line">        <span class="selector-class">.reward-item</span></span><br><span class="line">          <span class="attribute">display</span>: inline-block;</span><br><span class="line">          <span class="attribute">padding</span>: <span class="number">0px</span> <span class="number">8px</span>;</span><br><span class="line">          <span class="attribute">list-style-type</span>: none;</span><br><span class="line">          <span class="attribute">vertical-align</span>: top;</span><br><span class="line">          <span class="selector-class">.post-qr-code-img</span></span><br><span class="line">            <span class="attribute">box-shadow</span>: <span class="built_in">var</span>(--anzhiyu-shadow-lightblack);</span><br><span class="line">            <span class="attribute">border-radius</span>: <span class="number">12px</span>;</span><br><span class="line">            <span class="attribute">border</span>: <span class="built_in">var</span>(--style-border-always);</span><br><span class="line">          <span class="selector-class">.post-qr-code-desc</span></span><br><span class="line">              <span class="attribute">padding-top</span>: <span class="number">0rem</span>;</span><br><span class="line">              <span class="attribute">margin-top</span>: -<span class="number">8px</span>;</span><br><span class="line">              <span class="attribute">margin-bottom</span>: <span class="number">8px</span>;</span><br><span class="line">          <span class="selector-tag">img</span> </span><br><span class="line">            <span class="attribute">width</span>: <span class="number">130px</span>;</span><br><span class="line">            <span class="attribute">height</span>: <span class="number">130px</span>;</span><br><span class="line">            <span class="attribute">max-width</span>: fit-content</span><br><span class="line">          <span class="selector-pseudo">&amp;:first-child</span> <span class="selector-tag">img</span></span><br><span class="line">            <span class="attribute">border-color</span>: <span class="built_in">var</span>(--anzhiyu-green);</span><br><span class="line">          <span class="selector-pseudo">&amp;:last-child</span> <span class="selector-tag">img</span></span><br><span class="line">            <span class="attribute">border-color</span>: <span class="built_in">var</span>(--anzhiyu-blue);</span><br><span class="line"></span><br><span class="line">      <span class="selector-class">.reward-main-btn</span></span><br><span class="line">        <span class="attribute">background</span>: <span class="built_in">var</span>(--anzhiyu-secondbg);</span><br><span class="line">        <span class="attribute">color</span>: <span class="built_in">var</span>(--anzhiyu-fontcolor);</span><br><span class="line">        <span class="attribute">display</span>: flex;</span><br><span class="line">        <span class="attribute">flex-direction</span>: column;</span><br><span class="line">        <span class="attribute">border-radius</span>: <span class="number">12px</span>;</span><br><span class="line">        <span class="attribute">padding</span>: <span class="number">4px</span> <span class="number">0</span>;</span><br><span class="line">        <span class="attribute">border</span>: <span class="built_in">var</span>(--style-border-always);</span><br><span class="line">        <span class="attribute">margin</span>: <span class="number">8px</span>;</span><br><span class="line">        <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">        <span class="selector-pseudo">&amp;:hover</span> </span><br><span class="line">          <span class="attribute">color</span>: <span class="built_in">var</span>(--anzhiyu-white);</span><br><span class="line">          <span class="attribute">background</span>: <span class="built_in">var</span>(--anzhiyu-red);</span><br><span class="line">          <span class="attribute">box-shadow</span>: <span class="built_in">var</span>(--anzhiyu-shadow-red);</span><br><span class="line">        <span class="selector-class">.reward-text</span></span><br><span class="line">          <span class="attribute">margin-bottom</span>: <span class="number">0rem</span>;</span><br><span class="line">          <span class="attribute">font-weight</span>: bold;</span><br><span class="line">        <span class="selector-class">.reward-dec</span></span><br><span class="line">          <span class="attribute">font-size</span>: <span class="number">12px</span>;</span><br><span class="line"><span class="selector-class">.reward-link</span><span class="selector-class">.mode</span></span><br><span class="line">  <span class="attribute">background</span>: <span class="built_in">var</span>(--anzhiyu-green);</span><br><span class="line">  <span class="attribute">color</span>: <span class="built_in">var</span>(--anzhiyu-white);</span><br><span class="line">  <span class="attribute">padding</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">173px</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">40px</span>;</span><br><span class="line">  <span class="attribute">line-height</span>: <span class="number">39px</span>;</span><br><span class="line">  <span class="attribute">box-shadow</span>: <span class="built_in">var</span>(--anzhiyu-shadow-green);</span><br><span class="line">  <span class="attribute">border-radius</span>: <span class="number">8px</span>;</span><br><span class="line">  <span class="attribute">text-align</span>: center;</span><br><span class="line">  <span class="attribute">transition</span>: <span class="number">0.3s</span>;</span><br><span class="line">  <span class="selector-pseudo">&amp;:hover</span></span><br><span class="line">    <span class="attribute">background</span>: <span class="built_in">var</span>(--anzhiyu-theme);</span><br><span class="line">    <span class="attribute">box-shadow</span>: none;</span><br><span class="line">  <span class="selector-tag">a</span></span><br><span class="line">    <span class="attribute">color</span>: <span class="built_in">var</span>(--anzhiyu-white);</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">100%</span>;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">    <span class="attribute">display</span>: flex;</span><br><span class="line">    <span class="attribute">align-items</span>: center;</span><br><span class="line">    <span class="attribute">justify-content</span>: center;</span><br><span class="line">  <span class="selector-tag">i</span></span><br><span class="line">    <span class="attribute">margin-right</span>: <span class="number">4px</span>;</span><br><span class="line"></span><br><span class="line"><span class="selector-id">#quit-box</span></span><br><span class="line">  <span class="attribute">position</span>: fixed;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">100vw</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">100vh</span>;</span><br><span class="line">  <span class="attribute">background</span>: <span class="built_in">rgba</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, .<span class="number">2</span>);</span><br><span class="line">  <span class="attribute">top</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">left</span>: <span class="number">0</span>;</span><br><span class="line">  <span class="attribute">display</span>: none;</span><br><span class="line">  <span class="attribute">z-index</span>: <span class="number">101</span>;</span><br><span class="line">  <span class="attribute">margin</span>: <span class="number">0</span>;</span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Hexo </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 美化 </tag>
            
            <tag> 魔改 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>给博客添加个性名片</title>
      <link href="//posts/33673/"/>
      <url>//posts/33673/</url>
      
        <content type="html"><![CDATA[<div class="note warning flat"><p>本文修改主题为<code>Butterfly</code>主题，若使用其他主题，请自行确认修改位置。</p></div><h1 id="原文出处"><a href="#原文出处" class="headerlink" title="原文出处"></a>原文出处</h1><blockquote><p><a href="https://akilar.top/posts/5ff2da64/">https://akilar.top/posts/5ff2da64/</a><br><a href="https://codepen.io/FilipVitas/pen/ddLVZx">codepen-credit card pure css</a></p></blockquote><h1 id="效果预览"><a href="#效果预览" class="headerlink" title="效果预览"></a>效果预览</h1><details class="folding-tag" ><summary> 查看图片 </summary>              <div class='content'>              <p><img src="https://cdn.randench.cn/image/24/08/34cdea8a23b1fa3d.gif" alt="个性名片"></p>              </div>            </details><h1 id="修改步骤"><a href="#修改步骤" class="headerlink" title="修改步骤"></a>修改步骤</h1><h2 id="1-新建样式文件"><a href="#1-新建样式文件" class="headerlink" title="1. 新建样式文件"></a>1. 新建样式文件</h2><p>新建<code>[Blogroot]\themes\butterfly\layout\includes\custom\businesscard.pug</code></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line">.business-center</span><br><span class="line">  .business-card</span><br><span class="line">    .business-flip</span><br><span class="line">      .business-front</span><br><span class="line">        .business-strip-bottom</span><br><span class="line">        .business-strip-top</span><br><span class="line">        img.business-logo(width=&quot;80&quot; height=&quot;80&quot; src=url_for(theme.businesscard.QR_code)    alt=&quot;cardcode&quot;)</span><br><span class="line"></span><br><span class="line">        .business-Invitation Invitation</span><br><span class="line">        .business-chip</span><br><span class="line">          .business-chip-line</span><br><span class="line">          .business-chip-line</span><br><span class="line">          .business-chip-line</span><br><span class="line">          .business-chip-line</span><br><span class="line">          .business-chip-main</span><br><span class="line"></span><br><span class="line">        svg.business-wave(viewBox=&quot;0 3.71 26.959 38.787&quot; width=&quot;26.959&quot; height=&quot;38.787&quot;     fill=&quot;white&quot;)</span><br><span class="line">          path(d=&quot;M19.709 3.719c.266.043.5.187.656.406 4.125 5.207 6.594 11.781 6.594 18.938 0 7.   156-2.469 13.73-6.594 18.937-.195.336-.57.531-.957.492a.9946.9946 0 0 1-.851-.66c-.   129-.367-.035-.777.246-1.051 3.855-4.867 6.156-11.023 6.156-17.718 0-6.696-2.301-12.   852-6.156-17.719-.262-.317-.301-.762-.102-1.121.204-.36.602-.559 1.008-.504z&quot;)</span><br><span class="line">          path(d=&quot;M13.74 7.563c.231.039.442.164.594.343 3.508 4.059 5.625 9.371 5.625 15.157 0 5.   785-2.113 11.097-5.625 15.156-.363.422-1 .472-1.422.109-.422-.363-.472-1-.109-1.422 3.  211-3.711 5.156-8.551 5.156-13.843 0-5.293-1.949-10.133-5.156-13.844-.27-.309-.324-.   75-.141-1.114.188-.367.578-.582.985-.542h.093z&quot;)</span><br><span class="line">          path(d=&quot;M7.584 11.438c.227.031.438.144.594.312 2.953 2.863 4.781 6.875 4.781 11.313 0     4.433-1.828 8.449-4.781 11.312-.398.387-1.035.383-1.422-.016-.387-.398-.383-1.035.    016-1.421 2.582-2.504 4.187-5.993 4.187-9.875 0-3.883-1.605-7.372-4.187-9.875-.321-.    282-.426-.739-.266-1.133.164-.395.559-.641.984-.617h.094zM1.178 15.531c.121.02.238.063.   344.125 2.633 1.414 4.437 4.215 4.437 7.407 0 3.195-1.797 5.996-4.437 7.406-.492.258-1.   102.07-1.36-.422-.257-.492-.07-1.102.422-1.359 2.012-1.075 3.375-3.176 3.375-5.625 0-2.  446-1.371-4.551-3.375-5.625-.441-.204-.676-.692-.551-1.165.122-.468.567-.785 1.051-.   742h.094z&quot;)</span><br><span class="line"></span><br><span class="line">        .business-card-number</span><br><span class="line">          .business-section=theme.businesscard.master</span><br><span class="line"></span><br><span class="line">          .business-section=theme.businesscard.group</span><br><span class="line"></span><br><span class="line">        .business-end</span><br><span class="line">          span.business-end-text created:</span><br><span class="line">          span.business-end-date=theme.businesscard.created</span><br><span class="line"></span><br><span class="line">        .business-card-holder!=`$&#123;theme.businesscard.front&#125;`</span><br><span class="line">        .business-master</span><br><span class="line">          .business-circle.business-master-red</span><br><span class="line">          .business-circle.business-master-yellow    </span><br><span class="line">      .business-back</span><br><span class="line">        .business-strip-black</span><br><span class="line">        .business-ccv</span><br><span class="line">          label!=`$&#123;theme.businesscard.back1&#125;`</span><br><span class="line">          div!=`$&#123;theme.businesscard.back2&#125;`</span><br><span class="line">        .business-terms</span><br><span class="line">          p!=`$&#123;theme.businesscard.back3&#125;`</span><br><span class="line">          p!=`$&#123;theme.businesscard.back4&#125;`</span><br></pre></td></tr></table></figure><h2 id="2-新建卡片样式"><a href="#2-新建卡片样式" class="headerlink" title="2. 新建卡片样式"></a>2. 新建卡片样式</h2><p>新建<code>[Blogroot]\themes\butterfly\source\css\_layout\businesscard.styl</code></p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//媒体选择，屏幕过窄则隐藏，需要则取消注释</span></span><br><span class="line"><span class="comment">// @media screen and (max-width: 450px)</span></span><br><span class="line"><span class="comment">//  .business-center</span></span><br><span class="line"><span class="comment">//  display: none!important</span></span><br><span class="line"><span class="selector-class">.business-center</span></span><br><span class="line">  <span class="attribute">position</span>: relative</span><br><span class="line">  <span class="attribute">margin</span>: <span class="number">20px</span> auto</span><br><span class="line">  <span class="attribute">display</span>: block</span><br><span class="line">  <span class="attribute">left</span>: <span class="built_in">calc</span>(<span class="number">50%</span> - <span class="number">200px</span>)</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.business-card</span></span><br><span class="line">  <span class="attribute">width</span>: <span class="number">400px</span></span><br><span class="line">  <span class="attribute">height</span>: <span class="number">250px</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">@keyframes</span> business-flip</span><br><span class="line">  <span class="number">0%</span></span><br><span class="line">  <span class="number">100%</span></span><br><span class="line">    <span class="attribute">transform</span>: <span class="built_in">rotateY</span>(<span class="number">0deg</span>)</span><br><span class="line">  <span class="number">50%</span></span><br><span class="line">    <span class="attribute">transform</span>: <span class="built_in">rotateY</span>(<span class="number">180deg</span>)</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.business-flip</span></span><br><span class="line">  <span class="attribute">width</span>: inherit</span><br><span class="line">  <span class="attribute">height</span>: inherit</span><br><span class="line">  <span class="attribute">transition</span>: <span class="number">0.7s</span></span><br><span class="line">  <span class="attribute">transform-style</span>: preserve-<span class="number">3</span>d</span><br><span class="line">  <span class="attribute">animation</span>: business-flip <span class="number">2.5s</span> ease</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.business-front</span></span><br><span class="line"><span class="selector-class">.business-back</span></span><br><span class="line">  <span class="attribute">position</span>: absolute</span><br><span class="line">  <span class="attribute">width</span>: inherit</span><br><span class="line">  <span class="attribute">height</span>: inherit</span><br><span class="line">  <span class="attribute">border-radius</span>: <span class="number">15px</span></span><br><span class="line">  <span class="attribute">color</span>: <span class="number">#fff</span></span><br><span class="line">  <span class="attribute">text-shadow</span>: <span class="number">0</span> <span class="number">1px</span> <span class="number">1px</span> <span class="built_in">rgba</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">0.3</span>)</span><br><span class="line">  <span class="attribute">box-shadow</span>: <span class="number">0</span> <span class="number">1px</span> <span class="number">10px</span> <span class="number">1px</span> <span class="built_in">rgba</span>(<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0.3</span>)</span><br><span class="line">  <span class="attribute">backface-visibility</span>: hidden</span><br><span class="line">  <span class="attribute">background-image</span>: <span class="built_in">linear-gradient</span>(to right, <span class="number">#111</span>, <span class="number">#555</span>)</span><br><span class="line">  <span class="attribute">overflow</span>: hidden</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.business-front</span></span><br><span class="line">  <span class="attribute">transform</span>: <span class="built_in">translateZ</span>(<span class="number">0</span>)</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.business-strip-bottom</span></span><br><span class="line"><span class="selector-class">.business-strip-top</span></span><br><span class="line">  <span class="attribute">position</span>: absolute</span><br><span class="line">  <span class="attribute">right</span>: <span class="number">0</span></span><br><span class="line">  <span class="attribute">height</span>: inherit</span><br><span class="line">  <span class="attribute">background-image</span>: <span class="built_in">linear-gradient</span>(to bottom, <span class="number">#ff6767</span>, <span class="number">#ff4545</span>)</span><br><span class="line">  <span class="attribute">box-shadow</span>: <span class="number">0</span> <span class="number">0</span> <span class="number">10px</span> <span class="number">0px</span> <span class="built_in">rgba</span>(<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0.5</span>)</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.business-strip-bottom</span></span><br><span class="line">  <span class="attribute">width</span>: <span class="number">200px</span></span><br><span class="line">  <span class="attribute">transform</span>: <span class="built_in">skewX</span>(-<span class="number">15deg</span>) <span class="built_in">translateX</span>(<span class="number">50px</span>)</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.business-strip-top</span></span><br><span class="line">  <span class="attribute">width</span>: <span class="number">180px</span></span><br><span class="line">  <span class="attribute">transform</span>: <span class="built_in">skewX</span>(<span class="number">20deg</span>) <span class="built_in">translateX</span>(<span class="number">50px</span>)</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.business-logo</span></span><br><span class="line">  <span class="attribute">position</span>: absolute</span><br><span class="line">  <span class="attribute">top</span>: <span class="number">30px</span></span><br><span class="line">  <span class="attribute">right</span>: <span class="number">25px</span></span><br><span class="line"></span><br><span class="line"><span class="selector-class">.business-Invitation</span></span><br><span class="line">  <span class="attribute">position</span>: relative</span><br><span class="line">  <span class="attribute">top</span>: <span class="number">20px</span></span><br><span class="line">  <span class="attribute">left</span>: <span class="number">25px</span></span><br><span class="line">  <span class="attribute">text-transform</span>: uppercase</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.business-chip</span></span><br><span class="line">  <span class="attribute">position</span>: relative</span><br><span class="line">  <span class="attribute">top</span>: <span class="number">30px</span></span><br><span class="line">  <span class="attribute">left</span>: <span class="number">25px</span></span><br><span class="line">  <span class="attribute">display</span>: flex</span><br><span class="line">  <span class="attribute">align-items</span>: center</span><br><span class="line">  <span class="attribute">justify-content</span>: center</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">50px</span></span><br><span class="line">  <span class="attribute">height</span>: <span class="number">40px</span></span><br><span class="line">  <span class="attribute">border-radius</span>: <span class="number">5px</span></span><br><span class="line">  <span class="attribute">background-image</span>: <span class="built_in">linear-gradient</span>(to bottom left, <span class="number">#ffecc7</span>, <span class="number">#d0b978</span>)</span><br><span class="line">  <span class="attribute">overflow</span>: hidden</span><br><span class="line"></span><br><span class="line">  <span class="selector-class">.business-chip-line</span></span><br><span class="line">    <span class="attribute">position</span>: absolute</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">100%</span></span><br><span class="line">    <span class="attribute">height</span>: <span class="number">1px</span></span><br><span class="line">    <span class="attribute">background-color</span>: <span class="number">#333</span></span><br><span class="line"></span><br><span class="line">    <span class="selector-pseudo">&amp;:nth-child</span>(<span class="number">1</span>)</span><br><span class="line">      <span class="attribute">top</span>: <span class="number">13px</span></span><br><span class="line"></span><br><span class="line">    <span class="selector-pseudo">&amp;:nth-child</span>(<span class="number">2</span>)</span><br><span class="line">      <span class="attribute">top</span>: <span class="number">20px</span></span><br><span class="line"></span><br><span class="line">    <span class="selector-pseudo">&amp;:nth-child</span>(<span class="number">3</span>)</span><br><span class="line">      <span class="attribute">top</span>: <span class="number">28px</span></span><br><span class="line"></span><br><span class="line">    <span class="selector-pseudo">&amp;:nth-child</span>(<span class="number">4</span>)</span><br><span class="line">      <span class="attribute">left</span>: <span class="number">25px</span></span><br><span class="line">      <span class="attribute">width</span>: <span class="number">1px</span></span><br><span class="line">      <span class="attribute">height</span>: <span class="number">50px</span></span><br><span class="line"></span><br><span class="line">  <span class="selector-class">.business-chip-main</span></span><br><span class="line">    <span class="attribute">width</span>: <span class="number">20px</span></span><br><span class="line">    <span class="attribute">height</span>: <span class="number">25px</span></span><br><span class="line">    <span class="attribute">border</span>: <span class="number">1px</span> solid <span class="number">#333</span></span><br><span class="line">    <span class="attribute">border-radius</span>: <span class="number">3px</span></span><br><span class="line">    <span class="attribute">background-image</span>: <span class="built_in">linear-gradient</span>(to bottom left, <span class="number">#efdbab</span>, <span class="number">#e1cb94</span>)</span><br><span class="line">    <span class="attribute">z-index</span>: <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="selector-class">.business-wave</span></span><br><span class="line">  <span class="attribute">position</span>: relative</span><br><span class="line">  <span class="attribute">top</span>: -<span class="number">10px</span></span><br><span class="line">  <span class="attribute">left</span>: <span class="number">100px</span></span><br><span class="line"></span><br><span class="line"><span class="selector-class">.business-card-number</span></span><br><span class="line">  <span class="attribute">position</span>: relative</span><br><span class="line">  <span class="attribute">display</span>: flex</span><br><span class="line">  <span class="attribute">justify-content</span>: space-between</span><br><span class="line">  <span class="attribute">align-items</span>: center</span><br><span class="line">  <span class="attribute">margin</span>: <span class="number">0px</span> <span class="number">25px</span> <span class="number">0px</span></span><br><span class="line">  <span class="attribute">font-size</span>: <span class="number">23px</span></span><br><span class="line">  <span class="attribute">font-family</span>: <span class="string">&#x27;cc font&#x27;</span>, monospace</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.business-end</span></span><br><span class="line">  <span class="attribute">margin-left</span>: <span class="number">25px</span></span><br><span class="line">  <span class="attribute">text-transform</span>: uppercase</span><br><span class="line">  <span class="attribute">font-family</span>: <span class="string">&#x27;cc font&#x27;</span>, monospace</span><br><span class="line"></span><br><span class="line">  <span class="selector-class">.business-end-text</span></span><br><span class="line">    <span class="attribute">font-size</span>: <span class="number">9px</span></span><br><span class="line">    <span class="attribute">color</span>: <span class="built_in">rgba</span>(<span class="number">255</span>, <span class="number">255</span>, <span class="number">255</span>, <span class="number">0.8</span>)</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.business-card-holder</span></span><br><span class="line">  <span class="attribute">margin</span>: <span class="number">5px</span> <span class="number">25px</span></span><br><span class="line">  <span class="attribute">font-size</span>: <span class="number">14px</span></span><br><span class="line">  <span class="attribute">text-transform</span>: uppercase</span><br><span class="line">  <span class="attribute">font-family</span>: <span class="string">&#x27;cc font&#x27;</span>, monospace</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.business-master</span></span><br><span class="line">  <span class="attribute">position</span>: absolute</span><br><span class="line">  <span class="attribute">right</span>: <span class="number">20px</span></span><br><span class="line">  <span class="attribute">bottom</span>: <span class="number">20px</span></span><br><span class="line">  <span class="attribute">display</span>: flex</span><br><span class="line"></span><br><span class="line">  <span class="selector-class">.business-circle</span></span><br><span class="line">    <span class="attribute">width</span>: <span class="number">25px</span></span><br><span class="line">    <span class="attribute">height</span>: <span class="number">25px</span></span><br><span class="line">    <span class="attribute">border-radius</span>: <span class="number">50%</span></span><br><span class="line"></span><br><span class="line">  <span class="selector-class">.business-master-red</span></span><br><span class="line">    <span class="attribute">background-color</span>: <span class="number">#eb001b</span></span><br><span class="line">  <span class="selector-class">.business-master-yellow</span></span><br><span class="line">    <span class="attribute">margin-left</span>: -<span class="number">10px</span></span><br><span class="line">    <span class="attribute">background-color</span>: <span class="built_in">rgba</span>(<span class="number">255</span>, <span class="number">209</span>, <span class="number">0</span>, <span class="number">0.7</span>)</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.business-card</span></span><br><span class="line">  <span class="attribute">perspective</span>: <span class="number">1000</span></span><br><span class="line"></span><br><span class="line">  <span class="selector-pseudo">&amp;:hover</span> <span class="selector-class">.business-flip</span></span><br><span class="line">    <span class="attribute">transform</span>: <span class="built_in">rotateY</span>(<span class="number">180deg</span>)</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.business-back</span></span><br><span class="line">  <span class="attribute">transform</span>: <span class="built_in">rotateY</span>(<span class="number">180deg</span>) <span class="built_in">translateZ</span>(<span class="number">0</span>)</span><br><span class="line">  <span class="attribute">background</span>: <span class="number">#9e9e9e</span></span><br><span class="line"></span><br><span class="line"><span class="selector-class">.business-back</span></span><br><span class="line">  <span class="selector-class">.business-strip-black</span></span><br><span class="line">    <span class="attribute">position</span>: absolute</span><br><span class="line">    <span class="attribute">top</span>: <span class="number">30px</span></span><br><span class="line">    <span class="attribute">left</span>: <span class="number">0</span></span><br><span class="line">    <span class="attribute">width</span>: <span class="number">100%</span></span><br><span class="line">    <span class="attribute">height</span>: <span class="number">50px</span></span><br><span class="line">    <span class="attribute">background</span>: black</span><br><span class="line"></span><br><span class="line">  <span class="selector-class">.business-ccv</span></span><br><span class="line">    <span class="attribute">position</span>: absolute</span><br><span class="line">    <span class="attribute">top</span>: <span class="number">110px</span></span><br><span class="line">    <span class="attribute">left</span>: <span class="number">0</span></span><br><span class="line">    <span class="attribute">right</span>: <span class="number">0</span></span><br><span class="line">    <span class="attribute">height</span>: <span class="number">36px</span></span><br><span class="line">    <span class="attribute">width</span>: <span class="number">90%</span></span><br><span class="line">    <span class="attribute">padding</span>: <span class="number">10px</span></span><br><span class="line">    <span class="attribute">margin</span>: <span class="number">0</span> auto</span><br><span class="line">    <span class="attribute">border-radius</span>: <span class="number">5px</span></span><br><span class="line">    <span class="attribute">text-align</span>: right</span><br><span class="line">    <span class="attribute">letter-spacing</span>: <span class="number">1px</span></span><br><span class="line">    <span class="attribute">color</span>: <span class="number">#000</span></span><br><span class="line">    <span class="attribute">background</span>: white</span><br><span class="line"></span><br><span class="line">    <span class="selector-tag">label</span></span><br><span class="line">      <span class="attribute">display</span>: block</span><br><span class="line">      <span class="attribute">margin</span>: -<span class="number">30px</span> <span class="number">0</span> <span class="number">5px</span></span><br><span class="line">      <span class="attribute">font-size</span>: <span class="number">10px</span></span><br><span class="line">      <span class="attribute">text-transform</span>: uppercase</span><br><span class="line">      <span class="attribute">color</span>: white</span><br><span class="line">    <span class="selector-tag">div</span></span><br><span class="line">      <span class="attribute">position</span>: relative</span><br><span class="line">      <span class="attribute">top</span>: -<span class="number">5px</span></span><br><span class="line">  <span class="selector-class">.business-terms</span></span><br><span class="line">    <span class="attribute">position</span>: absolute</span><br><span class="line">    <span class="attribute">top</span>: <span class="number">130px</span></span><br><span class="line">    <span class="attribute">padding</span>: <span class="number">20px</span></span><br><span class="line">    <span class="attribute">font-size</span>: <span class="number">10px</span></span><br><span class="line">    <span class="attribute">text-align</span>: justify</span><br><span class="line"></span><br><span class="line"><span class="keyword">@font-face</span></span><br><span class="line">  <span class="attribute">font-family</span>: <span class="string">&#x27;cc font&#x27;</span></span><br><span class="line">  <span class="attribute">src</span>: <span class="built_in">url</span>(<span class="string">&quot;data:application/font-woff2;charset=utf-8;base64,d09GMgABAAAAAFg8ABMAAAAA2AAAAFfQAAIBSAAAAAAAAAAAAAAAAAAAAAAAAAAAP0ZGVE0cGjgbMByCZgZgAINqCCoJhGURCAqDhByCyxIBNgIkA4cSC4NMAAQgBYgqB4UzDIIPP3dlYmYGG1q4NcyzzsDdqsqQmqDWKIKNAwiIf9/IQOA8QFVwcz37/78mSDmkpvylGL9JAIdNYEPUmENGMsPhhWMhFpR4wmEhY+oOMgcpdGM5s6BwxrOspfxlqHHsxTuLqMwxJ99BXXF677xIVv95mVa/JnHxkRSZ+ww3nrjppmVHue1L6L2+9lq/815brL5SapRmh+V/teJtOzV50WjXf55O+3NnJiqm1KsUlc4CDLSNmk6WYNovKv2AMkRtC1P8UxTkdV0BcR1XJERE/BAQBRXfFxXR8Pt6PsvMSss+87o8rczrurIun7NfzazMvOvsfRTNrHtS+0+C7/f77blP5jdo4p1Gt0wSj54suU+36XQaWZpVsUSJDBD/2TJ/H2llkD2tFdARrbU+zx61ATkIQqr608YocJDjy+l/9/vtfXNEV+644HtQxR7uG2qni2U4a+mCR62qKTKV09xtefcbgjsWxDlCO8fk7GR87DKrlF/hfVOjjE0smVjGIMnS6vUt+L7LbDSaspZke+clEIeXdqV0tPG1TyV6rdBDoAF4DGTQzf9/eggaCBLwINqWUmpUnGsmwzK9cbh//vY0tVdPWnWXt/bXFfc2vllf2Z/SKgzAQeGB6FCoCRJBgXp+Td8dJ/wLQFtWgAqFU1t2psKMkMHKBppTFcoCKPDOq4PN+Y8tjjoJdQ3ocFA0kKA1IGzn7PbtdThc/vH8h+q0oN7uyY9/r//gffAgKCJU3s/Mt/kS7WYVFLpAvyPhv7l9PsdxzZxNQ3CIGG22sfJKNBicf9usdgbILjllRatTL6pVbdprlfkTOMYidgGSjbHisE6St8fMH4Zk0IgyyYlJNcQUzl1ef96mTFdeU/n/qVq2/wPk7YAXo53l0HQbHEPVuBT+EOTODEAuMKBoAJRkkJJlhr1nEhtMSfuOCrem1nLIsQqR1O6dJcdUpc5Fk2IVctm4NJQu0wOt+l0bcwWhKseYWg8yNy4SUQm9Ep5cfbumpnvYT+0Pk7QmnbdSm20iIAjImCoZ9z7f/XD2Pdak3e/SbQQaI4jOMOHOLxcAAuD5juBLAPDQ79efAcCrp4u/KyMTAVoAwJEhCkQ5P38claXIMitwVgohgkYMml2ECmpc6ywfxFmj5EFq3tERDhPGQXf2WlL/zOUJ4SUqs9CRQDZudElgM36jGUXrHVcs+C0e6GPrvUoBuUMRUwpN82SiJMpUoELJlHQZvWA8KuYqNHS7JSJwXJbgddRtItKIFyWVGrcjJV68BBw50XLJnGQZp1Jy41bEZ31egkTJ5hCnYDudFo9GIyyhqBJuAY6K7XEvXkhNF6JKrgLlcl6xGuZWL/J6MLtI48cmTkK76L9UNvzfAPLzFEesUeiV87XA8LBkMkk3h/BhqEyCpwFq7Oz6FUVbaUCfRZpEi7kn05NWZJ/I0lk2y2NFTMMa2Tz2TW5O4b//pOrRVDTmtG7nYqLuzgGrZqkss38DEjeq2OJ8+LPwYLg/fHmxYFHx/dv3qRdDLy6/uPDi/Iu+Fz0vTr5of7Hhhfvzy4902FcjoWaZYlkde6RkeVVnZ/7viaAoq7ppO91efzAcjYe6Od/a3tnd2z84PDp77vyFi5cuX7l6Tf16Q7gRmy0oyQgr7c5tl6haTzdM6wXH9fqD4Wg8mc7mi+Vqvdnu9oe7+4fHp+eX46vXb6j9mtq6RoUv3H5fIBQMT0QmJTkWjSdSmXQ2nyuXlAp4XG7//2+ynwUT/4m0ABsuUAb2RQCAaxUXbleaPQDgXnvPtGrtu4cefvW1t95+/Y07XbrDxz8ffhbCotd3sOZ09dZN23fs3LZ3H3ZdHT2MwYc+AIvx0E943PNe8E4Qaa0wPuqxHfSp6+ulAPRFn0sCtigZICaJpXRSV5+ijnVNDOsyyVeianT3ku1peCVJKc20yZLwTY0Sm1yyc0A1oxYm45armUBOnxISuUjb5JFoIQSKbfXH7zSH6VD983eaoyBviaKWdX1SK4zUAq+MTowNG588zLEOOraFg4kJTqyNXL88zD3s79QfkMlJUFFmU1DCHgXitjhPQO68dgTy5HcQ65tuFs0sVCuXcyE0N3uqAUCNDnGWneAJQSw3LOFZFEOEC1BG/pIJBdCKLbNroGBhDh3AkNFOsUWDYKDVtMyiAYO0SGw5gZxnrG/gwETO4g4GT8U6sa95zxSCw7uRAYawtB2IDfNFiSZL4xLhnXJIBNU5yAVZWhlhrNvRIJj2JGcbxzyDtcmmhA7QDpnEPKjEkgFp1gb8FpnpBVgYUyRwTu7LLGTHAho/QZ+q5pe1HabKY+aQ1dBgTS8SzIy/oGHisAIhBhTOATFs4AvEwpTehjOgjhiwLnPDkQUWWJNgnrIWscnsxpgkgzXGfPAn+xjE502qfJ6vIQDoEWgLqKgBak7wYy2qBdoWfDWDQ0NKzTzKPhfjYjOPA4aWAMR4HZa2XhOCWJjLF6MRh6lnNGeQU5izI8btcjhC8XO9MPMEycELFnPIFyNlYeoC4ziSeIzEedQ4jmoeMx4kEsQd7rx1fl0jRzeApHlP6ZaopEuISl0fYgsRQwVh3sQTB9QEgJ5GiBURIkQa6ZYGAEPYRqbvbuO4LO48IiDERsNBgq7283hbE4MA0Po1j7d6E5ym4UE/XipvK3WqNtVDtSZtPCXzK546PNf7qgVtpUnVrKMb8MgChM71DAWBha5ZqxJAMT5GRKpJELh6XPZYJHrcSK5Bb8+hLZdGdiEANej6Btue4yMUG3ZOjNAgLCxHCLKkHee1dXuDVlUrw+hUyEe5EP14wvpKxyurG+IIB+molXRwX9VbPawfdHywwFKscVVhq0Iu2012cY1JTXBtFUMcJKLEhmwlaYe5vbVDaI8rfW85W7k2VDMIy4l5CEJ9hpJLmyQ3UyGYC8S6y7S6uc4me0LAGkAEiQu/jbhL/cFU3BMrIac7OPXCBM0iY8Ay/mSjJMSeWdqMoFMUrJ4LhJIVHOV4AGjn5EI6QEMCkvGj1xCEVITt1M6QXMAGrlRchYwWzoQZfl5PAbGhNcAqKt0S2gImm8g6msinIZmvC2r4epUFrDHHJrxAxMOIOSQ+zyXF3wyeU3RW0pitcC5X6JiHG9IlzjZoU8PtjvIYySIUKTH0s/aOCAOgMWpguvFUT5r+RVwE6P7SuMIhsB8Jh5E4tXym/2eAIFZj3FU4eqWlf5DyWI+PgGpdnTu1ZQW1MGruCFYa7XUa6zKJEYcHmHidEmtOkEXq8W1aIrLTZK9Vibp9kCG6ZM6STECpWEWNhS2d4cBEa28IiFXkqo22eKejVOd7n3pRZqFWci3jjxXZZ6q7bHZpizCsuxrppXzwaxVPCCqv5MaOoit23lav/PD9I0aelbygRgrmUdHeO2qufqnWk4Rmezlhm56urTKvPhll8sAaOiiioeKUXE7luAuR2pWwqm2UHRGsXGR9to5H4Mrlgo2lza3e+6ebuGFfOaa3OytDRcvXjBZszssiio9Kn7zh1mvsWBUJlAQUx+Wl4u/2R/wSzlxm8q9tfaa8l/nySVRSlAThXIYrwx06Eps0fJVwLJtJ0iXHYU2ezdhFCtzmhNPAMD6xvNWQU6LFfcUQtajakxHS2W/sSkqmc6ws7QIuYpAHIZfwxm62rYfdvlq/DR0T9NPnleKAkG2c4gTrgv4BZmlZqvVz36fs2anXnxByF2XZmtv58t4UkmvwqytyHf601Cm7t9/W+kj1+NZ+nBGCFctVcqdLLOQlpzMAK0vhTqrq7F1VHz2FZOr3jrJt++d+RUz+MOUAMAnEyzgaoXE4gw5XKRLX9pc1NXWzM429P8J79dVfOkiinelKPbA0/86qRUggjTclCFl8EzQuZxuD/dsR8DJiLEzR+ME3uCkWGeJd9rJo03WC9sAnad6PrucwIFp6DWS0aTcYh6z82TL2pXijNjLPRcK/r6wB0ibff6lyvr5DRy1H1J1rmhLtQA7daj4k7+83PdumaduZKEZThJ/Lzi4xbMkmCgUk2iQ9VkK55B9bnFaDXAPboOzcfazxk2vFc+EYY+pqihRzr8sGJAkqt+fu5L3vlHCB4132IXe8hWNpdaNPO5QXbZUdofJu3OEUUN10IKqH9lyICqr9DgJvWgbFzZO71tb5eDLLbXi4QXUIusyeu8Dy0kpy0nlXD9J5WbG1wrEbQZgfP6W6kok2UbRjioik+430Ejgk3komkBtQEitw78ZlcefdSaAHPGFjoRGCjGB9HpmUY+LtEJ5VAMJWGqcB7M9AaRbJ0YEL2sl/lrVeHJVOjJKZlL+2HI93TxobjWw7eyCPtLnEaswPOrRB0emW5N7nqRGk0bMzpnwhdP3wlSQkJJTwGENZfxnn+HPyr5o1HTttCkEarkVxzSVExPLbuX+EwwCpfbti1cKKk20qaJf0UCORbdKkq6o2w6mt1Duiybk7X+2lIui7uv1No4JM4/oDOyNxCSGFejwCey5iU26n62BAPDLGN9d3jP1O+sUKstyDqi5CfZ3BQFRU1WlTJre3NjPktHz+iFcm7elhj6s8n1OFycWc2/td8w3Y7bJSK9Zat2VJPRpKLmA/587Lq4sUn1eChEnSxuXGdiIt++bwTlRUM7k999zhGnPxABjEb+C0OP0UXtwZ3mWQv8Upk3/gFx6dTkGugqla45K+XCpqt/OMg5bucdRt7fj3v7TZIdA6FXtQSUAkKwuam3hXSqcDoBPwDZXRnzkI9tX3BxKnt0LUJ1JsSfSYxsY0V4oBaZanaqGNybBxAn6zXQ0u/E5bDFQPVBJBG0mbIV/DGjyO2d9UDpWQeKkLiE3A0WB25hRurKww0Zgrxx35L2G+yAAxBkTiLJSWTvvz88Pm3vXpDLVpEco2eNyh/xp39S/z5FaOGFNIA639FnBIjGGdfcaXscb9LCqFhHoN8dFlnooaIOTP8EAtjHJiLhfivuH7Y1L/WDri7a+kOS78QiGXG5brmaDtMkEUSswvsrldYD8GplpPKsEgI4uD8dHEtaoGdDQ2TWjVrBUaj1IeKyvPDf3ms4mZLVCaREtlksnF4iLlEe2dVuFfKJB7qSzhnwbaobQSFYkL36wtdiBZWbwNBoT92qPQJcWd8XZK1/unuciI8PKPYAK6bhtgzbULND46TqoxJ3G1k5HJLFLwAKFlcTQI1p85eGQtLB3PryRDIpZYp1HX7ld0p7xaupIkNsPdwG49vFn1ksst1Z7e5h4PUPF49HTUSsgw/GSfWv/txgYO3XxbqVSKH6/V0rdL4hlhXJSRN9t0A3DEuEtOpWPghE1q5DrGU6n1mOajLZO5M9nWqcbGCnxmae3E2610OGVSm6ebq4vL7vL6ybY6kGjzWzWu5jtZyMhY6m1Fi8eb97UcJa3TgYxCY2MlMGWLjKkaEINzXoOn2+gJ8dqKLC/STqwkiTUTHIqCoNrmg5t4Wd2sd8ZqoY/aHs0aUyc+rUorDp5946IJlCP0kpOipFEKVNuDtEyD8SVsGnWS2+xnlnScY2ElCUGPOn43U8Z0g3y0Jq3dVrXleWSeF50OkHbbf+lTocVbshqIVZ9mNnhxa3irx2WZ7MxtOFWoMdlDdE/O0Cm6ekUw6pAX9IzendAXr8E7B9uLk/wKb4LC81LHBJ59qz5N6QA3VSvyB9WnTq7lq4RjsQgSlxOJnkDS1XwcAFtKWP4ClLMOmDIAsKeFdEym3oNAvPrsc8UeC6bJXq8n1evpJrO1piMYc1xERDnLgw0b3LHJkBf830cRe2aqFI7Ma/mZB5+nxN+3dSm7OZchSPpr8JuX9Iqy648gkjq9dvkxU3xZFgUFPrsFGcZIJziUlv68RE9PGLm22wWkquW9zzlmc5xWBsb575UTMid1Uls2gV+IzaTWhjKpcP1J7p3ehZI0lD1+Gf9JsgTpPSTLG1vKNtHv6U9n9+ai5e2e/rVALUENK5gBo/LD9KiiXr3CBLy5WpFcgvJQOrHKBcHUFQvviLRQ7TINa/wkWk0pj7P/YjiIFse+b4ljkzhPDLESmN5lCGS2a+iDOIEM3zQnOoCYsfzXvcuynfl80c4PuskfrBlXI5L31zafKu824P50/wUzSZp1aiAYteE68wXHWXPLL084h8D6Lyt5AKA8W8THY+RaQID1ZyHe+E3c2CO13GjYfOenX7g2CZOHKjmaKz0yRlHculJ9OvOEGr1e0dWna4/S0MNyCpDunlRD5wdNOoqqS1NcO3cSRLkQtxRdViTFvaNzMhryUXBSglQSQuaiFVEf+bNg3/kk7x1fEXs4V0ns3mGPLNp/ooS0g+e1+bjgGr7YhTBEkHsa9oz1b6vI4ZyD7Nf/wMyM1MojJoqPw9LQwDVqYM+JxeuCFjgHMCmaJexoFzCTv9utd2Z9Nv0qApMRqG+vMybrD+xKH7ftjxqxF/Drxkax97V16vWMDUuGx5wo13Zo4YNiOOpE7857MRKx229RguzblDCkvTa6gjdJlMbKYQNLNVaqpXPvrD9VPS4ulg5PlXWu/sCqRYjEOqa0yCvRVixz8kVfiREjoJXcQjCQVCbtlvrTjEtZdm3/CYeuqoO6cnXxlYPe95TnUtBX3LUV/z3v0+y0apsg+Zmp7DIE56uZ2sdaBLT4GzZBlpQO/MdTkpKp4Saz/OuR3+QpHzU+Ntbmi4DhL71A8L1aVFn9BYeTlpdUQ6spsd5kUBH75uY9S7JLFLCRBUPsBTFIw8q7piJQw25JeyYtNQtl7E5XRynxPXv+UCJZCalJgXNiu2zheyfO8113fsBx1f6OCwwbPxxVCzQ1WkfmU63gcOHm0YX4Zt+jf1uh3j3Y0W7xPmj0OysQ7jeFpHykVXU5fnchFViyQ1lb/vt6ub0W+FFSr+8Jm7zksZx827xUSnzIkIA5tGgLCTVHBySUDSeQxt3pgvD/Xcgdf8bjjvfvs6dSxD6xQGnEZnxnlAkqX04eDhmMk4zHKTl3jDPDwg0AA98LhsLtv3qoY6B59XI53r4+prdk6vMyRUl0bIA0cFXAHuHE7kOidlHRt+e1odKrVG/nEGc7OqWOuTdydRxuxhR2tOMpOQY6E06IxGMW/PFILPc/TIqrWnKcXd4tFP32oJx36YiTHNIFfPpIzxJjgD1zNVscNmJjBZrtxehISvQYomXCnUweeEhPF4CAIgXIkLWfEP3A3SDCEVPGID/qmrGMDtyzDktMUoBNn5YbvBKC32Eha7D1INiRkEUWjPFYcqGO5quGULhOHx5BjZ8eME4WC8mOVSrixHh0QR42yHIAJC1th5WtKQCUkjwUlwHC5ImtxgaES37VLrZNhzIqNARBg5yF7oBf4tjBMEDx76E8FzQLgQRhUaYLzhoQ6CncuRg6Ad9Kwp8Fh4C4a1fl2iLQXizl5glfw8QmdwFZNz3wVOO1XtEHW/4gLXL8itW+UFcIpqwUvMNDv3UjS5bEaS1urlFNNDbe5SyZX7U4yEkh62Js09/4xnQYPZEwxsIJ7jUIW2NQcYuJt08kmFED14Fmuzh5on+khxnRAeSy4houTNcVKCxU3rmB2V4E87o7pN5lwsNlv+882nNIHqRdkdt2wqZTGBRYKLwYmqbCzYBgEDRLAV1xDO4VsfvslMaRi8JuKFWlS+QMoCwJ5T9Ea8SIEbg4uqviL+Ixqn8v9aIRaBUnQHDmIsDYKUMmGKAMdxQ8MeZegVXz0ByBBObjKHrB3knWG/rgYjxb5NJKNg60m7fVcHemijgn3x1xJvhJbXG89vByUdfrPz6VhI7gI8hrMvum7uaQp18eWjlG5+mXaGSAt0Q5JPJzwipOuQomh0igqxpyAvcSlEGlzKUFAR64qquAedhwmbFLHG2H0ECFjAJKsbHWSUkHmYJMCL4n5wB+8ENL2BUTTNokQQx6ARBDRaX2S6w+fjEbdGF+sDs+O7meCBLi7M5uQGOSV+AIuccKZ4V3hR0qCZzxDP+0gXe6wWelOGFKOFFl3l9QGFsxPrjkkXILvZZr9Fr37gEqAC4BXgAuF6F1mfJCiX/+DeQIbz9tY8yfevv2r20/1CI70ljxoqGlE600MEmdvljcCCe1nbHVi8XZfzyuecgxlIB5UnshTlDLqCVh+S3gW83yr8iKLBLaOrWhTIn0ZV5CiJMjJTT0daJPKEmK477e3xBYATsKrN+lyL792v+BOsTuiupmLC3E/8eBzrA6NYCqoKS46tfDeu4CM32Zw3LwSQdTehDSfoRg2qrUEHjABi+6yKbk0bJIjsY8yCVx3XPj6jvSZKPCOPYsDMBgY+0j8buDx9LmW82ukeX8ijJ+WcVfWQz2sL6CFirJlVBD1+3ocInaEFMDixyVBK5FxbhmThPflXRQVc3k24esCQgnycI9Drjp05jVEQe19I9rRJEMvu+ELz+S7v8sf42iwucy6SuYkeRrAz9FRHQdfpEfP5IhOh/gN1Fgr/kIW+jMHEIEBdLosMV+B1GB1q7FukMDEwP1ukHBM9Df0A+egiTwBLAXuBMCwRx3gQ3GBII/wEDDABitVd4a6CmYCOdZgkVFQCmUO59vwtjLNElZyIGuzRMM8z8xr8HkhdxQvfh6tzus/FTMzRNL4te4TbDOKw8VPJV6lUHxC/kmzD1Mk/yFBFvbJGH+sRofprOrpsHH4zOPNvaPaUuYjdUtzdWvq4/u3tIIRT66FvXo/KMpVYfEk4X+gUImyyIDx86/aHfHo8FsKBefm78hH8qMv0I+762mXrdwyDPvOmEHB53sf9kfROe+D0des+iYI62w4VZwtDTjybuW7aVq+8lxTZPk1ScicFnfK5yebBDwzWKocheF09C/O84CEIbQDrx8wvAK/4lAF9CJLWFe92gLszR0G2DVJo18cnIJooaYRYMn2bTZhXs0r7CTxCZhEjpFwU8Yt4/TkDAARhqG/jWuVFDlRni0fINEU0Ncgz6NfNLWssA2R90Qq3yf+aTjV5EXhAr92ZQKzKPzqPQN6L5Ui7UUtqc/CjmLHL+aDXWoHdCdbLpWffGwI3fSCBfezfHS4axkOruVYlEGCZ4BNpc7KRDMc7l6S2aztYWyjVG/FV7MsxaK1dQW0GeJhzXBPYyCZ86kMlpgh/9z0e+ywF7ROGSvK7FOJ0UhfV0XbF06NPSJM0m3u4iADkDpaeTyxbgOBFkg6Ebb4ior4pL+aPeC8sqEpARCj8YmtSW56rIFzwG7jQVC8HRFvmDi/OEW9g0v4XVXA8EYQMCz4KmDU9Oimf6zcsd4ITaZx/CxgnZBDXUsM4TIk7wZAGOecJR3O/b9MXGd6C7wzHO5dBd6Ki4GqbX+hPKyhG2+9qkzM/ZpvluvhPKE2sZjlEY3kU5v70vI/w0RFR0hHfrw/LwcDtedBS3AeurTw+Vj5IdvUjZdufRAHgMLMyu5ShvJMXw4/3eOpdywMJoouAayVEqGoNopIFK3AYONYjIk/NVgDeA0sZtPhLmIg27KpwPfyB+M7knyTvK0qCjQMPkSbkMUDV61xc1ugavpxVF3dLngPQVqzr5+8v6rPXCWxaQlMd2lXC5fmqYbnVJVjMghTgQw92jgm4MIjsLuhjpjKi2vMCNJlV84mpr0Jml0dGBmIMKi7Jo5uIAi6AmAwRaAfE4OJx9wtrD39KMXR3ck+Sf5EWu1x6HLssTf1bPaNC+Re8pZ0OpNO5QIh0gP8vnY/M/MkE/KXUgAhCm4FgVmWaHUEyz3QTfaIRLbR0IFnd0PXj2Zem1LRP1kKK2D5n6Y47gNo8tvl0Y0gOm+6MxeRNSer0SX10+mHry6cgpQfSVs0i6UmI3jj1T2NiLupab1UlGRDGNRdptVXml3C5ZD0HzmzztE8maYUgwteyDjxDtrguCSzrntp/lOl3PgB6FZsdgLcB+Z3Wq+RwKeA/QkCo7Hv4pHnh8jhQGOK5SJRe7B29E8Cx2qo3j6FTCRTfMiiIzqKcrfx5M9RnkJ1mfcUX8u2AgocQ7bOBPr7MLO8IOwshWu5WfWp8gt8qY3VIkl/HynXHWWC19e6BGc5rjySgolmLeTCXLnrM1Pp4HehDpdNoWV19fJ5T1rJvfkkY1NVy6iGr54T8h8t3J+r7s/B8XU0UwSRyQtzgbHpjCGQr+XdxYfznQ/FBl4zD3aNtEkU6j2aykvbPXMLB4tKVqZUyHCq90Dkhiyklu7G+SWK2R3RJJFGSmAqnp3fpX78p2JVSk4xRQREkhcmXH0mpdRb39TexIlHLSBcDLjWbveFWYYTjF9qcGcivrUZerzq9ttNWiY3daZbaE8hbO3IMiVE7eyNss9pzv3PaQJ8rXL//1cmXvh3siVMeDZvhaEvvn2hiddef/lOfJpsvxfkv45ZDnIoPj0gN4RSEkDM96PJQF9ICPiORjs+Llkn0/6T/r0f/S7UF46JYZrriRJnKRD/7r7KNf4qPE+eYHRwb9P73xmO4PbFLIbHf5rLSoThDtKbw8ng/b27Gnq+nWvSl5g7z/MrIwgbyrgztluekRSRNCBIzCLAVglIoxPNEIF7ONMYjOLTCkD8I2asfteNbBLJHIHRfPRO1rlbRrd7R6/T6Sqimt0ESgySal8mpfrfrEVXEdhh6G0EXgw8VKi6C2EhrHpwdWxeg+RE1ynZBADl4HBGkpG6ZyG+XzHScw5vJPzcdZgwJ7OcQ7xEbiGcOiD9gZn66hYuPUt6erHSwwwBWUCLhi3oJff+qNyXgmJPchKyOqbN5scgtakx8U17QxjtGmEpBEHO2ifXVjhoFiVnpSEljDOr3jvoB1VAPS/oZqmq3bw8D4L4z8a4JEC8n8v7auh08v7+krzL0rS4fk8Js+HssU+0JooYhhlRauXdCMUMzBXPm5H/73G3r6kD4XRviX17GvuOiK5JLw5OuhQ1kblMoFQ5eQf6KASwt6W6Y6RviHDVTluq1ZyJtzosYFGtFn52dqS9kiGT0GgspOcPOpFaWHi9EdONbvXNjFI4DqA5eUW+7brXE5ErOb8T1lBt657+KO6w0ZbylTxdH385lvqlBzqURjQIPfIS1SUO/heHN294AShQyjc9pGZhXC+MHivN3/t0zVCdNttuAHuPuRBvKHULXLrFHw2B3Am0YuGxIzP5lF3l6OvtxgzFPz1+QEnlEbcM96ZtOGNHlo+100m4PBRvjPnjDHF3czcYkeii37dtFOwh9ApNsArzZY/OBlpTLdRkK22qGAS54ij87LgYQzWyEBmo2vBNRaJLrnKAgpWxTXLUgLr4qrOy1XJKSXC4FUuYSlhWTDYiVrKtijfGdAsW249bvGLlq9CBxA8S8llkwulHE7mQrVKiUKoc20H7bcLMhI8MjZzXBUCAUfB2eyxS7fj3EfawbrwwDW9eW0y6gF+f4dBU7/HDzRZY15v0JplDXG6dNKr1vzS/JLW10RwD+GNqaFpu2n1GA8ZBqTbjfkl+aWtf5HAcO1IuzfQm1XuOVhULLndadp2l1qnt3diub3brPG7QGPAVDV7YrYq2FZp2Myem1rp9BoXXV0EMOg4sxZ9y1W6CAUKV255W/FG4RVqCl1urhstzGvLk+TONuAJQDqhbMT4qR2iHybSYc9liVsnCLpsoZLNLWmr4CpcBdXOhTuLFgw2gVZt0Hvmy9HpU+FcaNG2aSX6R2iFPcpVhGMcbl3AjLjXj8qSMJG4EMbP8M8+FYApwaxMWYa59fufGYk430v8f2ILkfK5/F7enA3LTYLgFLX9WYxFj6lypwyVS7GtpIMtsJCqJWYeH0iT6iY6XBGIpViEVtodG/3PcS2LcMBA33BZtBsyTa4NENZvplIuSHLIKYNORUPOlJaMo/iHD4rQqB+jGIR7Gbupyxfr7lIiNNl2cHacitJihVF6BzxEZI5+Us/DnExlfRgn47DU0yXCiXXTO9GndsSc4xjtAydkRw7lcNxUxenwBlwTEhkb9L0eSvFtT5SJaFsJt/9ZV7AJz1YsXn+QbSI7fg1tXOFS0PgSFVCwgbV29A411iYJ2tpUmZVx13YOGs9cVh1bbZMIxGGkw5v7YSNAX7YWuiB8AsPHTWTMxYx65GD7jhmJ53S4rV8nL9FDptfC7rV0l6KKzYW9HSO55sdn0j3Zl7npbpkSz0FOxtCPwCgx8hIcaF0PuLTOIEKfIFYUt7YK1FvLcJcyDBOBYjF5NZKWI3kk83INt9CHu1nZdm97w/2k7owVUT+hHadT0UqJBe4HrMcTt6MUQ1ktTD/K+XUzDv+2XJ0VrRhJUR0YchZWQT7iYDEcTzoKTe6ULIMyUAWR+V6MbwDZkxpD2yT2l0l3QEmbKcxNHUxYk42l/MANMn9NkPKRTnncxp0GlIhYDQxrYiPJBp6ku+qOsMUeNNCheGpH8bQMuQRS3Q8aEjnLpDy63ENFHggwjEkOnfH3MA0vnQSBsLjirmHycvhajPko36KOEesDpuAgq+urCo9ZRQ/Fwyu+R4q5rEbrX4eb1vxwmNBI2P3LeiXDv1o3sriR4u8r4PTF2vtSvVb7fsrJjXfi1kBZ1kPmzpb+egoiQUsTe2npsEf2ejI+1Zrt8wtIgl/Se3zUj3H9CuKyI6PSM+BamSH54PBBbuz+QFd+06FL9kgPqUT3kXNn5MzmfdP4jqAEOPJntIfTeU1ObwH7kTAb5cIqQTVHXwOjg+9JkzFtZHvYkOkeGek99P8o/MbLLw61ZVDaQbr1RJusDGqKwU0CxSQIx6/iHllCXN2HA6s6AjyZ4EcnZm7HGq+xDcPbEHAAQOuKZn+MVHzhu58rmgLcMLVWBsa4/5soWqz1o63X1NmxZg5/zW/nCRPcXBc1sOQaXeMbHmaUTCH8LKeW6sxZKqIN6c6l+vXzZ0TebU5fHWCNqz0bG17T5srFWgEtximBSc/1zKSSDNS/l6OdOLuF4fbDe8p2ZzOXLb5VFwtLuWayY3rKsLpzcjPeQZ7C7HhzWBim2VzGLeVayB67q1SbO8RGnIMcf6Pe2iKVw9ulAUNc+HS7ec5rgapv7f1wKdy/d9vmmLefhl0Xqe/QopySmN5IOJeSCU8bGNtsYcZ7N1QmHzb5yVDJG+cbhrSatlWmTsf6gc2SsKBZdT2lKI6Z600TMaQjXfx/X72mFc8jYN/uXpVlY2sC4dW7Vz4mEnik64urymdX0oNCfGTNjkfSi+F7nJviMTtiznWM9IZz41TkV4TkycfpdfFS8SmR0nZaCuISQslqozm7V9GFw0+bu9EXmOJmrgfZV/G8XBodFPK8Gb2RSG5E87qNscs4P5WFKjGIVkpReeTAfFc5h+KBpfobMb2g/R1Wr/6T4/1UungKXAeo3onopRxTWrXeLMqUusJjf0U6JGpVQuc0uV8mQxABjrh+7h1eCsAvAArAb8sDKI6FZFMok8tnnqc7qzZom3p3NHDCiq20w8NVOP33jpzjf4OS3hu1Ji7hRnAMQCqv2ya1DSGYDPTE9TJetvfDr7tRFugDwDm13l28na7MDl7rlDB22UyiFwSI/jZ4qTQ4/Qs0d3kSE84l7iDjk62xsqu9EiumhP6bvTNkp2s0dq3nUZE9cTzzDUjMrp9Mb815H8kAu0CynbE9hakf5JSJ0w/bznEO4tO1CZk0Na3etj5vhahcrT0fDeJsp/Tvc9iY7tkxY73eeqZDoGJubPqDi9O/QuHKE+hwrudGMv6rT6+2tzvYkJxbMCcug9y9vNe3F/+VUiLPtRPZfnTFYgmMdEblaKSOFkLbNq5tXd46foAaSruXcaFSxahYzIamF1yyXHZh2hbsBGzfoMbPbtZAm08QG7QCaMqwfvgnCBxc4CM79ZmHFiQgt95h0U+Nr2jLLhdTmK1d+P1fog9VgSYIfXIlRlIUKy05qD+CVfsPbCD47xjhrn2z/J6BfLGUx9z989HapdHqmawPbfQQQyr73WWyiL/Kcd6RsQTbeyBddEQpwwM4ZlLDwliakJTFN1EkYRS9f8UolORP5yMlCWNtCw3NJJyAiNCoDvAse9U0xlh76zdNug1oIl/CKHj9nlEkKboiyCYK42jQUVL8NqWNjqjQiACOuWShMNbWi0gg8p7hM2HJWWHHk/6fecNbIIdSjNdz7wgzXnFPoerd/v12mqejhFDIyNXWPiRG7ne4SHBUiuBNMTuoT7a+wlb5iLBRihIjE3tUlGL4ZeXr9bie2VbgCXj8YE71OB2SQqLEPl7lPgZPYpi3rN4xY3o1VFDa4mAl3hSqCVbDqv7AedWKQ0uL+fL6mbu3N7fKVr1VzFMFW3v5KK+voK6NCToA6YqndsPtAdwX3MDL5Rs8x4mgFzDbCuv6lqD84cKtbYz9bFKXfPll1Ep9WxvuFRLoUDiha9HdFrJzptNpV8QKKMHN2pvNVdhJugofoOu3/QruT+nvv9BsNuPZ4N02fFXtreJbn69nry0IxzSOiJf9tkOeGsYJDhAO/RTqJfnyp54hQhf5O7A3dj/bW+l1xU9SthHxAd27QpIhRsg8r7Sqzf7YzJHuJ2Zpup7vQ4baueFz8PuFfS3fbYnz3uv5U+B1XeUe6zkuSqGwJZu4Hqo4qNer5fyLB5sA11kcMBhn5a59HDAlvoEGnlg/6puBS/M+Xcu5Yevs5qB6VpyfDdc6YdHd5ZpaE7l8Nd3fWcB/x6zgZ+/oIyAI3frt/kITQcmpvwJP/ixzi3pLvFOsSzKBkFqF7zrn781InB5OI/N5FqwDdVeZFwg9vBq6r9KRMy7KJDHqzj3LhC2NyC4yrtwmPt+D8wIq5seT/3J2yBhyoDWQ2g6EW/MDeC8pO+EM4w+4Mtgw8dQH4nk624BFYc4N44cJHxwoLAM2/QTr1Aftwjx0cTZ7NgEhKA92hsnV5oI/QAOUHVe7zh5zn+XYe73B2LI7iZItWSzFfPERJQrnT9atcABnjJ+ZditToHYIkbpkiHIKiqsiCS9CYYlfqjlpFuF1W79tAtRWjSVm1ZJsNglmOAhnRMAfW8u9J9m8PtH5XOc9+fyDTJ7Hmz0FmAIXnS1r1J8gMWexLCUE0fOn1kabeFOKCTtK0FhrRLGXKZ3BtybM55Xd+0whbZn4n+iTVdsvtELcpIyle5L6hlrGOVgx9FMjN/oJSmwU7MxgNftd8Cy7mq+wPeECGxRtU0MjXfsN1vteBSwV7fVy8657dxknUPp1CS3hA7sepLpvDcHO6f0lBT0pIb54HHvtvRWnZWNOf7zsLZJ5+73VLLPJmqSD5oxtD6+/wD5Et6IPsS/6ZrZmNIOaa+Bwp+m05ascZCuS8wp337TzcPOgk7Xdm6wIaCtUFDMDWdMv5YxaFd0O3uWXVxSC/lXCVfwHFtk9NL8ST1tNwmXwfNJKIP5qQSXOO1zEZuQ82Eh76hc9hmT3BY8Q4iAeuS4Q3kRmkRGB8AZi838U8sDS4DLk6jyh/rKZiIg9AeWr81z2tykSMrxGuwQ5IfROQfyK34N6L+988N+NFCbT580NTruAf4dz8ZrevvuCEYJDr1vuHURC/JGJtj8SkXtbe7aHhUeGNzXfRq4LMSP6RF/aPOPCesycMb/+lNl86DbywItNuSt6ewjCG+Dm4RJgK/JHQUnzTQC7LvgmiYgUqySRueI3MPLqO2RHgd7HNmkGABivmkbP6txKaOIHVRK7O2vvql7GZprvg004+wch6ljsefgYhb0TZak3Q2Nwgi1kGHlnc9ExHGvu3B3LyzMCwBhAT/j/u2wwg3yHtlDD4Vx/Re6m7fX3v5OYFtRyLgD4MUqqNryHRX3kwDSrZ92R5U1E4CK2N2XuaWl4R13qDpA92xzxv1os5deQjiauO9KTZQp85Sjk/LSlYQ/TlO4iNhw/+ENO/2g1zxS734XD8ennyZTHcmRZSD9ZrF9a8zHAgoXgsn4i0ZpFxdo01rrJy/JdHgCMCY6mSNePOB6xZ5gem/YTRJfwES2W1EfjnAhsJab7MWaiy7P4X8TzNSytLhs3fiyeGFmcoJmczJzETGgSzrJ4Iu7IMQJpIR96A4ArhYrF+PYf9uzes0QaKN+m4y7SQ5E+WdC8/z97OZEl/drMtSEv/dqbawPuxxEOuCRIPV5TfObc9qv/1Oeo5oxHPrRNqEJ8P8d3VqOKBAGvuY9wLaqppztopg7YD7EpcQNdl6WD5ByeKjCkAFmTO3gqBlLd7u5xAE9DsCyuR89J9DJEwZekP3OVGNnhkC6etDFSVN1/JoB9/eRGiolsWlTvZHhSLI/mCOwkkGpooxbbu3DcWpvKtguvzBuc+S6z0jJ19+2TddoH9RdAm6/LzubOCWh7XAefO+cvMSgYHQ3ZowEBtMn1zN9OaQbp45QUTCwP3tbqdIVU+/D3XWbLFKWpKlULvUzRbfYeDqdS7SOeddcMKknNQLqOj324CXPCQOdXf89263ctAw6fJplM3cdBh5YneOsnLYP7mntGAxU3K+mkPCPebUlZMm6jcQGpSMV+UGm/PHmLLPguhJIUDDPYBOUZvUdlQq4SN4615Rk92H7JiWdjbCQxLtfZAXqL4e+2zzaIGhBO8xY/1+UFCaAcIZjFvtlRuJsNfkfQBtgmDBT5GaPLgDo+5f6WfH6Emhsgak+U4au1TsrK9JSojen2is6u5IlsCDkGrO80rvkr8fcRWCv1ti8su77XIaQyOSWqNtE+xD0Zdx0BfaNTArvw6EM5yz2KH6hhelNTX7EHVX7yL5723O9MuH3f+cpcmxAO6hC98HyFLpZ+N7tzK5bdyDEJhg7TJXo/j1g6WC0+UOjBdiUKh1LnoBJ5ibO73K7URGZmxb4NIiPFsn2bEwoMpBsStsQiQUnVbH6HY86SG1xvr+YnWJR1/DvAsMUdgMr98LibHPkmYOFgQyptpf8fy/Pt1OUmZG9UlQqvwqEHke1BhMbjOO+Db69E7SyTOEQjB3PF8bks6D+csfNPJ1foJl7knyJLgC9DGx6+xiVJyi/F9125wQIPAPrvCelSjkjSCXArlJ5jDMd6RjxHVZqbxo0IdhStBotF/8GHfXWSEghGdQm6Cm44d4tsCIJ1qCgV+Hd1V9ACRHDs61UJkJ9XnZiMAR0Ufh3e4M/f2d8HhYClQWh33rRPt79uQzSG0bf58G9Jd98n+jFxhDhGKTVcbtpVfTPd/MsghPyNkqIZJdTwINMrJaPp3778ZYv8byJguvb30FyKR2lEEGzWp25qpkmPYBHzOxY9crteLBZIhXk3s9jDlWpkzTj4NWB8x4/3XPdmEvPs7Rz9MvcuN8AHIHfPL814/CC6GW2tWbwgcEpS+Gcx/MbYgqVDLKTC+f/4sjqs3DZX0s5m7eeWBzqO2mQFPo554rmlGmfglvWRZqkHZ/rT52vvWlbCkzFRqcs+1le8pCgEaobSz0U1mgq56efgg7Sex5kbmSuBxJ7/6qrVAG4sVpNuFUI5aa0ps26lpZJXIdlvTPi7FH25fod5kcrPCTSSBMO5TWpYGhMtMPXFjMJV6alOiujv1KGVTf/+fWnq2r3f46dT3FgXSos92U/JXZF35lU22UQsQhq9rG4w2UiJy1fh5bDghnv/nPbDF2zdYzppdaMfs6nxQw8iXPU+xbrRCzj+7Jph9eeLy5hpyloN/P0BPautpmVN6AYQgJCSa9ZlbZMeNu7EFoY02JBT5MRFfCvI+8Z0W5tpJzbE4y8eVnnK+PCreL91mg3qfHugQUj5ZaqQDcvNSeOPIUJWoO9jrI2QYPM4RJxFgIwhh+jEkP3bLYUE7Nvgb/ydTJTVXj/mT1Pt+x5CTYrh3ErH6im11NbHlORd6anLpMoFvUg11L/lUT2t5MH3gX3VgX7MEndaVv5ovxO+OZjhh/93nrb0UXJXonZkay2iodeEVWSE/AWrrYkieV9eYNHySPyFy6HEKILojw+BxDwaUf+yH/7H58b1ZCpgSMTLok7jPcCWmWjsr0rUKKgBaO0vyzDRJ3Mh2JPqEtsYXpsNoiFm3vujyJ7J6eL0r0Uch09HfT+sKColBsd2q9e7/6taDo770L+K/b+CSTO40req+0DxxJS76w0p5O+jZc3g1h6l42STskiFYdF7+WjiIcLcCBoSf7TjAfm0An7qR2Hhvt+LyhYKBay14cKPoyHSWFfo0V6o0+3e2sLYtlrC93JCzWcOUhnqtKKuuiOIVSw697MkwozaPjr+Dqvt+L4GdMNHRMG1tfjA4iGp9YF/NFE0NeGk3ijJmmTyz6IbH8M8D198FWVjpeuBBnCXsjXpuIRY07tVOWmtLQ3ssTeJDURsFHDE7fGxIiMpmkageYm5u9W29QeaZnWRqFOgWYkpWk0yyOpoxKJLmlUY8aVllFXgrKTxlc/vIBJRoHOwnzd4F7Y67B2bUdbsDWajULMAZy1NqHx2x1GaedwhDo5kH1Wq1TjKVo4S/0CArErAO+nEpLHOfZCf1bhiVZQVZlItBO9rE6lQIhvybSFFp+7jk16TWnbLPoLGyTWjy271ccnU77ruQwygnjpJADRHkYPxpSkLufdoGbPYMD9PkWGDDbngMSK33ISrhqO+TO4cuEO7Q0ZFEhQJm3iiOz8m/4+HimQopRy9+OeAM9UT8/GM90p+Yeyp7rUIQf0kKOWK7eCdnXdNo+BqpsDZ+bdLf9JqKKifDPNzalqOYRKf5eGTbZSmWe3d4v3K/3YqjXGJ9x0Rad4l9PKXmY8LnlaXr9WqiUvBz+o34mlGsv98D8DyGZf4QIuyftW/jR/cfVeX6vWcCZ7lHufOrq+ZiixOP5PZz8mq4G7LRDr7Yy/HdiJoDWAHoPfN4g/uIdNoyN4pY3ofjWGDmlJMlCx8E/z75n7Hkxpju8m/lhx966HoKEJG8Kx0NZkhRTh8oOYcqFVFGihL7dCiUgYI47I/NeWppYxTlPlngqUQTnGruChX0+uGiNhlJ3EVY/pXXfw5hDvPAPFcPyH4OXkDvgDhS+zyTtsLUR5xIPIKV7PTZYMOGrL/KPnkzZ3JJ6tMTOE4S8A3UNNbuR3imjBZIPYmO0I0YcbtwTNJHhpHTIAKjcbZmk+LIZ2BKuFmJH2pshfg6eTM9N+jbPz/SzqMTCGdpmDyJZfM/P+r175cKQaBpBMoKA4AVSNRrg28uY4XikIlShXX33oiQLAXEZKuJqo1sy4EFnvQF0XmzweP9l19slhJh2zy63zMR1Gxa7ufJkNHwsLx7yOULHdVkBKrMS1ilANfggf1IWhejl4rmWNcePCZ/oG6oAlcUy+L9H7Lxo1VnAqbj62X1VJFX7kxIesgxAz0+4HBrog2EKL8/VpER3ELhBpFowyROhGB6FCaZJKhCkTmZ8seXWLi5chFar4GcinnJmmfh7ArGvNTYpxiLep76ZaM3tonXHysVQfb1uRuQhZPCQl3k5k4nxjchYrpm69SSF9afdZl8hK41qeRsdfia7r2J6gT97T/Sb7TMGw6/VVTGj55iynqeJi7tjvp3svPMwkig5wroPfSSEut+4oVSLFn0jXVXmE2gIjimvqgdkZ2oGfr9vyyTMeNjGHOAgHjgjBh+XSpnF58AG2NQptM2TWPDrIUAKyRlsQMnIMNd+OkhxsWtROLY+DXAGridSDT7Nez6tE4/apg/aiZMGOgAIOcOKbaaLWQoYJWWjZy9iWA6HQS21Nax8VI0KRzKp1iUVOBLOqX/84yxeVYTBoWteysQ4Piy6QWhOBQbEDzGOWmqoExC0TKkCuo90ZVNZFCBqThk0oAWXT/Giqa7sBCCQ9CAIDiQEt8z3gEIJtZMlVtERGDQjLnw/E5usrtCgQkLnFt+/2EmHxRGTGgBFvsMKGPJpuOT8BgvxMxwZo5yyz4FBmB/hd1IrJvUiXzoZJXJaEOhAK2kzfQmHzAvZUNNICuU6qWLwNeYw6xh05HZTqj2WPezWUJUAQZbbAMBBMlu2yWrUKRT3d0JhyjW2XgNFJczbKUR7bQJZqhjqxQInZMQgxMgpRvw1HdArSyvglHU+o1rjQU2OoGDwlwpN7xXmouks0oj3ThIvzjB1G/GyqhJ7dK49ZgO0AfltVQEeGKq0GIIL6Xse3LkQyKRiyVjC2NWKp6fJUNKCKoAbNsVJRJl46Q3BVH3m3RAMe4tMd7IKhqGyr66YTBH8kcZilnk/Aq1ffLceuRvpoEYZyYg1mAyhWzo6lWylPrWwQnhwZXa4a5sqJx7TurJw+bsgNNTUhbXTeZ7Umx1mWAfRpyDwvlqxCvDnBy3hdHyPAMsiLRgWlI0RmHja+Uoi4M2K0yvaU+KYW8ARltGmwo+upbgVU/D09spp/eJ/riyB0ueWzLyYf3PwW7vWdWudKqkngw7AnIgYHuDIAOaWc/nQSmIla9X4///JuIrcUDQ1NK7zqjNcH++ut//e+3TkEEGuNMZHz97h086eNhc4GhE35zfnMxBX+pzggveTL+o6Rp0/zc+eVnUp7MD+O6Of+/GseXxWvQ9SIHYggwVIMhPz5DkIgznhVWR5uUygdNhlaSmnA7VHgfBt2qLXtCu9tl0IHpPY5XmxlokGvPbMHjQ2uiNvdKalYhMWhdRFgwd9FLtqvSUO0NR0SOZ7HRSxueedBdMYlxcMhvCUw8rFndnUswnLruRkcSJ0NrU8RjuXDaKfMeLnyT2XIfjjsnzB1bX2WF4OSHRGSiVvo7FdyJLHZDRfdMLJonhUGE4TrmSfNOAGQXK22Z9XDEMwIIoJXTYyVQnWnmsRmDqTNTFav2PiIqE1SjSbkFIwZZJw/trFl+FEwUl7EatNN0M9ZHwHRPPAcAkisu4FTE5wlLfo8QzIYqP2pmKoq1UKySLI0N0CfSI3IA4a17APTfLsEqDaiuFGt5FFxt9YbKhUeN8l8VqQPwYW84VOnmddLXyC2iYDpO1EYmkVskfJ/pILCL1u8T9qqhJt0eN2zuzvnZjo2eKSCOI/xtvwarwVA1U3wxs/KGKHhFI0Qdxrzc0YoKk1pxGtHUYJqQLzHvEjpr40ZZLz6u7Q734IbBq0fYOFwaqldYaHPp4yW7sv2WO1+duzy/vNPCejFUYs8Nq/EeP0bYNB2etXFr9hquzAn6kICPfcWPsYHToR/6vq6UevAW04LxlFUwJLyfIUKhqacUunqKow6x17wKFmOz1oywOQ2lYrE50Ckz4FVKkqqaayxD3tB6YdZQOgYQHYv3oKc6KVgGPJpDpqqLlDYgoQB0eYVhKPSwOexGV8fCS5OrfCFdYJcvC7mJC4g1dduzxKzP9SG4r5TAozEN+k4WMYPoc56LDQ5AKDBwsUtDyF8ZLmNHh177wrmAEYC64rPxpcQB2dY1MnBfaOK3UFm2ocdh9wjieRPAMYNzGRyqHsN2cegWKZ4dLdFQyGV55hopBZf9nj9RnrpcZvsKl2RDHpt8RnzDDTIVnTLtZ+3pl0CMPSi/DOhsuuKmNJMcGSJ5KTDIix3yYzgpEtsxZfjdPAAB7sWVbYZJOZi3NtTfNUoJ+1RnfFqfzNB5ElyDXPiRQlc+zDtsW8IWujY1zZYT+Mlvg2nO7q70NhidhuDtpODWc363j+mHWnW4by08uQuqfvMSKriEK0Jdz7GgAOUXGzyNI6V6EOmWhNNwOV2cUXjVT7Rsg49ErC/gZCThnNAx3nG+jZsUO9eC61Bcd00U328E046pmhmo/f446iPhg0mut0Ml94qffxXtD2eJhWQM+hC2xOkV3zHsP5BQPRbC3gtGfE08jjjuYVtKGRuz/g2onMxyKCIulMMZHPtXNSytl92QWT8lPLiyeqIOm+vK1eGAPUXNk05l5gd92MEba3iJfFdj8Qee8FJ6SW3LpvyD2/jm72NpXQpgAK0YfxR92LrxNl16+ZtvjdxjbN+DyDHSkbmFiQbHdpG/drwChRuEbu7J0o23Inq1RhflDE9FcxkFCQ0u8EL/zqxhk5DvBmyt7QFzppu8s/tzcbL3G5YM9sRVqzYqZHWitovJMKnBrXp+XAU9OMqWoOrekQEGkUg2nQ0TTQurNQsJTp9rCi+JmBCnCutDflfJPt9vIRVdRyEIQSU1mI2ZDzoRhWo8ev3SrPWTNFypBNyqdOMRRH6Ed75Zk6fVikugdsoxY2/Gsfhhl3g9uK6i+842MMOSkUL2zYA+PrKuB59P8OwtsmfWsSmevsXy+quBDKZpKH9UhILy7C495hRqqMkIU915SwC5xKLjFyg7QY840N5ykG2F9eOoMI9mXQjT1LnQiwWh+BuIEpdyXWvkQKvSuzWL7QkogMbxIk/t3XwK1akTLuNI5fFJXY1nct/v8SGW+m1VnCluYOZC6H2EWfA2Zfge2Rjz3hYMx6RlCvERZAZNXEPN93i2tw9VOyghkIFKeGiUu0WzoxjGEfg4/r1nsqzQjKX0gHMFmLXzkubVTyxecueSCtso5HvXUK041asi51UE/fUiq/bYGtsOKx+Os1TTXLXZPJ5FJXA5aC6UPx7PFoseZxDYnY7OZD5YdbW4H5yoo+3BCLRC9J4c41aF45i9F9OI1IHIpkGwMmLOdOkk5U4G+O6WiYXcrA4hBatF1RQxovbx83ATxK4gdhmv2TA5aag9jFl2OAPGsvFR+hkAoLscTYtlayD5Wj2oVkIw8cy4iWkcL5gcOhunHHRl3xJyl0z0FdL/WXuQs65XPYk2JPNua7rNbnvhHQxaLNk3Q+ZF118lroUoCSuMe2qDcgx7paGzLCghEPE0qUu83kGBHSrIE9tkm811T9qOAZWyXVGuPU5UZVc2GkbphvH6OA0eQdupazjGWx0WM/Ql11CjiyQHhXrEDhG5FNM9DkPF8+Fs5LUjaJvsYHXgO5dlLjRVh5f0apxZB7xDt8ysQa7irLYL0gpr1lnlZmJnN0qw61mUSVDJapVJsq0yuqySMjc2nIsHYYQE4TErzN1cY4TFYbRWtBhqCunKyPmwl7iWLK6vIrET31q9BC+fBjrJtaczHURn4kMjgS4ADUWwL3Msv2UC1VekActQ/+ZGrkeyaUJw2s8mAgSzD0ezbGYIA8YL6dplLmGfuijNndeMX2tgNRIKBWZpb1nyEFypDXh5BueQynV//7s/ZHDaMLp+j9mzJhvImgboxJjh9GKS3/RT6hSsDpOyYH+5k/GKBstl+QPxYLhydOUqSkLrNNOFtPow5IBnhmjIFWimFMxPrGpDB7Qba5h6XUbMgVYcAHWn/lSUqYXyI2u1cONEh3Vxe6KzqVYGkeVHiVvd+fVxn7B7GqqD6LppfhKG/HxpjEjmCUXDyphyaJbSmhHe29GZZNaFNdhpKcw0VLZm1xTlnhuS2bri6xd4RWPweHEOS7mMCR4IigxE8QZw3zrhcqgunzV4DQSuE6Q5ob3ZLN0orb+NsB4TJP0K33K4r64bAN/BcSzYG3Z7dPHiP+Bc+6zEs4ysb1qScs5sUO2YNPzLlN++oLf/Ii38mqeabNC8luYtCAD31VlAGEHOWkn3kNuAsmCHmEInYEAeY2MVJg2zV50F8pHKI8h4KVi+SsN2n67KxovQZxKOoCLY+J8pTRSzK9aIfgz/pR4jANbPHB5s0gqHrPDui/LJGuA2NLjGW7wDVagKfQfUkloVxrjA08Q7Q/xUUwXA0GLDHp9O6+R4ML5SWhqAkBZekaBl2gREV8qOFugQWMdJu1FGblzDe0HkyA+R3pLtK4ystb8aaPuPzG7zlQxDV0+tjrsUsq01X4OwMJxb2zARbxrU3bBpXY41ppAj2iskG8AAx6UbS/vaZUgnqdkX4kgtQYSYijkNpRkv6d4L4svl+uMfLUTnoebI3W4N/31umYgTEXh15h3nveHb6LkGoIYQ43Xi26HqD7TqvNFRUxDhRUgXRbssLONiSZszY3OiY2sWBc0GPxTScB4GoIeFhxWHigl5PSBuw8W5FxZfx+7x9Tdwn3u0joChqHz24U7FSDEmdKodZSkoJCZNQtwZqqsah9tLKrrwQTPqnsSnwtoBZnpsoyBdqaOhdMd9MdfkWTXzJ9eYq7cmvsmpLsEYcEHCyeC7fWBgz8m00ufqwlHXK4TqYiMfDAXcAGLdk7TLcH5Zn40fG/MxgEfDqk0bOerDCCRfC/QMJR4jfOdHOYl/DnUYdnLEc+SkLebO6zLd5R8XpP9MOylom1i7t/4Gng8p61U1oIpGSm0jDYidlY8QnY8t+lg0WXQnaOYZ8ZqmqZaMkG16yKnUcVFO1+3XpkMTYeXpnkTUcCrYXAOER1g05aWWVK3Tm5BGa1QagYpv2iKl+OwU1nAWZbZdrtawdNVpmVx7H6ZZ8hqppHuehX24XgawnoXcKh1ojxt3DmbHMx+leApnSP55OwBn5sx8qLcg/mXNIIMBTgqTDcPhwWCgOEECnsVzjB3FHbf/f+aKUflO1atMNDkNXP8+r4wul+ULxKNxPHEXMYbKzKO7g74jhv3IyZzgfAmCpV+dawg1Oz6VGMwTDm81H6RpKZXtb/8E166HcnJuzlshXKeC5ZLzt6P3VitsYDlTg4wkWLYqGUXDy6Ea2SSvH1Rd/++/SegNFVcp+w+996pu8L2nkIPBUORbXhOrJ3Mx31yc/rLe7oOnk927srn49fD/X27d+MEv5/Ngct/Ep7/Sc3qGkYlU0H+mZEKWDFNtOD5xRr76KvG8GDIcze5evjLfWz4l5cnye/H2zu7/SuZtzPf2l2dZul75CI2TS4TjrHElTGY5RCWmhaHQdRSPCEUKEaBMmF48qxlTor8rdkfKWiOuqUDFal/eIMjtua5doQDmL7EKKbAdXSED1wNNTs3zfLPTjTjXp4/s+TaPFD/xujdUtXlr5bItS15Vg9Zvl8E0EQen/2KNRrb/7Edq4bVCvMP653ZNEvn30roeJdEsxZjF62Yzk9+NmSIGF5OGOIPNn5FZd6hGq9Yos6qhHO8W2+Wy8Pa/0cAjv4Htp1nTpGrxcFLrjMDW9XwKcQ4sLj3gsO7Wt4bcnV7apBhb/YVOiM09xbSb7lS9m5w3RUckIBo2tdorA+dDZ60eynrzrP5CknT9BjotKXZEjBCJ0lgOGYsGViyhBprFZPCYZBRsI8BKMLS6601dXrS88bYkZM8kowJtQzAaBaF9n4Zw+05khWr962lCFBgqtEaSJUPC7sVQpUslwPCWJgVoiRwEzQx5xjnOpdQSFP/oBuipytrh1cs7LYqII0dvxvJz6NHVc2+YvSdxgHOGWn5srlBxlU1zxHDNFGpvi3JrOGBK8cdrjbwna7XRrpGYw0uDkBssF8AVwvMTReRnFCI7qFmtdr5xbPEGRIM3uAIv3pfjF4/NWYgSLfeKclqDrC8OglMmaApy12bSPKHKrmMU1CXICd2EAeoe5rB/LbtCeyi0kbGjfkeHJk69I28FQnMUmhzbbW4c3MLxlhKS9AitXoIfWOH4keuXr+HSSlUCR+0zqjkFHfxAV2bb9z/6FSQW2ULz31njNMWv0EkoF8ihEozjr73Uuq6YOx4dncymcq/xfn6bYKlQOwX5qTZ5J0oAhR3T8VxBmgpmu/aFSE1KrDxt92I1bYiLbQU1mqv4aGSSiyi0WL5WT1jWxiJ6XUqPuE/dPjmJsszPjiyOfjYJOCOEt+RUWRLJKLgZiK1+AysMKmK906kLlseRbHlGMPKOZoS35gmr+kjF/yz1jvsWllyeIFZkFHwyX8Mh7vXhhr2mYg7MqXCC3O65U7ybeEdjoBono9oiM8bAz781bQgqHmEKyNqWVmYqL+FxTBUncCC8BVmovrbdh581kxVvsQLsyWS3urVpx74kmaHB4qdbZzOTWMHRGt7zfZzJjrTtRQj8mBCPn3rBWxYncVWo1sOFVDzQWk7MDd2idqRzaIEd1Sn5bc2qHQyFurz96dcX96DDJD9UpvlQ2xuLI+/ddUFvhCXneIMzNdu+tTnDV+5ssLk3sOtXN1dq2+nlz7v1tRQglzrDpyPe9mxh13ynmKLr7n5Kij/zYFcJkoQX9HLmfrGSt/3/7s7yMEMvGRaTDfYf5n8xGea7y9asWj7wMJUdqNaU7DxlZohEvl48/hpeMr1af2kwFbryNFMwfWs7A3KN4yNXB9mQN1g1iEdU/J5i/Xo0QjzPuDuTVAQU1NsMGYwHnzyqr5keD6+DBh6Q+DAOvc5yTjGAqk0aB3Z0w413ftf5+IY0j9PUVl1o6ks4nmSvhcO4/dJWGPTVeNr8uIHenEg43CbnMLlgDT3Folq5AWUpHTkhwR/eNRr/mu9WpbcwjQ2HjJDI4V1oKWUitSn7DW7ZSbh56HkspaaMUAVOXIHut9Ja4s0Yg47baQqiCT2e4LFFERitjUM+YrM+qtnVT/4GFiEsGH8SE0Rh/YAjyn3rlu3PE1rMehxqhNBF/ppa+wWL9/toAYuO2O8Vi0JoANok3I6zZPd7smkBErPxcKJUZ5OAMOHvdkn4fLYyLvyHuF1XOSOFvioox6YCT/pOen9EnRuq2VprUdrHpflwFhsWv7k1l4et8C0rU4k93Vy1pmt7KAM6w865ZUd3O6kdeGm7xjff5992p+vF7thoF2T1/sFuyl3DRz+S/HjP41F936q5OWxb/cA3Lge2wOsZuXl/WR2MyYjgJLf7akPIJ6wVxGtU/LX9i0zQ1CvHTHqJNNk++V6LFt8/h/rEb8LzpqE1BKvhuj1lff1Jqr53a9jlK6wrIgqwf+FnoKscYawTyXImjnHmxI9eriIiULSgmTgJ/dfvt7PhwJWauls0vD1NQ4ltK7UVQ8MCQChDnWe2UBRwUoBFC94pFKFV3IZLsCNhsTXG1Nlw9NCsCS5UkaDimDRL+kTtvAu1pKxJciFZ85MbsFJA1KKNcoiBvD1u4HTbH7xWgiUJWVFgJxNhb56xShjqVA+crGQLltcy6KFvjQxrMtdaeDoE9YcAM67ufIaGb7E1oMcd7KZ/MJb54Qv1uGHggk8MtrBBB907HHezLX3gDKXnpGp+RsS3G/QmbjhZVvltqDn4OJpLUFUnSRS3t7DDSFX23miC6c2mg1bsCZMiUWz+OZMkZTVKXVSOrIDNtjKMhgKb7akhRkSRd/p8Qm8Dbrb1RcTP83McmXcl747OmDNPZD2Vw5Myo3VNb3kqHT3lLeDGfNMzhl2eD8PeSVy2Ezl4D+1u7qahDx4q2L5Dab/cL33gjMcXBVGOzDzEDdJ7YZSkzeNL9NojWrmlunXDh0lAMTVyragGZSmuGliKTMq1x8xreAgO0CFzi2UpqpDKI3J4CMnVcmAfrhZSAQotPQsqB5JwiIOgSwnXU9INbCZ08Ki7RoUJ5tSawnSq3Gja8QI3jPjjPEVTbY8j1b7IXLCZS58brjVqMgqtwgBT5fT6fU3Cn3aGNV1sbXvEGYQJi+e3oy/M6Vfzndwoi5lADYz1R5zVEscHk2XU5QS29BszcqeY+rxnO04e6PX7LGJ5OjbTJ+p8d6LrYaLv4J1ajE3IzdiGPIZo6LNoizWCJIQ+jmJ3TKrvS3JCAti9Fb81kyPVkhF0FYqh9DxR6jSoo2GzRh9ZsCFGTI1k9WybKJ9KlKFQ5ZC97QOPKjxZ7Edfoj+Ybl+Y7o4usvYHm0CWYwOmRfGCCj5cQ7Q6p6QAhLp0myFXORPGEQ5mOiAVAbI4OMozgOywZhBjMBffFQbPjxvilVxtJkEEAEJhUSm3YJXgOsvCrcchodF7VGvXeKY13dJQezRWP756az0GWa6sXashONb5jjTFdQTKrmmZtMFrSLtpkZ1KmjWIYxDZvHWgOxdW5VOJv5CDLDePjZT+4OS9+hQy2aFK1ZvTziBjpz7MrsVD34Z4CV+xTeomUfHfPfZVnw4ixR/yFnHB+I7RgJsi8t93baeny3Ra4x2gTihF9s1wqlk9O82Hl/DG8CVQ6VDZL2iEPbbGzl6RepWhxy8OZ5IaaArefmeOBjh0R++JvDnDBXDrErzO3vvMVI3XrdUyB4qQDWse59UZBdX7t7UqClcp8ypgbYGSj2S6hV1q21+PAJ3hUJouIy+/zRgmDgJccJBHkzv4fGGv9PEhwVvGK1MhDwjwwrCMD3wgWax+20k7wQHQW1Td4buQzmYIqB204ilcBhAXPARyfJGtKLXIf2QVyTXqcBrGj1wYKOhR2NNFPVBBgJZ9FKuFA3UswxHkEG9ierqHjpcnrtI87TzCkoXOfeA1z5XfJM+tHb5mH15r9t1i9ZY6yz6gE9zu+s8Um1efeTHfqVmplfZJdYyIGEXu6BFleKNdv5Kgcukl4OMz3GvNb4IL0qVL1xhrMCYeVPtwU12cnJE0DBssBMv1NVzWeVGjwQtfx6dbkBPDkE4Haf+gwcVbhdzuv9UVPmxtWfcm5m+ktMLzOL7fAtoAzAnadFY2xXon13S2UGmBeYrjEuNTB6m+qGy3RTXg92T0gpTymz+X3o5xTiPeEDu13cJOH93iplznDedEhn+Q6Sxw98Knpt3wyLyd66zu64j6EEPh9ofG12735A/KSY9/796Geq0xszL++IQlAlXdYI2CWjxT3wLy86fdfUjc0ct2s1j7K0d6303GJwG4GK6/l/nTPMvm35QtSswviy2LS/xfU1wpm2Cg/GOWzyS4o///WdOvfX3ZxWN/FfKeQmlWNwCy+yVLUZYvvD+FAyxZXBFPS7tWnBFV6guQ9Mp5uwhTka4Vp/N3jt9pbxdD+ncb8/myDMPAbz+K4FiY8czYU8E4Rpxv4BSMr/bdoT0MIVixxA3lU0xuWX4Gb2ZX6CDtfFeUMC8ND5n4jvccxWIWMA6uWhK9tCXZHP8G/o++OHtlgs13u4OW3WxQe3F0IwqhT6CzvAq9kDfpJzsEHLPB50OuKSVxEa4doGsYqlteFK8C9QGYA9SXATg+A4wh8JgBkQ25ysyp4vJPTBvwcpiRq8Se+cfXAwzxE/5aaZCsFzZj9uViPYlHuQrARpg4IvHdIsxwRIdneAUuzgjyPDsj4/ftjJwYc2cUzoZrlnlTEmEmkj4Vz4iGp7MzT0tOMzPP0GaYmWeJmfbBz4nKWvd9J8OkZ8G4wp5Og/q5qIBITwvjehC14XAHCy8TKzz8JEv0k4Rb7M2M4GHm5edbK6M6sVCbCNdcMNZ2snN0VL8krAKt3kKt7jhdJuoSdiSxSLP02wW4GHmip3bj2hpN7W6desKigdehvYX5hVhXTbWX7efk5fFtBFGM5x7zu6hAreryRlnpIdZWq1LffYCbUa/wcmFjXRcnUz7WRTp68bqq1TqXHc/Fyuh3kQDT1mUk3rVyKMnia/osIUwx/UUzyW1lc2qEkaw8WkqiX1nKhjxOerHyIBU5OB5AUB7nEydzaXTVOridoR1lzO1OtoQPHQ0i0PUsBJI7QuLCNicg5SaVZMRsRIs8ERKPGmnm5qJZqkYDpa5GJ900JMPzrK00FAt7N3FRm7bdXKaNx00UFUtTTfInYbqpTRhW1btaWo3XiZlGNbRCF5PniY2xOilpLAIgAt2qAXXtJH0CnPzlW3H9Pdv3Gz4ao2anDAEl+nux37yMnIKSSoRIUaKJYsSK+/3MP6tESZKlSJUmXYZMWbLlYHLlyVegUJFiJUqVKVehkprG7b31qlSrUatOvVc/6ibNWrRq065Dpy7dehgMM9wII40y2hhjjTPeBBM7v2qTTTHVNNPNMNMss80x1zzzGUPAOTU2u6jJtI122K7FL9pDhq0eWWePhpBjsys+dNJx8+YsOOykG55yUyaz3dSeY/W0Z730e4x/Ui/6is1rXvaKW3L8aJd7XvcGh298Zwstp97yXetxWpE+vsopAp29Flrka4stteR3Xf88LXe3Q9ZbabVqs753r9N+c94D74QRKUlFERRJURRNIsVQLFmRNeGJgEFdev1uyO16XLXJr5GEB12OZCJhe6QShajyHNcSn0O3VuFxauV2iys7tI5c6KwR+kyH5XV5fb4qX13Szdfm6/L1+YZcR02nhYvqIjROe8BvtRj7HdMr9IZsjUHoCfi97Lo7hq7Q0OmCzb+x8W4Kb4B2CLlZjZ8+QLRzbGDnjyD3E6tHBbcHgh9u9Yws5OWzpyMYrCfI5d3BnvXc2+nlANcmA88P0pkeDlfydhyvHBpwunKMwfmKKXKeghVUYQq2upUO8IaFA9S69SdRrlYnpqtlnswOrRhvh02N8hRLUxnUxcEiMlxfVVVTZgS3S0DD5icWAg==&quot;</span>) <span class="built_in">format</span>(<span class="string">&quot;woff2&quot;</span>)</span><br><span class="line">  <span class="attribute">font-weight</span>: normal</span><br><span class="line">  <span class="attribute">font-style</span>: normal</span><br></pre></td></tr></table></figure><h2 id="3-添加参数控制"><a href="#3-添加参数控制" class="headerlink" title="3. 添加参数控制"></a>3. 添加参数控制</h2><p>因为就想这个名片能显示在文章内就好，最好还能用front_matter参数控制，所以修改<code>[Blogroot]\themes\butterfly\layout\post.pug</code></p><figure class="highlight diff"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">  extends includes/layout.pug</span><br><span class="line"></span><br><span class="line">  block content</span><br><span class="line">    #post</span><br><span class="line">      if top_img <span class="comment">=== false</span></span><br><span class="line">        include includes/header/post-info.pug</span><br><span class="line">      article#article-container.post-content!=page.content</span><br><span class="line"><span class="addition">+     if page.businesscard ? page.businesscard : theme.businesscard.enable</span></span><br><span class="line"><span class="addition">+       include includes/custom/businesscard.pug</span></span><br><span class="line">      include includes/post/post-copyright.pug</span><br><span class="line">      .tag_share</span><br></pre></td></tr></table></figure><h2 id="4-添加配置项"><a href="#4-添加配置项" class="headerlink" title="4. 添加配置项"></a>4. 添加配置项</h2><p>在主题配置文件<code>[Blogroot]\_config.butterfly.yml</code>里添加配置项</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">businesscard:</span></span><br><span class="line">  <span class="attr">enable:</span> <span class="literal">true</span> <span class="comment">#总开关</span></span><br><span class="line">  <span class="attr">master:</span> <span class="string">RandomEnch</span> <span class="comment">#群主ID</span></span><br><span class="line">  <span class="attr">QR_code:</span> <span class="string">https://cdn.randench.cn/assets/xly.png</span></span><br><span class="line">  <span class="attr">group:</span> <span class="number">591979974</span> <span class="comment">#QQ群号</span></span><br><span class="line">  <span class="attr">created:</span> <span class="number">03</span><span class="string">/09/2020</span> <span class="comment">#建群时间</span></span><br><span class="line">  <span class="attr">front:</span> <span class="string">Welcome</span> <span class="string">to</span> <span class="string">XLYStudio</span> <span class="comment">#卡面正面描述语</span></span><br><span class="line">  <span class="attr">back1:</span> <span class="string">sitelink</span> <span class="comment">#背面从上到下四行文字内容自定义</span></span><br><span class="line">  <span class="attr">back2:</span> <span class="string">&lt;a</span> <span class="string">target=&quot;_blank&quot;</span> <span class="string">color=&quot;#49b1f5&quot;</span> <span class="string">href=&quot;https://jq.qq.com/?_wv=1027&amp;k=yRXysDsI&quot;&gt;加入群聊【XLY</span> <span class="string">Studio】&lt;/a&gt;</span></span><br><span class="line">  <span class="attr">back3:</span> <span class="string">Use</span> <span class="string">this</span> <span class="string">card</span> <span class="string">to</span> <span class="string">join</span> <span class="string">the</span> <span class="string">XLYStudio</span> <span class="string">and</span> <span class="string">participate</span> <span class="string">in</span> <span class="string">a</span> <span class="string">pleasant</span> <span class="string">discussion</span> <span class="string">together</span> <span class="string">.</span></span><br><span class="line">  <span class="attr">back4:</span> <span class="string">Welcome</span> <span class="string">to</span> <span class="string">RandomEnch&#x27;s</span> <span class="string">Blog</span> <span class="string">,</span> <span class="string">wish</span> <span class="string">you</span> <span class="string">a</span> <span class="string">nice</span> <span class="string">day</span> <span class="string">.</span></span><br></pre></td></tr></table></figure><h2 id="5-在想要添加名片的文章的front-matter里添加配置项"><a href="#5-在想要添加名片的文章的front-matter里添加配置项" class="headerlink" title="5. 在想要添加名片的文章的front-matter里添加配置项"></a>5. 在想要添加名片的文章的front-matter里添加配置项</h2><figure class="highlight diff"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">---</span></span><br><span class="line">  title: 博客美化记录</span><br><span class="line"></span><br><span class="line">  ......</span><br><span class="line"></span><br><span class="line"><span class="addition">+ businesscard: true</span></span><br><span class="line"><span class="comment">---</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Hexo </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 美化 </tag>
            
            <tag> 魔改 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>博客侧边栏添加那年今日</title>
      <link href="//posts/28169/"/>
      <url>//posts/28169/</url>
      
        <content type="html"><![CDATA[<div class="note warning flat"><p>本文修改主题为<code>Butterfly</code>主题，若使用其他主题，请自行确认修改位置。</p></div><h1 id="原文出处"><a href="#原文出处" class="headerlink" title="原文出处"></a>原文出处</h1><blockquote><p><a href="https://zfe.space/post/history-card.html">https://zfe.space/post/history-card.html</a></p></blockquote><h1 id="效果预览"><a href="#效果预览" class="headerlink" title="效果预览"></a>效果预览</h1><details class="folding-tag" ><summary> 查看图片 </summary>              <div class='content'>              <p><img src="https://cdn.randench.cn/image/24/08/e0f48dee481378f3.png" alt="history-card"></p>              </div>            </details><h1 id="修改步骤"><a href="#修改步骤" class="headerlink" title="修改步骤"></a>修改步骤</h1><h2 id="1-新建文件"><a href="#1-新建文件" class="headerlink" title="1. 新建文件"></a>1. 新建文件</h2><p>新建<code>[Blogroot]\themes\butterfly\layout\includes\widget\card_history.pug</code></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">if theme.aside.card_history.enable</span><br><span class="line">  .card-widget.card-history</span><br><span class="line">    .card-content</span><br><span class="line">      .item-headline</span><br><span class="line">        i.fas.fa-clock.fa-spin</span><br><span class="line">        span= _p(&#x27;那年今日&#x27;)</span><br><span class="line">      #history-baidu(style=&#x27;height: 100px;overflow: hidden;&#x27;)</span><br><span class="line">        #history-container.history_swiper-container(style=&quot;width: 100%;height: 100%;&quot;)</span><br><span class="line">            #history_container_wrapper.swiper-wrapper(style=&quot;height:20px&quot; )</span><br></pre></td></tr></table></figure><h2 id="2-修改文件"><a href="#2-修改文件" class="headerlink" title="2. 修改文件"></a>2. 修改文件</h2><p>修改<code>[Blogroot]\themes\butterfly\layout\includes\widget\index.pug</code></p><figure class="highlight diff"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">    if showToc &amp;&amp; tocStyleVal</span><br><span class="line">      .sticky_layout</span><br><span class="line">        include ./card_post_toc.pug</span><br><span class="line">    else</span><br><span class="line">      !=partial(&#x27;includes/widget/card_author&#x27;, &#123;&#125;, &#123;cache: true&#125;)</span><br><span class="line">      !=partial(&#x27;includes/widget/card_announcement&#x27;, &#123;&#125;, &#123;cache: true&#125;)</span><br><span class="line">      !=partial(&#x27;includes/widget/card_top_self&#x27;, &#123;&#125;, &#123;cache: true&#125;)</span><br><span class="line"><span class="addition">+     !=partial(&#x27;includes/widget/card_history&#x27;, &#123;&#125;, &#123;cache: true&#125;)</span></span><br><span class="line">      .sticky_layout</span><br><span class="line">        if showToc</span><br><span class="line">          include ./card_post_toc.pug</span><br><span class="line">        if page.series</span><br><span class="line">          include ./card_post_series.pug</span><br><span class="line">        !=partial(&#x27;includes/widget/card_recent_post&#x27;, &#123;&#125;, &#123;cache: true&#125;)</span><br><span class="line">        !=partial(&#x27;includes/widget/card_ad&#x27;, &#123;&#125;, &#123;cache: true&#125;)</span><br><span class="line">  else</span><br><span class="line">    //- page</span><br><span class="line">    !=partial(&#x27;includes/widget/card_author&#x27;, &#123;&#125;, &#123;cache: true&#125;)</span><br><span class="line">    !=partial(&#x27;includes/widget/card_announcement&#x27;, &#123;&#125;, &#123;cache: true&#125;)</span><br><span class="line">    !=partial(&#x27;includes/widget/card_top_self&#x27;, &#123;&#125;, &#123;cache: true&#125;)</span><br><span class="line"><span class="addition">+   !=partial(&#x27;includes/widget/card_history&#x27;, &#123;&#125;, &#123;cache: true&#125;)</span></span><br><span class="line"></span><br><span class="line">    .sticky_layout</span><br><span class="line">      if showToc</span><br><span class="line">        include ./card_post_toc.pug</span><br><span class="line">      !=partial(&#x27;includes/widget/card_recent_post&#x27;, &#123;&#125;, &#123;cache: true&#125;)</span><br><span class="line">      !=partial(&#x27;includes/widget/card_ad&#x27;, &#123;&#125;, &#123;cache: true&#125;)</span><br><span class="line">      !=partial(&#x27;includes/widget/card_newest_comment&#x27;, &#123;&#125;, &#123;cache: true&#125;)</span><br><span class="line">      !=partial(&#x27;includes/widget/card_categories&#x27;, &#123;&#125;, &#123;cache: true&#125;)</span><br><span class="line">      !=partial(&#x27;includes/widget/card_tags&#x27;, &#123;&#125;, &#123;cache: true&#125;)</span><br><span class="line">      !=partial(&#x27;includes/widget/card_archives&#x27;, &#123;&#125;, &#123;cache: true&#125;)</span><br><span class="line">      !=partial(&#x27;includes/widget/card_webinfo&#x27;, &#123;&#125;, &#123;cache: true&#125;)</span><br><span class="line">      !=partial(&#x27;includes/widget/card_bottom_self&#x27;, &#123;&#125;, &#123;cache: true&#125;)</span><br></pre></td></tr></table></figure><h2 id="3-引入样式"><a href="#3-引入样式" class="headerlink" title="3. 引入样式"></a>3. 引入样式</h2><p>在<code>[Blogroot]\_config.butterfly.yml</code>中引入</p><div class="tip warning faa-horizontal animated-hover"><p>注意：此 js 每页都需要加载 ，故插入 js 时应当加入 data-pjax 标签排除 pjax</p></div><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">inject:</span></span><br><span class="line">  <span class="attr">head:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">&lt;link</span> <span class="string">rel=&quot;stylesheet&quot;</span> <span class="string">href=&quot;https://cdn.jsdelivr.net/npm/swiper/swiper-bundle.min.css&quot;&gt;</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">&lt;link</span> <span class="string">rel=&quot;stylesheet&quot;</span> <span class="string">href=&quot;https://cdn.jsdelivr.net/gh/Zfour/Butterfly-card-history/baiduhistory/css/main.css&quot;&gt;</span></span><br><span class="line">  <span class="attr">bottom:</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">&lt;script</span> <span class="string">src=&quot;https://cdn.jsdelivr.net/npm/swiper/swiper-bundle.min.js&quot;&gt;&lt;/script&gt;</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">&lt;script</span> <span class="string">src=&quot;https://cdn.jsdelivr.net/gh/Zfour/Butterfly-card-history/baiduhistory/js/main.js&quot;&gt;&lt;/script&gt;</span></span><br></pre></td></tr></table></figure><p>修改<code>[Blogroot]\_config.butterfly.yml</code></p><figure class="highlight diff"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">aside:</span><br><span class="line">  enable: true</span><br><span class="line">  hide: false</span><br><span class="line">  button: true</span><br><span class="line">  mobile: true # display on mobile</span><br><span class="line">  position: right # left or right</span><br><span class="line">  display:</span><br><span class="line">    archive: true</span><br><span class="line">    tag: true</span><br><span class="line">    category: true</span><br><span class="line"><span class="addition">+ card_history:</span></span><br><span class="line"><span class="addition">+   enable: true</span></span><br><span class="line">  card_author:</span><br><span class="line">    enable: true</span><br><span class="line">    description:</span><br></pre></td></tr></table></figure><h2 id="4-自定义样式"><a href="#4-自定义样式" class="headerlink" title="4. 自定义样式"></a>4. 自定义样式</h2><p>根据博客样式修改自定义的<code>index.css</code>中的样式</p><p>由于直接用jsdiliver插入css样式，而原本样式定义了背景颜色，可能与博客背景冲突，若与博客的颜色不和，则可以自定义其背景样式并插入CSS来解决</p><figure class="highlight css"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.history_slide</span> &#123;</span><br><span class="line">    <span class="attribute">background</span>: <span class="number">#fff0</span> <span class="meta">!important</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><figure class="highlight diff"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">inject:</span><br><span class="line">  head:</span><br><span class="line"><span class="addition">+   - &lt;link rel=&quot;stylesheet&quot; href=&quot;/style/custom_css.css&quot;&gt;</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Hexo </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 美化 </tag>
            
            <tag> 魔改 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>文章页面上下篇按钮UI调整</title>
      <link href="//posts/7195/"/>
      <url>//posts/7195/</url>
      
        <content type="html"><![CDATA[<div class="note warning flat"><p>本文修改主题为<code>Butterfly</code>主题，若使用其他主题，请自行确认修改位置。</p></div><h1 id="原文出处"><a href="#原文出处" class="headerlink" title="原文出处"></a>原文出处</h1><blockquote><p><a href="https://akilar.top/posts/b77e1c58/">https://akilar.top/posts/b77e1c58/</a></p></blockquote><h1 id="效果预览"><a href="#效果预览" class="headerlink" title="效果预览"></a>效果预览</h1><details class="folding-tag" ><summary> 查看图片 </summary>              <div class='content'>              <p><img src="https://cdn.randench.cn/image/24/08/a86916f8de5f993d.png" alt="PC效果"><br><img src="https://cdn.randench.cn/image/24/08/415583e6e3e4df92.png" alt="Mobile效果"></p>              </div>            </details><h1 id="修改步骤"><a href="#修改步骤" class="headerlink" title="修改步骤"></a>修改步骤</h1><h2 id="1-修改文件"><a href="#1-修改文件" class="headerlink" title="1. 修改文件"></a>1. 修改文件</h2><p>修改 <code>[Blogroot]\themes\butterfly\layout\includes\pagination.pug</code>,调整布局。</p><figure class="highlight diff"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">if is_post()</span><br><span class="line">    - let prev = theme.post_pagination <span class="comment">=== 1 ? page.prev : page.next</span></span><br><span class="line">    - let next = theme.post_pagination <span class="comment">=== 1 ? page.next : page.prev</span></span><br><span class="line">    nav#pagination.pagination-post</span><br><span class="line">      if(prev)</span><br><span class="line">        - var hasPageNext = next ? &#x27;pull-left&#x27; : &#x27;pull-full&#x27;</span><br><span class="line">        .prev-post(class=hasPageNext)</span><br><span class="line">          - var pagination_cover = prev.cover <span class="comment">=== false ? prev.randomcover : prev.cover</span></span><br><span class="line"><span class="deletion">-         a(href=url_for(prev.path))</span></span><br><span class="line"><span class="addition">+         a(href=url_for(prev.path) title=prev.title )</span></span><br><span class="line"><span class="addition">+           i.fas.fa-chevron-left.prev-icon</span></span><br><span class="line"><span class="addition">+             .prev-label=_p(&#x27;pagination.prev&#x27;)</span></span><br><span class="line"><span class="addition">+         .pagination-card</span></span><br><span class="line">            img.prev-cover(src=url_for(pagination_cover) onerror=`onerror=null;src=&#x27;$&#123;url_for   (theme.error_img.post_page)&#125;&#x27;` alt=&#x27;cover of previous post&#x27;)</span><br><span class="line">            .pagination-info</span><br><span class="line">              .label=_p(&#x27;pagination.prev&#x27;)</span><br><span class="line">              .prev_info=prev.title</span><br><span class="line"></span><br><span class="line">      if(next)</span><br><span class="line">        - var hasPagePrev = prev ? &#x27;pull-right&#x27; : &#x27;pull-full&#x27;</span><br><span class="line">        - var pagination_cover = next.cover == false ? next.randomcover : next.cover</span><br><span class="line">        .next-post(class=hasPagePrev)</span><br><span class="line"><span class="deletion">-         a(href=url_for(next.path))</span></span><br><span class="line"><span class="addition">+         a(href=url_for(next.path) title=next.title )</span></span><br><span class="line"><span class="addition">+           i.fas.fa-chevron-right.next-icon</span></span><br><span class="line"><span class="addition">+             .next-label=_p(&#x27;pagination.next&#x27;)</span></span><br><span class="line"><span class="addition">+         .pagination-card</span></span><br><span class="line">            img.next-cover(src=url_for(pagination_cover) onerror=`onerror=null;src=&#x27;$&#123;url_for   (theme.error_img.post_page)&#125;&#x27;` alt=&#x27;cover of next post&#x27;)</span><br><span class="line">            .pagination-info</span><br><span class="line">              .label=_p(&#x27;pagination.next&#x27;)</span><br><span class="line">              .next_info=next.title</span><br></pre></td></tr></table></figure><h2 id="2-新建文件"><a href="#2-新建文件" class="headerlink" title="2. 新建文件"></a>2. 新建文件</h2><p>新建 <code>[Blogroot]\themes\butterfly\source\css\_layout\fixed-pagination.styl</code></p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 电脑端悬停按钮样式</span></span><br><span class="line"><span class="selector-id">#pagination</span></span><br><span class="line">  <span class="selector-class">.prev-post</span> <span class="selector-tag">a</span>,</span><br><span class="line">  <span class="selector-class">.next-post</span> <span class="selector-tag">a</span></span><br><span class="line">    <span class="attribute">z-index</span> <span class="number">99</span></span><br><span class="line">    <span class="attribute">display</span> flex<span class="meta">!important</span></span><br><span class="line">    <span class="attribute">overflow</span> hidden</span><br><span class="line">    <span class="attribute">height</span> <span class="number">150px</span></span><br><span class="line">    <span class="attribute">position</span> fixed<span class="meta">!important</span></span><br><span class="line">    <span class="attribute">top</span> <span class="number">45%</span></span><br><span class="line">    <span class="attribute">background</span> <span class="built_in">rgba</span>(<span class="number">0</span>,<span class="number">0</span>,<span class="number">0</span>,<span class="number">0.6</span>)</span><br><span class="line">    <span class="attribute">width</span> <span class="number">65px</span></span><br><span class="line">    <span class="attribute">font-size</span> <span class="number">65px</span></span><br><span class="line">    <span class="attribute">align-content</span> space-around</span><br><span class="line">    <span class="attribute">color</span> white</span><br><span class="line">    <span class="attribute">border-radius</span> <span class="number">10px</span></span><br><span class="line">    <span class="attribute">align-items</span> center</span><br><span class="line">    <span class="attribute">justify-content</span> space-around</span><br><span class="line"></span><br><span class="line">  <span class="selector-class">.prev-post</span> <span class="selector-class">.prev-label</span>,</span><br><span class="line">  <span class="selector-class">.next-post</span> <span class="selector-class">.next-label</span></span><br><span class="line">    <span class="attribute">display</span> none</span><br><span class="line">  <span class="selector-class">.prev-post</span></span><br><span class="line">    <span class="selector-tag">a</span></span><br><span class="line">      <span class="attribute">left</span> <span class="number">45px</span></span><br><span class="line">  <span class="selector-class">.next-post</span></span><br><span class="line">    <span class="selector-tag">a</span></span><br><span class="line">      <span class="attribute">right</span> <span class="number">45px</span></span><br><span class="line"><span class="comment">// 电脑端悬停卡片样式</span></span><br><span class="line"><span class="keyword">@media</span> screen <span class="keyword">and</span> (<span class="attribute">min-width</span>: <span class="number">768px</span>)</span><br><span class="line">  #pagination</span><br><span class="line">    .pagination-card</span><br><span class="line">      z-index <span class="number">99</span></span><br><span class="line">      display none</span><br><span class="line">      position fixed</span><br><span class="line">      top <span class="number">0</span></span><br><span class="line">      left <span class="number">0</span></span><br><span class="line">      right <span class="number">0</span></span><br><span class="line">      bottom <span class="number">0</span></span><br><span class="line">      margin auto</span><br><span class="line">      <span class="attribute">height</span> <span class="number">150px</span></span><br><span class="line">      <span class="attribute">width</span> <span class="number">400px</span></span><br><span class="line">      background rgba(<span class="number">66</span> , <span class="number">66</span>, <span class="number">66</span>, <span class="number">0.9</span>)</span><br><span class="line">      img</span><br><span class="line">        z-index <span class="number">100</span></span><br><span class="line">        position absolute</span><br><span class="line">        <span class="attribute">width</span> <span class="number">120px</span>!important</span><br><span class="line">        <span class="attribute">height</span> <span class="number">120px</span>!important</span><br><span class="line">        top <span class="number">15px</span>!important</span><br><span class="line">        opacity <span class="number">0.9</span>!important</span><br><span class="line">        border-radius <span class="number">50%</span></span><br><span class="line">      .pagination-info</span><br><span class="line">        position absolute</span><br><span class="line">        padding <span class="number">0</span> <span class="number">0</span> <span class="number">0</span>!important</span><br><span class="line">        top <span class="number">0px</span></span><br><span class="line">        <span class="attribute">width</span> calc( <span class="number">100%</span> - <span class="number">150px</span> )</span><br><span class="line">        <span class="attribute">height</span> <span class="number">200px</span></span><br><span class="line">        display flex</span><br><span class="line">        flex-direction column</span><br><span class="line">        transform unset!important</span><br><span class="line">        .prev_info,</span><br><span class="line">        .next_info</span><br><span class="line">          <span class="attribute">width</span> <span class="number">100%</span></span><br><span class="line">          <span class="attribute">height</span> <span class="number">75px</span></span><br><span class="line">          display flex</span><br><span class="line">          flex-direction column</span><br><span class="line">          align-items center</span><br><span class="line">          justify-content space-around</span><br><span class="line">        .label</span><br><span class="line">          <span class="attribute">width</span> <span class="number">100%</span></span><br><span class="line">          <span class="attribute">height</span> <span class="number">75px</span></span><br><span class="line">          display flex</span><br><span class="line">          flex-direction column</span><br><span class="line">          align-items center</span><br><span class="line">          justify-content space-around</span><br><span class="line">          &amp;::before</span><br><span class="line">            content &quot;&quot;</span><br><span class="line">            <span class="attribute">width</span> <span class="number">90%</span></span><br><span class="line">            <span class="attribute">height</span> <span class="number">2px</span></span><br><span class="line">            top <span class="number">40%</span></span><br><span class="line">            background white</span><br><span class="line">            position absolute</span><br><span class="line">    .prev-post</span><br><span class="line">      .pagination-card</span><br><span class="line">        flex-direction column</span><br><span class="line">        align-items center</span><br><span class="line">        border-top-left-radius <span class="number">75px</span></span><br><span class="line">        border-top-right-radius <span class="number">10px</span></span><br><span class="line">        border-bottom-left-radius <span class="number">75px</span></span><br><span class="line">        border-bottom-right-radius <span class="number">10px</span></span><br><span class="line">        img</span><br><span class="line">          left <span class="number">15px</span>!important</span><br><span class="line">        .pagination-info</span><br><span class="line">          left <span class="number">150px</span></span><br><span class="line"></span><br><span class="line">    .next-post</span><br><span class="line">      .pagination-card</span><br><span class="line">        flex-direction column</span><br><span class="line">        align-items center</span><br><span class="line">        border-top-left-radius <span class="number">10px</span></span><br><span class="line">        border-top-right-radius <span class="number">75px</span></span><br><span class="line">        border-bottom-left-radius <span class="number">10px</span></span><br><span class="line">        border-bottom-right-radius <span class="number">75px</span></span><br><span class="line">        img</span><br><span class="line">          right <span class="number">15px</span>!important</span><br><span class="line">        .pagination-info</span><br><span class="line">          right <span class="number">150px</span></span><br><span class="line"></span><br><span class="line">// 手机端样式</span><br><span class="line">@media screen <span class="keyword">and</span> (<span class="attribute">max-width</span>: <span class="number">768px</span>)</span><br><span class="line">  #pagination</span><br><span class="line">    .prev-post</span><br><span class="line">      a</span><br><span class="line">        <span class="attribute">height</span> <span class="number">45px</span> !important</span><br><span class="line">        <span class="attribute">width</span> <span class="number">100px</span></span><br><span class="line">        top <span class="number">35%</span></span><br><span class="line">        font-size <span class="number">20px</span></span><br><span class="line">        border-radius <span class="number">10px</span></span><br><span class="line">        padding <span class="number">5px</span></span><br><span class="line">        left <span class="number">0px</span></span><br><span class="line">        border-top-left-radius <span class="number">0px</span></span><br><span class="line">        border-top-right-radius <span class="number">22.5px</span></span><br><span class="line">        border-bottom-left-radius <span class="number">0px</span></span><br><span class="line">        border-bottom-right-radius <span class="number">22.5px</span></span><br><span class="line">        i</span><br><span class="line">          &amp;::before</span><br><span class="line">            content &quot;\f101&quot;</span><br><span class="line">      .prev-label</span><br><span class="line">        display inline-block</span><br><span class="line">        font-size <span class="number">20px</span></span><br><span class="line">        float left</span><br><span class="line">        margin-right <span class="number">5px</span></span><br><span class="line"></span><br><span class="line">    .next-post</span><br><span class="line">      a</span><br><span class="line">        <span class="attribute">height</span> <span class="number">45px</span> !important</span><br><span class="line">        <span class="attribute">width</span> <span class="number">100px</span></span><br><span class="line">        top <span class="number">35%</span></span><br><span class="line">        font-size <span class="number">20px</span></span><br><span class="line">        border-radius <span class="number">10px</span></span><br><span class="line">        padding <span class="number">5px</span></span><br><span class="line">        right <span class="number">0px</span></span><br><span class="line">        border-top-left-radius <span class="number">22.5px</span></span><br><span class="line">        border-top-right-radius <span class="number">0px</span></span><br><span class="line">        border-bottom-left-radius <span class="number">22.5px</span></span><br><span class="line">        border-bottom-right-radius <span class="number">0px</span></span><br><span class="line">        i</span><br><span class="line">          &amp;::before</span><br><span class="line">            content &quot;\f100&quot;</span><br><span class="line">      .next-label</span><br><span class="line">        display inline-block</span><br><span class="line">        font-size <span class="number">20px</span></span><br><span class="line">        float right</span><br><span class="line">        margin-left <span class="number">5px</span></span><br><span class="line">    .pagination-card</span><br><span class="line">      z-index <span class="number">99</span></span><br><span class="line">      display none</span><br><span class="line">      position fixed</span><br><span class="line">      top <span class="number">0</span></span><br><span class="line">      left <span class="number">0</span></span><br><span class="line">      right <span class="number">0</span></span><br><span class="line">      bottom <span class="number">0</span></span><br><span class="line">      margin auto</span><br><span class="line">      <span class="attribute">height</span> <span class="number">300px</span></span><br><span class="line">      <span class="attribute">width</span> <span class="number">90px</span></span><br><span class="line">      background rgba(<span class="number">66</span> , <span class="number">66</span>, <span class="number">66</span>, <span class="number">0.9</span>)</span><br><span class="line">      flex-direction column</span><br><span class="line">      align-items center</span><br><span class="line">      border-radius <span class="number">10px</span></span><br><span class="line">      border-top-left-radius <span class="number">45px</span></span><br><span class="line">      border-top-right-radius <span class="number">45px</span></span><br><span class="line">      border-bottom-left-radius <span class="number">10px</span></span><br><span class="line">      border-bottom-right-radius <span class="number">10px</span></span><br><span class="line">      img</span><br><span class="line">        z-index <span class="number">100</span></span><br><span class="line">        position absolute</span><br><span class="line">        <span class="attribute">width</span> <span class="number">70px</span>!important</span><br><span class="line">        <span class="attribute">height</span> <span class="number">70px</span>!important</span><br><span class="line">        top <span class="number">10px</span>!important</span><br><span class="line">        opacity <span class="number">0.9</span>!important</span><br><span class="line">        border-radius <span class="number">50%</span></span><br><span class="line">      .pagination-info</span><br><span class="line">        position absolute</span><br><span class="line">        padding <span class="number">0</span> <span class="number">0</span> <span class="number">0</span>!important</span><br><span class="line">        top <span class="number">90px</span></span><br><span class="line">        <span class="attribute">width</span> <span class="number">100%</span></span><br><span class="line">        <span class="attribute">height</span> <span class="number">200px</span></span><br><span class="line">        display flex</span><br><span class="line">        flex-direction row</span><br><span class="line">        justify-content flex-end</span><br><span class="line">        transform unset!important</span><br><span class="line">        .prev_info,</span><br><span class="line">        .next_info</span><br><span class="line">          <span class="attribute">width</span> <span class="number">60%</span>!important</span><br><span class="line">          <span class="attribute">height</span> <span class="number">200px</span></span><br><span class="line">          display block</span><br><span class="line">          writing-mode vertical-rl</span><br><span class="line">          text-align center</span><br><span class="line">        .label</span><br><span class="line">          <span class="attribute">width</span> <span class="number">40%</span></span><br><span class="line">          writing-mode vertical-rl</span><br><span class="line">          text-align start</span><br><span class="line">          &amp;::before</span><br><span class="line">            content &quot;&quot;</span><br><span class="line">            <span class="attribute">width</span> <span class="number">2px</span></span><br><span class="line">            <span class="attribute">height</span> <span class="number">180px</span></span><br><span class="line">            background white</span><br><span class="line">            position absolute</span><br><span class="line">// 夜间模式配色</span><br><span class="line">[data-theme=&quot;dark&quot;]</span><br><span class="line">  #pagination</span><br><span class="line">    .prev-post a,</span><br><span class="line">    .next-post a</span><br><span class="line">      background rgba(<span class="number">255</span>,<span class="number">255</span>,<span class="number">255</span>,<span class="number">0.3</span>)</span><br><span class="line">      <span class="attribute">color</span> rgba(<span class="number">20</span>, <span class="number">20</span>, <span class="number">20</span>,<span class="number">0.8</span>)</span><br><span class="line">// 悬停显示卡片动作</span><br><span class="line">#pagination</span><br><span class="line">  .prev-post,</span><br><span class="line">  .next-post</span><br><span class="line">    a</span><br><span class="line">      &amp;:<span class="attribute">hover</span></span><br><span class="line">        &amp; + .pagination-card</span><br><span class="line">          display flex</span><br></pre></td></tr></table></figure><p>新建 <code>[Blogroot]\themes\butterfly\source\js\fixed-pagination.js</code></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable language_">document</span>.<span class="title function_">addEventListener</span>(<span class="string">&#x27;scroll&#x27;</span>,<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//滚动条高度+视窗高度 = 可见区域底部高度</span></span><br><span class="line">    <span class="keyword">var</span> visibleBottom = <span class="variable language_">window</span>.<span class="property">scrollY</span> + <span class="variable language_">document</span>.<span class="property">documentElement</span>.<span class="property">clientHeight</span>;</span><br><span class="line">    <span class="comment">//可见区域顶部高度</span></span><br><span class="line">    <span class="keyword">var</span> visibleTop = <span class="variable language_">window</span>.<span class="property">scrollY</span>;</span><br><span class="line">    <span class="comment">// 获取翻页按钮容器</span></span><br><span class="line">    <span class="keyword">var</span> pagination = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;pagination&#x27;</span>);</span><br><span class="line">    <span class="comment">// 获取位置监测容器，此处采用评论区</span></span><br><span class="line">    <span class="keyword">var</span> eventlistner = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;post-comment&#x27;</span>);</span><br><span class="line">    <span class="keyword">if</span> (eventlistner&amp;&amp;pagination)&#123;</span><br><span class="line">    <span class="keyword">var</span> centerY = eventlistner.<span class="property">offsetTop</span>+(eventlistner.<span class="property">offsetHeight</span>/<span class="number">2</span>);</span><br><span class="line">    <span class="keyword">if</span>(centerY&gt;visibleTop&amp;&amp;centerY&lt;visibleBottom)&#123;</span><br><span class="line">      pagination.<span class="property">style</span>.<span class="property">display</span> = <span class="string">&#x27;flex&#x27;</span>;</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">      pagination.<span class="property">style</span>.<span class="property">display</span> = <span class="string">&#x27;none&#x27;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><h2 id="3-引入样式"><a href="#3-引入样式" class="headerlink" title="3. 引入样式"></a>3. 引入样式</h2><p>在 <code>[Blogroot]\_config.butterfly.yml</code>的<code>inject</code>配置项引入js就大功告成啦</p><figure class="highlight diff"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">inject:</span><br><span class="line">  head:</span><br><span class="line">  bottom:</span><br><span class="line"><span class="addition">+   - &lt;script src=&quot;/js/fixed-pagination.js&quot; async&gt;&lt;/script&gt;</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Hexo </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 美化 </tag>
            
            <tag> 魔改 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>添加白天夜间模式转换动画</title>
      <link href="//posts/11982/"/>
      <url>//posts/11982/</url>
      
        <content type="html"><![CDATA[<div class="note warning flat"><p>本文修改主题为<code>Butterfly</code>主题，若使用其他主题，请自行确认修改位置。</p></div><h1 id="原文出处"><a href="#原文出处" class="headerlink" title="原文出处"></a>原文出处</h1><blockquote><p><a href="https://akilar.top/posts/d9550c81/">https://akilar.top/posts/d9550c81/</a></p></blockquote><h1 id="效果预览"><a href="#效果预览" class="headerlink" title="效果预览"></a>效果预览</h1><details class="folding-tag" ><summary> 查看图片 </summary>              <div class='content'>              <p><img src="https://cdn.randench.cn/image/24/08/d1a98416af47bea6.gif" alt="转换动画"></p>              </div>            </details><h1 id="修改步骤"><a href="#修改步骤" class="headerlink" title="修改步骤"></a>修改步骤</h1><div class="tabs" id="主题适配"><ul class="nav-tabs"><button type="button" class="tab  active" data-href="主题适配-1">Butterfly 主题适配</button><button type="button" class="tab " data-href="主题适配-2">AnZhiYu主题适配</button></ul><div class="tab-contents"><div class="tab-item-content active" id="主题适配-1"><h2 id="Butterfly-主题适配"><a href="#Butterfly-主题适配" class="headerlink" title="Butterfly 主题适配"></a>Butterfly 主题适配</h2><h3 id="1-新建文件"><a href="#1-新建文件" class="headerlink" title="1. 新建文件"></a>1. 新建文件</h3><p>新建<code>[Blogroot]\themes\butterfly\layout\includes\custom\sun_moon.pug</code>,这部分其实实质上就是一个svg文件，通过js操作它的旋转显隐，淡入淡出实现动画效果</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">svg(aria-hidden=&#x27;true&#x27;, style=&#x27;position:absolute; overflow:hidden; width:0; height:0&#x27;)</span><br><span class="line">  symbol#icon-sun(viewBox=&#x27;0 0 1024 1024&#x27;)</span><br><span class="line">    path(d=&#x27;M960 512l-128 128v192h-192l-128 128-128-128H192v-192l-128-128 128-128V192h192l128-128 128 128h192v192z&#x27;, fill=&#x27;#FFD878&#x27;, p-id=&#x27;8420&#x27;)</span><br><span class="line">    path(d=&#x27;M736 512a224 224 0 1 0-448 0 224 224 0 1 0 448 0z&#x27;, fill=&#x27;#FFE4A9&#x27;, p-id=&#x27;8421&#x27;)</span><br><span class="line">    path(d=&#x27;M512 109.248L626.752 224H800v173.248L914.752 512 800 626.752V800h-173.248L512 914.752 397.248 800H224v-173.248L109.248 512 224 397.248V224h173.248L512 109.248M512 64l-128 128H192v192l-128 128 128 128v192h192l128 128 128-128h192v-192l128-128-128-128V192h-192l-128-128z&#x27;, fill=&#x27;#4D5152&#x27;, p-id=&#x27;8422&#x27;)</span><br><span class="line">    path(d=&#x27;M512 320c105.888 0 192 86.112 192 192s-86.112 192-192 192-192-86.112-192-192 86.112-192 192-192m0-32a224 224 0 1 0 0 448 224 224 0 0 0 0-448z&#x27;, fill=&#x27;#4D5152&#x27;, p-id=&#x27;8423&#x27;)</span><br><span class="line">  symbol#icon-moon(viewBox=&#x27;0 0 1024 1024&#x27;)</span><br><span class="line">    path(d=&#x27;M611.370667 167.082667a445.013333 445.013333 0 0 1-38.4 161.834666 477.824 477.824 0 0 1-244.736 244.394667 445.141333 445.141333 0 0 1-161.109334 38.058667 85.077333 85.077333 0 0 0-65.066666 135.722666A462.08 462.08 0 1 0 747.093333 102.058667a85.077333 85.077333 0 0 0-135.722666 65.024z&#x27;, fill=&#x27;#FFB531&#x27;, p-id=&#x27;11345&#x27;)</span><br><span class="line">    path(d=&#x27;M329.728 274.133333l35.157333-35.157333a21.333333 21.333333 0 1 0-30.165333-30.165333l-35.157333 35.157333-35.114667-35.157333a21.333333 21.333333 0 0 0-30.165333 30.165333l35.114666 35.157333-35.114666 35.157334a21.333333 21.333333 0 1 0 30.165333 30.165333l35.114667-35.157333 35.157333 35.157333a21.333333 21.333333 0 1 0 30.165333-30.165333z&#x27;, fill=&#x27;#030835&#x27;, p-id=&#x27;11346&#x27;)</span><br></pre></td></tr></table></figure><p>新建<code>[Blogroot]\themes\butterfly\source\css\_layout\sun_moon.styl</code></p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.Cuteen_DarkSky</span>,</span><br><span class="line"><span class="selector-class">.Cuteen_DarkSky</span><span class="selector-pseudo">:before</span></span><br><span class="line">  <span class="attribute">content</span> <span class="string">&#x27;&#x27;</span></span><br><span class="line">  <span class="attribute">position</span> fixed</span><br><span class="line">  <span class="attribute">left</span> <span class="number">0</span></span><br><span class="line">  <span class="attribute">right</span> <span class="number">0</span></span><br><span class="line">  <span class="attribute">top</span> <span class="number">0</span></span><br><span class="line">  <span class="attribute">bottom</span> <span class="number">0</span></span><br><span class="line">  <span class="attribute">z-index</span> <span class="number">88888888</span></span><br><span class="line"></span><br><span class="line"><span class="selector-class">.Cuteen_DarkSky</span></span><br><span class="line">  <span class="attribute">background</span> <span class="built_in">linear-gradient</span>(<span class="number">#feb8b0</span>, <span class="number">#fef9db</span>)</span><br><span class="line">  <span class="selector-pseudo">&amp;:before</span></span><br><span class="line">    <span class="attribute">transition</span> <span class="number">2s</span> ease all</span><br><span class="line">    <span class="attribute">opacity</span> <span class="number">0</span></span><br><span class="line">    <span class="attribute">background</span> <span class="built_in">linear-gradient</span>(<span class="number">#4c3f6d</span>, <span class="number">#6c62bb</span>, <span class="number">#93b1ed</span>)</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.DarkMode</span></span><br><span class="line">  <span class="selector-class">.Cuteen_DarkSky</span></span><br><span class="line">    <span class="selector-pseudo">&amp;:before</span></span><br><span class="line">      <span class="attribute">opacity</span> <span class="number">1</span></span><br><span class="line"></span><br><span class="line"><span class="selector-class">.Cuteen_DarkPlanet</span></span><br><span class="line">  <span class="attribute">z-index</span> <span class="number">99999999</span></span><br><span class="line">  <span class="attribute">position</span> fixed</span><br><span class="line">  <span class="attribute">left</span> -<span class="number">50%</span></span><br><span class="line">  <span class="attribute">top</span> -<span class="number">50%</span></span><br><span class="line">  <span class="attribute">width</span> <span class="number">200%</span></span><br><span class="line">  <span class="attribute">height</span> <span class="number">200%</span></span><br><span class="line">  -webkit-<span class="attribute">animation</span> CuteenPlanetMove <span class="number">2s</span> <span class="built_in">cubic-bezier</span>(<span class="number">0.7</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>)</span><br><span class="line">  <span class="attribute">animation</span> CuteenPlanetMove <span class="number">2s</span> <span class="built_in">cubic-bezier</span>(<span class="number">0.7</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>)</span><br><span class="line">  <span class="attribute">transform-origin</span> center bottom</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">@-webkit-keyframes</span> CuteenPlanetMove &#123;</span><br><span class="line">  <span class="number">0%</span> &#123;</span><br><span class="line">    <span class="attribute">transform</span>: <span class="built_in">rotate</span>(<span class="number">0</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  to &#123;</span><br><span class="line">    <span class="attribute">transform</span>: <span class="built_in">rotate</span>(<span class="number">360deg</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">@keyframes</span> CuteenPlanetMove &#123;</span><br><span class="line">  <span class="number">0%</span> &#123;</span><br><span class="line">    <span class="attribute">transform</span>: <span class="built_in">rotate</span>(<span class="number">0</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  to &#123;</span><br><span class="line">    <span class="attribute">transform</span>: <span class="built_in">rotate</span>(<span class="number">360deg</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="selector-class">.Cuteen_DarkPlanet</span></span><br><span class="line">  <span class="selector-pseudo">&amp;:after</span></span><br><span class="line">    <span class="attribute">position</span> absolute</span><br><span class="line">    <span class="attribute">left</span> <span class="number">35%</span></span><br><span class="line">    <span class="attribute">top</span> <span class="number">40%</span></span><br><span class="line">    <span class="attribute">width</span> <span class="number">9.375rem</span></span><br><span class="line">    <span class="attribute">height</span> <span class="number">9.375rem</span></span><br><span class="line">    <span class="attribute">border-radius</span> <span class="number">50%</span></span><br><span class="line">    <span class="attribute">content</span> <span class="string">&#x27;&#x27;</span></span><br><span class="line">    <span class="attribute">background</span> <span class="built_in">linear-gradient</span>(<span class="number">#fefefe</span>, <span class="number">#fffbe8</span>)</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.search</span></span><br><span class="line">  <span class="selector-tag">span</span></span><br><span class="line">    <span class="attribute">display</span> none</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.menus_item</span></span><br><span class="line">  <span class="selector-tag">a</span></span><br><span class="line">    <span class="attribute">text-decoration</span> none<span class="meta">!important</span></span><br><span class="line"><span class="comment">//按钮相关，对侧栏按钮做过魔改的可以调整这里的数值</span></span><br><span class="line"><span class="selector-class">.icon-V</span></span><br><span class="line">  <span class="attribute">padding</span> <span class="number">5px</span></span><br></pre></td></tr></table></figure><p>新建<code>[Blogroot]\themes\butterfly\source\js\sun_moon.js</code></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">switchNightMode</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;body&#x27;</span>).<span class="title function_">insertAdjacentHTML</span>(<span class="string">&#x27;beforeend&#x27;</span>, <span class="string">&#x27;&lt;div class=&quot;Cuteen_DarkSky&quot;&gt;&lt;div class=&quot;Cuteen_DarkPlanet&quot;&gt;&lt;/div&gt;&lt;/div&gt;&#x27;</span>),</span><br><span class="line">    <span class="built_in">setTimeout</span>(<span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">      <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;body&#x27;</span>).<span class="property">classList</span>.<span class="title function_">contains</span>(<span class="string">&#x27;DarkMode&#x27;</span>) ? (<span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;body&#x27;</span>).<span class="property">classList</span>.<span class="title function_">remove</span>(<span class="string">&#x27;DarkMode&#x27;</span>), <span class="variable language_">localStorage</span>.<span class="title function_">setItem</span>(<span class="string">&#x27;isDark&#x27;</span>, <span class="string">&#x27;0&#x27;</span>), <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;modeicon&#x27;</span>).<span class="title function_">setAttribute</span>(<span class="string">&#x27;xlink:href&#x27;</span>, <span class="string">&#x27;#icon-moon&#x27;</span>)) : (<span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;body&#x27;</span>).<span class="property">classList</span>.<span class="title function_">add</span>(<span class="string">&#x27;DarkMode&#x27;</span>), <span class="variable language_">localStorage</span>.<span class="title function_">setItem</span>(<span class="string">&#x27;isDark&#x27;</span>, <span class="string">&#x27;1&#x27;</span>), <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;modeicon&#x27;</span>).<span class="title function_">setAttribute</span>(<span class="string">&#x27;xlink:href&#x27;</span>, <span class="string">&#x27;#icon-sun&#x27;</span>)),</span><br><span class="line">        <span class="built_in">setTimeout</span>(<span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">          <span class="variable language_">document</span>.<span class="title function_">getElementsByClassName</span>(<span class="string">&#x27;Cuteen_DarkSky&#x27;</span>)[<span class="number">0</span>].<span class="property">style</span>.<span class="property">transition</span> = <span class="string">&#x27;opacity 3s&#x27;</span>;</span><br><span class="line">          <span class="variable language_">document</span>.<span class="title function_">getElementsByClassName</span>(<span class="string">&#x27;Cuteen_DarkSky&#x27;</span>)[<span class="number">0</span>].<span class="property">style</span>.<span class="property">opacity</span> = <span class="string">&#x27;0&#x27;</span>;</span><br><span class="line">          <span class="built_in">setTimeout</span>(<span class="keyword">function</span>(<span class="params"></span>) &#123;</span><br><span class="line">            <span class="variable language_">document</span>.<span class="title function_">getElementsByClassName</span>(<span class="string">&#x27;Cuteen_DarkSky&#x27;</span>)[<span class="number">0</span>].<span class="title function_">remove</span>();</span><br><span class="line">          &#125;, <span class="number">1e3</span>);</span><br><span class="line">        &#125;, <span class="number">2e3</span>)</span><br><span class="line">    &#125;)</span><br><span class="line">  <span class="keyword">const</span> nowMode = <span class="variable language_">document</span>.<span class="property">documentElement</span>.<span class="title function_">getAttribute</span>(<span class="string">&#x27;data-theme&#x27;</span>) === <span class="string">&#x27;dark&#x27;</span> ? <span class="string">&#x27;dark&#x27;</span> : <span class="string">&#x27;light&#x27;</span></span><br><span class="line">  <span class="keyword">if</span> (nowMode === <span class="string">&#x27;light&#x27;</span>) &#123;</span><br><span class="line">    <span class="title function_">activateDarkMode</span>()</span><br><span class="line">    saveToLocal.<span class="title function_">set</span>(<span class="string">&#x27;theme&#x27;</span>, <span class="string">&#x27;dark&#x27;</span>, <span class="number">2</span>)</span><br><span class="line">    <span class="variable constant_">GLOBAL_CONFIG</span>.<span class="property">Snackbar</span> !== <span class="literal">undefined</span> &amp;&amp; btf.<span class="title function_">snackbarShow</span>(<span class="variable constant_">GLOBAL_CONFIG</span>.<span class="property">Snackbar</span>.<span class="property">day_to_night</span>)</span><br><span class="line">    <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;modeicon&#x27;</span>).<span class="title function_">setAttribute</span>(<span class="string">&#x27;xlink:href&#x27;</span>, <span class="string">&#x27;#icon-sun&#x27;</span>)</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="title function_">activateLightMode</span>()</span><br><span class="line">    saveToLocal.<span class="title function_">set</span>(<span class="string">&#x27;theme&#x27;</span>, <span class="string">&#x27;light&#x27;</span>, <span class="number">2</span>)</span><br><span class="line">    <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&#x27;body&#x27;</span>).<span class="property">classList</span>.<span class="title function_">add</span>(<span class="string">&#x27;DarkMode&#x27;</span>), <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;modeicon&#x27;</span>).<span class="title function_">setAttribute</span>(<span class="string">&#x27;xlink:href&#x27;</span>, <span class="string">&#x27;#icon-moon&#x27;</span>)</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// handle some cases</span></span><br><span class="line">  <span class="keyword">typeof</span> utterancesTheme === <span class="string">&#x27;function&#x27;</span> &amp;&amp; <span class="title function_">utterancesTheme</span>()</span><br><span class="line">  <span class="keyword">typeof</span> <span class="variable constant_">FB</span> === <span class="string">&#x27;object&#x27;</span> &amp;&amp; <span class="variable language_">window</span>.<span class="title function_">loadFBComment</span>()</span><br><span class="line">  <span class="variable language_">window</span>.<span class="property">DISQUS</span> &amp;&amp; <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;disqus_thread&#x27;</span>).<span class="property">children</span>.<span class="property">length</span> &amp;&amp; <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> <span class="variable language_">window</span>.<span class="title function_">disqusReset</span>(), <span class="number">200</span>)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="2-修改文件"><a href="#2-修改文件" class="headerlink" title="2. 修改文件"></a>2. 修改文件</h3><p>修改<code>[Blogroot]\themes\butterfly\layout\includes\head.pug</code>,在文件末位加上一行</p><figure class="highlight diff"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">  //- global config</span><br><span class="line">  !=partial(&#x27;includes/head/config&#x27;, &#123;&#125;, &#123;cache: true&#125;)</span><br><span class="line"></span><br><span class="line">  include ./head/config_site.pug</span><br><span class="line">  include ./head/noscript.pug</span><br><span class="line"></span><br><span class="line">  !=fragment_cache(&#x27;injectHeadJs&#x27;, function()&#123;return inject_head_js()&#125;)</span><br><span class="line"></span><br><span class="line">  !=fragment_cache(&#x27;injectHead&#x27;, function()&#123;return injectHtml(theme.inject.head)&#125;)</span><br><span class="line"><span class="addition">+ include ./custom/sun_moon.pug</span></span><br></pre></td></tr></table></figure><p>修改<code>[Blogroot]\themes\butterfly\layout\includes\rightside.pug</code>,把原本的昼夜切换按钮替换掉</p><figure class="highlight diff"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">  when &#x27;translate&#x27;</span><br><span class="line">    if translate.enable</span><br><span class="line">      button#translateLink(type=&quot;button&quot; title=_p(&#x27;rightside.translate_title&#x27;))= translate.default</span><br><span class="line">  when &#x27;darkmode&#x27;</span><br><span class="line">    if darkmode.enable &amp;&amp; darkmode.button</span><br><span class="line"><span class="deletion">-     button#darkmode(type=&quot;button&quot; title=_p(&#x27;rightside.night_mode_title&#x27;))</span></span><br><span class="line"><span class="deletion">-       i.fas.fa-adjust</span></span><br><span class="line"><span class="addition">+     a.icon-V.hidden(onclick=&#x27;switchNightMode()&#x27;,  title=_p(&#x27;rightside.    night_mode_title&#x27;))</span></span><br><span class="line"><span class="addition">+       svg(width=&#x27;25&#x27;, height=&#x27;25&#x27;, viewBox=&#x27;0 0 1024 1024&#x27;)</span></span><br><span class="line"><span class="addition">+         use#modeicon(xlink:href=&#x27;#icon-moon&#x27;)</span></span><br></pre></td></tr></table></figure><p>修改<code>[Blogroot]\_config.butterfly.yml</code>,引入一下js</p><figure class="highlight diff"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">inject:</span><br><span class="line">  head:</span><br><span class="line">  bottom:</span><br><span class="line"><span class="addition">+   - &lt;script src=&quot;/js/sun_moon.js&quot; async&gt;&lt;/script&gt;</span></span><br></pre></td></tr></table></figure></div><div class="tab-item-content" id="主题适配-2"><h2 id="AnZhiYu-主题适配"><a href="#AnZhiYu-主题适配" class="headerlink" title="AnZhiYu 主题适配"></a>AnZhiYu 主题适配</h2><h3 id="1-新建文件"><a href="#1-新建文件" class="headerlink" title="1. 新建文件"></a>1. 新建文件</h3><p>新建<code>[Blogroot]\themes\anzhiyu\layout\includes\custom\sun_moon.pug</code>,这部分其实实质上就是一个svg文件，通过js操作它的旋转显隐，淡入淡出实现动画效果</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">svg(aria-hidden=&#x27;true&#x27;, style=&#x27;position:absolute; overflow:hidden; width:0; height:0&#x27;)</span><br><span class="line">  symbol#icon-sun(viewBox=&#x27;0 0 1024 1024&#x27;)</span><br><span class="line">    path(d=&#x27;M960 512l-128 128v192h-192l-128 128-128-128H192v-192l-128-128 128-128V192h192l128-128 128 128h192v192z&#x27;, fill=&#x27;#FFD878&#x27;, p-id=&#x27;8420&#x27;)</span><br><span class="line">    path(d=&#x27;M736 512a224 224 0 1 0-448 0 224 224 0 1 0 448 0z&#x27;, fill=&#x27;#FFE4A9&#x27;, p-id=&#x27;8421&#x27;)</span><br><span class="line">    path(d=&#x27;M512 109.248L626.752 224H800v173.248L914.752 512 800 626.752V800h-173.248L512 914.752 397.248 800H224v-173.248L109.248 512 224 397.248V224h173.248L512 109.248M512 64l-128 128H192v192l-128 128 128 128v192h192l128 128 128-128h192v-192l128-128-128-128V192h-192l-128-128z&#x27;, fill=&#x27;#4D5152&#x27;, p-id=&#x27;8422&#x27;)</span><br><span class="line">    path(d=&#x27;M512 320c105.888 0 192 86.112 192 192s-86.112 192-192 192-192-86.112-192-192 86.112-192 192-192m0-32a224 224 0 1 0 0 448 224 224 0 0 0 0-448z&#x27;, fill=&#x27;#4D5152&#x27;, p-id=&#x27;8423&#x27;)</span><br><span class="line">  symbol#icon-moon(viewBox=&#x27;0 0 1024 1024&#x27;)</span><br><span class="line">    path(d=&#x27;M611.370667 167.082667a445.013333 445.013333 0 0 1-38.4 161.834666 477.824 477.824 0 0 1-244.736 244.394667 445.141333 445.141333 0 0 1-161.109334 38.058667 85.077333 85.077333 0 0 0-65.066666 135.722666A462.08 462.08 0 1 0 747.093333 102.058667a85.077333 85.077333 0 0 0-135.722666 65.024z&#x27;, fill=&#x27;#FFB531&#x27;, p-id=&#x27;11345&#x27;)</span><br><span class="line">    path(d=&#x27;M329.728 274.133333l35.157333-35.157333a21.333333 21.333333 0 1 0-30.165333-30.165333l-35.157333 35.157333-35.114667-35.157333a21.333333 21.333333 0 0 0-30.165333 30.165333l35.114666 35.157333-35.114666 35.157334a21.333333 21.333333 0 1 0 30.165333 30.165333l35.114667-35.157333 35.157333 35.157333a21.333333 21.333333 0 1 0 30.165333-30.165333z&#x27;, fill=&#x27;#030835&#x27;, p-id=&#x27;11346&#x27;)</span><br></pre></td></tr></table></figure><p>新建<code>[Blogroot]\themes\anzhiyu\source\css\_layout\sun_moon.styl</code></p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br></pre></td><td class="code"><pre><span class="line"><span class="selector-class">.Cuteen_DarkSky</span>,</span><br><span class="line"><span class="selector-class">.Cuteen_DarkSky</span><span class="selector-pseudo">:before</span></span><br><span class="line">    <span class="attribute">content</span>: <span class="string">&#x27;&#x27;</span>;</span><br><span class="line">    <span class="attribute">position</span>: fixed;</span><br><span class="line">    <span class="attribute">left</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">right</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">top</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">bottom</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">z-index</span>: <span class="number">88888888</span></span><br><span class="line"></span><br><span class="line"><span class="selector-class">.Cuteen_DarkSky</span></span><br><span class="line">    <span class="attribute">background</span>: <span class="built_in">-webkit-linear-gradient</span>(bottom, <span class="number">#f8cd71</span> <span class="number">0</span>, <span class="number">#5bfde9</span> <span class="number">80%</span>);</span><br><span class="line">    <span class="attribute">background</span>: <span class="built_in">-moz-linear-gradient</span>(bottom, <span class="number">#f8cd71</span> <span class="number">0</span>, <span class="number">#5bfde9</span> <span class="number">80%</span>);</span><br><span class="line">    <span class="attribute">background</span>: <span class="built_in">-o-linear-gradient</span>(bottom, <span class="number">#f8cd71</span> <span class="number">0</span>, <span class="number">#5bfde9</span> <span class="number">80%</span>);</span><br><span class="line">    <span class="attribute">background</span>: <span class="built_in">-ms-linear-gradient</span>(bottom, <span class="number">#f8cd71</span> <span class="number">0</span>, <span class="number">#5bfde9</span> <span class="number">80%</span>);</span><br><span class="line">    <span class="attribute">background</span>: <span class="built_in">linear-gradient</span>(to top, <span class="number">#f8cd71</span> <span class="number">0</span>, <span class="number">#5bfde9</span> <span class="number">80%</span>)</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.Cuteen_DarkSky</span><span class="selector-pseudo">:before</span></span><br><span class="line">    -webkit-<span class="attribute">transition</span>: <span class="number">2s</span> ease all;</span><br><span class="line">    -moz-<span class="attribute">transition</span>: <span class="number">2s</span> ease all;</span><br><span class="line">    -o-<span class="attribute">transition</span>: <span class="number">2s</span> ease all;</span><br><span class="line">    -ms-<span class="attribute">transition</span>: <span class="number">2s</span> ease all;</span><br><span class="line">    <span class="attribute">transition</span>: <span class="number">2s</span> ease all;</span><br><span class="line">    <span class="attribute">opacity</span>: <span class="number">0</span>;</span><br><span class="line">    <span class="attribute">background</span>: <span class="built_in">-webkit-linear-gradient</span>(bottom, <span class="number">#30cfd0</span> <span class="number">0</span>, <span class="number">#330867</span> <span class="number">100%</span>);</span><br><span class="line">    <span class="attribute">background</span>: <span class="built_in">-moz-linear-gradient</span>(bottom, <span class="number">#30cfd0</span> <span class="number">0</span>, <span class="number">#330867</span> <span class="number">100%</span>);</span><br><span class="line">    <span class="attribute">background</span>: <span class="built_in">-o-linear-gradient</span>(bottom, <span class="number">#30cfd0</span> <span class="number">0</span>, <span class="number">#330867</span> <span class="number">100%</span>);</span><br><span class="line">    <span class="attribute">background</span>: <span class="built_in">-ms-linear-gradient</span>(bottom, <span class="number">#30cfd0</span> <span class="number">0</span>, <span class="number">#330867</span> <span class="number">100%</span>);</span><br><span class="line">    <span class="attribute">background</span>: <span class="built_in">linear-gradient</span>(to top, <span class="number">#30cfd0</span> <span class="number">0</span>, <span class="number">#330867</span> <span class="number">100%</span>)</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.DarkMode</span> <span class="selector-class">.Cuteen_DarkSky</span><span class="selector-pseudo">:before</span></span><br><span class="line">    <span class="attribute">opacity</span>: <span class="number">1</span>;</span><br><span class="line">    -ms-<span class="attribute">filter</span>: none;</span><br><span class="line">    <span class="attribute">filter</span>: none</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.Cuteen_DarkPlanet</span></span><br><span class="line">    <span class="attribute">z-index</span>: <span class="number">99999999</span>;</span><br><span class="line">    <span class="attribute">position</span>: fixed;</span><br><span class="line">    <span class="attribute">left</span>: -<span class="number">50%</span>;</span><br><span class="line">    <span class="attribute">top</span>: -<span class="number">50%</span>;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">200%</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">200%</span>;</span><br><span class="line">    -webkit-<span class="attribute">animation</span>: CuteenPlanetMove <span class="number">2s</span> <span class="built_in">cubic-bezier</span>(.<span class="number">7</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>);</span><br><span class="line">    -webkit-<span class="attribute">animation</span>: CuteenPlanetMove <span class="number">2s</span> <span class="built_in">cubic-bezier</span>(.<span class="number">7</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>);</span><br><span class="line">    -moz-<span class="attribute">animation</span>: CuteenPlanetMove <span class="number">2s</span> <span class="built_in">cubic-bezier</span>(.<span class="number">7</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>);</span><br><span class="line">    -o-<span class="attribute">animation</span>: CuteenPlanetMove <span class="number">2s</span> <span class="built_in">cubic-bezier</span>(.<span class="number">7</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>);</span><br><span class="line">    -ms-<span class="attribute">animation</span>: CuteenPlanetMove <span class="number">2s</span> <span class="built_in">cubic-bezier</span>(.<span class="number">7</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>);</span><br><span class="line">    <span class="attribute">animation</span>: CuteenPlanetMove <span class="number">2s</span> <span class="built_in">cubic-bezier</span>(.<span class="number">7</span>, <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span>);</span><br><span class="line">    -webkit-<span class="attribute">transform-origin</span>: center bottom;</span><br><span class="line">    -moz-<span class="attribute">transform-origin</span>: center bottom;</span><br><span class="line">    -o-<span class="attribute">transform-origin</span>: center bottom;</span><br><span class="line">    -ms-<span class="attribute">transform-origin</span>: center bottom;</span><br><span class="line">    <span class="attribute">transform-origin</span>: center bottom</span><br><span class="line"></span><br><span class="line"><span class="keyword">@-webkit-keyframes</span> CuteenPlanetMove &#123;</span><br><span class="line">    <span class="number">0%</span> &#123;</span><br><span class="line">        -webkit-<span class="attribute">transform</span>: <span class="built_in">rotate</span>(<span class="number">0</span>);</span><br><span class="line">        -moz-<span class="attribute">transform</span>: <span class="built_in">rotate</span>(<span class="number">0</span>);</span><br><span class="line">        -o-<span class="attribute">transform</span>: <span class="built_in">rotate</span>(<span class="number">0</span>);</span><br><span class="line">        -ms-<span class="attribute">transform</span>: <span class="built_in">rotate</span>(<span class="number">0</span>);</span><br><span class="line">        <span class="attribute">transform</span>: <span class="built_in">rotate</span>(<span class="number">0</span>)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    to &#123;</span><br><span class="line">        -webkit-<span class="attribute">transform</span>: <span class="built_in">rotate</span>(<span class="number">360deg</span>);</span><br><span class="line">        -moz-<span class="attribute">transform</span>: <span class="built_in">rotate</span>(<span class="number">360deg</span>);</span><br><span class="line">        -o-<span class="attribute">transform</span>: <span class="built_in">rotate</span>(<span class="number">360deg</span>);</span><br><span class="line">        -ms-<span class="attribute">transform</span>: <span class="built_in">rotate</span>(<span class="number">360deg</span>);</span><br><span class="line">        <span class="attribute">transform</span>: <span class="built_in">rotate</span>(<span class="number">360deg</span>)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.Cuteen_DarkPlanet</span> <span class="selector-id">#sun</span></span><br><span class="line">    <span class="attribute">position</span>: absolute;</span><br><span class="line">    <span class="attribute">border-radius</span>: <span class="number">100%</span>;</span><br><span class="line">    <span class="attribute">left</span>: <span class="number">44%</span>;</span><br><span class="line">    <span class="attribute">top</span>: <span class="number">30%</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">6rem</span>;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">6rem</span>;</span><br><span class="line">    <span class="attribute">background</span>: <span class="number">#ffee94</span>;</span><br><span class="line">    -webkit-<span class="attribute">box-shadow</span>: <span class="number">0</span> <span class="number">0</span> <span class="number">40px</span> <span class="number">#ffee94</span>;</span><br><span class="line">    <span class="attribute">box-shadow</span>: <span class="number">0</span> <span class="number">0</span> <span class="number">40px</span> <span class="number">#ffee94</span></span><br><span class="line"></span><br><span class="line"><span class="selector-class">.Cuteen_DarkPlanet</span> <span class="selector-id">#moon</span></span><br><span class="line">    <span class="attribute">position</span>: absolute;</span><br><span class="line">    <span class="attribute">border-radius</span>: <span class="number">100%</span>;</span><br><span class="line">    <span class="attribute">left</span>: <span class="number">44%</span>;</span><br><span class="line">    <span class="attribute">top</span>: <span class="number">30%</span>;</span><br><span class="line">    <span class="attribute">position</span>: absolute;</span><br><span class="line">    <span class="attribute">border-radius</span>: <span class="number">100%</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">6rem</span>;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">6rem</span>;</span><br><span class="line">    -webkit-<span class="attribute">box-shadow</span>: -<span class="number">1.8em</span> <span class="number">1.8em</span> <span class="number">0</span> .<span class="number">2em</span> <span class="number">#fff</span>;</span><br><span class="line">    <span class="attribute">box-shadow</span>: -<span class="number">1.8em</span> <span class="number">1.8em</span> <span class="number">0</span> .<span class="number">2em</span> <span class="number">#fff</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">@-moz-keyframes</span> CuteenPlanetMove &#123;</span><br><span class="line">  <span class="number">0%</span> &#123;</span><br><span class="line">      -webkit-<span class="attribute">transform</span>: <span class="built_in">rotate</span>(<span class="number">0</span>);</span><br><span class="line">      -moz-<span class="attribute">transform</span>: <span class="built_in">rotate</span>(<span class="number">0</span>);</span><br><span class="line">      -o-<span class="attribute">transform</span>: <span class="built_in">rotate</span>(<span class="number">0</span>);</span><br><span class="line">      -ms-<span class="attribute">transform</span>: <span class="built_in">rotate</span>(<span class="number">0</span>);</span><br><span class="line">      <span class="attribute">transform</span>: <span class="built_in">rotate</span>(<span class="number">0</span>)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  to &#123;</span><br><span class="line">      -webkit-<span class="attribute">transform</span>: <span class="built_in">rotate</span>(<span class="number">360deg</span>);</span><br><span class="line">      -moz-<span class="attribute">transform</span>: <span class="built_in">rotate</span>(<span class="number">360deg</span>);</span><br><span class="line">      -o-<span class="attribute">transform</span>: <span class="built_in">rotate</span>(<span class="number">360deg</span>);</span><br><span class="line">      -ms-<span class="attribute">transform</span>: <span class="built_in">rotate</span>(<span class="number">360deg</span>);</span><br><span class="line">      <span class="attribute">transform</span>: <span class="built_in">rotate</span>(<span class="number">360deg</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@-webkit-keyframes</span> CuteenPlanetMove &#123;</span><br><span class="line">  <span class="number">0%</span> &#123;</span><br><span class="line">      -webkit-<span class="attribute">transform</span>: <span class="built_in">rotate</span>(<span class="number">0</span>);</span><br><span class="line">      -moz-<span class="attribute">transform</span>: <span class="built_in">rotate</span>(<span class="number">0</span>);</span><br><span class="line">      -o-<span class="attribute">transform</span>: <span class="built_in">rotate</span>(<span class="number">0</span>);</span><br><span class="line">      -ms-<span class="attribute">transform</span>: <span class="built_in">rotate</span>(<span class="number">0</span>);</span><br><span class="line">      <span class="attribute">transform</span>: <span class="built_in">rotate</span>(<span class="number">0</span>)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  to &#123;</span><br><span class="line">      -webkit-<span class="attribute">transform</span>: <span class="built_in">rotate</span>(<span class="number">360deg</span>);</span><br><span class="line">      -moz-<span class="attribute">transform</span>: <span class="built_in">rotate</span>(<span class="number">360deg</span>);</span><br><span class="line">      -o-<span class="attribute">transform</span>: <span class="built_in">rotate</span>(<span class="number">360deg</span>);</span><br><span class="line">      -ms-<span class="attribute">transform</span>: <span class="built_in">rotate</span>(<span class="number">360deg</span>);</span><br><span class="line">      <span class="attribute">transform</span>: <span class="built_in">rotate</span>(<span class="number">360deg</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@-o-keyframes</span> CuteenPlanetMove &#123;</span><br><span class="line">  <span class="number">0%</span> &#123;</span><br><span class="line">      -webkit-<span class="attribute">transform</span>: <span class="built_in">rotate</span>(<span class="number">0</span>);</span><br><span class="line">      -moz-<span class="attribute">transform</span>: <span class="built_in">rotate</span>(<span class="number">0</span>);</span><br><span class="line">      -o-<span class="attribute">transform</span>: <span class="built_in">rotate</span>(<span class="number">0</span>);</span><br><span class="line">      -ms-<span class="attribute">transform</span>: <span class="built_in">rotate</span>(<span class="number">0</span>);</span><br><span class="line">      <span class="attribute">transform</span>: <span class="built_in">rotate</span>(<span class="number">0</span>)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  to &#123;</span><br><span class="line">      -webkit-<span class="attribute">transform</span>: <span class="built_in">rotate</span>(<span class="number">360deg</span>);</span><br><span class="line">      -moz-<span class="attribute">transform</span>: <span class="built_in">rotate</span>(<span class="number">360deg</span>);</span><br><span class="line">      -o-<span class="attribute">transform</span>: <span class="built_in">rotate</span>(<span class="number">360deg</span>);</span><br><span class="line">      -ms-<span class="attribute">transform</span>: <span class="built_in">rotate</span>(<span class="number">360deg</span>);</span><br><span class="line">      <span class="attribute">transform</span>: <span class="built_in">rotate</span>(<span class="number">360deg</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">@keyframes</span> CuteenPlanetMove &#123;</span><br><span class="line">  <span class="number">0%</span> &#123;</span><br><span class="line">      -webkit-<span class="attribute">transform</span>: <span class="built_in">rotate</span>(<span class="number">0</span>);</span><br><span class="line">      -moz-<span class="attribute">transform</span>: <span class="built_in">rotate</span>(<span class="number">0</span>);</span><br><span class="line">      -o-<span class="attribute">transform</span>: <span class="built_in">rotate</span>(<span class="number">0</span>);</span><br><span class="line">      -ms-<span class="attribute">transform</span>: <span class="built_in">rotate</span>(<span class="number">0</span>);</span><br><span class="line">      <span class="attribute">transform</span>: <span class="built_in">rotate</span>(<span class="number">0</span>)</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  to &#123;</span><br><span class="line">      -webkit-<span class="attribute">transform</span>: <span class="built_in">rotate</span>(<span class="number">360deg</span>);</span><br><span class="line">      -moz-<span class="attribute">transform</span>: <span class="built_in">rotate</span>(<span class="number">360deg</span>);</span><br><span class="line">      -o-<span class="attribute">transform</span>: <span class="built_in">rotate</span>(<span class="number">360deg</span>);</span><br><span class="line">      -ms-<span class="attribute">transform</span>: <span class="built_in">rotate</span>(<span class="number">360deg</span>);</span><br><span class="line">      <span class="attribute">transform</span>: <span class="built_in">rotate</span>(<span class="number">360deg</span>)</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.search</span></span><br><span class="line">  <span class="selector-tag">span</span></span><br><span class="line">    <span class="attribute">display</span> none</span><br><span class="line"></span><br><span class="line"><span class="selector-class">.menus_item</span></span><br><span class="line">  <span class="selector-tag">a</span></span><br><span class="line">    <span class="attribute">text-decoration</span> none<span class="meta">!important</span></span><br><span class="line"><span class="comment">//按钮相关，对侧栏按钮做过魔改的可以调整这里的数值</span></span><br><span class="line"><span class="selector-class">.icon-V</span></span><br><span class="line">  <span class="attribute">padding</span> <span class="number">5px</span></span><br></pre></td></tr></table></figure><p>新建<code>[Blogroot]\themes\anzhiyu\source\js\sun_moon.js</code></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> <span class="title function_">switchNightMode</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&quot;body&quot;</span>).<span class="title function_">insertAdjacentHTML</span>(<span class="string">&quot;beforeend&quot;</span>, <span class="string">&#x27;&lt;div class=&quot;Cuteen_DarkSky&quot;&gt;&lt;div class=&quot;Cuteen_DarkPlanet&quot;&gt;&lt;div id=&quot;sun&quot;&gt;&lt;/div&gt;&lt;div id=&quot;moon&quot;&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&#x27;</span>);</span><br><span class="line">  </span><br><span class="line">  <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">    <span class="keyword">if</span> (<span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&quot;body&quot;</span>).<span class="property">classList</span>.<span class="title function_">contains</span>(<span class="string">&quot;DarkMode&quot;</span>)) &#123;</span><br><span class="line">      <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&quot;body&quot;</span>).<span class="property">classList</span>.<span class="title function_">remove</span>(<span class="string">&quot;DarkMode&quot;</span>);</span><br><span class="line">      <span class="variable language_">localStorage</span>.<span class="title function_">setItem</span>(<span class="string">&quot;isDark&quot;</span>, <span class="string">&quot;0&quot;</span>);</span><br><span class="line">      <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;modeicon&quot;</span>).<span class="title function_">setAttribute</span>(<span class="string">&quot;xlink:href&quot;</span>, <span class="string">&quot;#icon-moon&quot;</span>);</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">      <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&quot;body&quot;</span>).<span class="property">classList</span>.<span class="title function_">add</span>(<span class="string">&quot;DarkMode&quot;</span>);</span><br><span class="line">      <span class="variable language_">localStorage</span>.<span class="title function_">setItem</span>(<span class="string">&quot;isDark&quot;</span>, <span class="string">&quot;1&quot;</span>);</span><br><span class="line">      <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;modeicon&quot;</span>).<span class="title function_">setAttribute</span>(<span class="string">&quot;xlink:href&quot;</span>, <span class="string">&quot;#icon-sun&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">      <span class="variable language_">document</span>.<span class="title function_">getElementsByClassName</span>(<span class="string">&quot;Cuteen_DarkSky&quot;</span>)[<span class="number">0</span>].<span class="property">style</span>.<span class="property">transition</span> = <span class="string">&quot;opacity 3s&quot;</span>;</span><br><span class="line">      <span class="variable language_">document</span>.<span class="title function_">getElementsByClassName</span>(<span class="string">&quot;Cuteen_DarkSky&quot;</span>)[<span class="number">0</span>].<span class="property">style</span>.<span class="property">opacity</span> = <span class="string">&quot;0&quot;</span>;</span><br><span class="line">      <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">        <span class="variable language_">document</span>.<span class="title function_">getElementsByClassName</span>(<span class="string">&quot;Cuteen_DarkSky&quot;</span>)[<span class="number">0</span>].<span class="title function_">remove</span>();</span><br><span class="line">      &#125;, <span class="number">1000</span>);</span><br><span class="line">    &#125;, <span class="number">2000</span>);</span><br><span class="line">  &#125;);</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (<span class="string">&quot;light&quot;</span> === (<span class="string">&quot;dark&quot;</span> === <span class="variable language_">document</span>.<span class="property">documentElement</span>.<span class="title function_">getAttribute</span>(<span class="string">&quot;data-theme&quot;</span>) ? <span class="string">&quot;dark&quot;</span> : <span class="string">&quot;light&quot;</span>)) &#123;</span><br><span class="line">    <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;sun&quot;</span>).<span class="property">style</span>.<span class="property">opacity</span> = <span class="string">&quot;1&quot;</span>;</span><br><span class="line">    <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;moon&quot;</span>).<span class="property">style</span>.<span class="property">opacity</span> = <span class="string">&quot;0&quot;</span>;</span><br><span class="line">    <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">      <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;sun&quot;</span>).<span class="property">style</span>.<span class="property">opacity</span> = <span class="string">&quot;0&quot;</span>;</span><br><span class="line">      <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;moon&quot;</span>).<span class="property">style</span>.<span class="property">opacity</span> = <span class="string">&quot;1&quot;</span>;</span><br><span class="line">    &#125;, <span class="number">1000</span>);</span><br><span class="line"></span><br><span class="line">    <span class="title function_">activateDarkMode</span>();</span><br><span class="line">    saveToLocal.<span class="title function_">set</span>(<span class="string">&quot;theme&quot;</span>, <span class="string">&quot;dark&quot;</span>, <span class="number">2</span>);</span><br><span class="line">    <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;modeicon&quot;</span>).<span class="title function_">setAttribute</span>(<span class="string">&quot;xlink:href&quot;</span>, <span class="string">&quot;#icon-sun&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">if</span> (<span class="variable constant_">GLOBAL_CONFIG</span>.<span class="property">Snackbar</span> !== <span class="literal">undefined</span>) &#123;</span><br><span class="line">        anzhiyu.<span class="title function_">snackbarShow</span>(<span class="variable constant_">GLOBAL_CONFIG</span>.<span class="property">Snackbar</span>.<span class="property">day_to_night</span>);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;, <span class="number">2000</span>);</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;sun&quot;</span>).<span class="property">style</span>.<span class="property">opacity</span> = <span class="string">&quot;0&quot;</span>;</span><br><span class="line">    <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;moon&quot;</span>).<span class="property">style</span>.<span class="property">opacity</span> = <span class="string">&quot;1&quot;</span>;</span><br><span class="line">    <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">      <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;sun&quot;</span>).<span class="property">style</span>.<span class="property">opacity</span> = <span class="string">&quot;1&quot;</span>;</span><br><span class="line">      <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;moon&quot;</span>).<span class="property">style</span>.<span class="property">opacity</span> = <span class="string">&quot;0&quot;</span>;</span><br><span class="line">    &#125;, <span class="number">1000</span>);</span><br><span class="line"></span><br><span class="line">    <span class="title function_">activateLightMode</span>();</span><br><span class="line">    saveToLocal.<span class="title function_">set</span>(<span class="string">&quot;theme&quot;</span>, <span class="string">&quot;light&quot;</span>, <span class="number">2</span>);</span><br><span class="line">    <span class="variable language_">document</span>.<span class="title function_">querySelector</span>(<span class="string">&quot;body&quot;</span>).<span class="property">classList</span>.<span class="title function_">add</span>(<span class="string">&quot;DarkMode&quot;</span>);</span><br><span class="line">    <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;modeicon&quot;</span>).<span class="title function_">setAttribute</span>(<span class="string">&quot;xlink:href&quot;</span>, <span class="string">&quot;#icon-moon&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> &#123;</span><br><span class="line">      <span class="keyword">if</span> (<span class="variable constant_">GLOBAL_CONFIG</span>.<span class="property">Snackbar</span> !== <span class="literal">undefined</span>) &#123;</span><br><span class="line">        anzhiyu.<span class="title function_">snackbarShow</span>(<span class="variable constant_">GLOBAL_CONFIG</span>.<span class="property">Snackbar</span>.<span class="property">night_to_day</span>);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;, <span class="number">2000</span>);</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="keyword">if</span> (<span class="keyword">typeof</span> utterancesTheme === <span class="string">&quot;function&quot;</span>) <span class="title function_">utterancesTheme</span>();</span><br><span class="line">  <span class="keyword">if</span> (<span class="keyword">typeof</span> <span class="variable constant_">FB</span> === <span class="string">&quot;object&quot;</span>) <span class="variable language_">window</span>.<span class="title function_">loadFBComment</span>();</span><br><span class="line">  <span class="keyword">if</span> (<span class="variable language_">window</span>.<span class="property">DISQUS</span> &amp;&amp; <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;disqus_thread&quot;</span>).<span class="property">children</span>.<span class="property">length</span>) <span class="built_in">setTimeout</span>(<span class="function">() =&gt;</span> <span class="variable language_">window</span>.<span class="title function_">disqusReset</span>(), <span class="number">200</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h3 id="2-修改文件"><a href="#2-修改文件" class="headerlink" title="2. 修改文件"></a>2. 修改文件</h3><p>修改<code>[Blogroot]\themes\anzhiyu\layout\includes\head.pug</code>,在文件末位加上一行</p><figure class="highlight diff"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="addition">!=fragment_cache(&#x27;injectHeadJs&#x27;, function()&#123;return inject_head_js()&#125;)</span></span><br><span class="line"></span><br><span class="line"><span class="addition">!=fragment_cache(&#x27;injectHead&#x27;, function()&#123;return injectHtml(theme.inject.head)&#125;)</span></span><br><span class="line"></span><br><span class="line"><span class="addition">+ include ./custom/sun_moon.pug</span></span><br></pre></td></tr></table></figure><p>修改<code>[Blogroot]\themes\anhziyu\layout\includes\rightside.pug</code>,把原本的昼夜切换按钮删掉</p><figure class="highlight diff"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">  when &#x27;translate&#x27;</span><br><span class="line">    if translate.enable</span><br><span class="line">      button#translateLink(type=&quot;button&quot; title=_p(&#x27;rightside.translate_title&#x27;))= translate.default</span><br><span class="line"><span class="deletion">- when &#x27;darkmode&#x27;</span></span><br><span class="line"><span class="deletion">-   if darkmode.enable &amp;&amp; darkmode.button</span></span><br><span class="line"><span class="deletion">-     button#darkmode(type=&quot;button&quot; title=_p(&#x27;rightside.night_mode_title&#x27;))</span></span><br><span class="line"><span class="deletion">-       i.fas.fa-adjust</span></span><br></pre></td></tr></table></figure><p>修改<code>[Blogroot]\_config.anzhiyu.yml</code>,引入一下js</p><figure class="highlight diff"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">inject:</span><br><span class="line">  head:</span><br><span class="line">  bottom:</span><br><span class="line"><span class="addition">+   - &lt;script src=&quot;/js/sun_moon.js&quot; async&gt;&lt;/script&gt;</span></span><br></pre></td></tr></table></figure><p>修改<code>[Blogroot]\themes\anhziyu\layout\includes\header\nav.pug</code>，将原本的昼夜切换按钮移动到顶栏</p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">div.nav-button#nav-darkmode</span><br><span class="line">  a.icon-V.hidden.faa-parent.animated-hover(onclick=&#x27;switchNightMode()&#x27;, title=_p (&#x27;rightside.night_mode_title&#x27;))</span><br><span class="line">    i.anzhiyufont.anzhiyu-icon-moon</span><br><span class="line">      use#modeicon(xlink:href=&#x27;#icon-moon&#x27;)</span><br></pre></td></tr></table></figure></div></div><div class="tab-to-top"><button type="button" aria-label="scroll to top"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i></button></div></div>]]></content>
      
      
      <categories>
          
          <category> Hexo </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 美化 </tag>
            
            <tag> HTML </tag>
            
            <tag> CSS </tag>
            
            <tag> JS </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>Butterfly主题顶栏菜单重写</title>
      <link href="//posts/20458/"/>
      <url>//posts/20458/</url>
      
        <content type="html"><![CDATA[<div class="note warning flat"><p>本文修改主题为<code>Butterfly</code>主题，若使用其他主题，请自行确认修改位置。</p></div><h1 id="原文出处"><a href="#原文出处" class="headerlink" title="原文出处"></a>原文出处</h1><blockquote><p><a href="https://akilar.top/posts/eac2c3d0/">https://akilar.top/posts/eac2c3d0/</a></p></blockquote><h1 id="效果预览"><a href="#效果预览" class="headerlink" title="效果预览"></a>效果预览</h1><details class="folding-tag" ><summary> 查看图片 </summary>              <div class='content'>              <p><img src="https://cdn.randench.cn/image/24/08/89145d9f0f5a9af3.gif" alt="效果预览"></p>              </div>            </details><h1 id="修改步骤"><a href="#修改步骤" class="headerlink" title="修改步骤"></a>修改步骤</h1><h2 id="1-重写顶栏样式"><a href="#1-重写顶栏样式" class="headerlink" title="1. 重写顶栏样式"></a>1. 重写顶栏样式</h2><p>重写<code>[Blogroot]\themes\butterfly\layout\includes\header\nav.pug</code></p><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line">#menu-container.menu-container</span><br><span class="line">  .menu-item</span><br><span class="line">    each value, label in theme.menu</span><br><span class="line">      if typeof value !== &#x27;object&#x27;</span><br><span class="line">        .menu-item-main</span><br><span class="line">          a.site-page.faa-parent.animated-hover(href=url_for(trim(value.split(&#x27;||&#x27;)[0])))</span><br><span class="line">            if value.split(&#x27;||&#x27;)[1]</span><br><span class="line">              - var icon_value = trim(value.split(&#x27;||&#x27;)[1])</span><br><span class="line">              - var anima_value = value.split(&#x27;||&#x27;)[2] ? trim(value.split(&#x27;||&#x27;)[2]) :     &#x27;faa-tada&#x27;</span><br><span class="line">              if icon_value.substring(0,2)==&quot;fa&quot;  </span><br><span class="line">                i.fa-fw(class=icon_value + &#x27; &#x27; + anima_value)</span><br><span class="line">              else if icon_value.substring(0,4)==&quot;icon&quot;  </span><br><span class="line">                svg.icon(aria-hidden=&quot;true&quot; class=anima_value)</span><br><span class="line">                  use(xlink:href=`#`+ icon_value)</span><br><span class="line">            span=&#x27; &#x27;+label</span><br><span class="line">      else</span><br><span class="line">        .menu-item-main.has-child</span><br><span class="line">          .menu-item-parent</span><br><span class="line">            a.site-page.faa-parent.animated-hover(href=&#x27;javascript:void(0);&#x27;)</span><br><span class="line">              if label.split(&#x27;||&#x27;)[1]</span><br><span class="line">                - var icon_label = trim(label.split(&#x27;||&#x27;)[1])</span><br><span class="line">                - var anima_label = label.split(&#x27;||&#x27;)[2] ? trim(label.split(&#x27;||&#x27;)[2]) :     &#x27;faa-tada&#x27;</span><br><span class="line">                if icon_label.substring(0,2)==&quot;fa&quot;  </span><br><span class="line">                  i.fa-fw(class=icon_label + &#x27; &#x27; + anima_label)</span><br><span class="line">                else if icon_label.substring(0,4)==&quot;icon&quot;  </span><br><span class="line">                  svg.icon(aria-hidden=&quot;true&quot; class=anima_label)</span><br><span class="line">                    use(xlink:href=`#`+ icon_label)</span><br><span class="line">              span=&#x27; &#x27;+ trim(label.split(&#x27;||&#x27;)[0])</span><br><span class="line">          each val,lab in value</span><br><span class="line">            .menu-item-child</span><br><span class="line">              a.faa-parent.animated-hover.site-page.child(href=url_for(trim(val.split(&#x27;||&#x27;)   [0])))</span><br><span class="line">                if val.split(&#x27;||&#x27;)[1]</span><br><span class="line">                  - var icon_val = trim(val.split(&#x27;||&#x27;)[1])</span><br><span class="line">                  - var anima_val = val.split(&#x27;||&#x27;)[2] ? trim(val.split(&#x27;||&#x27;)[2]) : &#x27;faa-tada&#x27;</span><br><span class="line">                  if icon_val.substring(0,2)==&quot;fa&quot;  </span><br><span class="line">                    i.fa-fw(class=icon_val + &#x27; &#x27; + anima_val)</span><br><span class="line">                  else if icon_val.substring(0,4)==&quot;icon&quot;</span><br><span class="line">                    svg.icon(aria-hidden=&quot;true&quot; class=anima_val)</span><br><span class="line">                      use(xlink:href=`#`+ icon_val)</span><br><span class="line">                span=&#x27; &#x27;+ lab</span><br><span class="line">  .top-bar</span><br><span class="line">    .message-container</span><br><span class="line">      .message-item.message-weather</span><br><span class="line">        #tp-weather-widget.message-weather-box</span><br><span class="line">      .message-item.message-date(onclick=&#x27;Navvisible()&#x27;)</span><br><span class="line">        #message-date-box.message-date-box</span><br><span class="line">        - var pagedescr = page.description ? page.description : &#x27;欢迎光临糖果屋，愿你有愉快的一天   &#x27;</span><br><span class="line">        - var subtitle = page.subtitle ? page.subtitle : page.title</span><br><span class="line">        if is_post()</span><br><span class="line">          #message-title-box.message-title-box</span><br><span class="line">            a#site-name(title=pagedescr) #[=subtitle]  </span><br><span class="line">        else if is_page()</span><br><span class="line">          #message-title-box.message-title-box</span><br><span class="line">            a#site-name(title=pagedescr) #[=subtitle]</span><br><span class="line">        else</span><br><span class="line">          #message-title-box.message-title-box</span><br><span class="line">            a#site-name(title=pagedescr) #[=config.title]</span><br><span class="line">      .message-item.message-function</span><br><span class="line">        if (theme.algolia_search.enable || theme.local_search.enable)</span><br><span class="line">          #search-button</span><br><span class="line">            a.site-page.social-icon.search.faa-parent.animated-hover</span><br><span class="line">              svg.faa-tada.icon(style=&quot;height:25px;width:25px&quot; aria-hidden=&quot;true&quot;)</span><br><span class="line">                use(xlink:href=&#x27;#icon-search-01&#x27;)</span><br><span class="line">              span=&#x27; &#x27;+_p(&#x27;search.title&#x27;)</span><br><span class="line">        a.icon-V.hidden.faa-parent.animated-hover(onclick=&#x27;switchNightMode()&#x27;,  title=_p    (&#x27;rightside.night_mode_title&#x27;))</span><br><span class="line">          svg.faa-tada(width=&#x27;25&#x27;, height=&#x27;25&#x27;, viewBox=&#x27;0 0 1024 1024&#x27;)</span><br><span class="line">            use#modeicon(xlink:href=&#x27;#icon-moon&#x27;)</span><br><span class="line">        #toggle-menu</span><br><span class="line">          a.site-page.faa-parent.animated-hover</span><br><span class="line">            svg.faa-tada.icon(style=&quot;height:25px;width:25px&quot; aria-hidden=&quot;true&quot;)</span><br><span class="line">              use(xlink:href=&#x27;#icon-multi-window-01&#x27;)</span><br><span class="line">  button.active-button(onclick=&#x27;Navvisible()&#x27;)</span><br></pre></td></tr></table></figure><div class="tip info"><p>此处的修改与原文并不相同，差异如下，因为和风天气不再提供服务，改用心知天气，预留标签不同</p></div><figure class="highlight diff"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">  .top-bar</span><br><span class="line">    .message-container</span><br><span class="line"><span class="deletion">-     .message-item.message-weather(onclick=&#x27;btf.scrollToDest(0, 500)&#x27;)</span></span><br><span class="line"><span class="deletion">-       #he-plugin-simple.message-weather-box</span></span><br><span class="line"><span class="addition">+     .message-item.message-weather</span></span><br><span class="line"><span class="addition">+       #tp-weather-widget.message-weather-box</span></span><br><span class="line">      .message-item.message-date(onclick=&#x27;Navvisible()&#x27;)</span><br><span class="line">        #message-date-box.message-date-box</span><br></pre></td></tr></table></figure><h2 id="2-新建样式"><a href="#2-新建样式" class="headerlink" title="2. 新建样式"></a>2. 新建样式</h2><p>新建<code>[Blogroot]\themes\butterfly\source\css\_layout\nav.styl</code></p><figure class="highlight stylus"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//default color:</span></span><br><span class="line"><span class="selector-pseudo">:root</span></span><br><span class="line"><span class="attr">--nav-bar-background-color</span>: <span class="built_in">rgba</span>(<span class="number">249</span>, <span class="number">249</span>, <span class="number">249</span>, <span class="number">0.79</span>)</span><br><span class="line"><span class="attr">--nav-font-color</span>: <span class="number">#494748</span></span><br><span class="line"><span class="attr">--nav-font-hover-color</span>: <span class="number">#494748</span></span><br><span class="line"><span class="attr">--nav-button-color</span>: transparent</span><br><span class="line"><span class="attr">--nav-active-button-color</span>: <span class="built_in">rgba</span>(<span class="number">40</span>, <span class="number">185</span>, <span class="number">230</span>, <span class="number">0.65</span>)</span><br><span class="line"><span class="attr">--nav-menu-background-color</span>: <span class="built_in">rgba</span>(<span class="number">160</span>,<span class="number">160</span>,<span class="number">160</span>,<span class="number">0.7</span>)</span><br><span class="line"><span class="attr">--nav-menu-item-background-color</span>: <span class="built_in">rgba</span>(<span class="number">249</span>, <span class="number">249</span>, <span class="number">249</span>,<span class="number">0.8</span>)</span><br><span class="line"><span class="attr">--nav-menu-item-font-color</span>: <span class="number">#494748</span></span><br><span class="line"><span class="attr">--nav-menu-item-hover-background-color</span>: <span class="number">#eda60c</span></span><br><span class="line"><span class="attr">--nav-menu-item-hover-font-color</span>: <span class="number">#f9f9f9</span></span><br><span class="line"><span class="selector-attr">[data-theme=<span class="string">&quot;dark&quot;</span>]</span></span><br><span class="line"><span class="attr">--nav-bar-background-color</span>: <span class="built_in">rgba</span>(<span class="number">66</span>,<span class="number">66</span>,<span class="number">66</span>,<span class="number">0.8</span>)</span><br><span class="line"><span class="attr">--nav-font-color</span>: <span class="number">#f9f9f9</span></span><br><span class="line"><span class="attr">--nav-font-hover-color</span>: <span class="number">#f9f9f9</span></span><br><span class="line"><span class="attr">--nav-button-color</span>: <span class="built_in">rgba</span>(<span class="number">20</span>, <span class="number">97</span>, <span class="number">227</span>, <span class="number">0.65</span>)</span><br><span class="line"><span class="attr">--nav-active-button-color</span>: <span class="built_in">rgba</span>(<span class="number">249</span>, <span class="number">246</span>, <span class="number">14</span>, <span class="number">0.71</span>)</span><br><span class="line"><span class="attr">--nav-menu-background-color</span>: <span class="built_in">rgb</span>(<span class="number">66</span>,<span class="number">66</span>,<span class="number">66</span>)</span><br><span class="line"><span class="attr">--nav-menu-item-background-color</span>: <span class="built_in">rgba</span>(<span class="number">77</span>, <span class="number">72</span>, <span class="number">73</span>,<span class="number">0.8</span>)</span><br><span class="line"><span class="attr">--nav-menu-item-font-color</span>: <span class="number">#f9f9f9</span></span><br><span class="line"><span class="attr">--nav-menu-item-hover-background-color</span>: <span class="number">#cdd0ce</span></span><br><span class="line"><span class="attr">--nav-menu-item-hover-font-color</span>: <span class="number">#4d4849</span></span><br><span class="line"><span class="selector-class">.nav-fixed</span></span><br><span class="line"><span class="selector-id">#menu-container</span></span><br><span class="line">  <span class="attribute">top</span>: -<span class="number">110px</span></span><br><span class="line">  <span class="attribute">transition</span>: all <span class="number">0.5s</span></span><br><span class="line">&amp;<span class="selector-class">.nav-visible</span></span><br><span class="line">  <span class="selector-id">#menu-container</span></span><br><span class="line">    <span class="attribute">top</span>: -<span class="number">60px</span></span><br><span class="line">    <span class="attribute">transition</span>: all <span class="number">0.5s</span></span><br><span class="line"><span class="selector-class">.menu-container</span></span><br><span class="line"><span class="attribute">background</span>: transparent</span><br><span class="line"><span class="attribute">position</span>: fixed</span><br><span class="line"><span class="attribute">z-index</span>: <span class="number">90</span></span><br><span class="line"><span class="attribute">top</span>: -<span class="number">60px</span></span><br><span class="line"><span class="attribute">left</span>: <span class="number">0</span></span><br><span class="line"><span class="attribute">height</span>: auto</span><br><span class="line"><span class="attribute">width</span>: <span class="number">100vw</span></span><br><span class="line"><span class="attribute">transition</span>: all <span class="number">0.5s</span> <span class="built_in">cubic-bezier</span>(<span class="number">0.59</span>, <span class="number">0.01</span>, <span class="number">0.48</span>, <span class="number">1.17</span>)</span><br><span class="line">&amp;<span class="selector-class">.active-menu-bar</span></span><br><span class="line">  <span class="attribute">top</span> <span class="number">0px</span> <span class="meta">!important</span></span><br><span class="line">  <span class="attribute">transition</span>: all <span class="number">0.5s</span> <span class="built_in">cubic-bezier</span>(<span class="number">0.59</span>, <span class="number">0.01</span>, <span class="number">0.48</span>, <span class="number">1.17</span>)</span><br><span class="line">  <span class="selector-tag">button</span><span class="selector-class">.active-button</span></span><br><span class="line">    <span class="attribute">background</span> <span class="built_in">var</span>(--nav-active-button-color) <span class="meta">!important</span></span><br><span class="line"><span class="selector-class">.menu-item</span></span><br><span class="line">  <span class="attribute">background</span>: <span class="built_in">var</span>(--nav-menu-background-color)</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">60px</span></span><br><span class="line">  <span class="attribute">width</span> <span class="number">100%</span></span><br><span class="line">  <span class="attribute">overflow-x</span>: hidden;</span><br><span class="line">  <span class="attribute">overflow-y</span>: hidden;</span><br><span class="line">  <span class="attribute">white-space</span>: nowrap;</span><br><span class="line">  <span class="attribute">text-align</span>: center;</span><br><span class="line">  <span class="attribute">font-size</span>: <span class="number">16px</span></span><br><span class="line">  &amp;::-webkit-scrollbar</span><br><span class="line">    <span class="attribute">display</span>: none</span><br><span class="line">  <span class="selector-class">.menu-item-main</span></span><br><span class="line">    <span class="attribute">font-size</span>: <span class="number">16px</span> <span class="meta">!important</span>;</span><br><span class="line">    <span class="attribute">display</span>: inline-flex;</span><br><span class="line">    <span class="attribute">color</span>: <span class="built_in">var</span>(--nav-menu-item-font-color)</span><br><span class="line">    <span class="attribute">background</span>: <span class="built_in">var</span>(--nav-menu-item-background-color)</span><br><span class="line">    <span class="attribute">width</span>: auto</span><br><span class="line">    <span class="attribute">min-width</span>: <span class="number">100px</span>;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">50px</span>;</span><br><span class="line">    <span class="attribute">align-items</span>: center;</span><br><span class="line">    <span class="attribute">justify-content</span>: center;</span><br><span class="line">    <span class="attribute">font-size</span>: <span class="number">14px</span>;</span><br><span class="line">    <span class="attribute">margin</span>: <span class="number">5px</span> <span class="number">5px</span>;</span><br><span class="line">    <span class="attribute">clip-path</span>: <span class="built_in">polygon</span>(<span class="number">3px</span> <span class="number">0</span>, <span class="built_in">calc</span>(<span class="number">50%</span> - <span class="number">5px</span>) <span class="number">0</span>,<span class="number">50%</span> <span class="number">0px</span>,<span class="built_in">calc</span>(<span class="number">50%</span> + <span class="number">5px</span>) <span class="number">0</span> ,<span class="built_in">calc</span>(<span class="number">100%</span> - <span class="number">3px</span>)     <span class="number">0</span>, <span class="number">100%</span> <span class="number">3px</span>,<span class="number">100%</span> <span class="built_in">calc</span>(<span class="number">50%</span> - <span class="number">5px</span>), <span class="number">100%</span> <span class="number">50%</span>,<span class="number">100%</span> <span class="built_in">calc</span>(<span class="number">50%</span> + <span class="number">5px</span>), <span class="number">100%</span> <span class="built_in">calc</span>(<span class="number">100%</span> - <span class="number">3px</span>),     <span class="built_in">calc</span>(<span class="number">100%</span> - <span class="number">3px</span>) <span class="number">100%</span>,<span class="built_in">calc</span>(<span class="number">50%</span> + <span class="number">5px</span>) <span class="number">100%</span>,<span class="number">50%</span> <span class="number">100%</span>,<span class="built_in">calc</span>(<span class="number">50%</span> - <span class="number">5px</span>) <span class="number">100%</span>,<span class="number">3px</span> <span class="number">100%</span>, <span class="number">0</span> calc   (<span class="number">100%</span> - <span class="number">3px</span>), <span class="number">0</span> <span class="built_in">calc</span>(<span class="number">50%</span> + <span class="number">5px</span>), <span class="number">0px</span> <span class="number">50%</span>,<span class="number">0</span> <span class="built_in">calc</span>(<span class="number">50%</span> - <span class="number">5px</span>),<span class="number">0</span> <span class="number">3px</span>);</span><br><span class="line">    <span class="attribute">transition</span>: all <span class="number">0.5s</span> <span class="built_in">cubic-bezier</span>(<span class="number">0.59</span>, <span class="number">0.01</span>, <span class="number">0.48</span>, <span class="number">1.17</span>)</span><br><span class="line">    <span class="selector-tag">a</span></span><br><span class="line">      <span class="attribute">color</span>: <span class="built_in">var</span>(--nav-menu-item-font-color)</span><br><span class="line">    <span class="selector-pseudo">&amp;:hover</span></span><br><span class="line">      <span class="attribute">color</span>: <span class="built_in">var</span>(--nav-menu-item-hover-font-color)</span><br><span class="line">      <span class="attribute">background</span>: <span class="built_in">var</span>(--nav-menu-item-hover-background-color)</span><br><span class="line">      <span class="attribute">clip-path</span>: <span class="built_in">polygon</span>(<span class="number">3px</span> <span class="number">0</span>, <span class="built_in">calc</span>(<span class="number">50%</span> - <span class="number">5px</span>) <span class="number">0</span>,<span class="number">50%</span> <span class="number">8px</span>,<span class="built_in">calc</span>(<span class="number">50%</span> + <span class="number">5px</span>) <span class="number">0</span> ,<span class="built_in">calc</span>(<span class="number">100%</span> -    <span class="number">3px</span>) <span class="number">0</span>, <span class="number">100%</span> <span class="number">3px</span>,<span class="number">100%</span> <span class="built_in">calc</span>(<span class="number">50%</span> - <span class="number">5px</span>), <span class="built_in">calc</span>(<span class="number">100%</span> - <span class="number">8px</span>) <span class="number">50%</span>,<span class="number">100%</span> <span class="built_in">calc</span>(<span class="number">50%</span> + <span class="number">5px</span>), <span class="number">100%</span>    <span class="built_in">calc</span>(<span class="number">100%</span> - <span class="number">3px</span>), <span class="built_in">calc</span>(<span class="number">100%</span> - <span class="number">3px</span>) <span class="number">100%</span>,<span class="built_in">calc</span>(<span class="number">50%</span> + <span class="number">5px</span>) <span class="number">100%</span>,<span class="number">50%</span> <span class="built_in">calc</span>(<span class="number">100%</span> - <span class="number">8px</span>),calc   (<span class="number">50%</span> - <span class="number">5px</span>) <span class="number">100%</span>,<span class="number">3px</span> <span class="number">100%</span>, <span class="number">0</span> <span class="built_in">calc</span>(<span class="number">100%</span> - <span class="number">3px</span>), <span class="number">0</span> <span class="built_in">calc</span>(<span class="number">50%</span> + <span class="number">5px</span>), <span class="number">8px</span> <span class="number">50%</span>,<span class="number">0</span> <span class="built_in">calc</span>(<span class="number">50%</span> -   <span class="number">5px</span>),<span class="number">0</span> <span class="number">3px</span>);</span><br><span class="line">      <span class="attribute">transition</span>: all <span class="number">0.5s</span> <span class="built_in">cubic-bezier</span>(<span class="number">0.59</span>, <span class="number">0.01</span>, <span class="number">0.48</span>, <span class="number">1.17</span>)</span><br><span class="line">      <span class="selector-tag">a</span></span><br><span class="line">        <span class="attribute">color</span>: <span class="built_in">var</span>(--nav-menu-item-hover-font-color)</span><br><span class="line">      <span class="selector-class">.menu-item-parent</span></span><br><span class="line">        <span class="attribute">width</span>: <span class="number">0</span></span><br><span class="line">        <span class="attribute">opacity</span> <span class="number">0</span></span><br><span class="line">        <span class="attribute">color</span>: <span class="built_in">var</span>(--nav-menu-item-hover-font-color)</span><br><span class="line">        <span class="attribute">background</span>: <span class="built_in">var</span>(--nav-menu-item-hover-background-color)</span><br><span class="line">        <span class="attribute">pointer-events</span>: none;</span><br><span class="line">        <span class="attribute">transition</span>: all <span class="number">0.5s</span> <span class="built_in">cubic-bezier</span>(<span class="number">0.59</span>, <span class="number">0.01</span>, <span class="number">0.48</span>, <span class="number">1.17</span>)</span><br><span class="line">      <span class="selector-class">.menu-item-child</span></span><br><span class="line">        <span class="attribute">color</span>: <span class="built_in">var</span>(--nav-menu-item-font-color)</span><br><span class="line">        <span class="attribute">background</span>: <span class="built_in">var</span>(--nav-menu-item-background-color)</span><br><span class="line">        <span class="attribute">width</span>: <span class="number">100px</span>;</span><br><span class="line">        <span class="attribute">opacity</span> <span class="number">1</span></span><br><span class="line">        <span class="attribute">pointer-events</span>: inherit;</span><br><span class="line">        <span class="attribute">transition</span>: all <span class="number">0.5s</span> <span class="built_in">cubic-bezier</span>(<span class="number">0.59</span>, <span class="number">0.01</span>, <span class="number">0.48</span>, <span class="number">1.17</span>)</span><br><span class="line">    &amp;<span class="selector-class">.has-child</span></span><br><span class="line">      <span class="selector-pseudo">&amp;:hover</span></span><br><span class="line">        <span class="attribute">background</span>: <span class="built_in">var</span>(--nav-menu-item-background-color) <span class="meta">!important</span></span><br><span class="line">    <span class="selector-class">.menu-item-parent</span></span><br><span class="line">      <span class="attribute">color</span>: <span class="built_in">var</span>(--nav-menu-item-font-color)</span><br><span class="line">      <span class="attribute">background</span>: <span class="built_in">var</span>(--nav-menu-item-background-color)</span><br><span class="line">      <span class="attribute">opacity</span>: <span class="number">1</span></span><br><span class="line">      <span class="attribute">pointer-events</span>: inherit</span><br><span class="line">      <span class="attribute">display</span>: inline-flex;</span><br><span class="line">      <span class="attribute">align-items</span>: center;</span><br><span class="line">      <span class="attribute">justify-content</span>: center;</span><br><span class="line">      <span class="attribute">width</span> <span class="number">100px</span></span><br><span class="line">      <span class="attribute">height</span>: <span class="number">50px</span>;</span><br><span class="line">      <span class="attribute">transition</span>: all <span class="number">0.5s</span> <span class="built_in">cubic-bezier</span>(<span class="number">0.59</span>, <span class="number">0.01</span>, <span class="number">0.48</span>, <span class="number">1.17</span>)</span><br><span class="line">      <span class="selector-tag">a</span></span><br><span class="line">        <span class="attribute">color</span>: <span class="built_in">var</span>(--nav-menu-item-font-color)</span><br><span class="line">    <span class="selector-class">.menu-item-child</span></span><br><span class="line">      <span class="attribute">color</span>: <span class="built_in">var</span>(--nav-menu-item-font-color)</span><br><span class="line">      <span class="attribute">background</span>: <span class="built_in">var</span>(--nav-menu-item-background-color)</span><br><span class="line">      <span class="attribute">opacity</span>: <span class="number">0</span></span><br><span class="line">      <span class="attribute">pointer-events</span>: none</span><br><span class="line">      <span class="attribute">display</span>: inline-flex;</span><br><span class="line">      <span class="attribute">align-items</span>: center;</span><br><span class="line">      <span class="attribute">justify-content</span>: center;</span><br><span class="line">      <span class="attribute">width</span> <span class="number">0</span></span><br><span class="line">      <span class="attribute">height</span>: <span class="number">50px</span>;</span><br><span class="line">      <span class="attribute">transition</span>: all <span class="number">0.5s</span> <span class="built_in">cubic-bezier</span>(<span class="number">0.59</span>, <span class="number">0.01</span>, <span class="number">0.48</span>, <span class="number">1.17</span>)</span><br><span class="line">      <span class="selector-tag">a</span></span><br><span class="line">        <span class="attribute">color</span>: <span class="built_in">var</span>(--nav-menu-item-font-color)</span><br><span class="line">      <span class="selector-pseudo">&amp;:hover</span></span><br><span class="line">        <span class="attribute">color</span>: <span class="built_in">var</span>(--nav-menu-item-font-color)</span><br><span class="line">        <span class="attribute">background</span>: <span class="built_in">var</span>(--nav-menu-item-hover-background-color)</span><br><span class="line">        <span class="selector-tag">a</span></span><br><span class="line">          <span class="attribute">color</span>: <span class="built_in">var</span>(--nav-menu-item-hover-font-color)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="selector-class">.top-bar</span></span><br><span class="line">  <span class="attribute">background</span>: <span class="built_in">var</span>(--nav-bar-background-color);</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">50px</span>;</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">  <span class="attribute">display</span>: flex;</span><br><span class="line">  <span class="attribute">align-items</span>: center;</span><br><span class="line">  <span class="attribute">flex-direction</span>: column;</span><br><span class="line">  <span class="attribute">border-radius</span> <span class="number">0</span> <span class="number">0</span> <span class="number">10px</span> <span class="number">10px</span></span><br><span class="line">  <span class="selector-class">.message-container</span></span><br><span class="line">    <span class="attribute">display</span>: flex;</span><br><span class="line">    <span class="attribute">flex-wrap</span>: nowrap;</span><br><span class="line">    <span class="attribute">height</span>: <span class="number">50px</span>;</span><br><span class="line">    <span class="attribute">width</span>: <span class="number">100%</span>;</span><br><span class="line">    <span class="attribute">align-items</span>: center;</span><br><span class="line">    <span class="attribute">flex-direction</span>: row;</span><br><span class="line">    <span class="selector-class">.message-item</span></span><br><span class="line">      <span class="attribute">display</span>: inline-flex</span><br><span class="line">      <span class="attribute">justify-content</span>: center</span><br><span class="line">      <span class="attribute">height</span>: <span class="number">50px</span></span><br><span class="line">      <span class="attribute">align-items</span>: center;</span><br><span class="line">    <span class="selector-class">.message-weather</span></span><br><span class="line">      <span class="attribute">width</span> <span class="number">25%</span></span><br><span class="line">      <span class="selector-class">.s-sticker-tmp</span><span class="selector-class">.module</span></span><br><span class="line">        <span class="attribute">color</span>: <span class="built_in">var</span>(--nav-font-color) <span class="meta">!important</span>;</span><br><span class="line">        <span class="attribute">font-family</span>: <span class="string">&#x27;ZhuZiAYuanJWD&#x27;</span> <span class="meta">!important</span>;</span><br><span class="line">      <span class="selector-class">.s-sticker-city</span><span class="selector-class">.module</span></span><br><span class="line">        <span class="attribute">color</span>: <span class="built_in">var</span>(--nav-font-color) <span class="meta">!important</span>;</span><br><span class="line">        <span class="attribute">font-family</span>: <span class="string">&#x27;ZhuZiAYuanJWD&#x27;</span> <span class="meta">!important</span>;</span><br><span class="line">    <span class="selector-class">.message-date</span></span><br><span class="line">      <span class="attribute">width</span> <span class="number">50%</span></span><br><span class="line">      <span class="selector-class">.message-date-box</span></span><br><span class="line">        <span class="attribute">display</span>: flex;</span><br><span class="line">        <span class="attribute">align-items</span>: center;</span><br><span class="line">        <span class="attribute">justify-content</span>: center;</span><br><span class="line">        <span class="attribute">width</span> <span class="number">50%</span></span><br><span class="line">        <span class="attribute">height</span>: <span class="number">50px</span></span><br><span class="line">        <span class="attribute">position</span> absolute</span><br><span class="line">        <span class="attribute">background</span> transparent</span><br><span class="line">        <span class="attribute">transform</span> <span class="built_in">rotateX</span>(<span class="number">0deg</span>)</span><br><span class="line">        <span class="attribute">transition</span>: all <span class="number">0.5s</span> <span class="built_in">cubic-bezier</span>(<span class="number">0.59</span>, <span class="number">0.01</span>, <span class="number">0.48</span>, <span class="number">1.17</span>);</span><br><span class="line">        <span class="attribute">opacity</span> <span class="number">1</span></span><br><span class="line">        <span class="attribute">font-family</span>: <span class="string">&#x27;UnidreamLED&#x27;</span>,<span class="string">&#x27;ZhuZiAYuanJWD&#x27;</span>;</span><br><span class="line">        <span class="attribute">font-size</span>: <span class="number">20px</span>;</span><br><span class="line">      <span class="selector-class">.message-title-box</span></span><br><span class="line">        <span class="attribute">display</span>: flex;</span><br><span class="line">        <span class="attribute">align-items</span>: center;</span><br><span class="line">        <span class="attribute">justify-content</span>: center;</span><br><span class="line">        <span class="attribute">width</span> <span class="number">50%</span></span><br><span class="line">        <span class="attribute">height</span>: <span class="number">50px</span></span><br><span class="line">        <span class="attribute">position</span> absolute</span><br><span class="line">        <span class="attribute">background</span> transparent</span><br><span class="line">        <span class="attribute">transform</span> <span class="built_in">rotateX</span>(-<span class="number">180deg</span>)</span><br><span class="line">        <span class="attribute">transition</span>: all <span class="number">0.5s</span> <span class="built_in">cubic-bezier</span>(<span class="number">0.59</span>, <span class="number">0.01</span>, <span class="number">0.48</span>, <span class="number">1.17</span>);</span><br><span class="line">        <span class="attribute">opacity</span> <span class="number">0</span></span><br><span class="line">        <span class="attribute">font-family</span>: <span class="string">&#x27;ZhuZiAYuanJWD&#x27;</span>;</span><br><span class="line">        <span class="attribute">font-size</span>: <span class="number">20px</span>;</span><br><span class="line">        <span class="selector-tag">a</span></span><br><span class="line">          <span class="attribute">color</span>: <span class="built_in">var</span>(--nav-font-color)</span><br><span class="line">          <span class="selector-pseudo">&amp;:hover</span></span><br><span class="line">            <span class="attribute">color</span>: <span class="built_in">var</span>(--nav-font-hover-color)</span><br><span class="line">      <span class="selector-pseudo">&amp;:hover</span></span><br><span class="line">        <span class="selector-class">.message-date-box</span></span><br><span class="line">          <span class="attribute">transform</span> <span class="built_in">rotateX</span>(<span class="number">180deg</span>)</span><br><span class="line">          <span class="attribute">opacity</span> <span class="number">0</span></span><br><span class="line">          <span class="attribute">transition</span>: all <span class="number">0.5s</span> <span class="built_in">cubic-bezier</span>(<span class="number">0.59</span>, <span class="number">0.01</span>, <span class="number">0.48</span>, <span class="number">1.17</span>);</span><br><span class="line">        <span class="selector-class">.message-title-box</span></span><br><span class="line">          <span class="attribute">transform</span> <span class="built_in">rotateX</span>(<span class="number">0deg</span>)</span><br><span class="line">          <span class="attribute">opacity</span> <span class="number">1</span></span><br><span class="line">          <span class="attribute">transition</span>: all <span class="number">0.5s</span> <span class="built_in">cubic-bezier</span>(<span class="number">0.59</span>, <span class="number">0.01</span>, <span class="number">0.48</span>, <span class="number">1.17</span>);</span><br><span class="line">    <span class="selector-class">.message-function</span></span><br><span class="line">      <span class="attribute">justify-content</span>: center;</span><br><span class="line">      <span class="attribute">width</span> <span class="number">25%</span></span><br><span class="line">      <span class="selector-tag">a</span></span><br><span class="line">        <span class="attribute">display</span>: flex;</span><br><span class="line">        <span class="attribute">align-items</span>: center;</span><br><span class="line">      <span class="selector-id">#toggle-menu</span></span><br><span class="line">        <span class="attribute">display</span> none</span><br><span class="line"><span class="selector-tag">button</span><span class="selector-class">.active-button</span></span><br><span class="line">  <span class="attribute">background</span>: <span class="built_in">var</span>(--nav-button-color);</span><br><span class="line">  <span class="attribute">width</span>: <span class="number">70px</span>;</span><br><span class="line">  <span class="attribute">height</span>: <span class="number">10px</span>;</span><br><span class="line">  <span class="attribute">border-radius</span>: <span class="number">1px</span>;</span><br><span class="line">  <span class="attribute">margin</span>: <span class="number">0px</span> auto;</span><br><span class="line">  <span class="attribute">border-bottom</span>: <span class="number">3px</span> solid <span class="built_in">var</span>(--nav-bar-background-color);</span><br><span class="line">  <span class="attribute">border-top</span>: <span class="number">3px</span> solid <span class="built_in">var</span>(--nav-bar-background-color);</span><br><span class="line">  <span class="attribute">border-left</span>: <span class="number">10px</span> solid <span class="built_in">var</span>(--nav-bar-background-color);</span><br><span class="line">  <span class="attribute">border-right</span>: <span class="number">10px</span> solid <span class="built_in">var</span>(--nav-bar-background-color);</span><br><span class="line">  <span class="attribute">transform</span>: <span class="built_in">perspective</span>(<span class="number">0.5em</span>) <span class="built_in">rotateX</span>(-<span class="number">5deg</span>);</span><br><span class="line">  <span class="attribute">left</span>: <span class="built_in">calc</span>(<span class="number">50%</span> - <span class="number">35px</span>);</span><br><span class="line">  <span class="attribute">position</span>: absolute;</span><br><span class="line">  <span class="selector-pseudo">&amp;:hover</span></span><br><span class="line">    <span class="attribute">background</span> <span class="built_in">var</span>(--nav-active-button-color) <span class="meta">!important</span></span><br><span class="line"><span class="keyword">@media</span> screen <span class="keyword">and</span> (<span class="attribute">max-width</span>: <span class="number">768px</span>)</span><br><span class="line">.menu-container</span><br><span class="line">  .top-bar</span><br><span class="line">    .message-container</span><br><span class="line">      .message-weather</span><br><span class="line">        .s-sticker-tmp.module</span><br><span class="line">          display none !important</span><br><span class="line">        .s-sticker-city.module</span><br><span class="line">          display none !important;</span><br><span class="line"><span class="keyword">if</span> <span class="built_in">hexo-config</span>(<span class="string">&#x27;mobile_menu&#x27;</span>)</span><br><span class="line"><span class="keyword">@media</span> screen <span class="keyword">and</span> (<span class="attribute">max-width</span>: <span class="number">768px</span>)</span><br><span class="line">  .menu-container</span><br><span class="line">    .top-bar</span><br><span class="line">      .message-container</span><br><span class="line">        .message-function</span><br><span class="line">          #toggle-menu</span><br><span class="line">            display block !important</span><br></pre></td></tr></table></figure><h2 id="3-移除原生顶栏的内容"><a href="#3-移除原生顶栏的内容" class="headerlink" title="3. 移除原生顶栏的内容"></a>3. 移除原生顶栏的内容</h2><p>移除<code>main.js</code>中关于原生顶栏的内容</p><div class="tip warning faa-horizontal animated-hover"><p>移除了原文中的 overflow-x 使其更加美观</p></div><figure class="highlight diff"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br></pre></td><td class="code"><pre><span class="line">  .</span><br><span class="line">  .</span><br><span class="line">  .</span><br><span class="line"></span><br><span class="line">  let blogNameWidth, menusWidth, searchWidth, $nav</span><br><span class="line">  let mobileSidebarOpen = false</span><br><span class="line"></span><br><span class="line"><span class="deletion">- const adjustMenu = (init) =&gt; &#123;</span></span><br><span class="line"><span class="deletion">-   if (init) &#123;</span></span><br><span class="line"><span class="deletion">-     blogNameWidth = document.getElementById(&#x27;site-name&#x27;).offsetWidth</span></span><br><span class="line"><span class="deletion">-     const $menusEle = document.querySelectorAll(&#x27;#menus .menus_item&#x27;)</span></span><br><span class="line"><span class="deletion">-     menusWidth = 0</span></span><br><span class="line"><span class="deletion">-     $menusEle.length &amp;&amp; $menusEle.forEach(i =&gt; &#123; menusWidth += i.offsetWidth &#125;)</span></span><br><span class="line"><span class="deletion">-     const $searchEle = document.querySelector(&#x27;#search-button&#x27;)</span></span><br><span class="line"><span class="deletion">-     searchWidth = $searchEle ? $searchEle.offsetWidth : 0</span></span><br><span class="line"><span class="deletion">-     $nav = document.getElementById(&#x27;nav&#x27;)</span></span><br><span class="line"><span class="deletion">-   &#125;</span></span><br><span class="line"><span class="deletion">-</span></span><br><span class="line"><span class="deletion">-   let hideMenuIndex = &#x27;&#x27;</span></span><br><span class="line"><span class="deletion">-   if (window.innerWidth &lt; 768) hideMenuIndex = true</span></span><br><span class="line"><span class="deletion">-   else hideMenuIndex = blogNameWidth + menusWidth + searchWidth &gt; $nav.offsetWidth - 120</span></span><br><span class="line"><span class="deletion">-</span></span><br><span class="line"><span class="deletion">-   if (hideMenuIndex) &#123;</span></span><br><span class="line"><span class="deletion">-     $nav.classList.add(&#x27;hide-menu&#x27;)</span></span><br><span class="line"><span class="deletion">-   &#125; else &#123;</span></span><br><span class="line"><span class="deletion">-     $nav.classList.remove(&#x27;hide-menu&#x27;)</span></span><br><span class="line"><span class="deletion">-   &#125;</span></span><br><span class="line"><span class="deletion">- &#125;</span></span><br><span class="line"><span class="deletion">-</span></span><br><span class="line"><span class="deletion">- // 初始化header</span></span><br><span class="line"><span class="deletion">- const initAdjust = () =&gt; &#123;</span></span><br><span class="line"><span class="deletion">-   adjustMenu(true)</span></span><br><span class="line"><span class="deletion">-   $nav.classList.add(&#x27;show&#x27;)</span></span><br><span class="line"><span class="deletion">- &#125;</span></span><br><span class="line"></span><br><span class="line">  // sidebar menus</span><br><span class="line">  const sidebarFn = &#123;</span><br><span class="line">    open: () =&gt; &#123;</span><br><span class="line"></span><br><span class="line">  .</span><br><span class="line">  .</span><br><span class="line">  .</span><br><span class="line"></span><br><span class="line">  const unRefreshFn = function () &#123;</span><br><span class="line">    window.addEventListener(&#x27;resize&#x27;, () =&gt; &#123;</span><br><span class="line"><span class="deletion">-     adjustMenu(false)</span></span><br><span class="line">      btf.isHidden(document.getElementById(&#x27;toggle-menu&#x27;)) &amp;&amp; mobileSidebarOpen &amp;&amp; sidebarFn.close()</span><br><span class="line">    &#125;)</span><br><span class="line"></span><br><span class="line">  .</span><br><span class="line">  .</span><br><span class="line">  .</span><br><span class="line"></span><br><span class="line">  window.refreshFn = function () &#123;</span><br><span class="line"><span class="deletion">-   initAdjust()</span></span><br><span class="line"></span><br><span class="line">    if (GLOBAL_CONFIG_SITE.isPost) &#123;</span><br><span class="line">      GLOBAL_CONFIG.noticeOutdate !== undefined &amp;&amp; addPostOutdateNotice()</span><br><span class="line">      GLOBAL_CONFIG.relativeDate.post &amp;&amp; relativeDate(document.querySelectorAll(&#x27;#post-meta time&#x27;))</span><br></pre></td></tr></table></figure><h2 id="4-新建顶栏JS文件"><a href="#4-新建顶栏JS文件" class="headerlink" title="4. 新建顶栏JS文件"></a>4. 新建顶栏JS文件</h2><p>新建<code>[Blogroot]\themes\butterfly\source\js\custom\nav.js</code></p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//鼠标控制横向滚动</span></span><br><span class="line"><span class="keyword">if</span> (<span class="variable language_">document</span>.<span class="title function_">getElementsByClassName</span>(<span class="string">&quot;menu-item&quot;</span>)[<span class="number">0</span>])&#123;</span><br><span class="line">  <span class="keyword">var</span> xscroll = <span class="variable language_">document</span>.<span class="title function_">getElementsByClassName</span>(<span class="string">&quot;menu-item&quot;</span>)[<span class="number">0</span>];</span><br><span class="line">  xscroll.<span class="title function_">addEventListener</span>(<span class="string">&quot;mousewheel&quot;</span>, <span class="keyword">function</span> (<span class="params">e</span>) &#123;</span><br><span class="line">  <span class="comment">//计算鼠标滚轮滚动的距离</span></span><br><span class="line">  <span class="keyword">var</span> v = -e.<span class="property">wheelDelta</span> / <span class="number">2</span>;</span><br><span class="line">  xscroll.<span class="property">scrollLeft</span> += v;</span><br><span class="line">  <span class="comment">//阻止浏览器默认方法</span></span><br><span class="line">  e.<span class="title function_">preventDefault</span>();</span><br><span class="line">  &#125;, <span class="literal">false</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 获取当前时间</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> box = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;message-date-box&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">//不足十位补零</span></span><br><span class="line"><span class="keyword">var</span> <span class="title function_">addZero</span> = val =&gt; val &lt; <span class="number">10</span> ? <span class="string">&#x27;0&#x27;</span> + val : val</span><br><span class="line"><span class="comment">//把阿拉伯数字的星期转化为中国汉字的星期 // 星期映射表</span></span><br><span class="line"><span class="keyword">var</span> <span class="title function_">trans</span> = val =&gt; &#123;</span><br><span class="line">    <span class="keyword">var</span> obj = &#123;</span><br><span class="line">        <span class="number">0</span>: <span class="string">&#x27;日&#x27;</span>,</span><br><span class="line">        <span class="number">1</span>: <span class="string">&#x27;一&#x27;</span>,</span><br><span class="line">        <span class="number">2</span>: <span class="string">&#x27;二&#x27;</span>,</span><br><span class="line">        <span class="number">3</span>: <span class="string">&#x27;三&#x27;</span>,</span><br><span class="line">        <span class="number">4</span>: <span class="string">&#x27;四&#x27;</span>,</span><br><span class="line">        <span class="number">5</span>: <span class="string">&#x27;五&#x27;</span>,</span><br><span class="line">        <span class="number">6</span>: <span class="string">&#x27;六&#x27;</span></span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> obj[val]</span><br><span class="line">&#125;</span><br><span class="line"><span class="title function_">setTime</span> ()</span><br><span class="line"><span class="comment">//获取时间的方法</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">setTime</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> time = <span class="keyword">new</span> <span class="title class_">Date</span>();</span><br><span class="line">    <span class="comment">// var year = time.getFullYear(); // 获取年</span></span><br><span class="line">    <span class="comment">// var month = time.getMonth() + 1; // 获取月（是从0到11，所以我们要给他加1）</span></span><br><span class="line">    <span class="comment">// var date = time.getDate(); // 获取日</span></span><br><span class="line">    <span class="keyword">var</span> hour = time.<span class="title function_">getHours</span>(); <span class="comment">// 获取小时</span></span><br><span class="line">    <span class="keyword">var</span> min = time.<span class="title function_">getMinutes</span>(); <span class="comment">// 获取分钟</span></span><br><span class="line">    <span class="keyword">var</span> sec = time.<span class="title function_">getSeconds</span>(); <span class="comment">// 获取秒</span></span><br><span class="line">    <span class="keyword">var</span> day = time.<span class="title function_">getDay</span>(); <span class="comment">// 获取星期几(0是星期日)</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> value = <span class="title function_">addZero</span>(hour) +</span><br><span class="line">        <span class="string">&#x27;:&#x27;</span> + <span class="title function_">addZero</span>(min) + <span class="string">&quot;:&quot;</span> + <span class="title function_">addZero</span>(sec) + <span class="string">&#x27; 星期&#x27;</span>+ <span class="title function_">trans</span>(day)</span><br><span class="line">    <span class="comment">// 把所有的时间拼接到一起</span></span><br><span class="line">    box.<span class="property">innerText</span> = value</span><br><span class="line">    <span class="comment">// console.log(value)</span></span><br><span class="line">    <span class="comment">// 把拼接好的时间插入到页面</span></span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// 让定时器每间隔一秒就执行一次setTime这个方法（这是实现时钟的核心）</span></span><br><span class="line"><span class="built_in">setInterval</span>(setTime, <span class="number">1000</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">Navvisible</span>(<span class="params"></span>)&#123;</span><br><span class="line">  <span class="keyword">var</span> navbar = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;menu-container&#x27;</span>)</span><br><span class="line">  <span class="keyword">if</span> (navbar) &#123;</span><br><span class="line">      <span class="comment">// 首先判断是否存在active类</span></span><br><span class="line">      <span class="keyword">if</span> (navbar.<span class="property">className</span>.<span class="title function_">indexOf</span>(<span class="string">&#x27;active-menu-bar&#x27;</span>) &gt; -<span class="number">1</span>)&#123;</span><br><span class="line">        <span class="comment">// 存在则移除</span></span><br><span class="line">        navbar.<span class="property">classList</span>.<span class="title function_">remove</span>(<span class="string">&#x27;active-menu-bar&#x27;</span>);</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="comment">// 不存在则先添加</span></span><br><span class="line">        navbar.<span class="property">classList</span>.<span class="title function_">add</span>(<span class="string">&#x27;active-menu-bar&#x27;</span>);</span><br><span class="line">      &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure><h2 id="5-引入样式文件"><a href="#5-引入样式文件" class="headerlink" title="5. 引入样式文件"></a>5. 引入样式文件</h2><p>在<code>[Blogroot]\_config.butterfly.yml</code>的<code>inject</code>配置项中引入</p><div class="tip warning faa-horizontal animated-hover"><p>注意：nav.js 每页都需要加载 ，故插入 js 时应当加入 data-pjax 标签排除 pjax</p></div><figure class="highlight diff"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">  bottom:</span><br><span class="line"><span class="addition">+   - &lt;script async data-pjax src=&quot;/js/custom/nav.js&quot;&gt;&lt;/script&gt;</span></span><br></pre></td></tr></table></figure><h2 id="6-新增配置项"><a href="#6-新增配置项" class="headerlink" title="6. 新增配置项"></a>6. 新增配置项</h2><p>在<code>[Blogroot]\_config.butterfly.yml</code>中新增配置项<code>mobile_menu</code>以控制手机端是否需要启用侧栏展开的菜单</p><figure class="highlight yml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">menu:</span></span><br><span class="line">  <span class="string">首页:</span> <span class="string">/</span> <span class="string">||</span> <span class="string">fas</span> <span class="string">fa-home</span> <span class="string">||</span> <span class="string">faa-tada</span></span><br><span class="line">  <span class="string">目录||</span> <span class="string">fas</span> <span class="string">fa-compass</span> <span class="string">||</span> <span class="attr">faa-tada:</span></span><br><span class="line">    <span class="string">归档:</span> <span class="string">/archives/</span> <span class="string">||</span> <span class="string">fas</span> <span class="string">fa-archive</span> <span class="string">||</span> <span class="string">faa-tada</span></span><br><span class="line">    <span class="string">标签:</span> <span class="string">/tags/</span> <span class="string">||</span> <span class="string">fas</span> <span class="string">fas</span> <span class="string">fa-tags</span> <span class="string">||</span> <span class="string">faa-tada</span></span><br><span class="line">    <span class="string">分类:</span> <span class="string">/categories/</span> <span class="string">||</span> <span class="string">fas</span> <span class="string">fa-folder-open</span> <span class="string">||</span> <span class="string">faa-tada</span></span><br><span class="line"></span><br><span class="line"><span class="attr">mobile_menu:</span> <span class="literal">false</span></span><br></pre></td></tr></table></figure><h2 id="7-添加天气显示"><a href="#7-添加天气显示" class="headerlink" title="7. 添加天气显示"></a>7. 添加天气显示</h2><p>如果要添加天气显示，需要先去心知天气创建应用，在用下方网址创建js，写入文件并引入</p><div class="tip info"><p>插件类型随意选择，需要吸附顶栏则选择固定极简，其余根据需要选择</p></div><div calss='anzhiyu-tag-link'><a class="tag-Link" target="_blank" href="https://www.seniverse.com/widgetv3">    <div class="tag-link-tips">引用站外地址</div>    <div class="tag-link-bottom">        <div class="tag-link-left" style="background-image: url(https://cdn.sencdn.com/widget2/assets/img/chameleon/logo.svg)">          <i class="anzhiyufont anzhiyu-icon-link" style="display: none"></i>        </div>        <div class="tag-link-right">            <div class="tag-link-title">心知天气Widget生成</div>            <div class="tag-link-sitename"> https://www.seniverse.com/widgetv3</div>        </div>        <i class="anzhiyufont anzhiyu-icon-angle-right"></i>    </div>    </a></div><p>点击生成后会得到一段HTML，将其<code>script</code>部分复制到自定义位置的<code>weather.js</code>并在<code>[Blogroot]\_config.butterfly.yml</code>中引入即可</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;tp-weather-widget&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  (<span class="keyword">function</span>(<span class="params">a,h,g,f,e,d,c,b</span>)&#123;b=<span class="keyword">function</span>(<span class="params"></span>)&#123;d=h.<span class="title function_">createElement</span>(g);c=h.<span class="title function_">getElementsByTagName</span>(g)[<span class="number">0</span>];d.<span class="property">src</span>=e;d.<span class="property">charset</span>=<span class="string">&quot;utf-8&quot;</span>;d.<span class="property">async</span>=<span class="number">1</span>;c.<span class="property">parentNode</span>.<span class="title function_">insertBefore</span>(d,c)&#125;;a[<span class="string">&quot;SeniverseWeatherWidgetObject&quot;</span>]=f;a[f]||(a[f]=<span class="keyword">function</span>(<span class="params"></span>)&#123;(a[f].<span class="property">q</span>=a[f].<span class="property">q</span>||[]).<span class="title function_">push</span>(<span class="variable language_">arguments</span>)&#125;);a[f].<span class="property">l</span>=+<span class="keyword">new</span> <span class="title class_">Date</span>();<span class="keyword">if</span>(a.<span class="property">attachEvent</span>)&#123;a.<span class="title function_">attachEvent</span>(<span class="string">&quot;onload&quot;</span>,b)&#125;<span class="keyword">else</span>&#123;a.<span class="title function_">addEventListener</span>(<span class="string">&quot;load&quot;</span>,b,<span class="literal">false</span>)&#125;&#125;(<span class="variable language_">window</span>,<span class="variable language_">document</span>,<span class="string">&quot;script&quot;</span>,<span class="string">&quot;SeniverseWeatherWidget&quot;</span>,<span class="string">&quot;//cdn.sencdn.com/widget2/static/js/bundle.js?t=&quot;</span>+<span class="built_in">parseInt</span>((<span class="keyword">new</span> <span class="title class_">Date</span>().<span class="title function_">getTime</span>() / <span class="number">100000000</span>).<span class="title function_">toString</span>(),<span class="number">10</span>)));</span></span><br><span class="line"><span class="language-javascript">  <span class="variable language_">window</span>.<span class="title class_">SeniverseWeatherWidget</span>(<span class="string">&#x27;show&#x27;</span>, &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">flavor</span>: <span class="string">&quot;slim&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">location</span>: <span class="string">&quot;XXXXXXXXXXXX&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">geolocation</span>: <span class="literal">true</span>,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">language</span>: <span class="string">&quot;auto&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">unit</span>: <span class="string">&quot;c&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">theme</span>: <span class="string">&quot;auto&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">token</span>: <span class="string">&quot;xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">hover</span>: <span class="string">&quot;enabled&quot;</span>,</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">container</span>: <span class="string">&quot;tp-weather-widget&quot;</span></span></span><br><span class="line"><span class="language-javascript">  &#125;)</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">(<span class="keyword">function</span>(<span class="params">a,h,g,f,e,d,c,b</span>)&#123;b=<span class="keyword">function</span>(<span class="params"></span>)&#123;d=h.<span class="title function_">createElement</span>(g);c=h.<span class="title function_">getElementsByTagName</span>(g)[<span class="number">0</span>];d.<span class="property">src</span>=e;d.<span class="property">charset</span>=<span class="string">&quot;utf-8&quot;</span>;d.<span class="property">async</span>=<span class="number">1</span>;c.<span class="property">parentNode</span>.<span class="title function_">insertBefore</span>(d,c)&#125;;a[<span class="string">&quot;SeniverseWeatherWidgetObject&quot;</span>]=f;a[f]||(a[f]=<span class="keyword">function</span>(<span class="params"></span>)&#123;(a[f].<span class="property">q</span>=a[f].<span class="property">q</span>||[]).<span class="title function_">push</span>(<span class="variable language_">arguments</span>)&#125;);a[f].<span class="property">l</span>=+<span class="keyword">new</span> <span class="title class_">Date</span>();<span class="keyword">if</span>(a.<span class="property">attachEvent</span>)&#123;a.<span class="title function_">attachEvent</span>(<span class="string">&quot;onload&quot;</span>,b)&#125;<span class="keyword">else</span>&#123;a.<span class="title function_">addEventListener</span>(<span class="string">&quot;load&quot;</span>,b,<span class="literal">false</span>)&#125;&#125;(<span class="variable language_">window</span>,<span class="variable language_">document</span>,<span class="string">&quot;script&quot;</span>,<span class="string">&quot;SeniverseWeatherWidget&quot;</span>,<span class="string">&quot;//cdn.sencdn.com/widget2/static/js/bundle.js?t=&quot;</span>+<span class="built_in">parseInt</span>((<span class="keyword">new</span> <span class="title class_">Date</span>().<span class="title function_">getTime</span>() / <span class="number">100000000</span>).<span class="title function_">toString</span>(),<span class="number">10</span>)));</span><br><span class="line"><span class="variable language_">window</span>.<span class="title class_">SeniverseWeatherWidget</span>(<span class="string">&#x27;show&#x27;</span>, &#123;</span><br><span class="line">  <span class="attr">flavor</span>: <span class="string">&quot;slim&quot;</span>,</span><br><span class="line">  <span class="attr">location</span>: <span class="string">&quot;XXXXXXXXXXXX&quot;</span>,</span><br><span class="line">  <span class="attr">geolocation</span>: <span class="literal">true</span>,</span><br><span class="line">  <span class="attr">language</span>: <span class="string">&quot;auto&quot;</span>,</span><br><span class="line">  <span class="attr">unit</span>: <span class="string">&quot;c&quot;</span>,</span><br><span class="line">  <span class="attr">theme</span>: <span class="string">&quot;auto&quot;</span>,</span><br><span class="line">  <span class="attr">token</span>: <span class="string">&quot;xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx&quot;</span>,</span><br><span class="line">  <span class="attr">hover</span>: <span class="string">&quot;enabled&quot;</span>,</span><br><span class="line">  <span class="attr">container</span>: <span class="string">&quot;tp-weather-widget&quot;</span></span><br><span class="line">&#125;)</span><br></pre></td></tr></table></figure><div class="tip warning faa-horizontal animated-hover"><p>注意：weather.js 每页都需要加载 ，故也要加入 data-pjax 标签</p></div><figure class="highlight diff"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">      bottom:</span><br><span class="line"><span class="addition">+       - &lt;script async data-pjax src=&quot;/js/weather.js&quot;&gt;&lt;/script&gt;</span></span><br></pre></td></tr></table></figure>]]></content>
      
      
      <categories>
          
          <category> Hexo </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 美化 </tag>
            
            <tag> 魔改 </tag>
            
            <tag> Butterfly </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>在网页上加入live2d</title>
      <link href="//posts/57431/"/>
      <url>//posts/57431/</url>
      
        <content type="html"><![CDATA[<p><img src="https://cdn.randench.cn/image/24/08/6fbacae1fa5afe83.svg"><img src="https://cdn.randench.cn/image/24/08/fa32683e95e6f5df.svg"><img src="https://cdn.randench.cn/image/24/08/3b19b5fedf53f05c.svg"><img src="https://cdn.randench.cn/image/24/08/76b617dd255633e9.svg"><img src="https://cdn.randench.cn/image/24/08/f89c015b12c5fda5.svg"><img src="https://cdn.randench.cn/image/24/08/571130d7213bb367.svg"></p><h1 id="项目地址"><a href="#项目地址" class="headerlink" title="项目地址"></a>项目地址</h1><p>我的Fork: <a href="https://github.com/RandomEnch/live2d-widget">https://github.com/RandomEnch/live2d-widget</a><br>原地址: <a href="https://github.com/stevenjoezhang/live2d-widget">https://github.com/stevenjoezhang/live2d-widget</a><br>修改于: <a href="https://github.com/fghrsh/live2d_demo">https://github.com/fghrsh/live2d_demo</a><br>API: <a href="https://github.com/fghrsh/live2d_api">https://github.com/fghrsh/live2d_api</a></p><h1 id="特点"><a href="#特点" class="headerlink" title="特点"></a>特点</h1><p>在网页中添加 Live2D 看板娘。兼容 PJAX，支持无刷新加载。<br>警告：本项目使用了大量 ES6 语法，不支持 IE 11 等老旧浏览器。</p><h1 id="示例"><a href="#示例" class="headerlink" title="示例"></a>示例</h1><p>在PC端博客的右下角可查看效果。</p><p><img src="https://cdn.randench.cn/image/24/08/2d18fb589c75591a.png"></p><h1 id="依赖"><a href="#依赖" class="headerlink" title="依赖"></a>依赖</h1><p>插件需要 Font Awesome 图标支持，请确保相关样式表已在页面中加载。以 Font Awesome v6 为例，请在 <code>&lt;head&gt;</code> 中导入 <code>all.min.css</code> 。<br>建议保存到本地后导入</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">&quot;stylesheet&quot;</span> <span class="attr">href</span>=<span class="string">&quot;https://cdn.jsdelivr.net/gh/RandomEnch/live2d-widget/all.min.css&quot;</span>&gt;</span></span><br></pre></td></tr></table></figure><h1 id="使用"><a href="#使用" class="headerlink" title="使用"></a>使用</h1><p>将这一行代码加入<code>&lt;head&gt;</code>或<code>&lt;body&gt;</code>，即可展现出效果：</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;https://cdn.jsdelivr.net/gh/RandomEnch/live2d-widget/autoload.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure><p>如果网站启用了 PJAX，由于看板娘不必每页刷新，因此要注意将相关脚本放到 PJAX 刷新区域之外。</p><p>换句话说，如果你是小白，或者只需要最基础的功能，就只用把这一行代码，连同前面加载 Font Awesome 的一行代码，一起放到 html 的 <code>&lt;head&gt;</code> 中即可。<br>对于用各种模版引擎（例如 Nunjucks，Jinja 或者 PHP）生成的页面，也要自行修改，方法类似，只是可能略为麻烦。</p><p>但是！我们强烈推荐自己进行配置，否则很多功能是不完整的，并且可能产生问题！<br>如果你有兴趣自己折腾的话，请看下面的详细说明。</p><h1 id="自定义配置"><a href="#自定义配置" class="headerlink" title="自定义配置"></a>自定义配置</h1><p>原来的项目使用了jsdeliver，而此处使用的是我自己构建的版本。<br>如果想自己修改使用，请自行clone原项目仓库。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git <span class="built_in">clone</span> https://github.com/stevenjoezhang/live2d-widget.git</span><br></pre></td></tr></table></figure><p>原项目部分内容已失效，如不想更改，可clone我的fork仓库。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git <span class="built_in">clone</span> https://github.com/RandomEnch/live2d-widget.git</span><br></pre></td></tr></table></figure><h2 id="修改"><a href="#修改" class="headerlink" title="修改"></a>修改</h2><p>修改<code>autoload.js</code>第34行后部分为：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">initWidget</span>(&#123;</span><br><span class="line"><span class="attr">waifuPath</span>: live2d_path + <span class="string">&quot;waifu-tips.json&quot;</span>,</span><br><span class="line"><span class="attr">apiPath</span>: <span class="string">&quot;你的自建api地址(可本地，可链接)&quot;</span>,</span><br><span class="line"><span class="comment">// 或者直接使用CDN的api</span></span><br><span class="line"><span class="comment">//cdnPath: &quot;https://npm.elemecdn.com/akilar-live2dapi@latest/&quot;</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><h2 id="API"><a href="#API" class="headerlink" title="API"></a>API</h2><p><code>initWidget</code> 方法接受名为 <code>apiPath</code> 和 <code>cdnPath</code> 的参数，两者设置其中一项即可。其中 <code>apiPath</code> 为后端 API 的 URL，可以自行搭建，并增加模型。</p><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git <span class="built_in">clone</span> https://github.com/fghrsh/live2d_demo.git</span><br></pre></td></tr></table></figure><p>将api放在网站目录中即可本地引用api，<code>autoload.js</code>格式为：</p><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_">initWidget</span>(&#123;</span><br><span class="line"><span class="attr">waifuPath</span>: live2d_path + <span class="string">&quot;waifu-tips.json&quot;</span>,</span><br><span class="line"><span class="attr">apiPath</span>: <span class="string">&quot;/live2d_demo/&quot;</span>,</span><br><span class="line"><span class="comment">//cdnPath: &quot;https://npm.elemecdn.com/akilar-live2dapi@latest/&quot;</span></span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure><h1 id="目录结构-Files"><a href="#目录结构-Files" class="headerlink" title="目录结构 Files"></a>目录结构 Files</h1><ul><li><code>waifu-tips.js</code> 包含了按钮和对话框的逻辑；</li><li><code>waifu-tips.json</code> 中定义了触发条件（<code>selector</code>，CSS 选择器）和触发时显示的文字（<code>text</code>）；</li><li><code>waifu.css</code> 是看板娘的样式表。</li></ul><div class="note warning flat"><p>警告：作者不对包括但不限于 waifu-tips.js 和 waifu-tips.json 文件中的内容负责，请自行确保它们是合适的。</p></div>]]></content>
      
      
      <categories>
          
          <category> Hexo </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 美化 </tag>
            
            <tag> 前端 </tag>
            
            <tag> live2d </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>刷课插件分享</title>
      <link href="//posts/56422/"/>
      <url>//posts/56422/</url>
      
        <content type="html"><![CDATA[<h1 id="序"><a href="#序" class="headerlink" title="序"></a>序</h1><p>想必大家都在为烦闷无聊的网课而烦恼，不刷又拿不到学分，在此推荐一些好用的刷网课插件。</p><span id="more"></span><h1 id="安装插件"><a href="#安装插件" class="headerlink" title="安装插件"></a>安装插件</h1><div class="tabs" id="plugin"><ul class="nav-tabs"><button type="button" class="tab  active" data-href="plugin-1">油猴</button><button type="button" class="tab " data-href="plugin-2">脚本猫</button></ul><div class="tab-contents"><div class="tab-item-content active" id="plugin-1"><p>使用Chrome或者Firefox浏览器，安装 <a href="https://chrome.google.com/webstore/detail/tampermonkey/dhdgffkkebhmkfjojejmpbldmpobfkfo">Tampermonkey</a> (油猴) 插件(需要翻墙)</p></div><div class="tab-item-content" id="plugin-2"><p>使用Chrome或者Firefox浏览器，安装 <a href="https://chrome.google.com/webstore/detail/scriptcat/ndcooeababalnlpkfedmmbbbgkljhpjf">Script Cat</a> (脚本猫) 插件(需要翻墙)<br>或者在 <a href="https://github.com/scriptscat/scriptcat/releases">Github</a> 下载</p></div></div><div class="tab-to-top"><button type="button" aria-label="scroll to top"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i></button></div></div><h1 id="插件地址"><a href="#插件地址" class="headerlink" title="插件地址"></a>插件地址</h1><h1 id="多功能-支持超星和智慧树"><a href="#多功能-支持超星和智慧树" class="headerlink" title="多功能  (支持超星和智慧树)"></a>多功能  (支持超星和智慧树)</h1><blockquote><p><a href="https://scriptcat.org/script-show-page/367">OCS 网课助手</a><br><a href="https://bbs.tampermonkey.net.cn/thread-61-1-1.html">网课小工具</a></p></blockquote><h1 id="刷课"><a href="#刷课" class="headerlink" title="刷课"></a>刷课</h1><blockquote><p><a href="https://scriptcat.org/script-show-page/21">中国大学mooc</a><br><a href="https://scriptcat.org/script-show-page/10">超星学习通</a><br><a href="https://bbs.tampermonkey.net.cn/thread-16-1-1.html">超星学习通考试用</a><br><a href="https://scriptcat.org/script-show-page/12">智慧树知到</a></p></blockquote><h1 id="使用方法"><a href="#使用方法" class="headerlink" title="使用方法"></a>使用方法</h1><p>此处以chrome浏览器为例</p><h1 id="安装"><a href="#安装" class="headerlink" title="安装"></a>安装</h1><p>如果插件从浏览器安装可跳过这一步<br>解压文件后得到crx文件<br>按下图步骤操作，选择crx文件安装，安装完毕</p><p><img src="https://cdn.randench.cn/image/24/08/3e3d7fd3dd93f517.png"></p><p><img src="https://cdn.randench.cn/image/24/08/fbe60bc6f33654c7.png"></p><p><img src="https://cdn.randench.cn/image/24/08/136792348b2c2a2d.png"></p><h1 id="脚本"><a href="#脚本" class="headerlink" title="脚本"></a>脚本</h1><p>从上文中所给的链接中安装，全部安装完毕后重启浏览器即可使用。<br>相关网页中也可管理插件列表，具体方法不做说明。</p><p><img src="https://cdn.randench.cn/image/24/08/49cc0019764c4ab8.png"></p>]]></content>
      
      
      <categories>
          
          <category> 实用 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> 工具 </tag>
            
            <tag> 网课 </tag>
            
            <tag> 油猴 </tag>
            
        </tags>
      
    </entry>
    
    
    
    <entry>
      <title>如何寻找Gal</title>
      <link href="//posts/41650/"/>
      <url>//posts/41650/</url>
      
        <content type="html"><![CDATA[<h2 id="准备"><a href="#准备" class="headerlink" title="准备"></a>准备</h2><p>首先你需要知道你需要的Gal的名称，最好知道日文和英文，搜索时会用到，接着就可以去资源网查找了。</p><h2 id="不知道玩什么Gal"><a href="#不知道玩什么Gal" class="headerlink" title="不知道玩什么Gal"></a>不知道玩什么Gal</h2><p><a href="https://vndb.org/">VNDB</a> 可以自选tag筛选Gal的网站，根据你想玩的类型选择tag查找吧~<br>注：网页为英文</p><details class="folding-tag" ><summary> 网页预览 </summary>              <div class='content'>              <p><img src="https://cdn.randench.cn/image/24/08/763b5eae0a852e60.png"></p>              </div>            </details><h2 id="如何查找"><a href="#如何查找" class="headerlink" title="如何查找"></a>如何查找</h2><blockquote><p><a href="https://www.qingju.org/">青桔网</a> （不需要魔法）<br><a href="https://blog.reimu.net/">灵梦御所</a> （需要魔法）<br><a href="https://www.hacg.uno/">琉璃神社</a>（不需要魔法）<br><a href="https://www.vikacg.com/">维咔VikACG</a> （需要魔法）<br><a href="https://www.zeroland.top/">白猫咖啡馆</a>（不需要魔法）</p></blockquote><h2 id="如何使用琉璃神社"><a href="#如何使用琉璃神社" class="headerlink" title="如何使用琉璃神社"></a>如何使用琉璃神社</h2><p>翻到页面最下方，你会看见<code>magnet:?xt=urn:btih:</code><br>且文中会有神秘代码，我猜你应该知道怎么用。</p><h2 id="如何使用灵梦御所"><a href="#如何使用灵梦御所" class="headerlink" title="如何使用灵梦御所"></a>如何使用灵梦御所</h2><p>打开网站后会提示输入密码，密码为⑨，下载的压缩包密码基本上也是⑨，除非有特别说明<br>找到相应Gal后，向下翻到发布者位置使用键盘按键↑↑↓↓←→←→BA即可得到隐藏内容</p><div class="note warning flat"><p>自从炸站之后此功能仅供娱乐，获取资源请去网站首页图片里的telegram群</p></div><h2 id="标准码-秒传-使用"><a href="#标准码-秒传-使用" class="headerlink" title="标准码(秒传)使用"></a>标准码(秒传)使用</h2><p>标准码自2023年8月后已失效，请使用网盘链接或者磁链下载，标准码资源均已失效</p>]]></content>
      
      
      <categories>
          
          <category> 游戏 </category>
          
      </categories>
      
      
        <tags>
            
            <tag> Galgame </tag>
            
        </tags>
      
    </entry>
    
    
  
  
</search>
