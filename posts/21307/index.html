<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no"><title>Python使用Redis缓存 | RE Blog</title><meta name="keywords" content="Python,Redis"><meta name="author" content="RandomEnch"><meta name="copyright" content="RandomEnch"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#f7f9fe"><meta name="mobile-web-app-capable" content="yes"><meta name="apple-touch-fullscreen" content="yes"><meta name="apple-mobile-web-app-title" content="Python使用Redis缓存"><meta name="application-name" content="Python使用Redis缓存"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="#f7f9fe"><meta property="og:type" content="article"><meta property="og:title" content="Python使用Redis缓存"><meta property="og:url" content="https://blog.randench.cn/posts/21307/index.html"><meta property="og:site_name" content="RE Blog"><meta property="og:description" content="前言最近编写了一个Flask应用，其API接口需要访问MySQL数据库读取数据，为了防止高并发情况下MySQL数据库的压力，使用了Redis作为缓存来提高API接口的响应速度。本文将介绍Redis的基本概念和在Python中的使用方法。 Redis简介Redis（Remote Dictionary"><meta property="og:locale" content="zh-CN"><meta property="og:image" content="https://cdn.randench.cn/image/24/09/9e415fdaa5db2c28.png"><meta property="article:author" content="RandomEnch"><meta property="article:tag"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://cdn.randench.cn/image/24/09/9e415fdaa5db2c28.png"><meta name="description" content="前言最近编写了一个Flask应用，其API接口需要访问MySQL数据库读取数据，为了防止高并发情况下MySQL数据库的压力，使用了Redis作为缓存来提高API接口的响应速度。本文将介绍Redis的基本概念和在Python中的使用方法。 Redis简介Redis（Remote Dictionary"><link rel="shortcut icon" href="https://cdn.randench.cn/assets/favicon.ico"><link rel="canonical" href="https://blog.randench.cn/posts/21307/"><link rel="preconnect" href="//cdn.cbd.int"><link rel="preconnect" href="//busuanzi.ibruce.info"><meta name="baidu-site-verification" content="codeva-t1pjTYOK2O"><meta name="google-site-verification" content="SMbuMid4xZgbAMMIofrritxSUTqhvP03Wiv1qcKM9M0"><link rel="stylesheet" href="https://npm.elemecdn.com/hexo-butterfly-tag-plugins-plus@1.0.17/lib/assets/font-awesome-animation.min.css"><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.cbd.int/@fortawesome/fontawesome-free@6.4.0/css/all.min.css" media="print" onload='this.media="all"'><link rel="stylesheet" href="https://cdn.cbd.int/node-snackbar@0.1.16/dist/snackbar.min.css" media="print" onload='this.media="all"'><link rel="stylesheet" href="https://cdn.cbd.int/@fancyapps/ui@5.0.28/dist/fancybox/fancybox.css" media="print" onload='this.media="all"'><script>const GLOBAL_CONFIG={linkPageTop:void 0,peoplecanvas:void 0,postHeadAiDescription:{enable:!0,gptName:"ArticleGPT",mode:"tianli",switchBtn:!1,btnLink:"https://blog.randench.cn/",randomNum:3,basicWordCount:1e3,key:"5ezcXXxnlh6",Referer:"https://blog.randench.cn/"},diytitle:void 0,LA51:{enable:!0,ck:"3J7K7PX8PGQedHeG",LingQueMonitorID:"3J7KDKIWT2qKX2Fw"},greetingBox:{enable:!0,default:"晚上好👋",list:[{greeting:"晚安😴",startTime:0,endTime:5},{greeting:"早上好鸭👋, 祝你一天好心情！",startTime:6,endTime:9},{greeting:"上午好👋, 状态很好，鼓励一下～",startTime:10,endTime:10},{greeting:"11点多啦, 在坚持一下就吃饭啦～",startTime:11,endTime:11},{greeting:"午安👋, 宝贝",startTime:12,endTime:14},{greeting:"🌈充实的一天辛苦啦！",startTime:14,endTime:18},{greeting:"19点喽, 奖励一顿丰盛的大餐吧🍔。",startTime:19,endTime:19},{greeting:"晚上好👋, 在属于自己的时间好好放松😌~",startTime:20,endTime:24}]},twikooEnvId:"https://twikoo.randench.cn",commentBarrageConfig:void 0,music_page_default:"nav_music",root:"/",preloader:{source:3},friends_vue_info:void 0,navMusic:!0,mainTone:{mode:"both",api:"https://img2color.randench.cn/api?img=",cover_change:!0},authorStatus:{skills:null},algolia:void 0,localSearch:{path:"/search.xml",preload:!0,languages:{hits_empty:"找不到您查询的内容：${query}"}},translate:{defaultEncoding:2,translateDelay:0,msgToTraditionalChinese:"繁",msgToSimplifiedChinese:"简",rightMenuMsgToTraditionalChinese:"转为繁体",rightMenuMsgToSimplifiedChinese:"转为简体"},noticeOutdate:{limitDay:60,position:"top",messagePrev:"文章于",messageNext:"天前最后更新，部分内容可能已经失效。"},highlight:{plugin:"highlight.js",highlightCopy:!0,highlightLang:!0,highlightHeightLimit:330},copy:{success:"复制成功",error:"复制错误",noSupport:"浏览器不支持"},relativeDate:{homepage:!1,simplehomepage:!1,post:!1},runtime:"天",date_suffix:{just:"刚刚",min:"分钟前",hour:"小时前",day:"天前",month:"个月前"},copyright:{copy:!0,copyrightEbable:!1,limitCount:50,languages:{author:"作者: RandomEnch",link:"链接: ",source:"来源: RE Blog",info:"著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。",copySuccess:"复制成功，复制和转载请标注本文地址"}},lightbox:"fancybox",Snackbar:{chs_to_cht:"你已切换为繁体",cht_to_chs:"你已切换为简体",day_to_night:"你已切换为深色模式",night_to_day:"你已切换为浅色模式",bgLight:"#425AEF",bgDark:"#1f1f1f",position:"top-left"},source:{justifiedGallery:{js:"https://cdn.cbd.int/flickr-justified-gallery@2.1.2/dist/fjGallery.min.js",css:"https://cdn.cbd.int/flickr-justified-gallery@2.1.2/dist/fjGallery.css"}},isPhotoFigcaption:!1,islazyload:!0,isAnchor:!1,shortcutKey:{enable:!0,delay:100,shiftDelay:200},autoDarkmode:!0}</script><script id="config-diff">var GLOBAL_CONFIG_SITE={configTitle:"RE Blog",title:"Python使用Redis缓存",postAI:"true",pageFillDescription:"前言, Redis简介, Redis 特点x2F优势, Redis 为什么很快, 应用场景, Redis 常用命令, Python 中使用 Redis, 安装 redis-py 库, 连接 Redis 服务器, 数据操作, 字符串操作, 哈希操作, 列表操作, 集合操作, 有序集合, 使用Redis作为缓存前言最近编写了一个应用其接口需要访问数据库读取数据为了防止高并发情况下数据库的压力使用了作为缓存来提高接口的响应速度本文将介绍的基本概念和在中的使用方法简介是一个开源的高性能键值对存储数据库最初由开发它在内存中存储数据并提供了持久化功能可以将数据保存到磁盘中是一种非关系型数据库的数据库它的数据结构十分丰富基础数据类型包括字符串列表双向链表散列键值对集合集合不重复和有序集合这使得它不仅仅是一个简单的键值存储还可以用于存储和处理复杂的数据特点优势具备许多特点和优势所以在大规模应用和高并发场景中得到广泛应用丰富的数据结构支持多种数据结构包括字符串哈希列表集合有序集合等每种数据结构都有丰富的操作命令可以方便地对数据进行存储和处理持久化提供了两种持久化方式和是将数据库在指定时间点转储到磁盘的快照持久化方式是将写操作追加到文件末尾的日志持久化方式这两种方式可以根据需求进行选择保证数据在服务器重启后不会丢失高性能是一种内存数据库数据存储在内存中因此读写速度非常快它采用单线程模型避免了多线程带来的竞争问题使得能够充分利用和内存资源支持事务支持事务操作可以将多个命令打包执行保证这些命令要么全部执行成功要么全部失败保持数据的一致性虽然在单个命令的执行上是原子性的但是多个命令的组合并不是原子性的通过事务可以实现一组命令的原子性执行高可用与分布式支持主从复制哨兵和集群等功能可以构建高可用和分布式的架构主从复制可以实现数据的热备份和读写分离哨兵可以监控的健康状态并进行自动故障转移集群可以将数据分布在多个节点上提高性能和扩展性发布订阅支持发布订阅模式可以实现消息的发布和订阅发布者将消息发布到指定的频道订阅者可以订阅感兴趣的频道并接收相应的消息实现了解耦和实时通信为什么很快内存存储将数据存储在内存中而不是像传统的磁盘存储数据库那样将数据写入到硬盘上由于内存的读写速度远远快于磁盘因此能够实现极快的读写性能单线程模型采用单线程模型每个实例都由单个主线程来处理所有的客户端请求虽然单线程看起来似乎会限制其性能但这实际上是的一大优势单线程模型消除了多线程之间的竞争和锁等开销使得能够充分利用资源并且避免了多线程带来的复杂性此外在内部使用了多路复用技术例如或来处理并发请求使得单线程能够同时处理多个客户端连接非阻塞使用了非阻塞也就是在读写操作时不会阻塞其他操作在读取数据时如果内存中没有所需的数据会立即返回一个空结果而不会等待数据从磁盘加载进来这样即使在高并发情况下也能够快速地响应请求高效的数据结构支持多种高效的数据结构比如字符串哈希列表集合有序集合等这些数据结构的设计和实现都非常高效能够在常量时间内完成查找插入删除等操作保证了的高速性能异步操作支持异步操作比如异步持久化和异步复制异步操作能够让在进行磁盘持久化和主从复制时不会阻塞其他操作提高了整体的性能优化的网络协议使用作为网络协议是一种简单高效的二进制协议协议的设计使得网络传输的数据量尽可能地减少减少了网络传输的开销提高了性能原子性操作支持很多原子性操作比如等原子性操作能够在一条命令中完成多个操作而且这些操作是不可中断的保证了数据的一致性应用场景由于具备高性能丰富的数据结构和多种特性它的主要应用场景如下缓存作为缓存数据库可以将经常访问的数据存储在内存中避免频繁读写数据库提高应用的响应速度缓存可以存储热点数据减轻后端数据库的压力提高系统的吞吐量计数器利用的原子性操作可以实现高效的计数器功能比如网站的点赞浏览次数等统计功能由于原子性操作的特性计数器的更新可以并发执行而不会出现竞争问题消息队列的发布订阅功能和列表数据结构可以实现简单的消息队列用于解耦系统的各个模块生产者将消息发布到指定频道消费者订阅感兴趣的频道并处理消息实现异步消息传递排行榜使用有序集合数据结构可以实现排行榜功能比如游戏中的玩家排名通过有序集合的分数属性可以对玩家的得分进行排序和排名实时显示排行榜会话缓存在应用中可以使用存储用户的会话数据实现分布式会话管理用户登录后可以将会话数据存储在中从而实现多台服务器之间的会话共享常用命令提供了命令行客户端用于与服务进行交互以下是一些常用的命令添加或修改一个字符串类型的键值对根据键名获取对应的值将一个整数值自增将一个整数值自减向列表的左边插入一个元素向列表的右边插入一个元素添加或修改一个哈希类型键的字段值根据键名和字段名获取哈希类型的值中使用安装库连接服务器连接到本地服务器地址默认本地端口号默认密码数据库参数用于确保从获取的字符串数据以字符串形式存在而不是字节类型数据操作字符串操作代指键名代指值字符串类型设置键值对获取字符串输出检查键是否存在输出或删除键输出表示删除成功批量设置键值对输出哈希操作代指哈希表字段数据存储哈希值获取哈希值输出批量存储哈希值假设可用输出注意这里可能需要获取所有哈希值输出类似列表操作代指列表名代指数据添加元素在列表左侧添加在列表右侧添加在列表左侧添加在列表右侧添加获取列表元素索引开始位置索引结束位置获取列表中的所有元素输出获取列表中的前两个元素输出移除元素移除并获取列表的第一个元素移除并获取列表的最后一个元素移除并获取列表的第一个元素输出移除并获取列表的最后一个元素输出列表长度输出列表的长度集合操作集合名数据添加元素可以一次添加多个元素获取集合中的元素输出集合中的所有元素可能是一个无序的列表集合的长度输出集合中的元素数量集合的差集假设已存在于中假设也已存在输出即有而没有的元素集合的交集输出即和共有的元素从集合中移除元素使用命令从集合中移除一个或多个元素现在中不再包含和集合的随机元素使用命令从集合中随机获取一个或多个元素随机输出中的一个元素获取多个随机元素获取两个随机元素集合的弹出元素使用命令从集合中随机移除一个元素并返回该元素随机输出中的一个元素并从集合中移除它有序集合有序集合是中一种特殊的集合类型它不仅包含元素还为每个元素关联了一个浮点数分数这使得元素可以按照分数进行排序添加元素到有序集合使用命令向有序集合中添加一个或多个元素及其分数或者对于单个元素获取有序集合中的元素使用升序或降序命令获取有序集合中的元素及其分数升序获取输出类似降序获取输出可能反转的顺序获取有序集合的排名使用升序排名或降序排名命令获取元素的排名输出如果是分数最低的元素输出如果是分数最高的元素删除有序集合中的元素使用命令从有序集合中移除一个或多个元素使用作为缓存为了避免短时间内大量的请求访问导致读取数据频繁可以使用作为缓存来提高接口的响应速度我的思路是将函数名和参数作为返回值作为并根据数据的变动情况设置缓存过期时间基本不变的数据可以设置较长的过期时间而经常变动的数据可以设置较短的过期时间既能提高缓存命中率又能避免缓存的滞后性同时为了方便存入和取出数据我将缓存函数写为了装饰器可以直接在函数上添加装饰器即可在调用函数前先检查缓存如果缓存存在则直接返回缓存数据否则调用函数并将结果存入缓存另外我还在装饰器中添加了参数的识别如果函数传参时带有参数装饰器会自动将其剔除不会影响原函数执行但会强制刷新缓存即不检查缓存是否存在这样可以更灵活地控制缓存的更新比如某些特殊情况下需要即时更新缓存的函数此处是自定义的配置文件用于存放连接信息等主机地址端口数据库缓存过期时间单位秒缓存前缀用于区分同一数据库下不同项目的缓存是否启用缓存建立连接由于我的未设置密码所以这里无需连接密码如果设置了密码则需要修改此处代码提取刷新标志并从中移除以防止传递给原始函数使用函数名称和参数生成唯一的键如果缓存未启用直接调用原始函数检查是否需要刷新缓存查询缓存如果缓存不存在或已过期调用原始函数将结果存储到并设置过期时间使用方法调用缓存装饰器过期时间为默认时间此处是需要缓存的函数调用缓存装饰器过期时间为秒此处是需要缓存的函数调用函数并传入参数输出再次调用函数由于缓存存在所以直接返回缓存数据不执行函数输出调用带有参数的函数会强制刷新缓存重新执行函数并更新缓存输出",isPost:!0,isHome:!1,isHighlightShrink:!1,isToc:!0,postUpdate:"2024-09-17 14:02:29",postMainColor:""}</script><noscript><style>#nav{opacity:1}.justified-gallery img{opacity:1}#post-meta time,#recent-posts time{display:inline!important}</style></noscript><script>(e=>{e.saveToLocal={set:(e,t,a)=>{if(0===a)return;const o={value:t,expiry:Date.now()+864e5*a};localStorage.setItem(e,JSON.stringify(o))},get:e=>{const t=localStorage.getItem(e);if(!t)return;const a=JSON.parse(t);if(!(Date.now()>a.expiry))return a.value;localStorage.removeItem(e)}},e.getScript=(e,t={})=>new Promise(((a,o)=>{const c=document.createElement("script");c.src=e,c.async=!0,c.onerror=o,c.onload=c.onreadystatechange=function(){const e=this.readyState;e&&"loaded"!==e&&"complete"!==e||(c.onload=c.onreadystatechange=null,a())},Object.keys(t).forEach((e=>{c.setAttribute(e,t[e])})),document.head.appendChild(c)})),e.getCSS=(e,t=!1)=>new Promise(((a,o)=>{const c=document.createElement("link");c.rel="stylesheet",c.href=e,t&&(c.id=t),c.onerror=o,c.onload=c.onreadystatechange=function(){const e=this.readyState;e&&"loaded"!==e&&"complete"!==e||(c.onload=c.onreadystatechange=null,a())},document.head.appendChild(c)})),e.activateDarkMode=()=>{document.documentElement.setAttribute("data-theme","dark"),null!==document.querySelector('meta[name="theme-color"]')&&document.querySelector('meta[name="theme-color"]').setAttribute("content","#18171d")},e.activateLightMode=()=>{document.documentElement.setAttribute("data-theme","light"),null!==document.querySelector('meta[name="theme-color"]')&&document.querySelector('meta[name="theme-color"]').setAttribute("content","#f7f9fe")};const t=saveToLocal.get("theme"),a=window.matchMedia("(prefers-color-scheme: dark)").matches,o=window.matchMedia("(prefers-color-scheme: light)").matches,c=window.matchMedia("(prefers-color-scheme: no-preference)").matches,n=!a&&!o&&!c;if(void 0===t){if(o)activateLightMode();else if(a)activateDarkMode();else if(c||n){const e=(new Date).getHours();e<=8||e>=23?activateDarkMode():activateLightMode()}window.matchMedia("(prefers-color-scheme: dark)").addListener((e=>{void 0===saveToLocal.get("theme")&&(e.matches?activateDarkMode():activateLightMode())}))}else"light"===t?activateLightMode():activateDarkMode();const d=saveToLocal.get("aside-status");void 0!==d&&("hide"===d?document.documentElement.classList.add("hide-aside"):document.documentElement.classList.remove("hide-aside"));/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)&&document.documentElement.classList.add("apple")})(window)</script><link rel="stylesheet" href="/css/randomench.css"><link rel="stylesheet" href="/css/iconfont.css"><svg aria-hidden="true" style="position:absolute;overflow:hidden;width:0;height:0"><symbol id="icon-sun" viewBox="0 0 1024 1024"><path d="M960 512l-128 128v192h-192l-128 128-128-128H192v-192l-128-128 128-128V192h192l128-128 128 128h192v192z" fill="#FFD878" p-id="8420"></path><path d="M736 512a224 224 0 1 0-448 0 224 224 0 1 0 448 0z" fill="#FFE4A9" p-id="8421"></path><path d="M512 109.248 626.752 224H800v173.248L914.752 512 800 626.752V800h-173.248L512 914.752 397.248 800H224v-173.248L109.248 512 224 397.248V224h173.248L512 109.248M512 64l-128 128H192v192l-128 128 128 128v192h192l128 128 128-128h192v-192l128-128-128-128V192h-192l-128-128z" fill="#4D5152" p-id="8422"></path><path d="M512 320c105.888 0 192 86.112 192 192s-86.112 192-192 192-192-86.112-192-192 86.112-192 192-192m0-32a224 224 0 1 0 0 448 224 224 0 0 0 0-448z" fill="#4D5152" p-id="8423"></path></symbol><symbol id="icon-moon" viewBox="0 0 1024 1024"><path d="M611.370667 167.082667a445.013333 445.013333 0 0 1-38.4 161.834666 477.824 477.824 0 0 1-244.736 244.394667 445.141333 445.141333 0 0 1-161.109334 38.058667 85.077333 85.077333 0 0 0-65.066666 135.722666A462.08 462.08 0 1 0 747.093333 102.058667a85.077333 85.077333 0 0 0-135.722666 65.024z" fill="#FFB531" p-id="11345"></path><path d="M329.728 274.133333l35.157333-35.157333a21.333333 21.333333 0 1 0-30.165333-30.165333l-35.157333 35.157333-35.114667-35.157333a21.333333 21.333333 0 0 0-30.165333 30.165333l35.114666 35.157333-35.114666 35.157334a21.333333 21.333333 0 1 0 30.165333 30.165333l35.114667-35.157333 35.157333 35.157333a21.333333 21.333333 0 1 0 30.165333-30.165333z" fill="#030835" p-id="11346"></path></symbol></svg><link rel="stylesheet" href="https://npm.elemecdn.com/hexo-butterfly-wowjs/lib/animate.min.css" media="print" onload='this.media="screen"'><meta name="generator" content="Hexo 8.1.1"><link rel="alternate" href="/atom.xml" title="RE Blog" type="application/atom+xml"></head><body data-type="anzhiyu"><div id="web_bg"><header class="full_page" id="web-header"></header></div><div id="an_music_bg"></div><div id="loading-box" onclick="document.getElementById(&quot;loading-box&quot;).classList.add(&quot;loaded&quot;)"><div class="loading-bg"><img class="loading-img nolazyload" alt="加载头像" src="https://cdn.randench.cn/assets/loading1.gif"><div class="loading-image-dot"></div></div></div><script>const preloader={endLoading:()=>{document.getElementById("loading-box").classList.add("loaded")},initLoading:()=>{document.getElementById("loading-box").classList.remove("loaded")}};window.addEventListener("load",(()=>{preloader.endLoading()})),setTimeout((function(){preloader.endLoading()}),1e4),document.addEventListener("pjax:send",(()=>{preloader.initLoading()})),document.addEventListener("pjax:complete",(()=>{preloader.endLoading()}))</script><link rel="stylesheet" href="https://cdn.cbd.int/anzhiyu-theme-static@1.1.10/progress_bar/progress_bar.css"><script async src="https://cdn.cbd.int/pace-js@1.2.4/pace.min.js" data-pace-options="{ &quot;restartOnRequestAfter&quot;:false,&quot;eventLag&quot;:false}"></script><div class="post" id="body-wrap"><header class="post-bg" id="page-header"><nav id="nav"><div id="nav-group"><span id="blog_name"><div class="back-home-button"><i class="iconfont icon-menu"></i><div class="back-menu-list-groups"><div class="back-menu-list-group"><div class="back-menu-list-title">网页</div><div class="back-menu-list"><a class="back-menu-item" href="https://blog.randench.cn/" title="博客"><img class="back-menu-item-icon" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;https://cdn.randench.cn/assets/404.png&quot;" data-lazy-src="https://cdn.randench.cn/assets/favicon.ico" alt="博客"><span class="back-menu-item-text">博客</span></a><a class="back-menu-item" target="_blank" rel="noopener" href="https://status.randench.cn/" title="站点监测"><img class="back-menu-item-icon" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;https://cdn.randench.cn/assets/404.png&quot;" data-lazy-src="https://cdn.randench.cn/image/24/08/4b35ffab73353564.ico" alt="站点监测"><span class="back-menu-item-text">站点监测</span></a><a class="back-menu-item" target="_blank" rel="noopener" href="https://www.randench.cn/" title="主页"><img class="back-menu-item-icon" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;https://cdn.randench.cn/assets/404.png&quot;" data-lazy-src="https://cdn.randench.cn/image/24/08/73744fc203b733d8.jpg" alt="主页"><span class="back-menu-item-text">主页</span></a><a class="back-menu-item" target="_blank" rel="noopener" href="https://hot.randench.cn/" title="今日热点"><img class="back-menu-item-icon" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;https://cdn.randench.cn/assets/404.png&quot;" data-lazy-src="https://cdn.randench.cn/image/24/08/ff3f9a2e5fdfd521.png" alt="今日热点"><span class="back-menu-item-text">今日热点</span></a><a class="back-menu-item" target="_blank" rel="noopener" href="https://music.randench.cn/" title="音乐"><img class="back-menu-item-icon" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;https://cdn.randench.cn/assets/404.png&quot;" data-lazy-src="https://cdn.randench.cn/image/24/08/0c18c494a5c97166.ico" alt="音乐"><span class="back-menu-item-text">音乐</span></a><a class="back-menu-item" target="_blank" rel="noopener" href="https://cloud.randench.cn/" title="网盘"><img class="back-menu-item-icon" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;https://cdn.randench.cn/assets/404.png&quot;" data-lazy-src="https://cdn.randench.cn/image/24/08/00a3f03c0954d37f.ico" alt="网盘"><span class="back-menu-item-text">网盘</span></a></div></div></div></div><a id="site-name" href="/" accesskey="h"><div class="title">RE Blog</div><i class="anzhiyufont anzhiyu-icon-house-chimney"></i></a><div id="he-plugin-simple"></div><script>!function(e,t,n,o,a,c,i,r){r=function(){c=t.createElement(n),i=t.getElementsByTagName(n)[0],c.src=a,c.charset="utf-8",c.async=1,i.parentNode.insertBefore(c,i)},e.SeniverseWeatherWidgetObject=o,e[o]||(e[o]=function(){(e[o].q=e[o].q||[]).push(arguments)}),e[o].l=+new Date,e.attachEvent?e.attachEvent("onload",r):e.addEventListener("load",r,!1)}(window,document,"script","SeniverseWeatherWidget","//cdn.sencdn.com/widget2/static/js/bundle.js?t="+parseInt(((new Date).getTime()/1e8).toString(),10)),window.SeniverseWeatherWidget("show",{flavor:"slim",location:"WX4FBXXFKE4F",geolocation:!0,language:"auto",unit:"c",theme:"auto",token:"1e881efc-9864-442e-a8a1-ebbe3f49afc9",hover:"enabled",container:"he-plugin-simple"}),document.addEventListener("DOMContentLoaded",(function(){const e=document.getElementById("page-header");if(e&&e.classList.contains("nav-fixed")){document.querySelectorAll("#he-plugin-simple .sw-bar-slim-location").forEach((function(e){e.style.color="var(--font-color)",e.style.setProperty("color","var(--font-color)","important")}))}else if(e&&e.classList.contains("not-top-img")){document.querySelectorAll("#he-plugin-simple .sw-bar-slim-location").forEach((function(e){e.style.color="var(--font-color)",e.style.setProperty("color","var(--font-color)","important")}))}}))</script></span><div class="mask-name-container"><div id="name-container"><a id="page-name" href="javascript:anzhiyu.scrollToDest(0, 500)">PAGE_NAME</a></div></div><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-file-lines faa-tada" style="font-size:.9em"></i> <span>文章</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/archives/"><i class="anzhiyufont anzhiyu-icon-box-archive faa-tada" style="font-size:.9em"></i> <span>归档</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/tags/"><i class="anzhiyufont anzhiyu-icon-tags faa-tada" style="font-size:.9em"></i> <span>标签</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/categories/"><i class="anzhiyufont anzhiyu-icon-shapes faa-tada" style="font-size:.9em"></i> <span>分类</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/charts/"><i class="fa-solid fa-chart-area faa-tada"></i> <span>统计</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-solid fa-user faa-tada"></i> <span>我的</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/bangumis/"><i class="anzhiyufont anzhiyu-icon-bilibili faa-tada" style="font-size:.9em"></i> <span>追番页</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/music/?id=9149426095&amp;server=netease"><i class="anzhiyufont anzhiyu-icon-music faa-tada" style="font-size:.9em"></i> <span>音乐馆</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/games/"><i class="fa-solid fa-gamepad faa-tada"></i> <span>游戏厅</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-paper-plane faa-tada" style="font-size:.9em"></i> <span>友链</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/link/"><i class="anzhiyufont anzhiyu-icon-link faa-tada" style="font-size:.9em"></i> <span>友人帐</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/fcircle/"><i class="anzhiyufont anzhiyu-icon-artstation faa-tada" style="font-size:.9em"></i> <span>朋友圈</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/comments/"><i class="anzhiyufont anzhiyu-icon-envelope faa-tada" style="font-size:.9em"></i> <span>留言板</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-solid fa-chess-queen faa-tada"></i> <span>关于</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/air-conditioner/"><i class="anzhiyufont anzhiyu-icon-fan faa-tada" style="font-size:.9em"></i> <span>小空调</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/about/"><i class="anzhiyufont anzhiyu-icon-paper-plane faa-tada" style="font-size:.9em"></i> <span>关于本人</span></a></li><li><a class="site-page child faa-parent animated-hover" href="javascript:toRandomPost()"><i class="anzhiyufont anzhiyu-icon-shoe-prints1 faa-tada" style="font-size:.9em"></i> <span>随便逛逛</span></a></li></ul></div></div></div><div id="nav-right"><div class="nav-button" id="randomPost_button"><a class="site-page" onclick="toRandomPost()" title="随机前往一个文章" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-dice"></i></a></div><div class="nav-button" id="search-button"><a class="site-page social-icon search" href="javascript:void(0);" title="搜索🔍" accesskey="s"><i class="anzhiyufont anzhiyu-icon-magnifying-glass"></i> <span>搜索</span></a></div><div class="nav-button" id="nav-darkmode"><a class="icon-V hidden faa-parent animated-hover" onclick="switchNightMode()" title="浅色和深色模式转换"><i class="anzhiyufont anzhiyu-icon-moon"><use id="modeicon" xlink:href="#icon-moon"></use></i></a></div><input id="center-console" type="checkbox"><label class="widget" for="center-console" title="中控台" onclick="anzhiyu.switchConsole()"><i class="left"></i><i class="widget center"></i><i class="widget right"></i></label><div id="console"><div class="console-card-group-reward"><ul class="reward-all console-card"><li class="reward-item"><a href="https://cdn.randench.cn/assets/pay/1.jpg" target="_blank"><img class="post-qr-code-img" alt="微信" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;https://cdn.randench.cn/assets/404.png&quot;" data-lazy-src="https://cdn.randench.cn/assets/pay/1.jpg"></a><div class="post-qr-code-desc">微信</div></li><li class="reward-item"><a href="https://cdn.randench.cn/assets/pay/2.jpg" target="_blank"><img class="post-qr-code-img" alt="支付宝" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;https://cdn.randench.cn/assets/404.png&quot;" data-lazy-src="https://cdn.randench.cn/assets/pay/2.jpg"></a><div class="post-qr-code-desc">支付宝</div></li></ul></div><div class="console-card-group"><div class="console-card-group-left"><div class="console-card" id="card-newest-comments"><div class="card-content"><div class="author-content-item-tips">互动</div><span class="author-content-item-title">最新评论</span></div><div class="aside-list"><span>正在加载中...</span></div></div></div><div class="console-card-group-right"><div class="console-card tags"><div class="card-content"><div class="author-content-item-tips">音乐</div><span class="author-content-item-title">灵魂的碰撞💥</span></div></div><div class="console-card history"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-box-archiv"></i><span>文章</span></div><div class="card-archives"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-archive"></i><span>归档</span><a class="card-more-btn" href="/archives/" title="查看更多"><i class="anzhiyufont anzhiyu-icon-angle-right"></i></a></div><ul class="card-archive-list"><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2025/06/"><span class="card-archive-list-date">六月 2025</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">1</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2025/03/"><span class="card-archive-list-date">三月 2025</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">3</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2025/01/"><span class="card-archive-list-date">一月 2025</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">1</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/12/"><span class="card-archive-list-date">十二月 2024</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">1</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/11/"><span class="card-archive-list-date">十一月 2024</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">4</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/09/"><span class="card-archive-list-date">九月 2024</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">2</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/08/"><span class="card-archive-list-date">八月 2024</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">10</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/07/"><span class="card-archive-list-date">七月 2024</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">17</span><span>篇</span></div></a></li></ul></div><hr></div></div></div><div class="button-group"><div class="console-btn-item"><a class="darkmode_switchbutton" title="显示模式切换" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-moon"></i></a></div><div class="console-btn-item" id="consoleHideAside" onclick="anzhiyu.hideAsideBtn()" title="边栏显示控制"><a class="asideSwitch"><i class="anzhiyufont anzhiyu-icon-arrows-left-right"></i></a></div><div class="console-btn-item" id="consoleRightMenu" onclick="anzhiyu.rightMenuToggle()" title="右键菜单开关"><a class="rightMenu-switch"><i class="iconfont icon-list"></i></a></div><div class="console-btn-item" id="consoleMusic" onclick="anzhiyu.musicToggle()" title="音乐开关"><a class="music-switch"><i class="anzhiyufont anzhiyu-icon-music"></i></a></div><div class="console-btn-item" id="consoleKeyboard" onclick="anzhiyu.keyboardToggle()" title="快捷键开关"><a class="keyboard-switch"><i class="anzhiyufont anzhiyu-icon-keyboard"></i></a></div></div><div class="console-mask" onclick="anzhiyu.hideConsole()" href="javascript:void(0);"></div></div><div class="nav-button" id="nav-totop"><a class="totopbtn" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i><span id="percent" onclick="anzhiyu.scrollToDest(0,500)">0</span></a></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);" title="切换"><i class="anzhiyufont anzhiyu-icon-bars"></i></a></div></div></div></nav><div id="post-info"><div id="post-firstinfo"><div class="meta-firstline"><a class="post-meta-original">原创</a><span class="post-meta-categories"><span class="post-meta-separator"></span><i class="anzhiyufont anzhiyu-icon-inbox post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E7%BC%96%E7%A8%8B/" itemprop="url">编程</a></span><span class="article-meta tags"><a class="article-meta__tags" href="/tags/Python/" tabindex="-1" itemprop="url"><span><i class="anzhiyufont anzhiyu-icon-hashtag"></i> Python</span></a><a class="article-meta__tags" href="/tags/Redis/" tabindex="-1" itemprop="url"><span><i class="anzhiyufont anzhiyu-icon-hashtag"></i> Redis</span></a></span></div></div><h1 class="post-title" itemprop="name headline">Python使用Redis缓存</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="anzhiyufont anzhiyu-icon-calendar-days post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" itemprop="dateCreated datePublished" datetime="2024-09-17T14:02:29.000Z" title="发表于 2024-09-17 14:02:29">2024-09-17</time><span class="post-meta-separator"></span><i class="anzhiyufont anzhiyu-icon-history post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" itemprop="dateCreated datePublished" datetime="2024-09-17T14:02:29.000Z" title="更新于 2024-09-17 14:02:29">2024-09-17</time></span></div><div class="meta-secondline"><span class="post-meta-separator"></span><span class="post-meta-wordcount"><i class="anzhiyufont anzhiyu-icon-file-word post-meta-icon" title="文章字数"></i><span class="post-meta-label" title="文章字数">字数总计:</span><span class="word-count" title="文章字数">4.2k</span><span class="post-meta-separator"></span><i class="anzhiyufont anzhiyu-icon-clock post-meta-icon" title="阅读时长"></i><span class="post-meta-label" title="阅读时长">阅读时长:</span><span>14分钟</span></span><span class="post-meta-separator"></span><span data-flag-title="Python使用Redis缓存"><i class="anzhiyufont anzhiyu-icon-fw-eye post-meta-icon"></i><span class="post-meta-label" title="阅读量">阅读量:</span><span id="twikoo_visitors" title="访问量"><i class="anzhiyufont anzhiyu-icon-spinner anzhiyu-spin"></i></span></span><span class="post-meta-separator"></span><span class="post-meta-position" title="作者IP属地为南京"><i class="anzhiyufont anzhiyu-icon-location-dot"></i> 南京</span></div></div></div><section class="main-hero-waves-area waves-area"><svg class="waves-svg" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto"><defs><path id="gentle-wave" d="M-160 44c30 0 58-18 88-18s58 18 88 18 58-18 88-18 58 18 88 18v44h-352Z"></path></defs><g class="parallax"><use href="#gentle-wave" x="48" y="0"></use><use href="#gentle-wave" x="48" y="3"></use><use href="#gentle-wave" x="48" y="5"></use><use href="#gentle-wave" x="48" y="7"></use></g></svg></section><div id="post-top-cover"><img class="nolazyload" id="post-top-bg" src="https://cdn.randench.cn/image/24/09/9e415fdaa5db2c28.png"></div></header><main id="blog-container"><div class="layout" id="content-inner"><div id="post"><div class="post-ai-description"><div class="ai-title"><i class="anzhiyufont anzhiyu-icon-bilibili"></i><div class="ai-title-text">AI-摘要</div><i class="anzhiyufont anzhiyu-icon-arrow-rotate-right"></i><i class="anzhiyufont anzhiyu-icon-circle-dot" title="朗读摘要"></i><div id="ai-tag">Tianli GPT</div></div><div class="ai-explanation">AI初始化中...</div><div class="ai-btn-box"><div class="ai-btn-item">介绍自己 🙈</div><div class="ai-btn-item">生成本文简介 👋</div><div class="ai-btn-item">推荐相关文章 📖</div><div class="ai-btn-item">前往主页 🏠</div><div class="ai-btn-item" id="go-tianli-blog">前往爱发电购买</div></div><script data-pjax src="/js/anzhiyu/ai_abstract.js"></script></div><article class="post-content" id="article-container" itemscope itemtype="https://blog.randench.cn/posts/21307/"><header><a class="post-meta-categories" href="/categories/%E7%BC%96%E7%A8%8B/" itemprop="url">编程</a><a href="/tags/Python/" tabindex="-1" itemprop="url">Python</a><a href="/tags/Redis/" tabindex="-1" itemprop="url">Redis</a><h1 id="CrawlerTitle" itemprop="name headline">Python使用Redis缓存</h1><span itemprop="author" itemscope itemtype="http://schema.org/Person">RandomEnch</span><time itemprop="dateCreated datePublished" datetime="2024-09-17T14:02:29.000Z" title="发表于 2024-09-17 14:02:29">2024-09-17</time><time itemprop="dateCreated datePublished" datetime="2024-09-17T14:02:29.000Z" title="更新于 2024-09-17 14:02:29">2024-09-17</time></header><h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>最近编写了一个Flask应用，其API接口需要访问MySQL数据库读取数据，为了防止高并发情况下MySQL数据库的压力，使用了Redis作为缓存来提高API接口的响应速度。本文将介绍Redis的基本概念和在Python中的使用方法。</p><h1 id="Redis简介"><a href="#Redis简介" class="headerlink" title="Redis简介"></a>Redis简介</h1><p>Redis（Remote Dictionary Server）是一个开源的高性能键值对存储数据库，最初由 Salvatore Sanfilippo 开发，它在内存中存储数据，并提供了持久化功能，可以将数据保存到磁盘中，是一种NoSQL(not-only sql,非关系型数据库)的数据库。</p><p>它的数据结构十分丰富，基础数据类型包括：string（字符串）、list（列表，双向链表）、hash（散列，键值对集合）、set（集合，不重复）和 sorted set（有序集合），这使得它不仅仅是一个简单的键值存储，还可以用于存储和处理复杂的数据。</p><h1 id="Redis-特点-优势"><a href="#Redis-特点-优势" class="headerlink" title="Redis 特点&#x2F;优势"></a>Redis 特点&#x2F;优势</h1><p>Redis 具备许多特点和优势，所以在大规模应用和高并发场景中得到广泛应用。</p><ul><li><strong>丰富的数据结构</strong>：Redis 支持多种数据结构，包括字符串（String）、哈希（Hash）、列表（List）、集合（Set）、有序集合（Sorted Set）等。每种数据结构都有丰富的操作命令，可以方便地对数据进行存储和处理。</li><li><strong>持久化</strong>：Redis 提供了两种持久化方式，RDB（Redis Database）和 AOF（Append Only File）。RDB 是将数据库在指定时间点转储到磁盘的快照持久化方式，AOF 是将写操作追加到文件末尾的日志持久化方式。这两种方式可以根据需求进行选择，保证数据在服务器重启后不会丢失。</li><li><strong>高性能</strong>：Redis 是一种内存数据库，数据存储在内存中，因此读写速度非常快。它采用单线程模型，避免了多线程带来的竞争问题，使得 Redis 能够充分利用 CPU 和内存资源。</li><li><strong>支持事务</strong>：Redis 支持事务操作，可以将多个命令打包执行，保证这些命令要么全部执行成功，要么全部失败，保持数据的一致性。虽然 Redis 在单个命令的执行上是原子性的，但是多个命令的组合并不是原子性的，通过事务可以实现一组命令的原子性执行。</li><li><strong>高可用与分布式</strong>：Redis 支持主从复制、哨兵和集群等功能，可以构建高可用和分布式的 Redis 架构。主从复制可以实现数据的热备份和读写分离，哨兵可以监控 Redis 的健康状态并进行自动故障转移，集群可以将数据分布在多个节点上，提高性能和扩展性。</li><li><strong>发布订阅</strong>：Redis 支持发布订阅模式，可以实现消息的发布和订阅。发布者将消息发布到指定的频道，订阅者可以订阅感兴趣的频道并接收相应的消息，实现了解耦和实时通信。</li></ul><h1 id="Redis-为什么很快"><a href="#Redis-为什么很快" class="headerlink" title="Redis 为什么很快"></a>Redis 为什么很快</h1><ul><li><strong>内存存储</strong>：Redis将数据存储在内存中，而不是像传统的磁盘存储数据库那样将数据写入到硬盘上。由于内存的读写速度远远快于磁盘，因此Redis能够实现极快的读写性能。</li><li><strong>单线程模型</strong>：Redis采用单线程模型，每个Redis实例都由单个主线程来处理所有的客户端请求。虽然单线程看起来似乎会限制其性能，但这实际上是Redis的一大优势。单线程模型消除了多线程之间的竞争和锁等开销，使得Redis能够充分利用CPU资源，并且避免了多线程带来的复杂性。此外，Redis在内部使用了I&#x2F;O多路复用技术（例如epoll或kqueue）来处理并发请求，使得单线程能够同时处理多个客户端连接。</li><li><strong>非阻塞IO</strong>：Redis使用了非阻塞IO，也就是在读写操作时不会阻塞其他操作。在读取数据时，如果内存中没有所需的数据，Redis会立即返回一个空结果，而不会等待数据从磁盘加载进来。这样即使在高并发情况下，Redis也能够快速地响应请求。</li><li><strong>高效的数据结构</strong>：Redis支持多种高效的数据结构，比如字符串、哈希、列表、集合、有序集合等。这些数据结构的设计和实现都非常高效，能够在常量时间内完成查找、插入、删除等操作，保证了Redis的高速性能。</li><li><strong>异步操作</strong>：Redis支持异步操作，比如异步持久化和异步复制。异步操作能够让Redis在进行磁盘持久化和主从复制时不会阻塞其他操作，提高了整体的性能。<br>优化的网络协议：Redis使用RESP（Redis Serialization Protocol）作为网络协议，RESP是一种简单、高效的二进制协议。RESP协议的设计使得网络传输的数据量尽可能地减少，减少了网络传输的开销，提高了性能。</li><li><strong>原子性操作</strong>：Redis支持很多原子性操作，比如INCR、DECR、SETNX等。原子性操作能够在一条命令中完成多个操作，而且这些操作是不可中断的，保证了数据的一致性。</li></ul><h1 id="应用场景"><a href="#应用场景" class="headerlink" title="应用场景"></a>应用场景</h1><p>由于 Redis 具备高性能、丰富的数据结构和多种特性，它的主要应用场景如下：</p><ul><li><strong>缓存</strong>：作为缓存数据库，Redis 可以将经常访问的数据存储在内存中，避免频繁读写数据库，提高应用的响应速度。缓存可以存储热点数据，减轻后端数据库的压力，提高系统的吞吐量。</li><li><strong>计数器</strong>：利用 Redis 的原子性操作，可以实现高效的计数器功能，比如网站的点赞、浏览次数等统计功能。由于 Redis 原子性操作的特性，计数器的更新可以并发执行而不会出现竞争问题。</li><li><strong>消息队列</strong>：Redis 的发布订阅功能和列表数据结构可以实现简单的消息队列，用于解耦系统的各个模块。生产者将消息发布到指定频道，消费者订阅感兴趣的频道并处理消息，实现异步消息传递。<br>排行榜：使用有序集合数据结构，可以实现排行榜功能，比如游戏中的玩家排名。通过有序集合的分数属性，可以对玩家的得分进行排序和排名，实时显示排行榜。</li><li><strong>会话缓存</strong>：在 Web 应用中，可以使用 Redis 存储用户的会话数据，实现分布式会话管理。用户登录后，可以将会话数据存储在 Redis 中，从而实现多台服务器之间的会话共享。</li></ul><h1 id="Redis-常用命令"><a href="#Redis-常用命令" class="headerlink" title="Redis 常用命令"></a>Redis 常用命令</h1><p>Redis 提供了命令行客户端 redis-cli，用于与 Redis 服务进行交互。以下是一些常用的 Redis 命令：</p><p><strong>SET</strong>：添加或修改一个字符串类型的键值对。<br><strong>GET</strong>：根据键名获取对应的值。<br><strong>INCR</strong>：将一个整数值自增 1。<br><strong>DECR</strong>：将一个整数值自减 1。<br><strong>LPUSH</strong>：向列表的左边插入一个元素。<br><strong>RPUSH</strong>：向列表的右边插入一个元素。<br><strong>HSET</strong>：添加或修改一个哈希类型键的字段值。<br><strong>HGET</strong>：根据键名和字段名获取哈希类型的值。</p><h1 id="Python-中使用-Redis"><a href="#Python-中使用-Redis" class="headerlink" title="Python 中使用 Redis"></a>Python 中使用 Redis</h1><h2 id="安装-redis-py-库"><a href="#安装-redis-py-库" class="headerlink" title="安装 redis-py 库"></a>安装 redis-py 库</h2><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install redis</span><br></pre></td></tr></table></figure><h2 id="连接-Redis-服务器"><a href="#连接-Redis-服务器" class="headerlink" title="连接 Redis 服务器"></a>连接 Redis 服务器</h2><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> redis  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># 连接到本地 Redis 服务器  </span></span><br><span class="line">r = redis.Redis(host=<span class="string">&#x27;localhost&#x27;</span>, port=<span class="number">6379</span>, db=<span class="number">0</span>, password=<span class="string">&#x27;&#x27;</span>, decode_responses=<span class="literal">True</span>)  </span><br><span class="line">  </span><br><span class="line"><span class="comment"># host ip地址 默认本地</span></span><br><span class="line"><span class="comment"># port 端口号 默认6379</span></span><br><span class="line"><span class="comment"># password 密码</span></span><br><span class="line"><span class="comment"># db 数据库</span></span><br><span class="line"><span class="comment"># decode_responses=True 参数用于确保从 Redis 获取的字符串数据以 Python 字符串形式存在，而不是字节类型</span></span><br></pre></td></tr></table></figure><h2 id="数据操作"><a href="#数据操作" class="headerlink" title="数据操作"></a>数据操作</h2><h3 id="字符串操作"><a href="#字符串操作" class="headerlink" title="字符串操作"></a>字符串操作</h3><ul><li>key 代指键名</li><li>string 代指值（字符串类型）</li></ul><p><strong>设置键值对 set(key, string)</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">r.<span class="built_in">set</span>(<span class="string">&#x27;mykey&#x27;</span>, <span class="string">&#x27;myvalue&#x27;</span>)</span><br></pre></td></tr></table></figure><p><strong>获取字符串 get(key)</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">value = r.get(<span class="string">&#x27;mykey&#x27;</span>)  </span><br><span class="line"><span class="built_in">print</span>(value)  <span class="comment"># 输出: myvalue</span></span><br></pre></td></tr></table></figure><p><strong>检查键是否存在 exists(key)</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">exists = r.exists(<span class="string">&#x27;mykey&#x27;</span>)  </span><br><span class="line"><span class="built_in">print</span>(exists)  <span class="comment"># 输出: True 或 False</span></span><br></pre></td></tr></table></figure><p><strong>删除键 delete(key)</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">deleted = r.delete(<span class="string">&#x27;mykey&#x27;</span>)  </span><br><span class="line"><span class="built_in">print</span>(deleted)  <span class="comment"># 输出: 1 表示删除成功</span></span><br></pre></td></tr></table></figure><p><strong>批量设置键值对 mset({key: value, key1: value1})</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">r.mset(&#123;<span class="string">&#x27;key1&#x27;</span>: <span class="string">&#x27;value1&#x27;</span>, <span class="string">&#x27;key2&#x27;</span>: <span class="string">&#x27;value2&#x27;</span>&#125;)  </span><br><span class="line">values = r.mget(<span class="string">&#x27;key1&#x27;</span>, <span class="string">&#x27;key2&#x27;</span>)  </span><br><span class="line"><span class="built_in">print</span>(values)  <span class="comment"># 输出: [&#x27;value1&#x27;, &#x27;value2&#x27;]</span></span><br></pre></td></tr></table></figure><h3 id="哈希操作"><a href="#哈希操作" class="headerlink" title="哈希操作"></a>哈希操作</h3><ul><li>keytable 代指哈希表</li><li>key 字段</li><li>value 数据</li></ul><p><strong>存储哈希值hset(keytable, key, value)</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">r.hset(<span class="string">&#x27;myhash&#x27;</span>, <span class="string">&#x27;field1&#x27;</span>, <span class="string">&#x27;value1&#x27;</span>)</span><br></pre></td></tr></table></figure><p><strong>获取哈希值hget(keytable, key)</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">value = r.hget(<span class="string">&#x27;myhash&#x27;</span>, <span class="string">&#x27;field1&#x27;</span>)  </span><br><span class="line"><span class="built_in">print</span>(value)  <span class="comment"># 输出: value1</span></span><br></pre></td></tr></table></figure><p><strong>批量存储哈希值hget(keytable, key_dict)</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 假设 hmset 可用  </span></span><br><span class="line">r.hmset(<span class="string">&#x27;myhash&#x27;</span>, &#123;<span class="string">&#x27;field2&#x27;</span>: <span class="string">&#x27;value2&#x27;</span>, <span class="string">&#x27;field3&#x27;</span>: <span class="string">&#x27;value3&#x27;</span>&#125;)  </span><br><span class="line">values = r.hmget(<span class="string">&#x27;myhash&#x27;</span>, <span class="string">&#x27;field2&#x27;</span>, <span class="string">&#x27;field3&#x27;</span>)  </span><br><span class="line"><span class="built_in">print</span>(values)  <span class="comment"># 输出: [b&#x27;value2&#x27;, b&#x27;value3&#x27;] （注意：这里可能需要 decode_responses=True）</span></span><br></pre></td></tr></table></figure><p><strong>获取所有哈希值hgetall(keytable)</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">all_fields_values = r.hgetall(<span class="string">&#x27;myhash&#x27;</span>)  </span><br><span class="line"><span class="built_in">print</span>(all_fields_values)  <span class="comment"># 输出类似: &#123;&#x27;field1&#x27;: &#x27;value1&#x27;, &#x27;field2&#x27;: &#x27;value2&#x27;, ...&#125;</span></span><br></pre></td></tr></table></figure><h3 id="列表操作"><a href="#列表操作" class="headerlink" title="列表操作"></a>列表操作</h3><ul><li>mylist 代指列表名</li><li>value代指数据</li></ul><p><strong>添加元素</strong></p><ul><li>lpush(mylist, value) 在列表左侧添加</li><li>rpush(mylist, value) 在列表右侧添加</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">r.lpush(<span class="string">&#x27;mylist&#x27;</span>, <span class="string">&#x27;value1&#x27;</span>)  <span class="comment"># 在列表左侧添加  </span></span><br><span class="line">r.rpush(<span class="string">&#x27;mylist&#x27;</span>, <span class="string">&#x27;value2&#x27;</span>)  <span class="comment"># 在列表右侧添加</span></span><br></pre></td></tr></table></figure><p><strong>获取列表元素lrang(mylist, start, end)</strong></p><ul><li>start 索引开始位置</li><li>end 索引结束位置</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 获取列表中的所有元素  </span></span><br><span class="line"><span class="built_in">print</span>(r.lrange(<span class="string">&#x27;mylist&#x27;</span>, <span class="number">0</span>, -<span class="number">1</span>))  <span class="comment"># 输出: [b&#x27;0&#x27;, b&#x27;a&#x27;, b&#x27;b&#x27;, b&#x27;c&#x27;]  </span></span><br><span class="line">  </span><br><span class="line"><span class="comment"># 获取列表中的前两个元素  </span></span><br><span class="line"><span class="built_in">print</span>(r.lrange(<span class="string">&#x27;mylist&#x27;</span>, <span class="number">0</span>, <span class="number">1</span>))  <span class="comment"># 输出: [b&#x27;0&#x27;, b&#x27;a&#x27;]</span></span><br></pre></td></tr></table></figure><p><strong>移除元素</strong></p><ul><li>lpop：移除并获取列表的第一个元素</li><li>rpop：移除并获取列表的最后一个元素</li></ul><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 移除并获取列表的第一个元素  </span></span><br><span class="line"><span class="built_in">print</span>(r.lpop(<span class="string">&#x27;mylist&#x27;</span>))  <span class="comment"># 输出: b&#x27;0&#x27;  </span></span><br><span class="line">  </span><br><span class="line"><span class="comment"># 移除并获取列表的最后一个元素  </span></span><br><span class="line"><span class="built_in">print</span>(r.rpop(<span class="string">&#x27;mylist&#x27;</span>))  <span class="comment"># 输出: b&#x27;c&#x27;</span></span><br></pre></td></tr></table></figure><p><strong>列表长度llen(mylist)</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(r.llen(<span class="string">&#x27;mylist&#x27;</span>))  <span class="comment"># 输出列表的长度</span></span><br></pre></td></tr></table></figure><h3 id="集合操作"><a href="#集合操作" class="headerlink" title="集合操作"></a>集合操作</h3><ul><li>myset 集合名</li><li>value 数据</li></ul><p><strong>添加元素sadd(myset, value)</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">r.sadd(<span class="string">&#x27;myset&#x27;</span>, <span class="string">&#x27;element1&#x27;</span>)  </span><br><span class="line">r.sadd(<span class="string">&#x27;myset&#x27;</span>, <span class="string">&#x27;element2&#x27;</span>, <span class="string">&#x27;element3&#x27;</span>)  <span class="comment"># 可以一次添加多个元素</span></span><br></pre></td></tr></table></figure><p><strong>获取集合中的元素smember(myset)</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">elements = r.smembers(<span class="string">&#x27;myset&#x27;</span>)  </span><br><span class="line"><span class="built_in">print</span>(elements)  <span class="comment"># 输出集合中的所有元素，可能是一个无序的列表</span></span><br></pre></td></tr></table></figure><p><strong>集合的长度scart(myset)</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">length = r.scard(<span class="string">&#x27;myset&#x27;</span>)  </span><br><span class="line"><span class="built_in">print</span>(length)  <span class="comment"># 输出集合中的元素数量</span></span><br></pre></td></tr></table></figure><p><strong>集合的差集sdiff(myset, myset1)</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">set1 = &#123;<span class="string">&#x27;element1&#x27;</span>, <span class="string">&#x27;element2&#x27;</span>, <span class="string">&#x27;element3&#x27;</span>&#125;  </span><br><span class="line">r.sadd(<span class="string">&#x27;set1&#x27;</span>, *set1)  <span class="comment"># 假设set1已存在于Redis中  </span></span><br><span class="line">r.sadd(<span class="string">&#x27;set2&#x27;</span>, <span class="string">&#x27;element2&#x27;</span>, <span class="string">&#x27;element4&#x27;</span>)  <span class="comment"># 假设set2也已存在  </span></span><br><span class="line">  </span><br><span class="line">diff = r.sdiff(<span class="string">&#x27;set1&#x27;</span>, <span class="string">&#x27;set2&#x27;</span>)  </span><br><span class="line"><span class="built_in">print</span>(diff)  <span class="comment"># 输出: &#123;&#x27;element1&#x27;, &#x27;element3&#x27;&#125;，即set1有而set2没有的元素</span></span><br></pre></td></tr></table></figure><p><strong>集合的交集sinter(myset, myset1)</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">inter = r.sinter(<span class="string">&#x27;set1&#x27;</span>, <span class="string">&#x27;set2&#x27;</span>)  </span><br><span class="line"><span class="built_in">print</span>(inter)  <span class="comment"># 输出: &#123;&#x27;element2&#x27;&#125;，即set1和set2共有的元素</span></span><br></pre></td></tr></table></figure><p><strong>从集合中移除元素</strong><br>使用srem命令从集合中移除一个或多个元素。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">r.srem(<span class="string">&#x27;myset&#x27;</span>, <span class="string">&#x27;element1&#x27;</span>, <span class="string">&#x27;element2&#x27;</span>)  </span><br><span class="line"><span class="comment"># 现在&#x27;myset&#x27;中不再包含&#x27;element1&#x27;和&#x27;element2&#x27;</span></span><br></pre></td></tr></table></figure><p><strong>集合的随机元素</strong><br>使用srandmember命令从集合中随机获取一个或多个元素。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">random_element = r.srandmember(<span class="string">&#x27;myset&#x27;</span>)  </span><br><span class="line"><span class="built_in">print</span>(random_element)  <span class="comment"># 随机输出&#x27;myset&#x27;中的一个元素  </span></span><br><span class="line">  </span><br><span class="line"><span class="comment"># 获取多个随机元素  </span></span><br><span class="line">random_elements = r.srandmember(<span class="string">&#x27;myset&#x27;</span>, <span class="number">2</span>)  <span class="comment"># 获取两个随机元素  </span></span><br><span class="line"><span class="built_in">print</span>(random_elements)</span><br></pre></td></tr></table></figure><p><strong>集合的弹出元素</strong><br>使用spop命令从集合中随机移除一个元素并返回该元素。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">popped_element = r.spop(<span class="string">&#x27;myset&#x27;</span>)  </span><br><span class="line"><span class="built_in">print</span>(popped_element)  <span class="comment"># 随机输出&#x27;myset&#x27;中的一个元素，并从集合中移除它</span></span><br></pre></td></tr></table></figure><h3 id="有序集合"><a href="#有序集合" class="headerlink" title="有序集合"></a>有序集合</h3><p>有序集合是Redis中一种特殊的集合类型，它不仅包含元素，还为每个元素关联了一个浮点数分数（score），这使得元素可以按照分数进行排序。</p><p><strong>添加元素到有序集合</strong><br>使用zadd命令向有序集合中添加一个或多个元素及其分数。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">r.zadd(<span class="string">&#x27;mysortedset&#x27;</span>, &#123;<span class="string">&#x27;member1&#x27;</span>: <span class="number">1</span>, <span class="string">&#x27;member2&#x27;</span>: <span class="number">2</span>&#125;)  </span><br><span class="line"><span class="comment"># 或者对于单个元素  </span></span><br><span class="line">r.zadd(<span class="string">&#x27;mysortedset&#x27;</span>, <span class="number">1</span>, <span class="string">&#x27;member3&#x27;</span>)</span><br></pre></td></tr></table></figure><p><strong>获取有序集合中的元素</strong><br>使用zrange（升序）或zrevrange（降序）命令获取有序集合中的元素及其分数。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 升序获取  </span></span><br><span class="line">ascending = r.zrange(<span class="string">&#x27;mysortedset&#x27;</span>, <span class="number">0</span>, -<span class="number">1</span>, withscores=<span class="literal">True</span>)  </span><br><span class="line"><span class="built_in">print</span>(ascending)  <span class="comment"># 输出类似: [(&#x27;member1&#x27;, 1.0), (&#x27;member2&#x27;, 2.0), (&#x27;member3&#x27;, 1.0)]  </span></span><br><span class="line">  </span><br><span class="line"><span class="comment"># 降序获取  </span></span><br><span class="line">descending = r.zrevrange(<span class="string">&#x27;mysortedset&#x27;</span>, <span class="number">0</span>, -<span class="number">1</span>, withscores=<span class="literal">True</span>)  </span><br><span class="line"><span class="built_in">print</span>(descending)  <span class="comment"># 输出可能反转的顺序</span></span><br></pre></td></tr></table></figure><p><strong>获取有序集合的排名</strong><br>使用zrank（升序排名）或zrevrank（降序排名）命令获取元素的排名。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">rank = r.zrank(<span class="string">&#x27;mysortedset&#x27;</span>, <span class="string">&#x27;member1&#x27;</span>)  </span><br><span class="line"><span class="built_in">print</span>(rank)  <span class="comment"># 输出: 0，如果member1是分数最低的元素  </span></span><br><span class="line">  </span><br><span class="line">revrank = r.zrevrank(<span class="string">&#x27;mysortedset&#x27;</span>, <span class="string">&#x27;member2&#x27;</span>)  </span><br><span class="line"><span class="built_in">print</span>(revrank)  <span class="comment"># 输出: 0，如果member2是分数最高的元素</span></span><br></pre></td></tr></table></figure><p><strong>删除有序集合中的元素</strong><br>使用zrem命令从有序集合中移除一个或多个元素。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">r.zrem(<span class="string">&#x27;mysortedset&#x27;</span>, <span class="string">&#x27;member1&#x27;</span>, <span class="string">&#x27;member3&#x27;</span>)</span><br></pre></td></tr></table></figure><h2 id="使用Redis作为缓存"><a href="#使用Redis作为缓存" class="headerlink" title="使用Redis作为缓存"></a>使用Redis作为缓存</h2><p>为了避免短时间内大量的请求访问导致读取数据频繁，可以使用Redis作为缓存来提高API接口的响应速度。我的思路是将函数名和参数作为key，返回值作为value，并根据数据的变动情况设置缓存过期时间。基本不变的数据可以设置较长的过期时间，而经常变动的数据可以设置较短的过期时间，既能提高缓存命中率，又能避免缓存的滞后性。</p><p>同时，为了方便存入和取出数据，我将缓存函数写为了装饰器(decorator)，可以直接在函数上添加@cache()装饰器，即可在调用函数前先检查缓存，如果缓存存在，则直接返回缓存数据，否则调用函数并将结果存入缓存。</p><p>另外，我还在装饰器中添加了refresh参数的识别，如果函数传参时带有refresh&#x3D;True参数，装饰器会自动将其剔除，不会影响原函数执行，但会强制刷新缓存，即不检查缓存是否存在，这样可以更灵活地控制缓存的更新，比如某些特殊情况下需要即时更新缓存的函数。</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> redis</span><br><span class="line"><span class="keyword">from</span> functools <span class="keyword">import</span> wraps</span><br><span class="line"></span><br><span class="line"><span class="comment"># 此处是自定义的配置文件，用于存放Redis连接信息等</span></span><br><span class="line"><span class="comment"># REDIS_HOST redis主机地址</span></span><br><span class="line"><span class="comment"># REDIS_PORT redis端口</span></span><br><span class="line"><span class="comment"># REDIS_DB redis数据库</span></span><br><span class="line"><span class="comment"># EXPIRE_TIME 缓存过期时间，单位秒</span></span><br><span class="line"><span class="comment"># CACHE_PREFIX 缓存前缀，用于区分同一数据库下不同项目的缓存</span></span><br><span class="line"><span class="comment"># ENABLE_CACHE 是否启用缓存</span></span><br><span class="line"><span class="keyword">from</span> config <span class="keyword">import</span> REDIS_HOST, REDIS_PORT, REDIS_DB, EXPIRE_TIME, CACHE_PREFIX, ENABLE_CACHE</span><br><span class="line"></span><br><span class="line"><span class="comment"># 建立Redis连接</span></span><br><span class="line"><span class="comment"># 由于我的redis未设置密码，所以这里无需连接密码，如果设置了密码，则需要修改此处代码</span></span><br><span class="line">redis_db = redis.Redis(host=REDIS_HOST, port=REDIS_PORT, db=REDIS_DB, decode_responses=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">cache</span>(<span class="params">cache_exp=EXPIRE_TIME</span>):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">decorator</span>(<span class="params">func</span>):</span><br><span class="line"><span class="meta">        @wraps(<span class="params">func</span>)</span></span><br><span class="line">        <span class="keyword">def</span> <span class="title function_">wrapper</span>(<span class="params">*args, **kwargs</span>):</span><br><span class="line">            <span class="comment"># 提取刷新标志，并从kwargs中移除，以防止传递给原始函数</span></span><br><span class="line">            refresh = kwargs.pop(<span class="string">&#x27;refresh&#x27;</span>, <span class="literal">False</span>)</span><br><span class="line">            <span class="comment"># 使用函数名称和参数生成唯一的Redis键</span></span><br><span class="line">            cache_key = <span class="string">f&quot;<span class="subst">&#123;CACHE_PREFIX&#125;</span>:<span class="subst">&#123;func.__name__&#125;</span>:<span class="subst">&#123;args&#125;</span>&quot;</span></span><br><span class="line"></span><br><span class="line">            <span class="comment"># 如果缓存未启用，直接调用原始函数</span></span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> ENABLE_CACHE:</span><br><span class="line">                <span class="keyword">return</span> func(*args, **kwargs)</span><br><span class="line"></span><br><span class="line">            <span class="comment"># 检查是否需要刷新缓存</span></span><br><span class="line">            <span class="keyword">if</span> <span class="keyword">not</span> refresh:</span><br><span class="line">                <span class="keyword">try</span>:</span><br><span class="line">                    <span class="comment"># 查询Redis缓存</span></span><br><span class="line">                    cached_result = redis_db.get(cache_key)</span><br><span class="line">                    <span class="keyword">if</span> cached_result:</span><br><span class="line">                        <span class="keyword">return</span> <span class="built_in">eval</span>(cached_result)</span><br><span class="line">                <span class="keyword">except</span>:</span><br><span class="line">                    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line">            <span class="comment"># 如果缓存不存在或已过期，调用原始函数</span></span><br><span class="line">            result = func(*args, **kwargs)</span><br><span class="line">            <span class="comment"># 将结果存储到Redis，并设置过期时间</span></span><br><span class="line">            <span class="keyword">if</span> result != &#123;&#125; <span class="keyword">and</span> result != <span class="string">&#x27;&#123;&#125;&#x27;</span>:</span><br><span class="line">                redis_db.setex(cache_key, cache_exp, <span class="built_in">str</span>(result))</span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                redis_db.setex(cache_key, <span class="number">180</span>, <span class="built_in">str</span>(result))</span><br><span class="line">            <span class="keyword">return</span> result</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> wrapper</span><br><span class="line">    <span class="keyword">return</span> decorator</span><br></pre></td></tr></table></figure><p><strong>使用方法：</strong></p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 调用缓存装饰器，过期时间为默认时间</span></span><br><span class="line"><span class="meta">@cache()</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">my_func</span>(<span class="params">a, b</span>):</span><br><span class="line">    <span class="comment"># 此处是需要缓存的函数</span></span><br><span class="line">    <span class="keyword">return</span> a + b</span><br><span class="line"></span><br><span class="line"><span class="comment"># 调用缓存装饰器，过期时间为120秒</span></span><br><span class="line"><span class="meta">@cache(<span class="params"><span class="number">120</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">my_func1</span>(<span class="params">a, b</span>):</span><br><span class="line">    <span class="comment"># 此处是需要缓存的函数</span></span><br><span class="line">    <span class="keyword">return</span> a + b</span><br><span class="line"></span><br><span class="line"><span class="comment"># 调用函数，并传入参数</span></span><br><span class="line">result = my_func(<span class="number">1</span>, <span class="number">2</span>)</span><br><span class="line"><span class="built_in">print</span>(result)  <span class="comment"># 输出: 3</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 再次调用函数，由于缓存存在，所以直接返回缓存数据，不执行函数</span></span><br><span class="line">result = my_func(<span class="number">1</span>, <span class="number">2</span>)</span><br><span class="line"><span class="built_in">print</span>(result)  <span class="comment"># 输出: 3</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 调用带有refresh参数的函数，会强制刷新缓存，重新执行函数并更新缓存</span></span><br><span class="line">result = my_func(<span class="number">1</span>, <span class="number">2</span>, refresh=<span class="literal">True</span>)</span><br><span class="line"><span class="built_in">print</span>(result)  <span class="comment"># 输出: 3</span></span><br></pre></td></tr></table></figure></article><div class="post-copyright"><div class="copyright-cc-box"><i class="anzhiyufont anzhiyu-icon-copyright"></i></div><div class="post-copyright__author_box"><a class="post-copyright__author_img" href="/" title="头像"><img class="post-copyright__author_img_back" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;https://cdn.randench.cn/assets/404.png&quot;" data-lazy-src="https://cdn.randench.cn/image/24/08/73744fc203b733d8.jpg" title="头像" alt="头像"><img class="post-copyright__author_img_front" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;https://cdn.randench.cn/assets/404.png&quot;" data-lazy-src="https://cdn.randench.cn/image/24/08/73744fc203b733d8.jpg" title="头像" alt="头像"></a><div class="post-copyright__author_name">RandomEnch</div><div class="post-copyright__author_desc">施恩勿念 受恩莫忘</div></div><div class="post-copyright__post__info"><a class="post-copyright__original" title="该文章为原创文章，注意版权协议" href="https://blog.randench.cn/posts/21307/">原创</a><a class="post-copyright-title"><span onclick='rm.copyPageUrl("https://blog.randench.cn/posts/21307/")'>Python使用Redis缓存</span></a></div><div class="post-tools" id="post-tools"><div class="post-tools-left"><div class="rewardLeftButton"><link rel="stylesheet" href="https://cdn.randench.cn/css/custom/coin.css" media="defer" onload='this.media="all"'><script>let clickedElement=null;function toggleClickEffect(e){const c=e.currentTarget;clickedElement===c?(clickedElement.classList.remove("clicked"),clickedElement=null):(clickedElement&&clickedElement.classList.remove("clicked"),c.classList.add("clicked"),clickedElement=c)}document.addEventListener("mousemove",(e=>{clickedElement&&!clickedElement.contains(e.target)&&(clickedElement.classList.remove("clicked"),clickedElement=null)}))</script><div class="post-reward" onclick="toggleClickEffect(event)"><button class="tip-button reward-button"><span class="tip-button__text">打赏</span><div class="coin-wrapper"><div class="coin"><div class="coin__middle"></div><div class="coin__back"></div><div class="coin__front"></div></div></div></button><div class="reward-main"><div class="reward-all"><span class="reward-title">感谢你赐予我前进的力量</span><ul class="reward-group"><li class="reward-item"><a href="https://cdn.randench.cn/assets/pay/1.jpg" target="_blank"><img class="post-qr-code-img" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;https://cdn.randench.cn/assets/404.png&quot;" data-lazy-src="https://cdn.randench.cn/assets/pay/1.jpg" alt="微信"></a><div class="post-qr-code-desc">微信</div></li><li class="reward-item"><a href="https://cdn.randench.cn/assets/pay/2.jpg" target="_blank"><img class="post-qr-code-img" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;https://cdn.randench.cn/assets/404.png&quot;" data-lazy-src="https://cdn.randench.cn/assets/pay/2.jpg" alt="支付宝"></a><div class="post-qr-code-desc">支付宝</div></li></ul></div></div></div><div id="quit-box" onclick="anzhiyu.removeRewardMask()" style="display:none"></div><audio id="coinAudio" src="https://npm.elemecdn.com/akilar-candyassets/audio/aowu.m4a"></audio><script defer src="https://cdn.randench.cn/js/custom/coin.js"></script></div><div class="shareRight"><div class="share-link mobile"><div class="share-qrcode"><div class="share-button" title="使用手机访问这篇文章"><i class="anzhiyufont anzhiyu-icon-qrcode"></i></div><div class="share-main"><div class="share-main-all"><div id="qrcode" title="https://blog.randench.cn/posts/21307/"></div><div class="reward-dec">使用手机访问这篇文章</div></div></div></div></div><div class="share-link weibo"><a class="share-button" target="_blank" href="https://service.weibo.com/share/share.php?title=Python使用Redis缓存&amp;url=https://blog.randench.cn/posts/21307/&amp;pic=https://cdn.randench.cn/image/24/09/9e415fdaa5db2c28.png" rel="external nofollow noreferrer noopener"><i class="anzhiyufont anzhiyu-icon-weibo"></i></a></div><script>function copyCurrentPageUrl(){var e=window.location.href,t=document.createElement("input");t.setAttribute("value",e),document.body.appendChild(t),t.select(),t.setSelectionRange(0,99999),document.execCommand("copy"),document.body.removeChild(t)}</script><div class="share-link copyurl"><div class="share-button" id="post-share-url" title="复制链接" onclick="copyCurrentPageUrl()"><i class="anzhiyufont anzhiyu-icon-link"></i></div></div></div></div></div><div class="post-copyright__notice"><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://blog.randench.cn" target="_blank">RE Blog</a>！</span></div></div><div class="post-tools-right"><div class="tag_share"><div class="post-meta__box"><div class="post-meta__box__tag-list"><a class="post-meta__box__tags" href="/tags/Python/"><span class="tags-punctuation"><i class="anzhiyufont anzhiyu-icon-tag"></i></span> Python<span class="tagsPageCount">6</span></a><a class="post-meta__box__tags" href="/tags/Redis/"><span class="tags-punctuation"><i class="anzhiyufont anzhiyu-icon-tag"></i></span> Redis<span class="tagsPageCount">1</span></a></div></div></div><div class="post_share"><div class="social-share" data-image="https://cdn.randench.cn/image/25/06/7528a483a6c04a48.webp" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.cbd.int/butterfly-extsrc@1.1.3/sharejs/dist/css/share.min.css" media="print" onload='this.media="all"'><script src="https://cdn.cbd.int/butterfly-extsrc@1.1.3/sharejs/dist/js/social-share.min.js" defer></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/posts/22407/"><img class="prev-cover" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;https://cdn.randench.cn/assets/404.png&quot;" data-lazy-src="https://cdn.randench.cn/image/24/11/451cc9ce477e6b3a.png" onerror='onerror=null,src="https://cdn.randench.cn/assets/404.png"' alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">在文章中添加条件勾选表单</div></div></a></div><div class="next-post pull-right"><a href="/posts/61148/"><img class="next-cover" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;https://cdn.randench.cn/assets/404.png&quot;" data-lazy-src="https://cdn.randench.cn/image/24/09/216365a5addb572f.png" onerror='onerror=null,src="https://cdn.randench.cn/assets/404.png"' alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">网站字体压缩</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="anzhiyufont anzhiyu-icon-thumbs-up fa-fw" style="font-size:1.5rem;margin-right:4px"></i><span>喜欢这篇文章的人也看了</span></div><div class="relatedPosts-list"><div><a href="/posts/23620/" title="Flask蓝图的使用"><img class="cover" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;https://cdn.randench.cn/assets/404.png&quot;" data-lazy-src="https://cdn.randench.cn/image/25/03/38fd5eab08ab4224.png" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2025-01-13</div><div class="title">Flask蓝图的使用</div></div></a></div><div><a href="/posts/43649/" title="Python项目生成依赖文件"><img class="cover" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;https://cdn.randench.cn/assets/404.png&quot;" data-lazy-src="https://cdn.randench.cn/image/24/11/ccf84cec49f74b3e.png" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2024-11-23</div><div class="title">Python项目生成依赖文件</div></div></a></div><div><a href="/posts/65106/" title="上传Python项目到PyPI"><img class="cover" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;https://cdn.randench.cn/assets/404.png&quot;" data-lazy-src="https://cdn.randench.cn/image/25/03/75d1f5c718446d23.webp" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2025-03-17</div><div class="title">上传Python项目到PyPI</div></div></a></div><div><a href="/posts/57236/" title="代理和换源"><img class="cover" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;https://cdn.randench.cn/assets/404.png&quot;" data-lazy-src="https://cdn.randench.cn/image/24/08/c67889d16bbe3749.png" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2024-08-25</div><div class="title">代理和换源</div></div></a></div><div><a href="/posts/59970/" title="软著申请源代码整合脚本"><img class="cover" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;https://cdn.randench.cn/assets/404.png&quot;" data-lazy-src="https://cdn.randench.cn/image/24/12/7feec030a7b3bc0d.png" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2024-12-03</div><div class="title">软著申请源代码整合脚本</div></div></a></div></div></div><hr><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="anzhiyufont anzhiyu-icon-comments"></i> <span>评论</span></div><div class="comment-randomInfo"><a onclick="anzhiyu.addRandomCommentInfo()" href="javascript:void(0)">匿名评论</a><a href="/privacy" style="margin-left:4px">隐私政策</a></div><div class="comment-tips" id="comment-tips"><span>✅ 你无需删除空行，直接评论以获取最佳展示效果</span></div></div><div class="comment-wrap"><div><div id="twikoo-wrap"></div></div></div></div><div class="comment-barrage"></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="card-content"><div class="author-info__sayhi" id="author-info__sayhi" onclick="anzhiyu.changeSayHelloText()"></div><div class="author-info-avatar"><img class="avatar-img" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;https://cdn.randench.cn/assets/404.png&quot;" data-lazy-src="https://cdn.randench.cn/image/24/08/73744fc203b733d8.jpg" onerror='this.onerror=null,this.src="https://cdn.randench.cn/assets/friend_404.gif"' alt="avatar"><div class="author-status"><img class="g-status" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;https://cdn.randench.cn/assets/404.png&quot;" data-lazy-src="https://bu.dusays.com/2023/08/24/64e6ce9c507bb.png" alt="status"></div></div><div class="author-info__description"><div style="line-height:1.38;margin:.6rem 0;text-align:justify;color:rgba(255,255,255,.8)">这有关于<b style="color:#fff">设计、开发</b>相关的问题和看法，还有<b style="color:#fff">一些经验</b>和<b style="color:#fff">分享</b>。</div><div style="line-height:1.38;margin:.6rem 0;text-align:justify;color:rgba(255,255,255,.8)">相信你可以在这里找到对你有用的<b style="color:#fff">知识</b>和<b style="color:#fff">教程</b>。</div></div><div class="author-info__bottom-group"><a class="author-info__bottom-group-left" href="/"><h1 class="author-info__name">RandomEnch</h1><div class="author-info__desc">施恩勿念 受恩莫忘</div></a><div class="card-info-social-icons is-center"><a class="social-icon faa-parent animated-hover" href="https://github.com/RandomEnch" target="_blank" title="Github"><i class="anzhiyufont anzhiyu-icon-github"></i></a><a class="social-icon faa-parent animated-hover" href="https://space.bilibili.com/393998362" target="_blank" title="BiliBili"><i class="anzhiyufont anzhiyu-icon-bilibili"></i></a></div></div></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-bullhorn anzhiyu-shake"></i><span>公告</span></div><div class="announcement_content"><div id="welcome-info"></div></div></div><div class="card-widget card-countdown"><div class="item-content"><div class="cd-count-left" id="countLeft"><span class="cd-text">距离</span><span class="cd-name" id="eventName">春节</span><span class="cd-time" id="daysUntil"></span><span class="cd-date" id="eventDate">2026-02-17</span></div><div class="cd-count-right" id="countRight"></div></div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-bars"></i><span>文章目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%89%8D%E8%A8%80"><span class="toc-number">1.</span> <span class="toc-text">前言</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Redis%E7%AE%80%E4%BB%8B"><span class="toc-number">2.</span> <span class="toc-text">Redis简介</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Redis-%E7%89%B9%E7%82%B9-%E4%BC%98%E5%8A%BF"><span class="toc-number">3.</span> <span class="toc-text">Redis 特点&#x2F;优势</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Redis-%E4%B8%BA%E4%BB%80%E4%B9%88%E5%BE%88%E5%BF%AB"><span class="toc-number">4.</span> <span class="toc-text">Redis 为什么很快</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%BA%94%E7%94%A8%E5%9C%BA%E6%99%AF"><span class="toc-number">5.</span> <span class="toc-text">应用场景</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Redis-%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4"><span class="toc-number">6.</span> <span class="toc-text">Redis 常用命令</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#Python-%E4%B8%AD%E4%BD%BF%E7%94%A8-Redis"><span class="toc-number">7.</span> <span class="toc-text">Python 中使用 Redis</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AE%89%E8%A3%85-redis-py-%E5%BA%93"><span class="toc-number">7.1.</span> <span class="toc-text">安装 redis-py 库</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%BF%9E%E6%8E%A5-Redis-%E6%9C%8D%E5%8A%A1%E5%99%A8"><span class="toc-number">7.2.</span> <span class="toc-text">连接 Redis 服务器</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E6%93%8D%E4%BD%9C"><span class="toc-number">7.3.</span> <span class="toc-text">数据操作</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AD%97%E7%AC%A6%E4%B8%B2%E6%93%8D%E4%BD%9C"><span class="toc-number">7.3.1.</span> <span class="toc-text">字符串操作</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%93%88%E5%B8%8C%E6%93%8D%E4%BD%9C"><span class="toc-number">7.3.2.</span> <span class="toc-text">哈希操作</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%97%E8%A1%A8%E6%93%8D%E4%BD%9C"><span class="toc-number">7.3.3.</span> <span class="toc-text">列表操作</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%9B%86%E5%90%88%E6%93%8D%E4%BD%9C"><span class="toc-number">7.3.4.</span> <span class="toc-text">集合操作</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9C%89%E5%BA%8F%E9%9B%86%E5%90%88"><span class="toc-number">7.3.5.</span> <span class="toc-text">有序集合</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8Redis%E4%BD%9C%E4%B8%BA%E7%BC%93%E5%AD%98"><span class="toc-number">7.4.</span> <span class="toc-text">使用Redis作为缓存</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-history"></i><span>最近发布</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/posts/53922/" title="Linux部署ZeroTier Moon节点"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;https://cdn.randench.cn/assets/404.png&quot;" data-lazy-src="https://cdn.randench.cn/image/25/06/7528a483a6c04a48.webp" onerror='this.onerror=null,this.src="https://cdn.randench.cn/assets/404.png"' alt="Linux部署ZeroTier Moon节点"></a><div class="content"><a class="title" href="/posts/53922/" title="Linux部署ZeroTier Moon节点">Linux部署ZeroTier Moon节点</a><time datetime="2025-06-16T22:43:23.000Z" title="发表于 2025-06-16 22:43:23">2025-06-16</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/2316/" title="音乐馆解除VIP限制"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;https://cdn.randench.cn/assets/404.png&quot;" data-lazy-src="https://cdn.randench.cn/image/25/03/72d3c08fef3e0aa2.webp" onerror='this.onerror=null,this.src="https://cdn.randench.cn/assets/404.png"' alt="音乐馆解除VIP限制"></a><div class="content"><a class="title" href="/posts/2316/" title="音乐馆解除VIP限制">音乐馆解除VIP限制</a><time datetime="2025-03-24T00:22:34.000Z" title="发表于 2025-03-24 00:22:34">2025-03-24</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/65106/" title="上传Python项目到PyPI"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;https://cdn.randench.cn/assets/404.png&quot;" data-lazy-src="https://cdn.randench.cn/image/25/03/75d1f5c718446d23.webp" onerror='this.onerror=null,this.src="https://cdn.randench.cn/assets/404.png"' alt="上传Python项目到PyPI"></a><div class="content"><a class="title" href="/posts/65106/" title="上传Python项目到PyPI">上传Python项目到PyPI</a><time datetime="2025-03-17T18:01:43.000Z" title="发表于 2025-03-17 18:01:43">2025-03-17</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/42313/" title="RKR98键盘使用说明"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;https://cdn.randench.cn/assets/404.png&quot;" data-lazy-src="https://cdn.randench.cn/image/25/03/80def6505eb3875d.webp" onerror='this.onerror=null,this.src="https://cdn.randench.cn/assets/404.png"' alt="RKR98键盘使用说明"></a><div class="content"><a class="title" href="/posts/42313/" title="RKR98键盘使用说明">RKR98键盘使用说明</a><time datetime="2025-03-17T16:58:12.000Z" title="发表于 2025-03-17 16:58:12">2025-03-17</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/posts/23620/" title="Flask蓝图的使用"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;https://cdn.randench.cn/assets/404.png&quot;" data-lazy-src="https://cdn.randench.cn/image/25/03/38fd5eab08ab4224.png" onerror='this.onerror=null,this.src="https://cdn.randench.cn/assets/404.png"' alt="Flask蓝图的使用"></a><div class="content"><a class="title" href="/posts/23620/" title="Flask蓝图的使用">Flask蓝图的使用</a><time datetime="2025-01-13T20:33:42.000Z" title="发表于 2025-01-13 20:33:42">2025-01-13</time></div></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div id="footer_deal"><a class="deal_link" href="mailto:1048421623@qq.com" title="email"><i class="anzhiyufont anzhiyu-icon-envelope"></i></a><a class="deal_link" href="tencent://AddContact/?fromId=50&amp;fromSubId=1&amp;subcmd=all&amp;uin=1048421623" title="QQ"><i class="anzhiyufont anzhiyu-icon-qq"></i></a><a class="deal_link" href="/atom.xml" title="RSS"><i class="anzhiyufont anzhiyu-icon-rss"></i></a><img class="footer_mini_logo" title="返回顶部" alt="返回顶部" onclick="anzhiyu.scrollToDest(0,500)" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;https://cdn.randench.cn/assets/404.png&quot;" data-lazy-src="https://cdn.randench.cn/image/24/08/73744fc203b733d8.jpg" size="50px"><a class="deal_link" target="_blank" rel="noopener" href="https://github.com/RandomEnch" title="Github"><i class="anzhiyufont anzhiyu-icon-github"></i></a><a class="deal_link" target="_blank" rel="noopener" href="https://space.bilibili.com/393998362" title="Bilibili"><i class="anzhiyufont anzhiyu-icon-bilibili"></i></a><a class="deal_link" target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/" title="CC"><i class="anzhiyufont anzhiyu-icon-copyright-line"></i></a></div><div id="anzhiyu-footer"><div class="footer-group"><div class="footer-title">服务</div><div class="footer-links"><a class="footer-item" title="51la统计" target="_blank" rel="noopener" href="https://v6.51.la/">51la统计</a><a class="footer-item" title="十年之约" target="_blank" rel="noopener" href="https://www.foreverblog.cn/">十年之约</a><a class="footer-item" title="开往" target="_blank" rel="noopener" href="https://github.com/travellings-link/travellings">开往</a></div></div><div class="footer-group"><div class="footer-title">直达</div><div class="footer-links"><a class="footer-item" title="归档" href="/archives/">归档</a><a class="footer-item" title="分类" href="/categories/">分类</a><a class="footer-item" title="标签" href="/tags/">标签</a></div></div><div class="footer-group"><div class="footer-title">文章</div><div class="footer-links"><a class="footer-item" title="友人帐" href="/link/">友人帐</a><a class="footer-item" title="朋友圈" href="/fcircle/">朋友圈</a><a class="footer-item" title="留言板" href="/comments/">留言板</a></div></div><div class="footer-group"><div class="footer-title">协议</div><div class="footer-links"><a class="footer-item" title="隐私协议" href="/privacy/">隐私协议</a><a class="footer-item" title="Cookies" href="/cookies/">Cookies</a><a class="footer-item" title="版权协议" href="/copyright/">版权协议</a></div></div><div class="footer-group"><div class="footer-title-group"><div class="footer-title">友链</div><a class="random-friends-btn" id="footer-random-friends-btn" href="javascript:addFriendLinksInFooter();" title="换一批友情链接"><i class="anzhiyufont anzhiyu-icon-arrow-rotate-right"></i></a></div><div class="footer-links" id="friend-links-in-footer"></div></div></div><p id="ghbdages"><a class="github-badge" target="_blank" href="https://hexo.io/" style="margin-inline:5px" data-title="本站使用Hexo框架" title="本站使用Hexo框架"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;https://cdn.randench.cn/assets/404.png&quot;" data-lazy-src="https://cdn.randench.cn/image/24/08/4c529e432a058540.svg" alt="本站使用Hexo框架"></a><a class="github-badge" target="_blank" href="https://github.com/anzhiyu-c/hexo-theme-anzhiyu" style="margin-inline:5px" data-title="本站使用AnZhiYu主题" title="本站使用AnZhiYu主题"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;https://cdn.randench.cn/assets/404.png&quot;" data-lazy-src="https://cdn.randench.cn/image/24/08/70533aead01f0e55.svg" alt="本站使用AnZhiYu主题"></a><a class="github-badge" target="_blank" href="https://github.com/" style="margin-inline:5px" data-title="本站项目由Github托管/自动化部署" title="本站项目由Github托管/自动化部署"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;https://cdn.randench.cn/assets/404.png&quot;" data-lazy-src="https://cdn.randench.cn/image/24/08/3f9b026530152ee9.svg" alt="本站项目由Github托管/自动化部署"></a><a class="github-badge" target="_blank" href="https://www.upyun.com/?utm_source=lianmeng&amp;utm_medium=referral" style="margin-inline:5px" data-title="本站由又拍云提供CDN加速/云存储服务" title="本站由又拍云提供CDN加速/云存储服务"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;https://cdn.randench.cn/assets/404.png&quot;" data-lazy-src="https://cdn.randench.cn/image/24/08/952c4f1a40da39dc.svg" alt="本站由又拍云提供CDN加速/云存储服务"></a><a class="github-badge" target="_blank" href="https://icp.gov.moe/?keyword=20249022" style="margin-inline:5px" data-title="本站已加入萌国ICP备案" title="本站已加入萌国ICP备案"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;https://cdn.randench.cn/assets/404.png&quot;" data-lazy-src="https://cdn.randench.cn/image/24/08/47cf4d14ead2d03f.svg" alt="本站已加入萌国ICP备案"></a><a class="github-badge" target="_blank" href="https://creativecommons.org/licenses/by-nc-sa/4.0/" style="margin-inline:5px" data-title="本站采用知识共享署名-非商业性使用-相同方式共享4.0国际许可协议进行许可" title="本站采用知识共享署名-非商业性使用-相同方式共享4.0国际许可协议进行许可"><img src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;https://cdn.randench.cn/assets/404.png&quot;" data-lazy-src="https://cdn.randench.cn/image/24/08/77f0a6d80f5b049e.svg" alt="本站采用知识共享署名-非商业性使用-相同方式共享4.0国际许可协议进行许可"></a></p></div><div id="footer-bar"><div class="footer-bar-links"><div class="footer-bar-left"><div id="footer-bar-tips"><div class="copyright">&copy;2020 - 2026 By <a class="footer-bar-link" href="/" title="RandomEnch" target="_blank">RandomEnch</a></div></div><div id="footer-type-tips"></div><div class="js-pjax"><script>function subtitleType(){window.typed=new Typed("#footer-type-tips",{strings:["施恩勿念&#44; 受恩莫忘"],startDelay:300,typeSpeed:150,loop:!0,backSpeed:50})}"function"==typeof Typed?subtitleType():getScript("https://cdn.cbd.int/typed.js@2.1.0/dist/typed.umd.js").then(subtitleType)</script></div></div><div class="footer-bar-right"><a class="footer-bar-link" target="_blank" rel="noopener" href="https://beian.miit.gov.cn/" title="苏ICP备-2024064902号-2">苏ICP备-2024064902号-2</a><a class="footer-bar-link cc" target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/" title="cc协议"><i class="iconfont icon-line"></i><i class="iconfont icon-by-line"></i><i class="iconfont icon-nc-line"></i><i class="iconfont icon-nd-line"></i></a></div></div></div></footer></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="sidebar-site-data site-data is-center"><a href="/archives/" title="archive"><div class="headline">文章</div><div class="length-num">42</div></a><a href="/tags/" title="tag"><div class="headline">标签</div><div class="length-num">35</div></a><a href="/categories/" title="category"><div class="headline">分类</div><div class="length-num">7</div></a></div><span class="sidebar-menu-item-title">功能</span><div class="sidebar-menu-item"><a class="darkmode_switchbutton menu-child" href="javascript:void(0);" title="显示模式"><i class="anzhiyufont anzhiyu-icon-circle-half-stroke"></i><span>显示模式</span></a></div><div class="back-menu-list-groups"><div class="back-menu-list-group"><div class="back-menu-list-title">网页</div><div class="back-menu-list"><a class="back-menu-item" href="https://blog.randench.cn/" title="博客"><img class="back-menu-item-icon" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;https://cdn.randench.cn/assets/404.png&quot;" data-lazy-src="https://cdn.randench.cn/assets/favicon.ico" alt="博客"><span class="back-menu-item-text">博客</span></a><a class="back-menu-item" target="_blank" rel="noopener" href="https://status.randench.cn/" title="站点监测"><img class="back-menu-item-icon" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;https://cdn.randench.cn/assets/404.png&quot;" data-lazy-src="https://cdn.randench.cn/image/24/08/4b35ffab73353564.ico" alt="站点监测"><span class="back-menu-item-text">站点监测</span></a><a class="back-menu-item" target="_blank" rel="noopener" href="https://www.randench.cn/" title="主页"><img class="back-menu-item-icon" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;https://cdn.randench.cn/assets/404.png&quot;" data-lazy-src="https://cdn.randench.cn/image/24/08/73744fc203b733d8.jpg" alt="主页"><span class="back-menu-item-text">主页</span></a><a class="back-menu-item" target="_blank" rel="noopener" href="https://hot.randench.cn/" title="今日热点"><img class="back-menu-item-icon" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;https://cdn.randench.cn/assets/404.png&quot;" data-lazy-src="https://cdn.randench.cn/image/24/08/ff3f9a2e5fdfd521.png" alt="今日热点"><span class="back-menu-item-text">今日热点</span></a><a class="back-menu-item" target="_blank" rel="noopener" href="https://music.randench.cn/" title="音乐"><img class="back-menu-item-icon" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;https://cdn.randench.cn/assets/404.png&quot;" data-lazy-src="https://cdn.randench.cn/image/24/08/0c18c494a5c97166.ico" alt="音乐"><span class="back-menu-item-text">音乐</span></a><a class="back-menu-item" target="_blank" rel="noopener" href="https://cloud.randench.cn/" title="网盘"><img class="back-menu-item-icon" src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;https://cdn.randench.cn/assets/404.png&quot;" data-lazy-src="https://cdn.randench.cn/image/24/08/00a3f03c0954d37f.ico" alt="网盘"><span class="back-menu-item-text">网盘</span></a></div></div></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-file-lines faa-tada" style="font-size:.9em"></i> <span>文章</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/archives/"><i class="anzhiyufont anzhiyu-icon-box-archive faa-tada" style="font-size:.9em"></i> <span>归档</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/tags/"><i class="anzhiyufont anzhiyu-icon-tags faa-tada" style="font-size:.9em"></i> <span>标签</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/categories/"><i class="anzhiyufont anzhiyu-icon-shapes faa-tada" style="font-size:.9em"></i> <span>分类</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/charts/"><i class="fa-solid fa-chart-area faa-tada"></i> <span>统计</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-solid fa-user faa-tada"></i> <span>我的</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/bangumis/"><i class="anzhiyufont anzhiyu-icon-bilibili faa-tada" style="font-size:.9em"></i> <span>追番页</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/music/?id=9149426095&amp;server=netease"><i class="anzhiyufont anzhiyu-icon-music faa-tada" style="font-size:.9em"></i> <span>音乐馆</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/games/"><i class="fa-solid fa-gamepad faa-tada"></i> <span>游戏厅</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-paper-plane faa-tada" style="font-size:.9em"></i> <span>友链</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/link/"><i class="anzhiyufont anzhiyu-icon-link faa-tada" style="font-size:.9em"></i> <span>友人帐</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/fcircle/"><i class="anzhiyufont anzhiyu-icon-artstation faa-tada" style="font-size:.9em"></i> <span>朋友圈</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/comments/"><i class="anzhiyufont anzhiyu-icon-envelope faa-tada" style="font-size:.9em"></i> <span>留言板</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-solid fa-chess-queen faa-tada"></i> <span>关于</span></a><ul class="menus_item_child"><li><a class="site-page child faa-parent animated-hover" href="/air-conditioner/"><i class="anzhiyufont anzhiyu-icon-fan faa-tada" style="font-size:.9em"></i> <span>小空调</span></a></li><li><a class="site-page child faa-parent animated-hover" href="/about/"><i class="anzhiyufont anzhiyu-icon-paper-plane faa-tada" style="font-size:.9em"></i> <span>关于本人</span></a></li><li><a class="site-page child faa-parent animated-hover" href="javascript:toRandomPost()"><i class="anzhiyufont anzhiyu-icon-shoe-prints1 faa-tada" style="font-size:.9em"></i> <span>随便逛逛</span></a></li></ul></div></div><span class="sidebar-menu-item-title">标签</span><div class="card-tags"><div class="item-headline"></div><div class="card-tag-cloud"><a href="/tags/AnZhiYu/" style="font-size:.88rem">AnZhiYu<sup>10</sup></a><a href="/tags/Butterfly/" style="font-size:.88rem">Butterfly<sup>3</sup></a><a href="/tags/CDN/" style="font-size:.88rem">CDN<sup>1</sup></a><a href="/tags/CSS/" style="font-size:.88rem">CSS<sup>1</sup></a><a href="/tags/Flask/" style="font-size:.88rem">Flask<sup>1</sup></a><a href="/tags/Galgame/" style="font-size:.88rem">Galgame<sup>1</sup></a><a href="/tags/HTML/" style="font-size:.88rem">HTML<sup>1</sup></a><a href="/tags/JS/" style="font-size:.88rem">JS<sup>1</sup></a><a href="/tags/Java/" style="font-size:.88rem">Java<sup>1</sup></a><a href="/tags/Linux/" style="font-size:.88rem">Linux<sup>3</sup></a><a href="/tags/MC/" style="font-size:.88rem">MC<sup>1</sup></a><a href="/tags/Maven/" style="font-size:.88rem">Maven<sup>1</sup></a><a href="/tags/PyPI/" style="font-size:.88rem">PyPI<sup>1</sup></a><a href="/tags/Python/" style="font-size:.88rem">Python<sup>6</sup></a><a href="/tags/Redis/" style="font-size:.88rem">Redis<sup>1</sup></a><a href="/tags/Serverless/" style="font-size:.88rem">Serverless<sup>1</sup></a><a href="/tags/ZeroTier/" style="font-size:.88rem">ZeroTier<sup>1</sup></a><a href="/tags/cdn/" style="font-size:.88rem">cdn<sup>1</sup></a><a href="/tags/git/" style="font-size:.88rem">git<sup>4</sup></a><a href="/tags/linux/" style="font-size:.88rem">linux<sup>1</sup></a><a href="/tags/live2d/" style="font-size:.88rem">live2d<sup>1</sup></a><a href="/tags/npm/" style="font-size:.88rem">npm<sup>1</sup></a><a href="/tags/%E5%89%8D%E7%AB%AF/" style="font-size:.88rem">前端<sup>1</sup></a><a href="/tags/%E5%AD%97%E4%BD%93%E5%8E%8B%E7%BC%A9/" style="font-size:.88rem">字体压缩<sup>1</sup></a><a href="/tags/%E5%AE%9D%E5%A1%94/" style="font-size:.88rem">宝塔<sup>1</sup></a><a href="/tags/%E5%AE%9E%E7%94%A8/" style="font-size:.88rem">实用<sup>6</sup></a><a href="/tags/%E5%B7%A5%E5%85%B7/" style="font-size:.88rem">工具<sup>1</sup></a><a href="/tags/%E6%95%99%E7%A8%8B/" style="font-size:.88rem">教程<sup>9</sup></a><a href="/tags/%E6%B2%B9%E7%8C%B4/" style="font-size:.88rem">油猴<sup>1</sup></a><a href="/tags/%E6%B8%B8%E6%88%8F/" style="font-size:.88rem">游戏<sup>1</sup></a><a href="/tags/%E7%BD%91%E8%AF%BE/" style="font-size:.88rem">网课<sup>1</sup></a><a href="/tags/%E7%BE%8E%E5%8C%96/" style="font-size:.88rem">美化<sup>21</sup></a><a href="/tags/%E8%BD%AF%E8%91%97/" style="font-size:.88rem">软著<sup>1</sup></a><a href="/tags/%E9%94%AE%E7%9B%98/" style="font-size:.88rem">键盘<sup>1</sup></a><a href="/tags/%E9%AD%94%E6%94%B9/" style="font-size:.88rem">魔改<sup>19</sup></a></div></div><hr></div></div><div id="keyboard-tips"><div class="keyboardTitle">博客快捷键</div><div class="keybordList"><div class="keybordItem"><div class="keyGroup"><div class="key">SHIFT K</div></div><div class="keyContent"><div class="content">关闭快捷键功能</div></div></div><div class="keybordItem"><div class="keyGroup"><div class="key">SHIFT A</div></div><div class="keyContent"><div class="content">打开/关闭中控台</div></div></div><div class="keybordItem"><div class="keyGroup"><div class="key">SHIFT M</div></div><div class="keyContent"><div class="content">播放/暂停音乐</div></div></div><div class="keybordItem"><div class="keyGroup"><div class="key">SHIFT D</div></div><div class="keyContent"><div class="content">深色/浅色显示模式</div></div></div><div class="keybordItem"><div class="keyGroup"><div class="key">SHIFT S</div></div><div class="keyContent"><div class="content">站内搜索</div></div></div><div class="keybordItem"><div class="keyGroup"><div class="key">SHIFT R</div></div><div class="keyContent"><div class="content">随机访问</div></div></div><div class="keybordItem"><div class="keyGroup"><div class="key">SHIFT H</div></div><div class="keyContent"><div class="content">返回首页</div></div></div><div class="keybordItem"><div class="keyGroup"><div class="key">SHIFT L</div></div><div class="keyContent"><div class="content">友链页面</div></div></div><div class="keybordItem"><div class="keyGroup"><div class="key">SHIFT P</div></div><div class="keyContent"><div class="content">关于本站</div></div></div><div class="keybordItem"><div class="keyGroup"><div class="key">SHIFT I</div></div><div class="keyContent"><div class="content">原版/本站右键菜单</div></div></div></div></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="anzhiyufont anzhiyu-icon-book-open"></i></button><button id="translateLink" type="button" title="简繁转换">繁</button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="anzhiyufont anzhiyu-icon-circle-half-stroke"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="anzhiyufont anzhiyu-icon-arrows-left-right"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="anzhiyufont anzhiyu-icon-gear"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="anzhiyufont anzhiyu-icon-list-ul"></i></button><button id="to_comment" type="button" title="直达评论" onclick="FixedCommentBtn()"><i class="anzhiyufont anzhiyu-icon-comments"></i></button><button id="go-up" type="button" title="回到顶部"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i></button></div></div><div id="nav-music"><a id="nav-music-hoverTips" onclick="anzhiyu.musicToggle()" accesskey="m">播放音乐</a><div id="console-music-bg"></div><meting-js id="7450526032" server="netease" type="playlist" mutex="true" preload="none" theme="var(--anzhiyu-main)" data-lrctype="0" order="random" volume="0.7"></meting-js></div><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="anzhiyufont anzhiyu-icon-xmark"></i></button></nav><div class="is-center" id="loading-database"><i class="anzhiyufont anzhiyu-icon-spinner anzhiyu-pulse-icon"></i> <span>数据库加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"></div></div><hr><div id="local-search-results"></div></div></div><div id="search-mask"></div></div><div id="rightMenu"><div class="rightMenu-group rightMenu-small"><div class="rightMenu-item" id="menu-backward"><i class="anzhiyufont anzhiyu-icon-arrow-left"></i></div><div class="rightMenu-item" id="menu-forward"><i class="anzhiyufont anzhiyu-icon-arrow-right"></i></div><div class="rightMenu-item" id="menu-refresh"><i class="anzhiyufont anzhiyu-icon-arrow-rotate-right" style="font-size:1rem"></i></div><div class="rightMenu-item" id="menu-top"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i></div></div><div class="rightMenu-group rightMenu-line rightMenuPlugin"><div class="rightMenu-item" id="menu-copytext"><i class="anzhiyufont anzhiyu-icon-copy"></i><span>复制选中文本</span></div><div class="rightMenu-item" id="menu-pastetext"><i class="anzhiyufont anzhiyu-icon-paste"></i><span>粘贴文本</span></div><a class="rightMenu-item" id="menu-commenttext"><i class="anzhiyufont anzhiyu-icon-comment-medical"></i><span>引用到评论</span></a><div class="rightMenu-item" id="menu-newwindow"><i class="anzhiyufont anzhiyu-icon-window-restore"></i><span>新窗口打开</span></div><div class="rightMenu-item" id="menu-copylink"><i class="anzhiyufont anzhiyu-icon-link"></i><span>复制链接地址</span></div><div class="rightMenu-item" id="menu-copyimg"><i class="anzhiyufont anzhiyu-icon-images"></i><span>复制此图片</span></div><div class="rightMenu-item" id="menu-downloadimg"><i class="anzhiyufont anzhiyu-icon-download"></i><span>下载此图片</span></div><div class="rightMenu-item" id="menu-newwindowimg"><i class="anzhiyufont anzhiyu-icon-window-restore"></i><span>新窗口打开图片</span></div><div class="rightMenu-item" id="menu-search"><i class="anzhiyufont anzhiyu-icon-magnifying-glass"></i><span>站内搜索</span></div><div class="rightMenu-item" id="menu-searchBaidu"><i class="anzhiyufont anzhiyu-icon-magnifying-glass"></i><span>百度搜索</span></div><div class="rightMenu-item" id="menu-music-playlist" onclick="window.open(&quot;https://music.163.com/playlist?id=7450526032&quot;, &quot;_blank&quot;);" style="display:none"><i class="anzhiyufont anzhiyu-icon-radio"></i><span>查看所有歌曲</span></div><div class="rightMenu-item" id="menu-music-copyMusicName"><i class="anzhiyufont anzhiyu-icon-copy"></i><span>复制歌名</span></div></div><div class="rightMenu-group rightMenu-line rightMenuOther"><a class="rightMenu-item menu-link" id="menu-randomPost"><i class="anzhiyufont anzhiyu-icon-shuffle"></i><span>随便逛逛</span></a><a class="rightMenu-item menu-link" href="/categories/"><i class="anzhiyufont anzhiyu-icon-cube"></i><span>博客分类</span></a><a class="rightMenu-item menu-link" href="/tags/"><i class="anzhiyufont anzhiyu-icon-tags"></i><span>文章标签</span></a></div><div class="rightMenu-group rightMenu-line rightMenuOther"><a class="rightMenu-item" id="menu-copy" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-copy"></i><span>复制地址</span></a><a class="rightMenu-item" id="menu-commentBarrage" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-message"></i><span class="menu-commentBarrage-text">关闭热评</span></a><a class="rightMenu-item" id="menu-darkmode" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-circle-half-stroke"></i><span class="menu-darkmode-text">深色模式</span></a><a class="rightMenu-item" id="menu-translate" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-language"></i><span>轉為繁體</span></a><a class="rightMenu-item" id="menu-rightMenuToggle" onclick="anzhiyu.rightMenuToggle()"><i class="iconfont icon-list"></i><span>原生菜单</span></a></div><div class="rightMenu-group rightMenu-music rightMenuPlayer"><a class="rightMenuMusic-item" id="menu-music-data"><span id="name"></span><span id="artist"></span></a><a class="rightMenuMusic-item" id="menu-music-volume"><div id="menu-music-volume-down"><i class="iconfont icon-volume-down"></i></div><div id="volume-slider"><div id="slider-rail"><div id="slider-process"></div><div id="slider-dot"><div id="slider-dot-handle"></div></div></div></div><div id="menu-music-volume-up"><i class="iconfont icon-volume-up"></i></div></a><a class="rightMenuMusic-item" id="menu-music-control"><div id="menu-music-back"><i class="iconfont icon-prev"></i></div><div id="menu-music-toggle"><i class="iconfont icon-play"></i></div><div id="menu-music-forward"><i class="iconfont icon-next"></i></div></a></div></div><div id="rightmenu-mask"></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.cbd.int/@fancyapps/ui@5.0.28/dist/fancybox/fancybox.umd.js"></script><script src="https://cdn.cbd.int/instant.page@5.2.0/instantpage.js" type="module"></script><script src="https://cdn.cbd.int/vanilla-lazyload@17.8.5/dist/lazyload.iife.min.js"></script><script src="https://cdn.cbd.int/node-snackbar@0.1.16/dist/snackbar.min.js"></script><script>function panguFn(){"object"==typeof pangu?pangu.autoSpacingPage():getScript("https://cdn.cbd.int/pangu@4.0.7/dist/browser/pangu.min.js").then((()=>{pangu.autoSpacingPage()}))}function panguInit(){panguFn()}document.addEventListener("DOMContentLoaded",panguInit)</script><script>var meting_api="https://meting.randench.cn/?server=:server&type=:type&id=:id&auth=:auth&r=:r"</script><canvas id="universe"></canvas><script async src="https://npm.elemecdn.com/anzhiyu-theme-static@1.0.0/dark/dark.js"></script><script async src="/anzhiyu/random.js"></script><script src="/js/search/local-search.js"></script><div class="js-pjax"><script>(()=>{const o=()=>{"object"==typeof twikoo?setTimeout(t,0):getScript("https://registry.npmmirror.com/twikoo/1.6.44/files/dist/twikoo.min.js").then(t)},t=()=>{twikoo.init(Object.assign({el:"#twikoo-wrap",envId:"https://twikoo.randench.cn",region:"",onCommentLoaded:()=>{anzhiyu.loadLightbox(document.querySelectorAll("#twikoo .tk-content img:not(.tk-owo-emotion)"))}},null))};o()})()</script><input type="hidden" name="page-type" id="page-type" value="post"></div><script>window.addEventListener("load",(()=>{const e=e=>{let t="";if(e.length)for(let n=0;n<e.length;n++){t+="<div class='aside-list-item'>";{const a="data-lazy-src";t+=`<a href='${e[n].url}' class='thumbnail'><img ${a}='${e[n].avatar}' alt='${e[n].nick}'><div class='name'><span>${e[n].nick} </span></div></a>`}t+=`<div class='content'>\n        <a class='comment' href='${e[n].url}' title='${e[n].content}'>${e[n].content}</a>\n        <time datetime="${e[n].date}">${anzhiyu.diffDate(e[n].date,!0)}</time></div>\n        </div>`}else t+="没有评论";let n=document.querySelector("#card-newest-comments .aside-list");n&&(n.innerHTML=t),window.lazyLoadInstance&&window.lazyLoadInstance.update(),window.pjax&&window.pjax.refresh(n)},t=()=>{if(document.querySelector("#card-newest-comments .aside-list")){const t=saveToLocal.get("twikoo-newest-comments");t?e(JSON.parse(t)):(()=>{const t=()=>{twikoo.getRecentComments({envId:"https://twikoo.randench.cn",region:"",pageSize:6,includeReply:!0}).then((function(t){const n=t.map((e=>{return{content:(t=e.comment,""===t||(t=(t=(t=(t=t.replace(/<img.*?src="(.*?)"?[^\>]+>/gi,"[图片]")).replace(/<a[^>]+?href=["']?([^"']+)["']?[^>]*>([^<]+)<\/a>/gi,"[链接]")).replace(/<pre><code>.*?<\/pre>/gi,"[代码]")).replace(/<[^>]+>/g,"")).length>150&&(t=t.substring(0,150)+"..."),t),avatar:e.avatar,nick:e.nick,url:e.url+"#"+e.id,date:new Date(e.created).toISOString()};var t}));saveToLocal.set("twikoo-newest-comments",JSON.stringify(n),10/1440),e(n)})).catch((function(e){document.querySelector("#card-newest-comments .aside-list").textContent="无法获取评论，请确认相关配置是否正确"}))};"object"==typeof twikoo?t():getScript("https://registry.npmmirror.com/twikoo/1.6.44/files/dist/twikoo.min.js").then(t)})()}};t(),document.addEventListener("pjax:complete",t)}))</script><script async data-pjax src="https://npm.elemecdn.com/anzhiyu-theme-static@1.0.1/bubble/bubble.js"></script><script>var visitorMail=""</script><script async data-pjax src="https://cdn.cbd.int/anzhiyu-theme-static@1.0.0/waterfall/waterfall.js"></script><script src="https://lf3-cdn-tos.bytecdntp.com/cdn/expire-1-M/qrcodejs/1.0.0/qrcode.min.js"></script><script src="/js/anzhiyu/right_click_menu.js"></script><link rel="stylesheet" href="https://cdn.cbd.int/anzhiyu-theme-static@1.1.9/icon/ali_iconfont_css.css"><script defer src="https://cdn.randench.cn/live2d-widget/autoload.js"></script><script async src="https://cdn.randench.cn/js/custom/sun_moon.js"></script><script async src="https://cdn.randench.cn/js/custom/fixed_comment.js"></script><script async src="https://lib.baomitu.com/echarts/4.9.0-rc.1/echarts.min.js"></script><script async src="https://cdn.randench.cn/js/countdown.js"></script><script async src="https://cdn.randench.cn/js/swiper-bundle.min.js"></script><script data-pjax async src="https://cdn.randench.cn/js/welcome.js"></script><script data-pjax async src="https://cdn.randench.cn/js/imgloaded.js"></script><script data-pjax async src="https://cdn.randench.cn/js/grayscale.js"></script><script data-pjax async src="https://cdn.randench.cn/js/history.js"></script><script id="click-heart" src="https://cdn.cbd.int/butterfly-extsrc@1.1.3/dist/click-heart.min.js" async mobile="false"></script><link rel="stylesheet" href="https://cdn.cbd.int/anzhiyu-theme-static@1.0.0/aplayer/APlayer.min.css" media="print" onload='this.media="all"'><script src="https://cdn.cbd.int/anzhiyu-blog-static@1.0.1/js/APlayer.min.js"></script><script src="https://cdn.cbd.int/hexo-anzhiyu-music@1.0.1/assets/js/Meting2.min.js"></script><script src="https://cdn.cbd.int/pjax@0.2.8/pjax.min.js"></script><script>let pjaxSelectors=['meta[property="og:image"]','meta[property="og:title"]','meta[property="og:url"]','meta[property="og:type"]','meta[property="og:site_name"]','meta[property="og:description"]',"head > title","#config-diff","#body-wrap","#rightside-config-hide","#rightside-config-show",".js-pjax"];var pjax=new Pjax({elements:'a:not([target="_blank"])',selectors:pjaxSelectors,cacheBust:!1,analytics:!1,scrollRestoration:!1});document.addEventListener("pjax:send",(function(){if(anzhiyu.removeGlobalFnEvent("pjax"),anzhiyu.removeGlobalFnEvent("themeChange"),document.getElementById("rightside").classList.remove("rightside-show"),window.aplayers)for(let e=0;e<window.aplayers.length;e++)window.aplayers[e].options.fixed||window.aplayers[e].destroy();"object"==typeof typed&&typed.destroy();const e=document.body.classList;e.contains("read-mode")&&e.remove("read-mode")})),document.addEventListener("pjax:complete",(function(){window.refreshFn(),document.querySelectorAll("script[data-pjax]").forEach((e=>{const t=document.createElement("script"),o=e.text||e.textContent||e.innerHTML||"";Array.from(e.attributes).forEach((e=>t.setAttribute(e.name,e.value))),t.appendChild(document.createTextNode(o)),e.parentNode.replaceChild(t,e)})),GLOBAL_CONFIG.islazyload&&window.lazyLoadInstance.update(),"function"==typeof panguInit&&panguInit(),"function"==typeof gtag&&gtag("config","",{page_path:window.location.pathname}),"object"==typeof _hmt&&_hmt.push(["_trackPageview",window.location.pathname]),"function"==typeof loadMeting&&document.getElementsByClassName("aplayer").length&&loadMeting(),"object"==typeof Prism&&Prism.highlightAll()})),document.addEventListener("pjax:error",(e=>{404===e.request.status&&pjax.loadUrl("/404.html")}))</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><script charset="UTF-8" src="https://cdn.cbd.int/anzhiyu-theme-static@1.1.5/accesskey/accesskey.js"></script></div><div id="popup-window"><div class="popup-window-title">通知</div><div class="popup-window-divider"></div><div class="popup-window-content"><div class="popup-tip">你好呀</div><div class="popup-link"><i class="anzhiyufont anzhiyu-icon-arrow-circle-right"></i></div></div></div><div class="js-pjax"><script async>for(var arr=document.getElementsByClassName("recent-post-item"),i=0;i<arr.length;i++)arr[i].classList.add("wow"),arr[i].classList.add("animate__zoomIn"),arr[i].setAttribute("data-wow-duration","600ms"),arr[i].setAttribute("data-wow-delay","100ms"),arr[i].setAttribute("data-wow-offset","100"),arr[i].setAttribute("data-wow-iteration","1")</script><script async>for(var arr=document.getElementsByClassName("card-widget"),i=0;i<arr.length;i++)arr[i].classList.add("wow"),arr[i].classList.add("animate__zoomIn"),arr[i].setAttribute("data-wow-duration",""),arr[i].setAttribute("data-wow-delay",""),arr[i].setAttribute("data-wow-offset",""),arr[i].setAttribute("data-wow-iteration","")</script></div><script defer src="https://npm.elemecdn.com/hexo-butterfly-wowjs/lib/wow.min.js"></script><script defer src="https://npm.elemecdn.com/hexo-butterfly-wowjs/lib/wow_init.js"></script></body></html>